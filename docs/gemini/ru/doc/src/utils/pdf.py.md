# Модуль `pdf`

## Обзор

Модуль `pdf` предназначен для преобразования HTML-контента или файлов в PDF с использованием различных библиотек. Он предоставляет набор статических методов класса `PDFUtils` для сохранения HTML в PDF, а также для конвертации PDF в HTML.

## Оглавление

1. [Классы](#классы)
    - [`PDFUtils`](#pdfutils)
2. [Функции](#функции)
    - [`set_project_root`](#set_project_root)
    - [`pdf_to_html`](#pdf_to_html)
    - [`html2pdf`](#html2pdf)

## Классы

### `PDFUtils`

**Описание**: Класс для работы с PDF-файлами, предоставляющий методы для сохранения HTML-контента в PDF с использованием различных библиотек.

**Методы**:
- `save_pdf_pdfkit`: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `pdfkit`.
- `save_pdf_fpdf`: Сохраняет текст в PDF с использованием библиотеки `FPDF`.
- `save_pdf_weasyprint`: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `WeasyPrint`.
- `save_pdf_xhtml2pdf`: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `xhtml2pdf`.

#### `save_pdf_pdfkit`

**Описание**: Сохранить HTML-контент или файл в PDF с использованием библиотеки `pdfkit`.

**Параметры**:
- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True` если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `pdfkit.PDFKitError`: Ошибка генерации PDF через `pdfkit`.
- `OSError`: Ошибка доступа к файлу.
- `Exception`: Неожиданная ошибка.

#### `save_pdf_fpdf`

**Описание**: Сохранить текст в PDF с использованием библиотеки FPDF.

**Параметры**:
- `data` (str): Текст, который необходимо сохранить в PDF.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True`, если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `FileNotFoundError`: Если не найден файл шрифтов или сам шрифт.
- `Exception`: Ошибка при сохранении PDF через FPDF.

#### `save_pdf_weasyprint`

**Описание**: Сохранить HTML-контент или файл в PDF с использованием библиотеки `WeasyPrint`.

**Параметры**:
- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True` если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `Exception`: Ошибка при сохранении PDF через WeasyPrint.

#### `save_pdf_xhtml2pdf`

**Описание**: Сохранить HTML-контент или файл в PDF с использованием библиотеки `xhtml2pdf`.

**Параметры**:
- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True` если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `Exception`: Ошибка при сохранении PDF через xhtml2pdf.

#### `html2pdf`

**Описание**: Преобразует HTML-контент в PDF-файл, используя `WeasyPrint`.

**Параметры**:
- `html_str` (str): HTML-контент в виде строки.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool | None`: `True`, если PDF успешно сгенерирован, иначе `None`.

**Вызывает исключения**:
- `Exception`: Ошибка во время генерации PDF.

## Функции

### `set_project_root`

**Описание**: Находит корневой каталог проекта, начиная с каталога текущего файла, и останавливается на первом каталоге, содержащем один из файлов-маркеров.

**Параметры**:
- `marker_files` (tuple): Имена файлов или каталогов для идентификации корня проекта. По умолчанию `('__root__', '.git')`.

**Возвращает**:
- `Path`: Путь к корневому каталогу, если найден, иначе каталог, где находится скрипт.

### `pdf_to_html`

**Описание**: Конвертирует PDF-файл в HTML-файл.

**Параметры**:
- `pdf_file` (str | Path): Путь к исходному PDF-файлу.
- `html_file` (str | Path): Путь к сохраняемому HTML-файлу.

**Возвращает**:
- `bool`: `True`, если конвертация прошла успешно, иначе `False`.

**Вызывает исключения**:
- `Exception`: Ошибка при конвертации PDF в HTML.