## <algorithm>

1.  **התחלה:**
    *   הסקריפט מתחיל.
    *   דוגמא: הפעלת הסקריפט `anagram.py` מהטרמינל.

2.  **ייבוא ספריות:**
    *   ספריית `google.generativeai` מיובאת לשימוש במודלים של Gemini.
    *   ספריית `re` מיובאת לשימוש בביטויים רגולריים.
    *   דוגמא: `import google.generativeai as genai`, `import re`.

3.  **הגדרת מחלקה `GoogleGenerativeAI`:**
    *   הגדרה של מחלקה לניהול אינטראקציה עם מודלי Gemini.
    *   המאפיינים כוללים מפתח API, שם המודל, והוראת מערכת (system prompt).
    *   דוגמא:
        *   `MODELS = ["gemini-1.5-flash-8b", "gemini-2-13b", "gemini-3-20b"]` - רשימה של מודלים.
        *   `__init__(self, api_key, system_instruction, model_name)` - אתחול המודל.
        *   `ask(self, q)` - שליחת שאילתה וקבלת תשובה.

4.  **אתחול מודל:**
    *   המשתמש מתבקש להזין מפתח API.
    *   יצירת מופע של המחלקה `GoogleGenerativeAI` עם מפתח ה-API והוראת המערכת.
    *   דוגמא:
        *   `API_KEY = input("API ключ от `gemini`: ")` - קבלת קלט מהמשתמש.
        *   `model = GoogleGenerativeAI(api_key=API_KEY, system_instruction=system_instruction)` - יצירת מופע.

5.  **לולאת אינטראקציה:**
    *   לולאה אינסופית המאפשרת למשתמש להזין אותיות.
    *   דוגמא: `while True:`

6.  **קבלת קלט משתמש:**
    *   המשתמש מתבקש להזין אותיות עבור חיפוש אנאגרמה.
    *   דוגמא: `q = input("Введитe буквы, по которым Gemini подберет анаграмму (для выхода нажмите Ctrl+C): ")`

7.  **ניקוי הקלט:**
    *   קלט המשתמש עובר ניקוי מכל התווים שאינם אותיות קיריליות.
    *   דוגמא:
        *   `q = re.sub(r"[^а-яА-ЯёЁ]", "", q)` - הסרת תווים שאינם קיריליים.
        *   `if not q:` - בדיקה אם הקלט ריק אחרי ניקוי.

8.  **שליחת שאילתה למודל:**
    *   השאילתה (קלט המשתמש הנקי) נשלחת למודל Gemini.
    *   דוגמא: `response = model.ask(q)`

9.  **קבלת תשובה:**
    *   התשובה המתקבלת מהמודל (המילה או "Нет анаграмм") מודפסת לקונסולה.
    *   דוגמא: `print(response)`

10. **חזרה ללולאה:**
    *   הסקריפט חוזר ללולאת האינטראקציה, וממתין לקלט נוסף.
    *   דוגמא: חזרה לשלב 5.

11. **סיום:**
    *   הסקריפט מסתיים כאשר המשתמש יוצא מהלולאה באמצעות `Ctrl+C`.

## <mermaid>

```mermaid
flowchart TD
    Start[התחלה] --> ImportLibraries[ייבוא ספריות: <br><code>google.generativeai</code>, <code>re</code>];
    ImportLibraries --> DefineClass[הגדרת מחלקה: <br><code>GoogleGenerativeAI</code>];
    DefineClass --> InitModel[אתחול מודל: <br>קבלת מפתח API, <br>יצירת מופע <code>GoogleGenerativeAI</code>];
    InitModel --> InteractionLoop[לולאת אינטראקציה];
    InteractionLoop --> GetUserInput[קבלת קלט משתמש: <br>אותיות לאנאגרמה];
    GetUserInput --> CleanInput[ניקוי קלט: <br>הסרת תווים שאינם קיריליים];
    CleanInput --> CheckInput[בדיקת קלט: <br>אם קלט ריק];
    CheckInput -- קלט ריק --> PrintError[הדפסת שגיאה];
    PrintError --> InteractionLoop;
    CheckInput -- קלט תקין --> SendQueryToModel[שליחת שאילתה למודל Gemini];
    SendQueryToModel --> GetModelResponse[קבלת תשובה מהמודל];
    GetModelResponse --> PrintResponse[הדפסת תשובה];
    PrintResponse --> InteractionLoop;
    InteractionLoop --> End[סיום (Ctrl+C)];
```

## <explanation>

**ייבואים (Imports):**

*   `google.generativeai as genai`: ספרייה זו משמשת לאינטראקציה עם מודלי הבינה המלאכותית של Google Gemini. היא מאפשרת לשלוח שאילתות למודל ולקבל תשובות, וכוללת בין השאר את `genai.configure` להגדרת מפתח ה-API ואת `genai.GenerativeModel` לאתחול מודל.
*   `re`: ספרייה זו מספקת תמיכה בביטויים רגולריים, שבהם משתמשים כדי לטפל בטקסט, למשל להסיר תווים לא רצויים. כאן, היא משמשת לניקוי הקלט של המשתמש.

**מחלקות (Classes):**

*   `GoogleGenerativeAI`:
    *   **תפקיד**: מחלקה זו מגדירה את האופן בו מתקשרים עם מודלי Gemini. היא עוטפת את הפונקציונליות של ספריות `google.generativeai`, ומקלה על שימוש במודל.
    *   **מאפיינים**:
        *   `MODELS`: רשימה של שמות מודלים זמינים (לדוגמה `gemini-1.5-flash-8b`).
        *   `api_key`: מפתח API לצורך אימות עם שירותי Gemini.
        *   `model_name`: שם המודל הספציפי בו משתמשים.
        *   `model`: מופע של מודל Gemini, שנוצר לאחר אתחול.
    *   **שיטות**:
        *   `__init__(self, api_key, system_instruction, model_name)`: פעולת האתחול של המחלקה. מקבלת מפתח API, הוראת מערכת ושם מודל.
        *   `ask(self, q)`: מקבלת שאילתה (`q`) ומחזירה את תשובת המודל או הודעת שגיאה במידה ומתרחשת שגיאה.
    *   **אינטראקציה**: המחלקה יוצרת קשר עם שירותי Gemini באמצעות ספריית `google.generativeai`, ומטפלת בשליחת שאילתות וקבלת תשובות.

**פונקציות (Functions):**

*   `__init__(self, api_key: str, system_instruction: str = "", model_name: str = "gemini-2.0-flash-exp")`:
    *   **פרמטרים**:
        *   `api_key`: מפתח ה-API של גוגל.
        *   `system_instruction`: ההוראה (ה-prompt) למודל, ברירת מחדל היא מחרוזת ריקה.
        *   `model_name`: שם המודל לשימוש, ברירת מחדל היא `"gemini-2.0-flash-exp"`.
    *   **ערך מוחזר**: אין (None).
    *   **מטרה**: אתחול מופע של המחלקה `GoogleGenerativeAI`, כולל קביעת תצורה של ספריית `genai`, והגדרת המודל.
*   `ask(self, q: str) -> str`:
    *   **פרמטרים**:
        *   `q`: מחרוזת השאילתה.
    *   **ערך מוחזר**: מחרוזת התשובה מהמודל או הודעת שגיאה.
    *   **מטרה**: שליחת השאילתה למודל Gemini וקבלת התשובה. מטפלת בשגיאות במהלך תהליך השאילתה.
*   *   הקוד `if __name__ == "__main__":` מאפשר הפעלה של קוד מסוים רק כאשר הסקריפט מורץ ישירות (ולא כאשר הוא מיובא).
        *   `input("API ключ от `gemini`: ")`: מבקש מהמשתמש להזין מפתח API.
        *   `GoogleGenerativeAI(api_key=API_KEY, system_instruction=system_instruction)`: יוצר מופע של המחלקה `GoogleGenerativeAI`.
        *   `while True:`: לולאה אינסופית המאפשרת למשתמש להמשיך לשלוח שאילתות למודל.
        *   `input("Введитe буквы, по которым Gemini подберет анаграмму (для выхода нажмите Ctrl+C): ")`: מבקש מהמשתמש להזין אותיות.
        *   `re.sub(r"[^а-яА-ЯёЁ]", "", q)`: משתמש בביטוי רגולרי כדי להסיר תווים שאינם אותיות קיריליות.
        *   `if not q:`: בדיקה אם הקלט ריק לאחר הסרת התווים הלא רצויים.
        *   `print(response)`: מדפיס את התשובה שחזרה מהמודל.

**משתנים (Variables):**

*   `system_instruction`: מחרוזת המכילה את הוראת המערכת (system prompt) עבור מודל Gemini. ההוראה מגדירה את התפקיד של המודל כגנרטור אנאגרמות.
*   `API_KEY`: מחרוזת המכילה את מפתח ה-API של גוגל, שמתקבל כקלט מהמשתמש.
*   `model`: מופע של המחלקה `GoogleGenerativeAI`, המכיל את המודל Gemini שהוגדר.
*   `q`: מחרוזת המכילה את הקלט מהמשתמש (האותיות) לאנאגרמה.
*   `response`: מחרוזת המכילה את התגובה מהמודל.

**בעיות אפשריות או תחומים לשיפור:**

*   **טיפול בשגיאות**: הקוד מטפל בשגיאות באופן כללי בלוק `try...except` בתוך הפונקציה `ask`. ייתכן שיש צורך בטיפול מפורט יותר בסוגי שגיאות שונים.
*   **שימוש במודלים**: הקוד משתמש במודל ברירת מחדל `"gemini-2.0-flash-exp"`. יש להוסיף אפשרות לבחירת מודל אחר מתוך רשימת המודלים הזמינים.
*   **אבטחה**: אחסון מפתח API ישירות בקוד אינו מאובטח. עדיף להשתמש במשתני סביבה או בגישה מאובטחת אחרת.
*   **קלט משתמש**: ניקוי הקלט מתבצע באמצעות ביטוי רגולרי, אך ניתן להוסיף בדיקות נוספות כמו אורך הקלט, או הגבלת סוגי התווים המותרים.

**שרשרת קשרים עם חלקים אחרים בפרויקט:**
*   קוד זה אינו תלוי בקבצים אחרים בפרויקט מלבד הספריות שהוא מייבא.
*   הקוד עובד עצמאית ומתמקד באינטראקציה עם מודל Gemini.

בסיכום, הקוד מאפשר למשתמש להזין רצף אותיות קיריליות, והוא משתמש במודל Gemini כדי לייצר מילה קיימת (אנאגרמה) מאותיות אלו או להחזיר "Нет анаграмм" במידה ולא נמצאה מילה מתאימה.