Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `GWorksheet`, предназначенный для работы с Google Spreadsheets. Он наследуется от класса `Worksheet` и предоставляет методы для создания, получения и настройки рабочих листов (worksheet).  Класс позволяет создавать новые рабочие листы, открывать существующие, очищать данные в них и настраивать направление текста (rtl/ltr).

Шаги выполнения
-------------------------
1. **Импортирование необходимых библиотек:**
   Код импортирует классы `Spreadsheet`, `Worksheet`, `GSRender` из модуля `global_settingspread` и `goog.grender`.  Это необходимо для взаимодействия с Google Sheets API.

2. **Определение класса `GWorksheet`:**
   Класс `GWorksheet` расширяет функциональность `Worksheet` для работы с Google Sheets.

3. **Инициализация `GWorksheet`:**
    Метод `__init__` инициализирует экземпляр класса, принимая в качестве аргументов ссылку на объект `sh` (предположительно представляющий Spreadsheet), название нового рабочего листа, количество строк и столбцов, направление текста и флаг очистки, если лист уже существует.

4. **Получение или создание рабочего листа (`get`):**
   Метод `get`  является ключевым. Он создает новый рабочий лист, если `ws_title` равно 'new', или открывает существующий лист с заданным `ws_title`. Если лист с указанным `ws_title` уже существует, и `wipe_if_exist` установлен в `True`, то его данные очищаются.

5. **Установка заголовка (`header`):**
   Метод `header` устанавливает заголовок рабочего листа с помощью `render.header`.

6. **Установка категории (`category`):**
   Метод `category` устанавливает категорию для рабочего листа с помощью `render.write_category_title`.

7. **Установка направления текста (`direction`):**
   Метод `direction` устанавливает направление текста на листе с помощью `render.set_worksheet_direction`.


Пример использования
-------------------------
.. code-block:: python

    # Предполагается, что вы уже имеете инициализированный объект sh, представляющий Google Spreadsheet
    from hypotez.src.goog.spreadsheet.bberyakov.gworksheets import GWorksheet
    from global_settingspread import Spreadsheet

    # Создание объекта Spreadsheet (замените на ваш способ получения ссылки)
    sh = Spreadsheet()
    
    # Создание нового рабочего листа
    ws = GWorksheet(sh, ws_title='Новый лист', rows=10, cols=20, wipe_if_exist=True)
    
    # Установка заголовка
    ws.header("Название листа", range="A1:B1", merge_type="MERGE_COLUMNS")
    
    # Запись категорий
    ws.category("Категория A")
    ws.category("Категория B")
    
    # Установка направления текста
    ws.direction("ltr")
    
    # ... (Дальнейшая работа с листом) ...