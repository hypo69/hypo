# Модуль try_xpath_background.js

## Обзор

Данный модуль содержит код обработчика сообщений для расширения браузера, предназначенного для работы с XPath-выражениями. Модуль отвечает за взаимодействие с содержимым страницы, загрузку и обновление стилей, хранение и получение состояния всплывающего окна.

## Переменные

### `tx`

**Описание**: псевдоним для объекта `tryxpath`.

### `fu`

**Описание**: псевдоним для объекта `tryxpath.functions`.

### `popupState`

**Описание**: Состояние всплывающего окна.

### `popupCss`

**Описание**: Строка CSS-стилей для всплывающего окна.

### `results`

**Описание**: Результаты поиска, полученные с помощью XPath.

### `css`

**Описание**: Загруженные CSS-стили.

### `attributes`

**Описание**: Объект, содержащий атрибуты, используемые для поиска элементов.


## Функции

### `loadDefaultCss`

**Описание**: Загружает стандартные CSS-стили.

**Возвращает**:
- `Promise`: Promise, содержащий загруженные CSS-стили в текстовом формате.

**Вызывает исключения**:
- `Ошибка` (generic): При возникновении ошибок при загрузке CSS-стилей.



### `genericListener`

**Описание**: Общий обработчик сообщений.

**Параметры**:
- `message` (object): Сообщение, отправленное в обработчик.
- `sender` (object): Объект отправителя сообщения.
- `sendResponse` (function): Функция для отправки ответа.

**Возвращает**:
- `function | undefined`: Обработчик сообщения или `undefined`, если нет подходящего обработчика.

**Вызывает исключения**:
- `Ошибка` (generic): При возникновении ошибок в обработчике сообщений.


### `genericListener.listeners.storePopupState`

**Описание**: Хранит состояние всплывающего окна.

**Параметры**:
- `message` (object): Сообщение, содержащее состояние.

**Возвращает**:
- `undefined`


### `genericListener.listeners.requestRestorePopupState`

**Описание**: Отправляет запрос на восстановление состояния всплывающего окна.

**Параметры**:
- `message` (object): Сообщение, содержащее запрос.

**Возвращает**:
- `undefined`

### `genericListener.listeners.requestInsertStyleToPopup`

**Описание**: Отправляет запрос на вставку CSS-стилей в всплывающее окно.

**Параметры**:
- `message` (object): Сообщение, содержащее запрос.

**Возвращает**:
- `undefined`

### `genericListener.listeners.showAllResults`

**Описание**: Показывает все результаты поиска в отдельном окне.

**Параметры**:
- `message` (object): Сообщение, содержащее результаты поиска.
- `sender` (object): Объект отправителя.

**Возвращает**:
- `undefined`


### `genericListener.listeners.loadResults`

**Описание**: Возвращает результаты поиска.

**Параметры**:
- `message` (object): Сообщение, содержащее запрос.
- `sender` (object): Объект отправителя.
- `sendResponse` (function): Функция для отправки ответа.


**Возвращает**:
- `true`: Индикатор успешного выполнения.



### `genericListener.listeners.updateCss`

**Описание**: Обновляет CSS-стили.

**Параметры**:
- `message` (object): Сообщение, содержащее обновленные стили.
- `sender` (object): Объект отправителя.

**Возвращает**:
- `undefined`


**Вызывает исключения**:
- `fu.onError`: Обработка ошибок при выполнении запросов.


### `genericListener.listeners.loadOptions`

**Описание**: Возвращает настройки.

**Параметры**:
- `message` (object): Сообщение, содержащее запрос.
- `sender` (object): Объект отправителя.
- `sendResponse` (function): Функция для отправки ответа.


**Возвращает**:
- `true`: Индикатор успешного выполнения.



### `genericListener.listeners.requestSetContentInfo`

**Описание**: Отправляет запрос на установку информации о содержимом.

**Параметры**:
- `message` (object): Сообщение, содержащее запрос.
- `sender` (object): Объект отправителя.

**Возвращает**:
- `undefined`




## Обработчики событий

### `browser.storage.onChanged`

**Описание**: Обработчик событий изменения значений в хранилище браузера.

**Параметры**:
- `changes` (object): Объект, содержащий изменения в хранилище.


## Инициализация

### `browser.storage.sync.get`

**Описание**: Загружает настройки из синхронизированного хранилища.

**Параметры**:
- `options` (object): Объект с начальными значениями.


**Возвращает**:
- `Promise`: Promise, содержащий загруженные настройки.

**Вызывает исключения**:
- `fu.onError`: Обработка ошибок при выполнении запросов.