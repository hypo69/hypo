# Модуль `hypotez/src/suppliers/aliexpress/campaign/_pytest/test_alipromo_campaign.py`

## Обзор

Данный модуль содержит тесты для класса `AliPromoCampaign`, предназначенного для работы с кампаниями на AliExpress. Модуль включает в себя фикстуры и тесты, проверяющие основные методы класса, включая инициализацию кампании, загрузку продуктов, создание пространств имен для продуктов, категорий и кампаний, подготовку продуктов, извлечение данных продуктов, сохранение продуктов и вывод списка продуктов кампании.  Тесты покрывают сценарии с наличием и отсутствием файлов JSON.

## Оглавление

* [Фикстуры](#фикстуры)
* [Тесты](#тесты)

## Фикстуры

### `campaign`

**Описание**: Фикстура для создания экземпляра класса `AliPromoCampaign` для использования в тестах.

**Возвращает**:
- `AliPromoCampaign`: Экземпляр класса `AliPromoCampaign` с заданными параметрами.

## Тесты

### `test_initialize_campaign`

**Описание**: Тестирует метод `initialize_campaign`, проверяя правильность инициализации данных кампании.

**Параметры**:
- `mocker`: Моковая среда для подмены зависимостей.
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `campaign.campaign.name` соответствует ожидаемому значению.
- Проверяет, что `campaign.campaign.category.test_category.name` соответствует ожидаемому значению.


### `test_get_category_products_no_json_files`

**Описание**: Тестирует метод `get_category_products` в случае отсутствия файлов JSON.

**Параметры**:
- `mocker`: Моковая среда для подмены зависимостей.
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `products` пустой список.


### `test_get_category_products_with_json_files`

**Описание**: Тестирует метод `get_category_products` в случае наличия файлов JSON.

**Параметры**:
- `mocker`: Моковая среда для подмены зависимостей.
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `products` содержит один элемент.
- Проверяет, что `products[0].product_id` соответствует ожидаемому значению.
- Проверяет, что `products[0].product_title` соответствует ожидаемому значению.


### `test_create_product_namespace`

**Описание**: Тестирует метод `create_product_namespace`.

**Параметры**:
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `product.product_id` соответствует ожидаемому значению.
- Проверяет, что `product.product_title` соответствует ожидаемому значению.


### `test_create_category_namespace`

**Описание**: Тестирует метод `create_category_namespace`.

**Параметры**:
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `category.name` соответствует ожидаемому значению.
- Проверяет, что `category.tags` соответствует ожидаемому значению.


### `test_create_campaign_namespace`

**Описание**: Тестирует метод `create_campaign_namespace`.

**Параметры**:
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `camp.name` соответствует ожидаемому значению.
- Проверяет, что `camp.title` соответствует ожидаемому значению.


### `test_prepare_products`

**Описание**: Тестирует метод `prepare_products`.

**Параметры**:
- `mocker`: Моковая среда для подмены зависимостей.
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `campaign.process_affiliate_products` вызывался один раз.


### `test_fetch_product_data`

**Описание**: Тестирует метод `fetch_product_data`.

**Параметры**:
- `mocker`: Моковая среда для подмены зависимостей.
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `products` содержит два элемента.
- Проверяет значения `product_id` для элементов `products`.


### `test_save_product`

**Описание**: Тестирует метод `save_product`.

**Параметры**:
- `mocker`: Моковая среда для подмены зависимостей.
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `Path.write_text` вызывался один раз с правильными аргументами.


### `test_list_campaign_products`

**Описание**: Тестирует метод `list_campaign_products`.

**Параметры**:
- `campaign`: Экземпляр класса `AliPromoCampaign` (из фикстуры).

**Ассерты**:
- Проверяет, что `product_titles` содержит ожидаемые названия продуктов.