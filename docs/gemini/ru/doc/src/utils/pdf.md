# Модуль hypotez/src/utils/pdf

## Обзор

Этот модуль предоставляет инструменты для преобразования HTML-контента или файлов в PDF-формат, используя различные библиотеки, такие как `pdfkit`, `FPDF`, `WeasyPrint` и `xhtml2pdf`.  Модуль также содержит функцию для определения корневой директории проекта.

## Функции

### `set_project_root`

**Описание**: Находит корневую директорию проекта, начиная от текущей директории.  Ищет директории, содержащие указанные файлы или папки.

**Параметры**:

- `marker_files` (tuple): Кортеж имен файлов или директорий, которые указывают на корень проекта. По умолчанию используются `pyproject.toml`, `requirements.txt` и `.git`.

**Возвращает**:

- `Path`: Путь к корневой директории проекта, если найдена. В противном случае возвращает директорию, где находится данный скрипт.

**Вызывает исключения**:

-  Возможны ошибки, связанные с поиском файлов/директорий.


### `PDFUtils.save_pdf_pdfkit`

**Описание**: Сохраняет HTML-контент или файл в PDF-файл с использованием библиотеки `pdfkit`.

**Параметры**:

- `data` (str | Path): HTML-контент или путь к HTML-файлу, который необходимо преобразовать.
- `pdf_file` (str | Path): Путь к файлу PDF, куда будет сохранён результат.

**Возвращает**:

- `bool`: `True`, если преобразование выполнено успешно, иначе `False`.

**Вызывает исключения**:

- `pdfkit.PDFKitError`: Ошибка при генерации PDF с помощью `pdfkit`.
- `OSError`: Ошибка доступа к файлу.
- `Exception`: Любые другие неожиданные ошибки.


### `PDFUtils.save_pdf_fpdf`

**Описание**: Сохраняет текст в PDF-файл с использованием библиотеки `FPDF`.

**Параметры**:

- `data` (str): Текст, который необходимо сохранить в PDF.
- `pdf_file` (str | Path): Путь к файлу PDF, куда будет сохранён результат.

**Возвращает**:

- `bool`: `True`, если преобразование выполнено успешно, иначе `False`.

**Вызывает исключения**:

- `FileNotFoundError`: Если файл шрифтов `fonts.json` не найден или файл шрифта не найден.
- `Exception`: Любые другие неожиданные ошибки.

**Примечание**: Данная функция требует наличия файла `fonts.json` в директории `assets/fonts` в корневом каталоге проекта.  Формат `fonts.json` должен соответствовать приведенному в коде примеру.


### `PDFUtils.save_pdf_weasyprint`

**Описание**: Сохраняет HTML-контент или файл в PDF-файл с использованием библиотеки `WeasyPrint`.

**Параметры**:

- `data` (str | Path): HTML-контент или путь к HTML-файлу, который необходимо преобразовать.
- `pdf_file` (str | Path): Путь к файлу PDF, куда будет сохранён результат.

**Возвращает**:

- `bool`: `True`, если преобразование выполнено успешно, иначе `False`.

**Вызывает исключения**:

- `Exception`: Любые другие неожиданные ошибки.


### `PDFUtils.save_pdf_xhtml2pdf`

**Описание**: Сохраняет HTML-контент или файл в PDF-файл с использованием библиотеки `xhtml2pdf`.

**Параметры**:

- `data` (str | Path): HTML-контент или путь к HTML-файлу, который необходимо преобразовать.
- `pdf_file` (str | Path): Путь к файлу PDF, куда будет сохранён результат.

**Возвращает**:

- `bool`: `True`, если преобразование выполнено успешно, иначе `False`.

**Вызывает исключения**:

- `Exception`: Любые другие неожиданные ошибки.


### `PDFUtils.html2pdf`

**Описание**: Преобразует HTML-контент в PDF-файл с помощью `WeasyPrint`.

**Параметры**:

- `html_str` (str): HTML-контент.
- `pdf_file` (str | Path): Путь к файлу PDF, куда будет сохранён результат.

**Возвращает**:

- `bool | None`: `True`, если преобразование выполнено успешно, иначе `None` и выводит сообщение об ошибке.


## Классы

### `PDFUtils`

**Описание**: Класс для работы с PDF-файлами. Предоставляет методы для преобразования HTML-контента в PDF-формат с использованием различных библиотек.


```