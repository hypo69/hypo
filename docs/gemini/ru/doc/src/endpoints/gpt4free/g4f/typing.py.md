# Модуль typing.py

## Обзор

Модуль `typing.py` предназначен для определения пользовательских типов и псевдонимов типов, используемых в проекте `hypotez`. Он также включает импорты стандартных модулей `typing` и `os`, а также обработку исключения `ImportError` для библиотеки `PIL`.

## Подробней

Этот модуль играет важную роль в обеспечении статической типизации и улучшении читаемости кода. Он определяет типы данных, используемые в различных частях проекта, и предоставляет удобные псевдонимы для сложных типов.

## Типы

### `SHA256`

```python
SHA256 = NewType('sha_256_hash', str)
```

**Назначение**: Определяет псевдоним типа `SHA256` для представления SHA256 хеша в виде строки.

**Как работает**:

1. Использует `NewType` из модуля `typing` для создания нового типа `SHA256`, основанного на типе `str`.

### `CreateResult`

```python
CreateResult = Iterator[Union[str, ResponseType]]
```

**Назначение**: Определяет псевдоним типа `CreateResult` для представления итератора, возвращающего строки или объекты `ResponseType`.

**Как работает**:

1. Использует `Iterator` из модуля `typing` для создания типа итератора.
2. Использует `Union` для указания, что итератор может возвращать либо строку (`str`), либо объект типа `ResponseType`.

### `AsyncResult`

```python
AsyncResult = AsyncIterator[Union[str, ResponseType]]
```

**Назначение**: Определяет псевдоним типа `AsyncResult` для представления асинхронного итератора, возвращающего строки или объекты `ResponseType`.

**Как работает**:

1. Использует `AsyncIterator` из модуля `typing` для создания типа асинхронного итератора.
2. Использует `Union` для указания, что асинхронный итератор может возвращать либо строку (`str`), либо объект типа `ResponseType`.

### `Messages`

```python
Messages = List[Dict[str, Union[str, List[Dict[str, Union[str, Dict[str, str]]]]]]]]
```

**Назначение**: Определяет псевдоним типа `Messages` для представления списка словарей, содержащих строковые ключи и значения, которые могут быть строками или списками словарей.

**Как работает**:

1. Использует `List` и `Dict` из модуля `typing` для создания сложного типа списка словарей.
2. Использует `Union` для указания, что значения в словарях могут быть строками или списками словарей, которые в свою очередь могут содержать строки или словари.

### `Cookies`

```python
Cookies = Dict[str, str]
```

**Назначение**: Определяет псевдоним типа `Cookies` для представления словаря, содержащего строковые ключи и строковые значения, используемого для хранения cookie.

**Как работает**:

1. Использует `Dict` из модуля `typing` для создания типа словаря, где ключи и значения являются строками.

### `ImageType`

```python
ImageType = Union[str, bytes, IO, Image, os.PathLike]
```

**Назначение**: Определяет псевдоним типа `ImageType` для представления различных типов изображений, таких как строки, байты, объекты `IO`, объекты `Image` из библиотеки `PIL` или пути к файлам.

**Как работает**:

1. Использует `Union` для объединения различных типов данных, которые могут представлять изображение.

### `MediaListType`

```python
MediaListType = List[Tuple[ImageType, Optional[str]]]
```

**Назначение**: Определяет псевдоним типа `MediaListType` для представления списка кортежей, содержащих объекты `ImageType` и необязательные строки.

**Как работает**:

1. Использует `List` и `Tuple` из модуля `typing` для создания списка кортежей.
2. Использует `ImageType` и `Optional[str]` для указания типов элементов в кортеже.

## Обработка исключений

```python
try:
    from PIL.Image import Image
except ImportError:
    class Image:
        pass
```

**Назначение**: Обрабатывает исключение `ImportError`, которое может возникнуть, если библиотека `PIL` не установлена.

**Как работает**:

1. Пытается импортировать класс `Image` из модуля `PIL.Image`.
2. Если импорт не удался, создает пустой класс `Image`, чтобы избежать ошибок при использовании аннотации типов `Image`.

## Условный импорт

```python
if sys.version_info >= (3, 8):
    from typing import TypedDict
else:
    from typing_extensions import TypedDict
```

**Назначение**: Условно импортирует класс `TypedDict` из модуля `typing` или `typing_extensions` в зависимости от версии Python.

**Как работает**:

1. Проверяет версию Python с помощью `sys.version_info`.
2. Если версия Python >= 3.8, импортирует `TypedDict` из `typing`.
3. В противном случае импортирует `TypedDict` из `typing_extensions`.

## Список `__all__`

```python
__all__ = [
    'Any',
    'AsyncGenerator',
    'Generator',
    'AsyncIterator',
    'Iterator'
    'Tuple',
    'Union',
    'List',
    'Dict',
    'Type',
    'IO',
    'Optional',
    'TypedDict',
    'SHA256',
    'CreateResult',
    'AsyncResult',
    'Messages',
    'Cookies',
    'Image',
    'ImageType',
    'MediaListType'
]
```

**Назначение**: Определяет список имен, которые будут экспортироваться при импорте модуля `typing`.

**Как работает**:

1. Создает список строк, содержащих имена всех типов и классов, которые должны быть доступны при импорте модуля.

## Заключение

Модуль `typing.py` предоставляет набор инструментов для работы с типами данных в проекте `hypotez`. Он определяет псевдонимы типов, обрабатывает исключения и условно импортирует классы в зависимости от версии Python.