# Модуль для генерации токсичных комментариев на Habr с использованием OpenAI
==================================================================

Модуль содержит функцию `habra_toxic_commenter`, которая использует языковую модель OpenAI для поиска статьи на Habr по указанному автору, открытия её и генерации токсичного комментария.

## Обзор

Модуль предназначен для автоматической генерации токсичных комментариев к статьям на сайте Habr с использованием языковой модели OpenAI. Он использует библиотеку `langchain_openai` для взаимодействия с OpenAI, а также класс `Agent` из модуля `browser_use` для автоматизации действий в браузере.

## Подробнее

Данный код используется для демонстрации возможностей автоматической генерации комментариев с использованием AI. Он может быть использован в различных целях, включая исследование токсичности в онлайн-коммуникациях или для автоматизации процессов модерации контента.

## Функции

### `habra_toxic_commenter`

```python
async def habra_toxic_commenter(author_username: str, model_name: str = "gpt-4o") -> str | None:
    """
    Ищет статью на Хабре по указанному автору, открывает её и генерирует токсичный комментарий.

    Args:
        author_username (str): Имя пользователя на Хабре.
        model_name (str): Название языковой модели OpenAI для использования. По умолчанию gpt-4o.

    Returns:
        str | None: Строку с результатом работы агента, содержащую название статьи и сгенерированный комментарий.
                    Возвращает None, если произошла ошибка.
    """
```

**Назначение**: Функция `habra_toxic_commenter` ищет статью на Habr по указанному автору, открывает её и генерирует токсичный комментарий с использованием языковой модели OpenAI.

**Параметры**:
- `author_username` (str): Имя пользователя на Habr, чью статью нужно найти.
- `model_name` (str): Название языковой модели OpenAI для использования. По умолчанию `"gpt-4o"`.

**Возвращает**:
- `str | None`: Строку с результатом работы агента, содержащую название статьи и сгенерированный комментарий. Возвращает `None`, если произошла ошибка.

**Вызывает исключения**:
- `Exception`: Если происходит ошибка при выполнении задачи.

**Как работает функция**:

1. Инициализирует языковую модель OpenAI (`ChatOpenAI`) с указанным именем модели.
2. Формирует задачу для агента, указывающую на необходимость поиска статьи указанного автора на Habr, открытия её полной версии и генерации токсичного комментария на русском языке, связанного с этой статьей.
3. Создает экземпляр класса `Agent` с задачей и языковой моделью.
4. Запускает агента для выполнения задачи.
5. Возвращает результат работы агента.
6. В случае возникновения ошибки логирует ошибку и возвращает `None`.

```
      Начало
        ↓
Инициализация LLM (ChatOpenAI)
        ↓
Формирование задачи для агента
        ↓
   Создание экземпляра агента
        ↓
        Запуск агента
        ↓
    Успех? ----→ Возврат результата
        ↓   Нет
    Логирование ошибки
        ↓
    Возврат None
        ↓
        Конец
```

**Примеры**:

```python
import asyncio

async def main():
    author = "ElKornacio"
    result = await habra_toxic_commenter(author_username=author)

    if result:
        print("Результат работы агента:")
        print(result)
    else:
        print("Не удалось получить результат.")

if __name__ == "__main__":
    asyncio.run(main())
```

### `main`

```python
async def main():
    """
    Пример использования функции habra_toxic_commenter.
    """
```

**Назначение**: Функция `main` является примером использования функции `habra_toxic_commenter`.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- Отсутствует.

**Как работает функция**:

1. Определяет имя пользователя Habr (`author`).
2. Вызывает функцию `habra_toxic_commenter` с именем пользователя.
3. Если результат получен, выводит его на экран.
4. Если результат не получен, выводит сообщение об ошибке.

```
      Начало
        ↓
Определение имени пользователя
        ↓
Вызов habra_toxic_commenter
        ↓
    Результат? ----→ Вывод результата
        ↓   Нет
Вывод сообщения об ошибке
        ↓
        Конец
```

**Примеры**:

```python
async def main():
    author = "ElKornacio"  # Замените на имя пользователя, статьи которого хотите найти
    result = await habra_toxic_commenter(author_username=author)

    if result:
        print("Результат работы агента:")
        print(result)
    else:
        print("Не удалось получить результат.")

if __name__ == "__main__":
    asyncio.run(main())