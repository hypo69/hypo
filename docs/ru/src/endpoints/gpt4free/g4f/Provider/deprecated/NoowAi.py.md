# Модуль NoowAi
## Обзор
Модуль `NoowAi` предоставляет асинхронный генератор для взаимодействия с сервисом NoowAi.com. Он поддерживает использование истории сообщений и модель `gpt-3.5-turbo`. Этот модуль является частью устаревших провайдеров (deprecated) в проекте `hypotez`.

## Подробнее
Модуль предназначен для отправки запросов к NoowAi и получения ответов в асинхронном режиме. Он использует `aiohttp` для асинхронных HTTP-запросов и предоставляет функциональность для обработки потоковых ответов от сервера. Поддерживает проксирование запросов.
## Классы

### `NoowAi`

**Описание**: Класс `NoowAi` является асинхронным провайдером, который взаимодействует с API NoowAi для генерации текста на основе предоставленных сообщений.

**Наследует**:
- `AsyncGeneratorProvider`: Наследует функциональность асинхронного генератора от базового класса `AsyncGeneratorProvider`.

**Атрибуты**:
- `url` (str): URL сервиса NoowAi (`https://noowai.com`).
- `supports_message_history` (bool): Поддержка истории сообщений (True).
- `supports_gpt_35_turbo` (bool): Поддержка модели `gpt-3.5-turbo` (True).
- `working` (bool): Указывает, работает ли провайдер в данный момент (False).

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для получения ответов от NoowAi.

## Функции

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """
    Создает асинхронный генератор для взаимодействия с API NoowAi.

    Args:
        cls (Type[NoowAi]): Ссылка на класс `NoowAi`.
        model (str): Используемая модель (например, `gpt-3.5-turbo`).
        messages (Messages): Список сообщений для отправки в API.
        proxy (str, optional): Адрес прокси-сервера для использования. По умолчанию `None`.
        **kwargs: Дополнительные аргументы.

    Returns:
        AsyncResult: Асинхронный генератор, возвращающий ответы от API NoowAi.

    Raises:
        RuntimeError: Если при обработке ответа от сервера возникает ошибка.

    """
```

**Назначение**: Функция `create_async_generator` создает и возвращает асинхронный генератор, который отправляет сообщения в API NoowAi и возвращает сгенерированные ответы.

**Параметры**:
- `cls` (Type[NoowAi]): Ссылка на класс `NoowAi`. Используется для доступа к атрибутам класса, таким как URL.
- `model` (str): Имя используемой модели, например `gpt-3.5-turbo`.
- `messages` (Messages): Список сообщений, отправляемых в API NoowAi. Обычно это список словарей, где каждый словарь содержит роли (`role`) и контент (`content`).
- `proxy` (str, optional): URL прокси-сервера для использования при отправке запроса. По умолчанию `None`.
- `**kwargs`: Дополнительные параметры, которые могут быть переданы.

**Возвращает**:
- `AsyncResult`: Асинхронный генератор, который выдает части ответа от API NoowAi.

**Вызывает исключения**:
- `RuntimeError`: Вызывается, если в процессе обработки ответа от сервера возникает ошибка, например, если строка ответа не соответствует ожидаемому формату или если сервер возвращает сообщение об ошибке.

**Как работает функция**:
1. **Определение заголовков**: Функция начинает с определения необходимых HTTP-заголовков для запроса, включая `User-Agent`, `Accept`, `Content-Type` и другие.
2. **Создание сессии**: Используется `aiohttp.ClientSession` для управления асинхронными HTTP-запросами.
3. **Формирование данных**: Создается словарь `data`, который содержит параметры запроса, включая идентификаторы бота, сессии, чата, контекста, а также список сообщений и флаг потоковой передачи (`stream`).
4. **Отправка запроса**: Отправляется POST-запрос к API NoowAi с использованием `session.post`.
5. **Обработка потока ответов**: Функция асинхронно итерирует по строкам в ответе сервера. Каждая строка проверяется на префикс `b"data: "`.
6. **Декодирование JSON**: Если строка начинается с `data: `, она декодируется из JSON.
7. **Обработка типов сообщений**: В зависимости от значения ключа `type` в JSON, функция выполняет разные действия:
   - `live`: Выдает данные (`line["data"]`) в генератор.
   - `end`: Завершает генератор.
   - `error`: Вызывает исключение `RuntimeError` с сообщением об ошибке.

**Примеры**:

```python
import asyncio
from typing import List, Dict, AsyncGenerator, Optional

from g4f.Provider.deprecated.NoowAi import NoowAi

async def main():
    messages: List[Dict[str, str]] = [
        {"role": "user", "content": "Привет, как дела?"}
    ]

    async def stream_response(generator: AsyncGenerator[str, None]):
        async for message in generator:
            print(message, end="")
        print()

    generator: AsyncGenerator[str, None] = await NoowAi.create_async_generator(
        model="gpt-3.5-turbo",
        messages=messages,
        proxy=None  # Замените на URL вашего прокси, если необходимо
    )

    await stream_response(generator)

if __name__ == "__main__":
    asyncio.run(main())
```
В этом примере показано, как использовать `NoowAi.create_async_generator` для создания асинхронного генератора и обработки потоковых ответов от API NoowAi.