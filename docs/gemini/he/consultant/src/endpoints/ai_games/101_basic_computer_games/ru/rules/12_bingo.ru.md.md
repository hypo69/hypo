# Анализ кода модуля `12_bingo.ru.md`

**Качество кода**
*   **Соответствие требованиям к формату кода (1-10)**: 
    - Код представлен в формате Markdown (`md`).
    -  Есть разделение на секции, как и требуется: Название игры, Описание, Пошаговая инструкция, Пример работы программы, Возможные ограничения.
    - Текст написан на русском языке, как и требуется.
    -  Присутствуют примеры кода.
    -  Формат инструкций соответствует заданному.

 - **Преимущества**
        -  Хорошее структурирование текста, логичное разделение на блоки.
        -  Четкое описание правил игры.
        -  Наличие пошаговой инструкции.
        -  Пример работы программы помогает понять процесс игры.

 -  **Недостатки**
    -  Нет кода на Python, что не позволяет оценить его качество.
    -  Необходимо добавить конкретную реализацию на Python с учетом указанных правил.

**Рекомендации по улучшению**
1.  **Реализация на Python**: необходимо добавить реализацию игры на Python, используя reStructuredText (RST) для всех docstring, комментариев и аннотаций типов.
2.  **Обработка ввода**: в коде на Python должна присутствовать проверка ввода от пользователя.
3.  **Разделение на функции**: код должен быть разбит на функции для улучшения читаемости и переиспользуемости.
4.  **Документация**: добавить docstring в стиле reStructuredText (RST) для всех функций и классов.
5.  **Логирование**: использовать `from src.logger.logger import logger` для логирования ошибок и отладочной информации.
6.  **Избегать `try-except`**: минимизировать использование общих блоков `try-except` и использовать `logger.error`.

**Улучшенный код**

```markdown
### Название игры: **Bingo** (Бинго)

#### Описание
В этой игре игрок и компьютер по очереди играют в Бинго. Компьютер генерирует карточку Бинго для обоих игроков. Затем он вращает барабан и случайным образом выбирает числа, которые выводятся на экране. Игрок должен отметить эти числа на своей карточке, чтобы собрать выигрышные комбинации. Когда кто-то заполнил все числа в одной строке, столбце или диагонали, он выигрывает.

---

### Пошаговая инструкция для реализации

#### 1. **Инициализация игры**
   - **Создание карточек:** Компьютер генерирует для игрока и себя случайные карточки Бинго с размерами 5x5. Каждая карточка содержит случайные числа, распределенные по пяти колонкам (B, I, N, G, O).
     - Столбец **B**: числа от 1 до 15.
     - Столбец **I**: числа от 16 до 30.
     - Столбец **N**: числа от 31 до 45 (с центральной ячейкой, которая считается "свободной").
     - Столбец **G**: числа от 46 до 60.
     - Столбец **O**: числа от 61 до 75.

#### 2. **Основной цикл игры**
   - **Генерация чисел:** Компьютер случайным образом генерирует числа от 1 до 75 и объявляет их поочередно.
   - **Проверка на бинго:** После каждого номера, который выпадает, игрок и компьютер проверяют, есть ли этот номер на их карточке.
     - Если номер есть, игрок или компьютер отмечает его на своей карточке.
   - **Победа:** Игра завершается, когда один из игроков закроет одну из линий на карточке (горизонтальную, вертикальную или диагональ).
   - **Проверка на выигрыш:** Компьютер проверяет, есть ли у игрока или у него самого заполненная линия и объявляет победителя.

#### 3. **Подсчёт победителя**
   - После каждого хода проверяется, есть ли на карточке комбинация чисел, которые соответствуют выигрышной линии. Если игрок или компьютер выигрывает, программа выводит:
     ```
     Поздравляем! Вы выиграли!
     ```
   - Если оба игрока не собрали линию, игра продолжается до тех пор, пока кто-то не выиграет.

#### 4. **Завершение игры**
   - Когда кто-то выигрывает, программа предлагает сыграть ещё раз:
     ```
     Хотите сыграть снова? (да/нет)
     ```

---

### Пример работы программы

1. **Начало игры**:
   ```
   Добро пожаловать в игру Бинго!
   Вот ваша карточка:
   B  I  N  G  O
   10 22 35 50 69
   8  16  FREE 47 60
   5  29  41 55 68
   12 18 33 53 72
   14 23 44 52 74

   Я тоже создал свою карточку. Начинаем!
   ```

2. **Ход игры**:
   ```
   Компьютер вытянул номер: 22
   Выставляем его на своей карточке.
   ```

3. **Проверка на бинго**:
   ```
   Внимание! У вас есть линия на карточке! Вы выиграли!
   ```

4. **Вывод результата**:
   ```
   Поздравляем! Вы выиграли!
   Хотите сыграть снова? (да/нет)
   ```

---

### Возможные ограничения
- Программа должна гарантировать, что карточки генерируются случайным образом.
- Требуется обработка ошибок ввода для случая, если игрок попытается ввести несуществующий номер.

---
```

```python
"""
Модуль для реализации игры Бинго.
=========================================================================================

Модуль содержит функции для создания карточек Бинго, генерации случайных чисел
и проверки выигрышных комбинаций.

Пример использования
--------------------

.. code-block:: python

    bingo_game = BingoGame()
    bingo_game.play()
"""
import random
from typing import List, Dict, Tuple
from src.logger.logger import logger  # Импортируем logger

class BingoGame:
    """
    Класс, представляющий игру Бинго.

    :ivar player_card: Карточка игрока.
    :vartype player_card: dict
    :ivar computer_card: Карточка компьютера.
    :vartype computer_card: dict
    :ivar called_numbers: Список вызванных номеров.
    :vartype called_numbers: list
    """
    def __init__(self):
        """
        Инициализирует игру, создавая карточки для игрока и компьютера.
        """
        self.player_card: Dict[str, List[int]] = self._create_card()  # Карточка игрока
        self.computer_card: Dict[str, List[int]] = self._create_card()  # Карточка компьютера
        self.called_numbers: List[int] = [] # Список вызванных номеров

    def _create_card(self) -> Dict[str, List[int]]:
        """
        Генерирует случайную карточку Бинго.

        :return: Карточка Бинго в виде словаря, где ключи - буквы столбцов ('B', 'I', 'N', 'G', 'O'),
                 а значения - список чисел в каждом столбце.
        :rtype: dict
        """
        card = {}
        card['B'] = random.sample(range(1, 16), 5)  # Генерация чисел от 1 до 15
        card['I'] = random.sample(range(16, 31), 5)  # Генерация чисел от 16 до 30
        card['N'] = random.sample(range(31, 46), 4)  # Генерация чисел от 31 до 45
        card['N'].insert(2, 'FREE')  # Вставка FREE в центральную ячейку
        card['G'] = random.sample(range(46, 61), 5)  # Генерация чисел от 46 до 60
        card['O'] = random.sample(range(61, 76), 5)  # Генерация чисел от 61 до 75
        return card

    def _print_card(self, card: Dict[str, List[int]], player: str = 'Player') -> None:
        """
        Выводит на экран карточку Бинго.

        :param card: Карточка Бинго.
        :type card: dict
        :param player: Имя игрока (по умолчанию 'Player').
        :type player: str
        :return: None
        """
        print(f'\n{player}\'s card:')
        print('B   I   N   G   O')
        for i in range(5):
            print(f'{card["B"][i]:2} {card["I"][i]:2} {str(card["N"][i]):4} {card["G"][i]:2} {card["O"][i]:2}')

    def _check_bingo(self, card: Dict[str, List[int]], called_numbers: List[int]) -> bool:
        """
        Проверяет, есть ли Бинго на карточке.

        :param card: Карточка Бинго.
        :type card: dict
        :param called_numbers: Список вызванных номеров.
        :type called_numbers: list
        :return: True, если Бинго есть, False в противном случае.
        :rtype: bool
        """
        # Проверка строк
        for row in range(5):
            if all(card['B'][row] in called_numbers for i in range(5) if card['B'][i] != 'FREE' ) and \
               all(card['I'][row] in called_numbers for i in range(5) if card['I'][i] != 'FREE' ) and \
               all(card['N'][row] in called_numbers for i in range(5) if card['N'][i] != 'FREE' ) and \
               all(card['G'][row] in called_numbers for i in range(5) if card['G'][i] != 'FREE' ) and \
               all(card['O'][row] in called_numbers for i in range(5) if card['O'][i] != 'FREE' ):

               return True

        # Проверка столбцов
        for col in ['B', 'I', 'N', 'G', 'O']:
             if all(number in called_numbers for number in card[col] if number != 'FREE'):
                 return True


        # Проверка диагоналей
        if all(card['B'][i] in called_numbers for i in range(5) if card['B'][i] != 'FREE') and \
           all(card['I'][i] in called_numbers for i in range(5) if card['I'][i] != 'FREE') and\
           all(card['N'][i] in called_numbers for i in range(5) if card['N'][i] != 'FREE') and\
           all(card['G'][i] in called_numbers for i in range(5) if card['G'][i] != 'FREE') and\
           all(card['O'][i] in called_numbers for i in range(5) if card['O'][i] != 'FREE'):
            return True

        if all(card['B'][i] in called_numbers for i in range(4, -1, -1) if card['B'][i] != 'FREE') and \
           all(card['I'][i] in called_numbers for i in range(4, -1, -1) if card['I'][i] != 'FREE') and\
           all(card['N'][i] in called_numbers for i in range(4, -1, -1) if card['N'][i] != 'FREE') and\
           all(card['G'][i] in called_numbers for i in range(4, -1, -1) if card['G'][i] != 'FREE') and\
           all(card['O'][i] in called_numbers for i in range(4, -1, -1) if card['O'][i] != 'FREE'):
            return True
        return False

    def play(self) -> None:
        """
        Запускает игру Бинго.

        :return: None
        """
        print('Добро пожаловать в игру Бинго!')
        self._print_card(self.player_card, 'Your')  # Выводим карточку игрока
        print('Я тоже создал свою карточку. Начинаем!')
        while True:
            number = random.randint(1, 75) # Генерация случайного числа от 1 до 75
            if number not in self.called_numbers:
                self.called_numbers.append(number) # Добавляем число в список вызванных номеров
                print(f'Компьютер вытянул номер: {number}') # Выводим вытянутый номер
                if self._check_bingo(self.player_card, self.called_numbers):  # Проверка Бинго для игрока
                    print('Внимание! У вас есть линия на карточке! Вы выиграли!') # Выводим сообщение о победе
                    print('Поздравляем! Вы выиграли!') # Выводим сообщение о победе
                    break
                if self._check_bingo(self.computer_card, self.called_numbers): # Проверка Бинго для компьютера
                    print('Компьютер выиграл!') # Выводим сообщение о победе компьютера
                    break
            else:
                continue

        while True:
            play_again = input('Хотите сыграть снова? (да/нет): ').lower() # Предлагаем сыграть еще раз
            if play_again == 'да':
                self.__init__() # Перезапуск игры
                self.play()
                break
            elif play_again == 'нет':
                print('Спасибо за игру!') # Выводим благодарность за игру
                break
            else:
                print('Некорректный ввод. Пожалуйста, введите "да" или "нет".')  # Выводим сообщение о некорректном вводе

if __name__ == '__main__':
    """
    Точка входа в программу.
    """
    try:
        game = BingoGame() # Создаем объект игры
        game.play() # Запускаем игру
    except Exception as e:
        logger.error('Произошла ошибка при выполнении игры', exc_info=True) # Логируем ошибки
```