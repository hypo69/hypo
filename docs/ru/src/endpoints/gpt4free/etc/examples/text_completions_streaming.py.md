# Модуль для демонстрации потоковой передачи текста с использованием gpt4free

## Обзор

Модуль демонстрирует, как использовать библиотеку `g4f` для выполнения потоковой передачи текстовых завершений как в синхронном, так и в асинхронном режимах. Он включает примеры использования `Client` и `AsyncClient` для взаимодействия с моделью "gpt-4" и отображения результатов в реальном времени.

## Подробней

Этот модуль предоставляет два основных способа использования API gpt4free для получения текстовых завершений:
1.  Синхронный стриминг: Использует `Client` для получения данных в синхронном режиме.
2.  Асинхронный стриминг: Использует `AsyncClient` и `asyncio` для неблокирующего получения данных.

Модуль демонстрирует, как можно настроить клиент, запросить у модели генерацию текста на основе вопроса, и обработать поток данных, выводя чанки контента по мере их поступления.

## Функции

### `sync_stream`

```python
def sync_stream():
    """
    Выполняет синхронную потоковую передачу текстовых завершений с использованием gpt-4.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Возникает, если происходит ошибка при создании или обработке потока.

    Как работает функция:
    1.  Создает экземпляр класса `Client`.
    2.  Вызывает метод `chat.completions.create` объекта `client` для получения потока завершений.
    3.  Итерируется по чанкам в потоке, извлекая и выводя содержимое каждого чанка.

    Внутри функции происходят следующие действия и преобразования:
    Создание клиента -->  Запрос на потоковую передачу -->  Итерация по чанкам -->  Вывод содержимого чанка
    """
    client = Client()
    stream = client.chat.completions.create(
        model="gpt-4",
        messages=[
            {"role": "user", "content": question}
        ],
        stream=True,
    )
    
    for chunk in stream:
        if chunk.choices[0].delta.content:
            print(chunk.choices[0].delta.content or "", end="")

### `async_stream`

```python
async def async_stream():
    """
    Выполняет асинхронную потоковую передачу текстовых завершений с использованием gpt-4.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Возникает, если происходит ошибка при создании или обработке потока.

    Как работает функция:
    1.  Создает экземпляр класса `AsyncClient`.
    2.  Вызывает метод `chat.completions.create` объекта `client` для получения асинхронного потока завершений.
    3.  Асинхронно итерируется по чанкам в потоке, извлекая и выводя содержимое каждого чанка.

    Внутри функции происходят следующие действия и преобразования:
    Создание асинхронного клиента --> Запрос на асинхронную потоковую передачу --> Асинхронная итерация по чанкам --> Вывод содержимого чанка
    """
    client = AsyncClient()
    stream = client.chat.completions.create(
        model="gpt-4",
        messages=[
            {"role": "user", "content": question}
        ],
        stream=True,
    )
    
    async for chunk in stream:
        if chunk.choices and chunk.choices[0].delta.content:
            print(chunk.choices[0].delta.content, end="")

### `main`

```python
def main():
    """
    Запускает синхронный и асинхронный потоки для демонстрации.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Возникает, если происходит ошибка во время выполнения потоков.

    Как работает функция:
    1.  Выводит заголовок "Synchronous Stream:".
    2.  Вызывает функцию `sync_stream` для выполнения синхронного потока.
    3.  Выводит разделитель строк.
    4.  Выводит заголовок "Asynchronous Stream:".
    5.  Использует `asyncio.run` для запуска асинхронной функции `async_stream`.

    Внутри функции происходят следующие действия и преобразования:
    Вывод заголовка синхронного потока --> Запуск синхронного потока --> Вывод разделителя --> Вывод заголовка асинхронного потока --> Запуск асинхронного потока
    """
    print("Synchronous Stream:")
    sync_stream()
    print("\n\nAsynchronous Stream:")
    asyncio.run(async_stream())

**Примеры:**

Примеры вызовов `main`

```python
main()
```
###
## Переменные

-   `question` (str): Содержит вопрос, который будет отправлен в модель gpt-4 для получения ответа.
```python
question = """
Hey! How can I recursively list all files in a directory in Python?
"""