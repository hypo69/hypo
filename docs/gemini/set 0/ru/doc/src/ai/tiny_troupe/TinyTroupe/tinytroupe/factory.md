# Модуль tinytroupe.factory

## Обзор

Этот модуль предоставляет базовый класс `TinyFactory` и класс `TinyPersonFactory` для создания и управления различными типами фабрик, необходимых для генерации агентов.  Он включает механизмы кэширования и транзакционные операции для обработки фабрик и связанных с ними агентов.

## Классы

### `TinyFactory`

**Описание**: Базовый класс для фабрик. Обеспечивает удобство расширения системы, особенно в отношении кэширования транзакций. Хранит список всех созданных фабрик.

**Методы**:

- `__init__(self, simulation_id: str = None) -> None`: Инициализирует экземпляр `TinyFactory`.
    - **Параметры**:
        - `simulation_id` (str, необязательно): Идентификатор симуляции. По умолчанию `None`.
    - **Возвращает**:
        - `None`
- `__repr__(self)`: Возвращает строковое представление объекта.
- `set_simulation_for_free_factories(simulation)`: Устанавливает симуляцию для свободных фабрик.
    - **Параметры**:
        - `simulation`: Объект симуляции.
    - **Возвращает**:
        - `None`
- `add_factory(factory)`: Добавляет фабрику в глобальный список фабрик.
    - **Параметры**:
        - `factory`: Экземпляр `TinyFactory`.
    - **Возвращает**:
        - `None`
    - **Исключения**:
        - `ValueError`: Если фабрика с таким же именем уже существует.
- `clear_factories()`: Очищает глобальный список всех фабрик.
    - **Возвращает**:
        - `None`
- `encode_complete_state(self) -> dict`: Кодирует полное состояние фабрики.
    - **Возвращает**:
        - `dict`: Словарь, представляющий состояние фабрики.
- `decode_complete_state(self, state: dict)`: Декодирует полное состояние фабрики.
    - **Параметры**:
        - `state` (dict): Словарь, содержащий состояние фабрики.
    - **Возвращает**:
        - `self`: Текущий экземпляр `TinyFactory`.

### `TinyPersonFactory`

**Описание**: Фабрика для создания агентов `TinyPerson`. Хранит контекст и информацию о сгенерированных агентах.

**Методы**:

- `__init__(self, context_text, simulation_id:str=None)`: Инициализирует экземпляр `TinyPersonFactory`.
    - **Параметры**:
        - `context_text` (str): Текст контекста для генерации агентов.
        - `simulation_id` (str, необязательно): Идентификатор симуляции. По умолчанию `None`.
    - **Возвращает**:
        - `None`
- `generate_person_factories(number_of_factories, generic_context_text)`: Генерирует список фабрик `TinyPersonFactory` с помощью LLM OpenAI.
    - **Параметры**:
        - `number_of_factories` (int): Количество фабрик для генерации.
        - `generic_context_text` (str): Общий текст контекста.
    - **Возвращает**:
        - `list`: Список экземпляров `TinyPersonFactory` или `None`, если генерация не удалась.
- `generate_person(self, agent_particularities:str=None, temperature:float=1.5, attempts:int=5)`: Генерирует экземпляр `TinyPerson` с помощью LLM OpenAI.
    - **Параметры**:
        - `agent_particularities` (str): Дополнительные особенности агента.
        - `temperature` (float): Параметр температуры для LLM.
        - `attempts` (int): Количество попыток генерации.
    - **Возвращает**:
        - `TinyPerson`: Экземпляр `TinyPerson`, или `None` при ошибке.
    - **Исключения**:
        - `Exception`: Общее сообщение об ошибке.
- `_aux_model_call(self, messages, temperature)`: Вспомогательный метод для вызова модели. Используется для корректного использования декоретора `@transactional`.
    - **Параметры**:
        - `messages`: Список сообщений для модели.
        - `temperature`: Параметр температуры.
    - **Возвращает**:
        - `dict | None`: Ответ от модели или `None`.
- `_setup_agent(self, agent, configuration)`: Настраивает агента с необходимыми элементами.
    - **Параметры**:
        - `agent`: Экземпляр `TinyPerson`.
        - `configuration`: Словарь настроек.
    - **Возвращает**:
        - `None`



## Функции

(Здесь будут описаны функции, если они есть)