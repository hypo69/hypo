# Модуль для сбора данных о товарах с AliExpress

## Обзор

Модуль `graber.py` предназначен для сбора данных о товарах с веб-сайта AliExpress. Он содержит класс `Graber`, который наследуется от базового класса `src.suppliers.graber.Graber`. Класс предоставляет методы для обработки различных полей товара на странице.

## Подробнее

Этот модуль является частью системы для сбора и обработки данных о товарах от различных поставщиков. Он специализируется на работе с AliExpress, предоставляя инструменты для извлечения информации о товарах, их характеристиках и ценах. Модуль использует веб-драйвер для взаимодействия с сайтом AliExpress и сбора необходимых данных.

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для сбора данных о товарах с AliExpress. Он наследует функциональность от класса `src.suppliers.graber.Graber` и предоставляет методы для обработки полей товара.

**Как работает класс**:
1.  Класс инициализируется с экземпляром веб-драйвера и индексом языка.
2.  Устанавливается префикс поставщика как `'aliexpress'`.
3.  Вызывается конструктор родительского класса `Graber` из модуля `src.suppliers.graber`.
4.  Устанавливается значение локатора для декоратора в `None`. Если значение будет установлено, оно выполнится в декораторе `@close_pop_up`.

**Методы**:

*   `__init__`: Инициализация класса `Graber`.

    **Параметры**:
    *   `driver` (Driver): Экземпляр веб-драйвера для взаимодействия с браузером.
    *   `lang_index` (int): Индекс языка.

    **Как работает метод**:
    1.  Устанавливает атрибут `supplier_prefix` в значение `'aliexpress'`.
    2.  Вызывает конструктор родительского класса `src.suppliers.graber.Graber` с указанием префикса поставщика, драйвера и индекса языка.
    3.  Устанавливает атрибут `Context.locator_for_decorator` в `None`.

## Функции

### `close_pop_up`

```python
def close_pop_up(value: Any = None) -> Callable:
    """
    Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.
    
    :param value: Дополнительное значение для декоратора.
    :type value: Any
    :return: Декоратор, оборачивающий функцию.
    :rtype: Callable
    
    """
```

**Назначение**: Функция `close_pop_up` создает декоратор для закрытия всплывающих окон на веб-странице перед выполнением основной логики декорируемой функции. Это позволяет избежать ситуаций, когда всплывающие окна мешают сбору данных.

**Параметры**:

*   `value` (Any, optional): Дополнительное значение для декоратора. По умолчанию `None`.

**Возвращает**:

*   `Callable`: Декоратор, который оборачивает функцию.

**Как работает функция**:

1.  Определяется функция `decorator`, которая принимает декорируемую функцию `func` в качестве аргумента.
2.  Внутри `decorator` определяется функция `wrapper`, которая будет выполняться вместо оригинальной функции `func`.
3.  Внутри `wrapper` происходит следующее:
    *   Проверяется наличие локатора для закрытия всплывающего окна в `Context.locator_for_decorator`.
    *   Если локатор присутствует, выполняется попытка закрытия всплывающего окна с использованием метода `execute_locator` веб-драйвера.
    *   В случае возникновения ошибки `ExecuteLocatorException` при выполнении локатора, ошибка логируется.
    *   Выполняется основная функция `func` с передачей ей аргументов и ключевых слов.
    *   Возвращается результат выполнения `func`.
4.  Функция `decorator` возвращает функцию `wrapper`.
5.  Функция `close_pop_up` возвращает функцию `decorator`.

**Примеры**:

Пример использования декоратора `close_pop_up` для закрытия всплывающего окна перед выполнением функции сбора данных:

```python
from src.suppliers.aliexpress.graber import close_pop_up
from src.suppliers.graber import Context

# Определяем локатор для закрытия всплывающего окна
Context.locator_for_decorator = {'close_pop_up': {'type': 'css', 'selector': '.close-button'}}

# Применяем декоратор к функции сбора данных
@close_pop_up()
async def collect_data(item_id: str) -> dict:
    """
    Собирает данные о товаре с AliExpress.
    """
    # Логика сбора данных
    data = {'item_id': item_id, 'name': 'Example Product'}
    return data

# Вызываем функцию сбора данных
async def main():
    item_data = await collect_data('1234567890')
    print(item_data)

# Запускаем асинхронную функцию
if __name__ == "__main__":
    import asyncio
    asyncio.run(main())