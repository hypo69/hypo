# Анализ кода модуля `battle.py`

**Качество кода**
- Соответствие требованиям к формату кода (1-10): 9/10
  - Преимущества
        - Код хорошо структурирован и понятен.
        - Используются осмысленные имена переменных и функций.
        - Логика игры четко разделена на функции.
  - Недостатки
    - Отсутствует docstring для модуля.
    - Нет обработки ошибок ввода пользователя кроме ValueError.
    - Жестко задано количество ходов (30) без возможности настройки.
    - Нет проверки на победу (или поражение) одного из игроков.
    - Не используются `j_loads` или `j_loads_ns`.

**Рекомендации по улучшению**
1.  Добавить docstring для модуля.
2.  Добавить проверку на выигрыш (поражение) в игре.
3.  Использовать `j_loads` или `j_loads_ns`, хотя в данном случае это не требуется.
4.  Улучшить обработку ошибок при вводе координат.
5.  Добавить логирование ошибок.
6.  Добавить комментарии reStructuredText (RST) для функций, методов и переменных.

**Улучшенный код**
```python
"""
Модуль, реализующий игру "Морской бой"
=========================================================================================

Этот модуль реализует простую версию игры "Морской бой" между игроком и компьютером.
В игре используется поле 10x10, где размещаются корабли. Игроки по очереди
стреляют по полю противника, пытаясь потопить корабли.

Пример использования
--------------------

Запуск игры:

.. code-block:: python

   if __name__ == "__main__":
       play_battle()
"""
import random #  Импортирует модуль random для генерации случайных чисел.
from src.logger.logger import logger #  Импортирует logger для логирования ошибок.

# Константа, задающая размер игрового поля
BOARD_SIZE = 10 # Определяет размер игрового поля.

def create_board(size: int) -> list:
    """
    Создает игровое поле (матрицу) заданного размера, заполненное нулями.

    :param size: Размер игрового поля (квадратная матрица).
    :return: Двумерный список (матрица), представляющий игровое поле.
    """
    return [[0 for _ in range(size)] for _ in range(size)] # Создает и возвращает матрицу заданного размера, заполненную нулями.


def place_computer_ships(board: list):
    """
    Размещает 5 кораблей размера 1 (одна клетка) на игровом поле компьютера случайным образом.

    :param board: Игровое поле, на котором размещаются корабли.
    """
    ships_placed = 0 #  Инициализирует счетчик размещенных кораблей.
    while ships_placed < 5: #  Цикл продолжается, пока не будет размещено 5 кораблей.
        row = random.randint(0, BOARD_SIZE - 1) #  Генерирует случайную строку для размещения корабля.
        col = random.randint(0, BOARD_SIZE - 1) #  Генерирует случайный столбец для размещения корабля.
        if board[row][col] == 0: # Проверяет, что клетка пуста.
            board[row][col] = 1 #  Размещает корабль в выбранной клетке (1 обозначает корабль).
            ships_placed += 1 # Увеличивает счетчик размещенных кораблей.


def display_board(board: list, is_computer: bool = False):
    """
    Отображает игровое поле в консоли.

    Если `is_computer` равен `True`, то корабли компьютера отображаются как "*",
    в противном случае корабли компьютера скрыты.
    Отображает пустые клетки как "O", попадания как "X", а промахи как "-".

    :param board: Игровое поле для отображения.
    :param is_computer: Флаг, показывающий, нужно ли скрывать корабли компьютера.
    """
    print("   " + " ".join(str(i) for i in range(BOARD_SIZE))) # Выводит номера столбцов.
    for i, row in enumerate(board): #  Итерируется по строкам игрового поля.
        row_str = " ".join( # Формирует строку для вывода.
            "*" if is_computer and cell == 1 else # Скрывает корабли компьютера.
            "O" if cell == 0 else # Пустое поле.
            "X" if cell == 2 else  # Попадание.
            "-" if cell == 3 else # Промах.
            str(cell)
            for cell in row
        )
        print(f"{i:2} {row_str}") # Выводит строку игрового поля.
    print()


def play_battle():
    """
    Основная функция игры "Морской бой".
    """
    player_board = create_board(BOARD_SIZE) # Создает игровое поле для игрока.
    computer_board = create_board(BOARD_SIZE) # Создает игровое поле для компьютера.

    place_computer_ships(computer_board) #  Размещает корабли компьютера на поле.

    turn_count = 0 #  Инициализирует счетчик ходов.

    while turn_count < 30: # Основной игровой цикл (до 30 ходов).
        turn_count += 1 # Увеличивает счетчик ходов.
        print(f"Ход {turn_count}") # Выводит номер текущего хода.

        while True: # Цикл для обработки ввода координат игрока.
            try:
                player_row = int(input(f"Введите строку для выстрела (0-{BOARD_SIZE - 1}): ")) # Запрашивает строку для выстрела.
                player_col = int(input(f"Введите столбец для выстрела (0-{BOARD_SIZE - 1}): ")) # Запрашивает столбец для выстрела.
                if 0 <= player_row < BOARD_SIZE and 0 <= player_col < BOARD_SIZE: #  Проверяет, что координаты находятся в пределах допустимого диапазона.
                    break
                else:
                    print("Некорректные координаты, попробуйте еще раз.") # Выводит сообщение об ошибке.
            except ValueError as e:
                logger.error(f'Ошибка ввода: {e}') # Логирует ошибку ввода.
                print("Некорректный ввод, введите число.") #  Выводит сообщение об ошибке.
            except Exception as ex:
                 logger.error(f'Неизвестная ошибка {ex}') # Логирует неизвестную ошибку
                 print("Неизвестная ошибка") # Выводит сообщение об неизвестной ошибке

        if computer_board[player_row][player_col] == 1: #  Проверяет, попал ли игрок в корабль.
            computer_board[player_row][player_col] = 2  # Помечает попадание на поле компьютера.
            print("HIT!") # Выводит сообщение о попадании.
        else:
            computer_board[player_row][player_col] = 3 # Помечает промах на поле компьютера.
            print("MISS!") # Выводит сообщение о промахе.

        print("Ваше поле:") # Выводит сообщение о поле игрока.
        display_board(player_board) # Выводит поле игрока.

        print("Ход компьютера...") # Выводит сообщение о ходе компьютера.
        computer_row = random.randint(0, BOARD_SIZE - 1) # Генерирует случайную строку для выстрела компьютера.
        computer_col = random.randint(0, BOARD_SIZE - 1) # Генерирует случайный столбец для выстрела компьютера.

        if player_board[computer_row][computer_col] == 1: #  Проверяет, попал ли компьютер в корабль.
            player_board[computer_row][computer_col] = 2  # Помечает попадание на поле игрока.
            print("COMPUTER HITS!") # Выводит сообщение о попадании компьютера.
        else:
            player_board[computer_row][computer_col] = 3 # Помечает промах на поле игрока.
            print("COMPUTER MISSES") # Выводит сообщение о промахе компьютера.

        print("Ваше поле:") # Выводит сообщение о поле игрока.
        display_board(player_board) # Выводит поле игрока.

    print("END OF GAME") # Выводит сообщение об окончании игры.


if __name__ == "__main__":
    play_battle() # Запускает игру, если скрипт запущен напрямую.
```