## Ответ на Задачу No 309: Равнобедренные треугольники с целочисленными сторонами и высотами

### 1. Анализ задачи и решение
**Понимание задачи:**
*   Нам дан равнобедренный треугольник ABC, где |AB| = |AC| = a.
*   Нам нужно найти минимальное целочисленное значение |BC| = b, при котором высота из A на BC (обозначим её h) является целым числом.
*   Функция B(a,b) возвращает минимальное b для заданного a, при котором h - целое.
*   Нам нужно найти сумму B(n, n) для всех n от 1 до 10^7.

**Решение:**
1.  **Геометрия:**
    *   Рассмотрим треугольник ABC, где AB = AC = a, BC = b. Высота h из A падает в середину BC, разделив его на две равные части b/2.
    *   Теперь у нас есть прямоугольный треугольник, где гипотенуза a, один катет b/2, а второй катет - высота h.
    *   По теореме Пифагора: a² = h² + (b/2)².
    *   Отсюда: h² = a² - (b²/4) или 4h² = 4a² - b²
    *   Чтобы h было целым, 4h² должно быть целым, и следовательно, 4a² - b² должно быть квадратом целого числа. То есть, 4a² - b² = k² для некоторого целого k.
    *   b² = 4a² - k²
    *   b² = (2a - k)(2a + k)
    *   Минимальное целое b получается когда 2a-k=m^2 и 2a+k=n^2, где mn -  b, причем n-m  - четное
    *   2a = (m^2 + n^2)/2
    *   Для минимизации b, m и n должны быть максимально близки. 
    *   Если мы возьмем n = 2a/k, где k - любое нечетное число и m = k, то получается 2a= (k^2 + (2a/k)^2)/2
    *   Получается 4a = k^2 + 4a^2/k^2
    *   4ak^2 = k^4 + 4a^2
    *   4a(k^2 - a) = k^4
    *   b = 2 * sqrt(a^2 - h^2)
    *   4a^2 - b^2 = k^2
    *   b^2 = 4a^2 - k^2
    *   b^2 = (2a - k)(2a + k)
    *   k - нечетное, минимальное 1.
    *   b^2 = 4a^2 - 1
    *   2a - k = x
    *   2a + k = y
    *   xy = b^2
    *   2a-k = 1
    *   2a+k = b^2
    *   4a=b^2 +1, если не четное.

    *   Если k = 1, то b = sqrt(4a² - 1). Это целое число только, если 4a^2-1 является полным квадратом.
    *   4a² - b² = k²
    *   b² = 4a² - k²
    *   b = sqrt(4a^2 - k^2)
    *   Если k = 2*x + 1  то минимальное b будет = 2 * sqrt(a^2 - (a-1)^2)
    *   h = (a-1)  то b =  sqrt (4 * a^2 - (2*a-1)^2)
    *   b = sqrt (4a^2 - (4a^2 - 4a +1)
    *   b = sqrt (4a -1)
    *   минимальное h =  sqrt (a^2 - a^2/4) = a/2 * sqrt(3)
    *   минимальное b  = sqrt (4a^2 - 4a^2/4 *3) = a
    *   b = 2 * sqrt(a^2 - h^2) = 2 * sqrt(a^2 - (a/n)^2)

2.  **Случай B(n, n):** 
    *   Если a = n, то ищем минимальное b при h-целое.
    *   Подставляем a=n, b=n ->  h² = n² - (n²/4) = (3/4)n² -> h = (n√3)/2.
    *   Чтобы h было целым, n должен быть четным и кратным sqrt(3).
    *   Пробуем разные k. 
    *   b² = 4n² - k²
    *   Минимальное b получается когда k = 2n-1, тогда b = sqrt(4n^2 - (2n-1)^2) = sqrt(4n - 1)
    *   b = 2n, тогда h=0
    *   Если 4n-1 = i^2
    *   b = sqrt(4n^2-k^2)

3.  **Поиск минимального b:**
    *   Для b будет минимальным, если k будет максимальным.  Тогда  минимальное b  будет при k=1. b = sqrt(4n^2 - 1)
    *   Но, в условии сказано, что 4a^2 - b^2  = k^2, значит  b^2 = 4a^2 -k^2, а не 4a^2 - 1.

4.  **Оптимизация вычислений**
   * Ищем n такое что 4n-1 это квадрат какогото числа.
   * b = x, тогда x^2 = 4n-1,  x = sqrt(4n-1)
   * нужно проверить при каких n, sqrt(4n-1) будет целым числом.
   * 4n = x^2 + 1
   * n = (x^2 + 1)/4
   * x - нечетное.
   * перебираем нечетные x и считаем n и b для них.
   *

    
### 2. Алгоритм решения
1.  Начать
2.  Инициализировать переменную `total_sum` со значением 0
3.  Для каждого нечетного числа `x`  от 1 до `2 * sqrt(limit) + 1`
    *   Вычислить `n = (x^2 + 1) / 4`
    *   Если `n` - целое, и `n`  не превышает `limit`:
        *   Прибавить `x` к `total_sum`
4.  Вернуть `total_sum`
5.  Конец

### 3. Реализация на Python 3.12
```python
import math

def solve():
    limit = 10**7
    total_sum = 0
    x = 1
    while True:
      n = (x**2 + 1)/4
      if n > limit:
          break
      if n == int(n):
        total_sum += x
      x += 2
    return total_sum

result = solve()
print(result)

```

### 4. Блок-схема в формате mermaid
```mermaid
flowchart TD
    Start((Начало)) --> InitializeSum((Инициализировать total_sum = 0, x = 1))
    InitializeSum --> LoopStart((Начать цикл while True))
    LoopStart --> CalculateN((Вычислить n = (x^2 + 1) / 4))
    CalculateN --> CheckLimit((Проверить: n > limit?))
    CheckLimit -- Да --> End((Конец))
    CheckLimit -- Нет --> CheckInteger((Проверить: n - целое?))
    CheckInteger -- Да --> AddToSum((Прибавить x к total_sum))
    AddToSum --> IncrementX((x = x + 2))
    CheckInteger -- Нет --> IncrementX
    IncrementX --> LoopStart
```

**Legenda:**
*   **Начало, Конец:** Начало и конец алгоритма.
*   **Инициализировать total_sum = 0, x = 1:** Создаем переменную для хранения результата и присваиваем ей значение 0, создаем переменную x=1
*   **Начать цикл while True:** Начало бесконечного цикла.
*   **Вычислить n = (x^2 + 1) / 4:** Вычисляем значение n по формуле.
*   **Проверить: n > limit?** Проверяем, превышает ли n заданный предел.
*   **Проверить: n - целое?** Проверяем, является ли n целым числом.
*   **Прибавить x к total_sum:** Если n целое и не превышает лимит, добавляем x к total_sum.
*   **x = x + 2:** Увеличиваем x на 2.
