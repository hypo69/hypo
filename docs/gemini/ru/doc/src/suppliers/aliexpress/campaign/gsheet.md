# Модуль `hypotez/src/suppliers/aliexpress/campaign/gsheet.py`

## Обзор

Модуль `gsheet.py` предоставляет класс `AliCampaignGoogleSheet` для работы с Google Таблицами в контексте управления рекламными кампаниями AliExpress. Он позволяет записывать данные о кампаниях, категориях и продуктах, а также форматировать листы таблиц.  Модуль использует библиотеку `gspread` для взаимодействия с Google Таблицами.

## Оглавление

- [Модуль `gsheet.py`](#модуль-gsheetpy)
- [Класс `AliCampaignGoogleSheet`](#класс-alicampaigngooglesheet)
- [Метод `__init__`](#метод-init)
- [Метод `clear`](#метод-clear)
- [Метод `delete_products_worksheets`](#метод-delete_products_worksheets)
- [Метод `set_campaign_worksheet`](#метод-set_campaign_worksheet)
- [Метод `set_products_worksheet`](#метод-set_products_worksheet)
- [Метод `set_categories_worksheet`](#метод-set_categories_worksheet)
- [Метод `get_categories`](#метод-get_categories)
- [Метод `set_category_products`](#метод-set_category_products)
- [Вспомогательные методы `_format_categories_worksheet` и `_format_category_products_worksheet`](#вспомогательные-методы-format_categories_worksheet-и-format_category_products_worksheet)


## Класс `AliCampaignGoogleSheet`

**Описание**: Класс для работы с Google Sheets в рамках кампаний AliExpress. Наследует класс `SpreadSheet` и предоставляет дополнительные методы для управления листами Google Sheets, записи данных о категориях и продуктах, и форматирования листов.

**Атрибуты**:

- `spreadsheet_id`: Идентификатор Google Таблицы.
- `spreadsheet`: Объект `SpreadSheet`, представляющий подключение к Google Таблице.
- `worksheet`: Объект `Worksheet`, представляющий активный лист.


## Метод `__init__`

**Описание**: Инициализирует класс `AliCampaignGoogleSheet`.

**Параметры**:

- `campaign_name` (str): Название кампании.
- `language` (str | dict, optional): Язык кампании. По умолчанию `None`.
- `currency` (str, optional): Валюта кампании. По умолчанию `None`.

**Возвращает**:
-  None

**Вызывает исключения**:
-  Возможны исключения, связанные с инициализацией `SpreadSheet`.


## Метод `clear`

**Описание**: Очищает содержимое таблицы, удаляя листы продуктов и очищая данные на листах категорий и других указанных листах.

**Параметры**:
-  Нет

**Возвращает**:
-  None

**Вызывает исключения**:
- Любые исключения, возникающие при удалении листов.


## Метод `delete_products_worksheets`

**Описание**: Удаляет все листы из Google Таблицы, кроме листов 'categories' и 'product_template'.

**Параметры**:
- Нет

**Возвращает**:
-  None

**Вызывает исключения**:
- Возможные исключения при работе с листами Google Таблиц.



## Метод `set_campaign_worksheet`

**Описание**: Записывает данные о кампании в лист Google Таблиц.

**Параметры**:
- `campaign` (`SimpleNamespace`): Объект с данными о кампании.
- `language` (str, optional): Язык кампании.
- `currency` (str, optional): Валюта кампании.

**Возвращает**:
-  None

**Вызывает исключения**:
- Любые исключения, возникающие при записи данных в таблицу.


## Метод `set_products_worksheet`

**Описание**: Записывает данные о продуктах в листы Google Таблиц, соответствующие каждой категории.

**Параметры**:
- `category_name` (str): Название категории.

**Возвращает**:
-  None

**Вызывает исключения**:
- Возможные исключения при работе с данными продуктов или с листами Google Таблиц.



## Метод `set_categories_worksheet`

**Описание**: Записывает данные о категориях в лист Google Таблиц.

**Параметры**:
- `categories` (`SimpleNamespace`): Объект с данными о категориях.

**Возвращает**:
-  None

**Вызывает исключения**:
- Возможные исключения при работе с данными категорий или с листами Google Таблиц.



## Метод `get_categories`

**Описание**: Возвращает данные о категориях из листа Google Таблиц.

**Параметры**:
- Нет

**Возвращает**:
- list[dict]: Список словарей, представляющих данные о категориях.

**Вызывает исключения**:
- Возможные исключения при чтении данных из Google Таблиц.



## Метод `set_category_products`

**Описание**: Записывает данные о продуктах для заданной категории в Google Таблицу.

**Параметры**:
- `category_name` (str): Название категории.
- `products` (dict): Словарь с данными о продуктах.

**Возвращает**:
- None

**Вызывает исключения**:
- Любые исключения, возникающие при записи данных.


## Вспомогательные методы `_format_categories_worksheet` и `_format_category_products_worksheet`

**Описание**:  Методы для форматирования листов категорий и продуктов. Устанавливают ширину столбцов и высоту строк, а также форматируют заголовки.

**Параметры**:
- `ws` (Worksheet): Объект Worksheet, представляющий лист для форматирования.

**Возвращает**:
- None

**Вызывает исключения**:
- Возможные исключения при работе с форматированием листов.