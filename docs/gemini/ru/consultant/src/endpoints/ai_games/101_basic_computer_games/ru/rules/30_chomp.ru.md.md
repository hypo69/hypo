# Анализ кода модуля `30_chomp.ru.md`

**Качество кода**
7
- Плюсы
    - Документ содержит подробное описание правил игры "CHOMP", включая пошаговую инструкцию и пример работы программы.
    - Представлены основные этапы игры: инициализация, основной цикл, подсчет победителя и завершение игры.
    - Документ хорошо структурирован, разделен на логические блоки с заголовками.
- Минусы
    - Отсутствует код реализации игры, только текстовое описание.
    - Нет примеров кода на Python, только описание логики.
    - Не используется reStructuredText (RST) для комментариев.

**Рекомендации по улучшению**
1. Необходимо добавить код реализации игры на Python.
2. Следует преобразовать текстовые комментарии в формат reStructuredText (RST).
3. Добавить docstring к функциям и классам для более ясного понимания структуры кода.
4. Использовать `logger` для логирования ошибок и отладки.
5. Необходимо добавить валидацию входных данных.

**Оптимизированный код**
```markdown
### Название игры: **CHOMP** (Печенька)
   
#### Описание
**CHOMP** — это стратегическая игра на сетке, где каждый игрок по очереди «съедает» клетки с печеньки. Цель игры — не «съесть» отравленную клетку, которая расположена в верхнем левом углу. Игроки начинают с нижнего правого угла и по очереди выбирают клетки для уничтожения. Когда игрок выбирает клетку, все клетки, расположенные ниже и правее этой клетки, исчезают.

---

### Пошаговая инструкция для реализации

#### 1. **Инициализация игры**
   - В начале игры вам будет предложено выбрать размер игрового поля (например, 4 ряда и 7 столбцов).
   - Игроки по очереди делают ходы, начиная с нижнего правого угла поля.
   - Задача — не выбрать клетку с отравленной (P) клеткой, которая находится в верхнем левом углу.

#### 2. **Основной цикл игры**
   - **Ход игрока:**
     1. Игрок вводит координаты клетки для «съедения», например, (3, 4).
     2. Все клетки, которые находятся ниже и правее выбранной, включая саму клетку, исчезают.
     3. Если игрок выбирает отравленную клетку (верхний левый угол), он проигрывает игру.
   
   - **Повторение хода:**
     - Игра продолжается, пока не останется только отравленная клетка, или пока игроки не решат выйти.

#### 3. **Подсчёт победителя**
   - Игра продолжается до тех пор, пока один из игроков не съедает отравленную клетку.
   - Победителем становится тот, кто не съел отравленную клетку и оставил её для противника.
   - Программа может предложить сыграть снова, если один из игроков проиграл.

#### 4. **Завершение игры**
   - После завершения игры программа предложит сыграть снова:
     ```
     Хотите сыграть снова? (да/нет)
     ```
    
---

### Пример работы программы

1. **Начало игры:**
   ```
   Добро пожаловать в игру CHOMP!
   Введите количество игроков: 2
   Введите количество рядов: 4
   Введите количество столбцов: 7
   ```

2. **Задача:**
   ```
   Игрок 1, введите координаты клетки для съедения (ряд, колонка): 3,4
   Игрок 2, введите координаты клетки для съедения (ряд, колонка): 2,3
   ```
    
3. **Завершение игры:**
   ```
   Игрок 1 съел отравленную клетку! Игра завершена.
   Хотите сыграть снова? (да/нет)
   > нет
   Спасибо за игру!
   ```

---
    
### Возможные ограничения
- Программа должна корректно обрабатывать выход за пределы поля и повторное использование уже съеденных клеток.
- Игра не поддерживает дополнительные правила или модификации для увеличения сложности.
  
---

### Реализация

Игра реализована с помощью простых математических операций для проверки координат и корректного удаления клеток из игрового поля.
```
```python
"""
Модуль реализует игру CHOMP.
=========================================================================================
 
Этот модуль содержит функции для инициализации игры, обработки ходов игроков
и определения победителя в игре CHOMP.

Пример использования
--------------------

Пример запуска игры:

.. code-block:: python

    play_chomp()
"""
from src.logger.logger import logger # Импорт logger для логирования ошибок

def init_board(rows: int, cols: int) -> list[list[str]]:
    """
    Инициализирует игровое поле.

    :param rows: Количество рядов в поле.
    :param cols: Количество столбцов в поле.
    :return: Двумерный список, представляющий игровое поле.
    """
    # Код создает игровое поле, заполненное символом 'O'
    board = [['O' for _ in range(cols)] for _ in range(rows)]
    # Код устанавливает отравленную клетку в верхнем левом углу
    board[0][0] = 'P'
    return board

def print_board(board: list[list[str]]):
    """
    Выводит текущее состояние игрового поля.

    :param board: Двумерный список, представляющий игровое поле.
    """
    # Код выводит каждую строку игрового поля
    for row in board:
        print(' '.join(row))
    print()

def get_move(player: int) -> tuple[int, int]:
    """
    Получает ход игрока.

    :param player: Номер игрока (1 или 2).
    :return: Кортеж, содержащий координаты выбранной клетки (ряд, столбец).
    """
    while True:
        try:
            # Код запрашивает ввод координат от игрока
            move_str = input(f'Игрок {player}, введите координаты клетки для съедения (ряд, колонка), например 3,4: ').split(',')
            row, col = int(move_str[0].strip()) - 1, int(move_str[1].strip()) - 1
            return row, col
        except (ValueError, IndexError) as ex:
            # Код обрабатывает ошибку при неверном вводе
            logger.error(f'Некорректный ввод. Попробуйте еще раз. {ex}')

def make_move(board: list[list[str]], row: int, col: int) -> bool:
    """
    Выполняет ход игрока, удаляя клетки на игровом поле.

    :param board: Двумерный список, представляющий игровое поле.
    :param row: Ряд выбранной клетки.
    :param col: Столбец выбранной клетки.
    :return: True, если ход был сделан, False, если игрок съел отравленную клетку.
    """
    rows = len(board)
    cols = len(board[0])
    # Код проверяет, съедена ли отравленная клетка
    if board[row][col] == 'P':
         return False

    # Код удаляет клетки, начиная с выбранной
    for r in range(row, rows):
        for c in range(col, cols):
             board[r][c] = ' '

    return True

def play_chomp():
    """
    Запускает игру CHOMP.
    """
    # Код выводит приветствие
    print('Добро пожаловать в игру CHOMP!')
    while True:
        try:
            # Код запрашивает количество игроков
            num_players = int(input('Введите количество игроков: '))
            # Код запрашивает размеры игрового поля
            rows = int(input('Введите количество рядов: '))
            cols = int(input('Введите количество столбцов: '))

            # Код инициализирует игровое поле
            board = init_board(rows, cols)
            current_player = 1
            game_over = False
            while not game_over:
                # Код выводит текущее состояние доски
                print_board(board)
                # Код получает ход игрока
                row, col = get_move(current_player)
                # Код выполняет ход игрока
                if not make_move(board, row, col):
                     # Код устанавливает флаг окончания игры если съели отравленную клетку
                    print(f'Игрок {current_player} съел отравленную клетку! Игра завершена.')
                    game_over = True
                else:
                    # Код переключает игрока
                     current_player = 3 - current_player

            # Код запрашивает у пользователя, хочет ли он сыграть снова
            play_again = input('Хотите сыграть снова? (да/нет) ')
            if play_again.lower() != 'да':
                print('Спасибо за игру!')
                break
        except (ValueError, IndexError) as ex:
            # Код обрабатывает ошибку ввода и предлагает перезапустить игру
            logger.error(f'Неверный формат ввода. Игра начнется заново. {ex}')
            
if __name__ == '__main__':
    # Код запускает игру при запуске модуля
    play_chomp()
```