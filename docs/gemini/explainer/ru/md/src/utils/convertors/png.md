# hypotez/src/utils/convertors/png.py

```markdown
Модуль `src.utils.convertors.png` предназначен для преобразования текстовых строк в изображения PNG. Он использует библиотеку Pillow для создания изображений с указанными параметрами.

**Описание класса `TextToImageGenerator`:**

Класс `TextToImageGenerator` отвечает за генерацию изображений PNG из списка текстовых строк. Он предоставляет методы для определения пути вывода, вычисления позиции текста, создания изображений, проверки существования файлов, извлечения текстовых строк из файла, обработки размеров и других вспомогательных функций.  Класс имеет следующие важные методы:

* **`__init__`**: Инициализирует класс с настройками по умолчанию для директории вывода, размера холста, отступа, фона и цвета текста.
* **`generate_images`**: Генерация изображений PNG. Принимает список строк, директорию вывода, шрифт, размер холста, отступ, цвет фона и текста, уровень логирования и флаг перезаписи существующих файлов. Возвращает список путей к сгенерированным изображениям.  Обрабатывает ситуации, когда файл уже существует (с опцией `clobber`) и логирует предупреждение.
* **`generate_png`**: Создаёт изображение PNG с заданным текстом, шрифтом, цветами и размерами.
* **`center_text_position`**: Вычисляет координаты для центрирования текста на холсте.
* **`overlay_images`**: Наложение одного PNG изображения на другой в заданной позиции с указанной прозрачностью.  Функция важна для комбинирования изображений.

**Описание функции `webp2png`:**

Функция `webp2png` конвертирует изображение в формате WEBP в формат PNG. Принимает путь к входному изображению в формате WEBP и путь для сохранения выходного изображения в формате PNG. Возвращает `True` при успешной конвертации, `None` в случае ошибки. Обрабатывает потенциальные исключения во время работы.


**Основные моменты:**

* **Обработка ошибок:** Класс и функция `webp2png` содержат обработку исключений (`try...except`), что повышает устойчивость кода к ошибкам.
* **Логирование:** Используется модуль `logger` из `src.logger` для записи сообщений об ошибках и предупреждениях.
* **Управление путями:** Используется `pathlib.Path`, что улучшает обработку путей к файлам и каталогам.
* **Типизация:** Используется `typing`, что улучшает читаемость и надежность кода.
* **Документация:**  Код содержит docstrings, описывающие классы и функции. Это существенно повышает читаемость и понимание кода.


**Пример использования:**

```python
generator = TextToImageGenerator()
lines = ["Текст 1", "Текст 2"]
images = await generator.generate_images(lines, output_dir="./output", canvas_size=(512, 512), font="Arial.ttf")
print(images)

# Пример использования webp2png
webp2png("input.webp", "output.png")
```

**Рекомендации:**

*  Проверьте корректность путей к файлам и каталогам.
*  Убедитесь в наличии необходимых библиотек (Pillow).
*  Оптимизируйте обработку изображений при больших размерах для повышения производительности.


Этот комментарий предоставляет исчерпывающее объяснение кода, его структуры и основных особенностей.
```