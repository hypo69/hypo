# Модуль Hashnode

## Обзор

Модуль `Hashnode.py` предоставляет асинхронный генератор для взаимодействия с сервисом Hashnode AI для генерации текста на основе предоставленных сообщений и поисковых результатов. Он включает в себя функциональность для выполнения веб-поиска и получения источников, которые затем используются для формирования ответа. Модуль предназначен для интеграции в систему, требующую генерацию текста с использованием внешних источников.

## Подробней

Модуль предназначен для использования в асинхронных приложениях, где требуется взаимодействие с API Hashnode для генерации текста на основе предоставленных сообщений. В модуле реализована поддержка прокси-серверов. Модуль определяет класс `Hashnode`, который наследуется от `AsyncGeneratorProvider`.

## Классы

### `SearchTypes`

**Описание**:
Класс `SearchTypes` содержит статические атрибуты, определяющие типы поиска, поддерживаемые Hashnode.

**Аттрибуты**:
- `quick` (str): Строка "quick", представляющая быстрый поиск.
- `code` (str): Строка "code", представляющая поиск кода.
- `websearch` (str): Строка "websearch", представляющая веб-поиск.

### `Hashnode`

**Описание**:
Класс `Hashnode` предоставляет функциональность для взаимодействия с API Hashnode. Он включает методы для создания асинхронного генератора, который отправляет запросы к API Hashnode и возвращает сгенерированный текст.

**Наследует**:
`AsyncGeneratorProvider` - базовый класс для асинхронных провайдеров, использующих генераторы.

**Аттрибуты**:
- `url` (str): URL-адрес сервиса Hashnode ("https://hashnode.com").
- `working` (bool): Флаг, указывающий, работает ли провайдер (False).
- `supports_message_history` (bool): Флаг, указывающий, поддерживает ли провайдер историю сообщений (True).
- `supports_gpt_35_turbo` (bool): Флаг, указывающий, поддерживает ли провайдер модель GPT-3.5 Turbo (True).
- `_sources` (list): Список источников, полученных в результате веб-поиска (изначально пустой).

**Методы**:

- `create_async_generator`: Создает асинхронный генератор для получения ответов от Hashnode.
- `get_sources`: Возвращает список источников, использованных для генерации ответа.

## Функции

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    search_type: str = SearchTypes.websearch,
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """
    Создает асинхронный генератор для взаимодействия с API Hashnode.

    Args:
        model (str): Модель для использования (не используется в данной реализации).
        messages (Messages): Список сообщений для отправки в API Hashnode.
        search_type (str, optional): Тип поиска, который следует использовать. По умолчанию `SearchTypes.websearch`.
        proxy (str, optional): Адрес прокси-сервера для использования. По умолчанию `None`.
        **kwargs: Дополнительные аргументы (не используются в данной реализации).

    Returns:
        AsyncResult: Асинхронный генератор, возвращающий части сгенерированного текста.

    Raises:
        aiohttp.ClientResponseError: Если запрос к API возвращает ошибку.

    Как работает функция:
    1. Функция устанавливает необходимые заголовки для HTTP-запросов.
    2. Создается асинхронная сессия клиента с использованием библиотеки aiohttp.
    3. Извлекается последний запрос пользователя из списка сообщений.
    4. В зависимости от типа поиска (`search_type`) выполняется веб-поиск.
    5. Формируются данные для запроса к API Hashnode.
    6. Отправляется POST-запрос к API Hashnode с использованием асинхронной сессии.
    7. Функция итерируется по ответу, декодирует полученные чанки и выдает их в качестве результата.

    Внутри функции происходят следующие действия и преобразования:
    A: Установка заголовков запроса.
    |
    -- B: Создание асинхронной сессии.
    |
    C: Определение типа поиска.
    |
    D: Выполнение веб-поиска (если необходимо).
    |
    E: Формирование данных запроса.
    |
    F: Отправка запроса и получение ответа.

    Примеры:
        >>> async for chunk in Hashnode.create_async_generator(model="gpt-3.5-turbo", messages=[{"role": "user", "content": "Hello"}], search_type="websearch"):
        ...     print(chunk, end="")
        ...
        Привет!
    """
```

### `get_sources`

```python
@classmethod
def get_sources(cls) -> list:
    """
    Возвращает список источников, использованных для генерации ответа.

    Returns:
        list: Список словарей, содержащих заголовок и URL источника.

    Как работает функция:
    1. Функция преобразует список `cls._sources` в список словарей, каждый из которых содержит заголовок и URL источника.

    Внутри функции происходят следующие действия и преобразования:
    A: Преобразование `cls._sources` в список словарей.

    Примеры:
        >>> Hashnode._sources = [{"name": "Example", "url": "https://example.com"}]
        >>> Hashnode.get_sources()
        [{'title': 'Example', 'url': 'https://example.com'}]
    """