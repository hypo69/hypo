# Модуль для обработки диалогов с AI-моделью
=================================================

Модуль содержит класс `ConversationHandler`, который используется для организации и управления диалогами с AI-моделями через API g4f.

Пример использования
----------------------

```python
conversation = ConversationHandler(model="gpt-4")
conversation.add_user_message("Hello!")
print("Assistant:", conversation.get_response())
```

## Оглавление

- [Обзор](#обзор)
- [Классы](#классы)
    - [ConversationHandler](#conversationhandler)
        - [Методы](#методы)
            - [`__init__`](#__init__)
            - [`add_user_message`](#add_user_message)
            - [`get_response`](#get_response)

## Обзор

Модуль `messages.py` предоставляет класс `ConversationHandler` для управления ходом диалога с AI-моделью, такой как GPT-4. Он позволяет добавлять сообщения пользователя, получать ответы от модели и сохранять историю разговоров.

## Подробней

Этот модуль предназначен для упрощения взаимодействия с API g4f.  Класс `ConversationHandler` инициализирует клиент g4f, устанавливает модель, используемую для диалога, и хранит историю сообщений. Основная цель - предоставить удобный интерфейс для ведения продолжительных диалогов с AI-моделью, сохраняя контекст предыдущих сообщений.

## Классы

### `ConversationHandler`

**Описание**: Класс для управления диалогом с AI-моделью.

**Принцип работы**:
Класс `ConversationHandler` инкапсулирует логику взаимодействия с AI-моделью через библиотеку `g4f`. При инициализации создается клиент `g4f.client.Client` и устанавливается модель (по умолчанию "gpt-4"). Метод `add_user_message` добавляет сообщения пользователя в историю диалога, а метод `get_response` отправляет историю диалога в модель и возвращает ответ ассистента, который также добавляется в историю.

**Методы**:

- `__init__`
- `add_user_message`
- `get_response`

#### `__init__`

```python
def __init__(self, model: str = "gpt-4"):
    """
    Инициализирует объект ConversationHandler.

    Args:
        model (str, optional): Название модели для использования. По умолчанию "gpt-4".
    """
```

**Назначение**: Инициализация экземпляра класса `ConversationHandler`.

**Параметры**:
- `model` (str): Название модели, которую нужно использовать для диалога. По умолчанию используется модель "gpt-4".

**Как работает**:
1. Инициализируется клиент `g4f.client.Client`.
2. Устанавливается модель для диалога.
3. Создается пустой список для хранения истории диалога (`conversation_history`).

#### `add_user_message`

```python
def add_user_message(self, content: str):
    """
    Добавляет сообщение пользователя в историю диалога.

    Args:
        content (str): Текст сообщения пользователя.
    """
```

**Назначение**: Добавление сообщения пользователя в историю диалога.

**Параметры**:
- `content` (str): Текст сообщения пользователя.

**Как работает**:
1. Создает словарь, содержащий роль "user" и текст сообщения.
2. Добавляет этот словарь в список `conversation_history`.

#### `get_response`

```python
def get_response(self) -> str:
    """
    Отправляет историю диалога в модель и возвращает ответ ассистента.

    Returns:
        str: Текст ответа ассистента.
    """
```

**Назначение**: Получение ответа от AI-модели на основе истории диалога.

**Возвращает**:
- `str`: Текст ответа ассистента.

**Как работает**:
1. Отправляет запрос к API `g4f.client.chat.completions.create` с текущей историей диалога.
2. Извлекает ответ ассистента из полученного ответа.
3. Добавляет сообщение ассистента в историю диалога.
4. Возвращает текст ответа ассистента.

**Примеры**:

```python
conversation = ConversationHandler()
conversation.add_user_message("Hello!")
print("Assistant:", conversation.get_response())

conversation.add_user_message("How are you?")
print("Assistant:", conversation.get_response())