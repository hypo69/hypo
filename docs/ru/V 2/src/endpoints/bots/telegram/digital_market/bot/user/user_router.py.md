# Модуль `user_router`

## Обзор

Модуль `user_router` содержит обработчики сообщений и callback-запросов для взаимодействия с пользователем в Telegram боте. Он включает в себя обработку команды `/start`, отображение главной страницы, информации о магазине, профиля пользователя с историей покупок и деталей конкретных покупок.

## Оглавление
1. [Обзор](#обзор)
2. [Функции](#функции)
    - [`cmd_start`](#cmd_start)
    - [`page_home`](#page_home)
    - [`page_about`](#page_about)
    - [`page_about`](#page_about-1)
    - [`page_user_purchases`](#page_user_purchases)

## Функции

### `cmd_start`

**Описание**: Обрабатывает команду `/start`. Если пользователь уже зарегистрирован, отправляет приветственное сообщение и главное меню. Иначе регистрирует нового пользователя и также отправляет приветствие с главным меню.

**Параметры**:
- `message` (Message): Объект сообщения от Telegram.
- `session_with_commit` (AsyncSession): Асинхронная сессия для работы с базой данных.

**Возвращает**:
- `None`: Ничего не возвращает. Отправляет сообщение пользователю.

**Вызывает исключения**:
- `sqlalchemy.exc.SQLAlchemyError`: Ошибка при работе с базой данных.

### `page_home`

**Описание**: Обрабатывает callback-запрос с данными `home`. Отправляет пользователю главную страницу с главным меню.

**Параметры**:
- `call` (CallbackQuery): Объект callback-запроса от Telegram.

**Возвращает**:
- `None`: Ничего не возвращает. Отправляет сообщение пользователю.

### `page_about`

**Описание**: Обрабатывает callback-запрос с данными `about`. Отправляет пользователю информацию о магазине.

**Параметры**:
- `call` (CallbackQuery): Объект callback-запроса от Telegram.

**Возвращает**:
- `None`: Ничего не возвращает. Отправляет сообщение пользователю.

### `page_about`

**Описание**: Обрабатывает callback-запрос с данными `my_profile`. Отображает профиль пользователя, включая статистику покупок. Если покупок нет, сообщает об этом. Если есть, показывает их количество и общую сумму.

**Параметры**:
- `call` (CallbackQuery): Объект callback-запроса от Telegram.
- `session_without_commit` (AsyncSession): Асинхронная сессия для работы с базой данных.

**Возвращает**:
- `None`: Ничего не возвращает. Отправляет сообщение пользователю.

**Вызывает исключения**:
- `sqlalchemy.exc.SQLAlchemyError`: Ошибка при работе с базой данных.

### `page_user_purchases`

**Описание**: Обрабатывает callback-запрос с данными `purchases`. Отображает детали покупок пользователя. Если покупок нет, сообщает об этом. Иначе отправляет информацию о каждой покупке, включая имя, описание, цену и закрытый контент, а также файл, если он есть.

**Параметры**:
- `call` (CallbackQuery): Объект callback-запроса от Telegram.
- `session_without_commit` (AsyncSession): Асинхронная сессия для работы с базой данных.

**Возвращает**:
- `None`: Ничего не возвращает. Отправляет сообщение пользователю.

**Вызывает исключения**:
- `sqlalchemy.exc.SQLAlchemyError`: Ошибка при работе с базой данных.