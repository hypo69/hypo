Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `AliCampaignGoogleSheet`, который взаимодействует с Google Таблицами для управления рекламными кампаниями AliExpress.  Класс наследует функциональность из класса `SpreadSheet` и предоставляет методы для создания, обновления и форматирования листов, содержащих данные о категориях и продуктах кампании.  Методы позволяют очистить таблицу, удалить листы продуктов, записывать данные кампании, категории и продукты в соответствующие листы, а также форматировать листы для улучшенного отображения.  Код использует библиотеку gspread для работы с Google Таблицами.

Шаги выполнения
-------------------------
1. **Импортирование необходимых библиотек**: Модуль импортирует необходимые библиотеки, включая `time`, `SimpleNamespace`, `typing`, `gspread`, `SpreadSheet`, `j_dumps`, `pprint`, `logger`, `translate` и др., для работы с Google Таблицами, манипулирования данными и логирования.

2. **Определение класса `AliCampaignGoogleSheet`**: Определяется класс `AliCampaignGoogleSheet`, наследующий от `SpreadSheet`. Он предназначен для работы с Google Таблицами.

3. **Инициализация класса**: Конструктор `__init__` класса `AliCampaignGoogleSheet` принимает имя кампании (`campaign_name`), язык (`language`) и валюту (`currency`) как параметры.  Он инициализирует родительский класс `SpreadSheet` с заданным ID таблицы.

4. **Очистка данных**: Метод `clear()` удаляет листы продуктов и очищает данные в листах категорий.

5. **Удаление листов продуктов**: Метод `delete_products_worksheets()` удаляет все листы из таблицы, кроме листов 'categories' и 'product_template'.

6. **Запись данных кампании**: Метод `set_campaign_worksheet()` записывает данные кампании (имя, заголовок, язык, валюту, описание) в лист 'campaign' в Google Таблицах, используя вертикальную запись (свойство `batch_update`).

7. **Запись данных о продуктах**: Метод `set_products_worksheet()` записывает данные о продуктах (идентификатор, цена, описание и т.д.) в листы продуктов.

8. **Запись данных категорий**: Метод `set_categories_worksheet()` записывает данные о категориях (название, описание, теги) в лист 'categories'.  Этот метод очищает лист перед записью новых данных.

9. **Получение данных о категориях**: Метод `get_categories()` возвращает данные о категориях из листа 'categories' в виде списка словарей.

10. **Запись данных о продуктах в категорию**: Метод `set_category_products()` записывает данные о продуктах в лист, соответствующий имени категории, добавляя новые строки в лист с продуктами.

11. **Форматирование листов**: Методы `_format_categories_worksheet()` и `_format_category_products_worksheet()` выполняют форматирование листов, устанавливая ширину столбцов и высоту строк для лучшего визуального восприятия данных.  Форматирование включает в себя установку цвета и стиля заголовков.

Пример использования
-------------------------
.. code-block:: python

    from hypotez.src.suppliers.aliexpress.campaign.gsheet import AliCampaignGoogleSheet
    from types import SimpleNamespace

    # Предполагается, что у вас есть объект campaign_data, содержащий данные о кампании
    campaign_data = SimpleNamespace(
        campaign_name="My Campaign",
        title="Campaign Title",
        language="ru",
        currency="USD",
        description="Campaign Description",
    )

    # Создаем экземпляр класса
    gsheet_instance = AliCampaignGoogleSheet(
        campaign_name=campaign_data.campaign_name
    )

    # Запись данных кампании в Google Таблицы
    gsheet_instance.set_campaign_worksheet(campaign_data)

    # Пример использования для записи данных о продуктах
    # Предполагаем, что есть объект category с данными о категориях
    # ... (Загрузка данных о категориях)

    # gsheet_instance.set_products_worksheet("Electronics")