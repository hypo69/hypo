# Модуль `Local`

## Обзор

Модуль `Local` предоставляет класс `Local`, который является адаптером для локальных моделей, таких как GPT4All, в рамках библиотеки `g4f`. Он позволяет использовать эти модели для генерации текста, поддерживая как потоковую, так и не потоковую генерацию. Модуль также включает проверку наличия необходимых зависимостей и предоставляет метод для получения списка доступных локальных моделей.

## Подробнее

Этот модуль является частью системы `g4f` и предназначен для интеграции локальных моделей в общий интерфейс. Он абстрагирует детали взаимодействия с `gpt4all` и предоставляет удобный способ использования локальных моделей через `g4f`. Модуль `Local` использует классы и функции из других модулей `g4f`, таких как `AbstractProvider`, `ProviderModelMixin`, `MissingRequirementsError`, `get_models`, `LocalProvider`.

## Классы

### `Local(AbstractProvider, ProviderModelMixin)`

**Описание**: Класс `Local` предоставляет интерфейс для работы с локальными моделями GPT4All. Он наследуется от `AbstractProvider` и `ProviderModelMixin`, что позволяет ему интегрироваться в систему `g4f` и использовать общие методы и атрибуты.

**Принцип работы**:
Класс `Local` инициализируется без параметров. Он проверяет наличие необходимых зависимостей (`gpt4all`) и предоставляет метод для генерации текста (`create_completion`). Если зависимости не установлены, он выбрасывает исключение `MissingRequirementsError`.

**Атрибуты**:
- `label` (str): Имя провайдера - `"GPT4All"`.
- `working` (bool): Флаг, указывающий, что провайдер работает - `True`.
- `supports_message_history` (bool): Флаг, указывающий, что провайдер поддерживает историю сообщений - `True`.
- `supports_system_message` (bool): Флаг, указывающий, что провайдер поддерживает системные сообщения - `True`.
- `supports_stream` (bool): Флаг, указывающий, что провайдер поддерживает потоковую генерацию - `True`.
- `models` (list): Список доступных локальных моделей.
- `default_model` (str): Модель, используемая по умолчанию.

**Методы**:
- `get_models()`: Возвращает список доступных локальных моделей.
- `create_completion(model: str, messages: Messages, stream: bool, **kwargs) -> CreateResult`: Генерирует текст на основе переданных сообщений и параметров.

## Функции

### `get_models()`

```python
@classmethod
def get_models(cls)
```

**Назначение**: Получение списка доступных локальных моделей.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- `list`: Список доступных локальных моделей.

**Как работает функция**:

1.  **Проверка наличия моделей**: Функция проверяет, был ли уже получен список моделей. Это делается путем проверки атрибута `cls.models`.
2.  **Получение списка моделей**: Если список моделей еще не был получен, функция вызывает `get_models()` из модуля `...locals.models`, чтобы получить список доступных моделей.
3.  **Установка модели по умолчанию**: После получения списка моделей функция устанавливает первую модель в списке в качестве модели по умолчанию, сохраняя ее в атрибуте `cls.default_model`.
4.  **Возврат списка моделей**: Функция возвращает список доступных моделей.

**Примеры**:
```python
models = Local.get_models()
print(models)
```

### `create_completion()`

```python
@classmethod
def create_completion(
    cls,
    model: str,
    messages: Messages,
    stream: bool,
    **kwargs
) -> CreateResult
```

**Назначение**: Создание запроса на завершение текста с использованием локальной модели.

**Параметры**:
- `model` (str): Имя используемой модели.
- `messages` (Messages): Список сообщений для генерации текста.
- `stream` (bool): Флаг, указывающий, нужно ли использовать потоковый режим.
- `**kwargs`: Дополнительные параметры, передаваемые в функцию `create_completion` из `LocalProvider`.

**Возвращает**:
- `CreateResult`: Результат запроса на завершение текста.

**Вызывает исключения**:
- `MissingRequirementsError`: Если не установлены необходимые зависимости (`gpt4all`).

**Как работает функция**:

1.  **Проверка зависимостей**: Функция проверяет, установлены ли необходимые зависимости (`gpt4all`). Если зависимости не установлены, выбрасывается исключение `MissingRequirementsError` с рекомендацией по установке зависимостей.
2.  **Получение модели**: Функция вызывает `cls.get_model(model)` для получения объекта модели.
3.  **Создание запроса на завершение**: Функция вызывает `LocalProvider.create_completion` с переданными параметрами и объектом модели. Результат запроса возвращается.

**Примеры**:

```python
messages = [{"role": "user", "content": "Hello, how are you?"}]
result = Local.create_completion(model="default", messages=messages, stream=False)
print(result)