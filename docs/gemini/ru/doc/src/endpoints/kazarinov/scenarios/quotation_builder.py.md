# Модуль quotation_builder

## Обзор

Модуль `quotation_builder` предназначен для обработки данных о товарах от поставщиков, их разбора, подготовки к использованию моделями искусственного интеллекта и интеграции с Facebook для публикации рекламных объявлений о продукции. Модуль включает в себя функциональность для извлечения данных, их обработки с помощью AI, а также для интеграции с Facebook для публикации информации о продуктах.

## Подробней

Модуль выполняет следующие основные задачи:

1.  **Извлечение и разбор данных о товарах**: Модуль взаимодействует с различными поставщиками (Morlevi, Ksp, Ivory, Grandadvance) для извлечения информации о товарах. Для этого используются классы-граберы, такие как `MorleviGraber`, `KspGraber`, `IvoryGraber` и `GrandadvanceGraber`.

2.  **Преобразование данных**: Полученные данные преобразуются в формат, удобный для дальнейшей обработки и использования в AI-моделях. Это включает в себя очистку и стандартизацию данных, а также преобразование их в словари.

3.  **Обработка данных с использованием AI**: Модуль использует AI-модели, в частности Google Gemini, для обработки данных о товарах. Это может включать в себя генерацию описаний, заголовков и других рекламных материалов.

4.  **Интеграция с Facebook**: После обработки данных модуль интегрируется с Facebook для публикации рекламных объявлений о продукции. Это включает в себя загрузку изображений, создание текстовых сообщений и их публикацию на страницах Facebook.

5.  **Генерация отчетов**: Модуль также предоставляет функциональность для генерации отчетов о проделанной работе и обработанных данных.

Модуль `quotation_builder` является важной частью проекта, так как он автоматизирует процесс подготовки данных и публикации рекламных объявлений, что позволяет значительно сократить время и усилия, затрачиваемые на эти задачи.

## Классы

### `QuotationBuilder`

**Описание**: Класс `QuotationBuilder` отвечает за извлечение, разбор и сохранение данных о продуктах поставщиков. Он также управляет взаимодействием с AI-моделями и интеграцией с Facebook для публикации информации о продуктах.

**Методы**:

*   `__init__`: Инициализирует экземпляр класса `QuotationBuilder`, настраивает драйвер веб-браузера и модель Gemini.
*   `convert_product_fields`: Преобразует поля продукта в словарь.
*   `process_ai`: Обрабатывает список продуктов с использованием AI-модели.
*   `process_ai_async`: Асинхронно обрабатывает список продуктов с использованием AI-модели.
*   `save_product_data`: Сохраняет данные продукта в файл.
*   `post_facebook_async`: Исполняет сценарий рекламного модуля `facebook`.

**Параметры**:

*   `driver` (`Driver`): Экземпляр Selenium WebDriver.
*   `export_path` (`Path`): Путь для экспорта данных.
*   `products_list` (`List[dict]`): Список обработанных данных о продуктах.

**Примеры**

Пример инициализации класса:

```python
quotation_builder = QuotationBuilder(mexiron_name='test_mexiron', driver='firefox')
```

## Функции

### `main`

```python
def main():
    """"""
    ...
    lang:str = 'he'
    
    mexiron_name: str = '250203025325520'
    base_path:Path = Path(gs.path.external_storage)
    export_path = base_path / ENDPOINT / 'mexironim' / mexiron_name
    html_path: Path = export_path / f'{mexiron_name}_{lang}.html'
    pdf_path: Path = export_path / f'{mexiron_name}_{lang}.pdf'
    docx_path:Path = export_path / f'{mexiron_name}_{lang}.doc'
    data = j_loads(export_path / f'{mexiron_name}_{lang}.json')

    quotation = QuotationBuilder(mexiron_name)
    asyncio.run(quotation.create_reports(data[lang], mexiron_name, lang, html_path, pdf_path, docx_path))
```

**Описание**: Функция `main` является точкой входа в программу. Она выполняет настройку и запуск процесса формирования отчетов на основе данных, полученных от AI-модели.

**Параметры**: # если есть параметры

*   `mexiron_name` (`str`): Имя мехирона, используемое для идентификации и организации файлов.
*   `lang` (`str`): Язык, на котором будут формироваться отчеты.
*   `html_path` (`Path`): Путь к HTML-файлу отчета.
*   `pdf_path` (`Path`): Путь к PDF-файлу отчета.
*   `docx_path` (`Path`): Путь к DOCX-файлу отчета.
*   `data` (`dict`): Словарь с данными, используемыми для формирования отчетов.

**Возвращает**: # если есть возвращаемое значение

*   `None`: Функция ничего не возвращает, но выполняет формирование отчетов и сохранение их в файлы.

**Вызывает исключения**: # если есть исключения

*   `FileNotFoundError`: Если не удается найти необходимые файлы конфигурации или данных.
*   `Exception`: В случае возникновения ошибок при создании отчетов или других операциях.

**Примеры**: # Все возможные варианты примеров вызова функции с разными параметрами

Пример вызова функции `main`:

```python
main()
```