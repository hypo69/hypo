# Модуль `test_utils`

## Обзор

Этот модуль содержит тесты для функций `name_or_empty`, `extract_json` и `repeat_on_error` из модуля `tinytroupe.utils`.

## Функции

### `test_extract_json`

**Описание**: Тестирует функцию `extract_json`, проверяя её работу с различными входными данными, включая корректный JSON, JSON массив, экранированные символы, невалидный JSON и отсутствие JSON.

**Тестируемые случаи**:

- **Корректный JSON**: Функция должна корректно извлекать JSON объект из строки.
- **JSON массив**: Функция должна корректно извлекать JSON массив из строки.
- **Экранированные символы**: Функция должна корректно обрабатывать экранированные символы в JSON.
- **Невалидный JSON**: Функция должна возвращать пустой словарь при получении невалидного JSON.
- **Отсутствие JSON**: Функция должна возвращать пустой словарь при отсутствии JSON в строке.

**Параметры**:

- `text` (str): Строка, содержащая потенциальный JSON.

**Возвращает**:

- `dict | list`: Извлеченный JSON объект или JSON массив, либо пустой словарь, если JSON не найден или невалиден.


### `test_name_or_empty`

**Описание**: Тестирует функцию `name_or_empty`, проверяя её работу с различными входными данными, включая именованные объекты и `None`.

**Тестируемые случаи**:

- **Именованный объект**: Функция должна возвращать имя объекта, если он существует.
- **None**: Функция должна возвращать пустую строку, если входной параметр равен `None`.

**Параметры**:

- `entity`: Объект, имя которого может быть извлечено, или `None`.

**Возвращает**:

- `str`: Имя объекта или пустая строка.


### `test_repeat_on_error`

**Описание**: Тестирует функцию `repeat_on_error`, проверяя её работу с различными сценариями, включая повторные попытки с исключениями, успешное выполнение без исключений и исключения, не входящие в список.

**Тестируемые случаи**:

- **Исключение с повторными попытками**: Функция должна повторять вызов функции, если указанное исключение возникает, до достижения максимального количества попыток, после чего должна поднять исключение.
- **Успешное выполнение без исключений**: Функция должна выполнить функцию один раз, если она выполняется без исключений.
- **Исключение, не входящее в список**: Функция должна поднять указанное исключение, если возникает исключение, не входящее в список обработанных исключений.

**Параметры**:

- `retries` (int): Максимальное количество попыток.
- `exceptions` (list): Список исключений, которые следует перехватывать и обрабатывать.

**Вызывает исключения**:

- `DummyException`: Исключения, перехватываемые при повторном выполнении.
- `RuntimeError`:  Исключение, которое не должно быть обработано.

**Возвращает**:

-  Функция не имеет прямого возвращаемого значения.


## Модули

- `tinytroupe.utils`
- `testing_utils` (в импорте)

## Замечания

- В тестах используются `MagicMock` для имитации поведения функции `dummy_function`.
- Модуль `testing_utils` (возможно) содержит вспомогательные функции для тестирования.
- Используется декоратор `@repeat_on_error`, что означает, что тестируемая функция будет вызвана несколько раз, если произойдет указанное исключение.
- Тесты проверяют корректную работу функций с различными входными данными и сценариями.