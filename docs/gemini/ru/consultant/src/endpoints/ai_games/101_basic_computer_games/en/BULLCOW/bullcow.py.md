# Анализ кода модуля `bullcow.py`

**Качество кода: 7/10**
-   **Плюсы**
    -   Код хорошо структурирован и легко читается.
    -   Логика игры "Быки и коровы" реализована корректно.
    -   Используются понятные имена переменных.
    -   Присутствуют комментарии, описывающие основные шаги алгоритма.
    -   Обработка ошибок ввода пользователя реализована с помощью `try-except`.
    -   В начале файла приведено описание игры, алгоритма и блок-схема.

-   **Минусы**
    -   Не все комментарии соответствуют стандарту reStructuredText (RST).
    -   Отсутствуют docstring для функций и модуля.
    -   Используется стандартный `input`, вместо обертки с `try-except` для логирования.
    -   Не используется логгер для ошибок.
    -   Присутствует рекурсивный вызов функции `generate_target_number`, что может привести к ошибке переполнения стека.
    -   Избыточное использование комментариев, которые дублируют логику кода.

**Рекомендации по улучшению**

1.  **Документация**:
    -   Добавить docstring в формате RST для модуля и функции `generate_target_number`.
    -   Переписать комментарии в формате RST.
2.  **Логирование**:
    -   Использовать `from src.logger.logger import logger` для логирования ошибок.
    -   Заменить `print` на `logger.error` в блоке `try-except` и проверке на корректность введенного числа.
    -   Убрать лишние блоки `try-except`, которые можно заменить на логирование.
3.  **Генерация числа**:
    -   Изменить рекурсивный вызов функции `generate_target_number` на цикл для избежания `RecursionError`.
4.  **Форматирование**:
    -   Соблюдать PEP8 в форматировании кода.
    -   Убрать избыточные комментарии, которые дублируют логику кода.
5.  **Улучшения**:
    -   Добавить проверку на уникальность цифр во вводе пользователя.

**Оптимизированный код**

```python
"""
Модуль для реализации игры "Быки и коровы".
=========================================================================================

Этот модуль содержит функции для генерации случайного 4-значного числа с неповторяющимися цифрами
и игровой цикл для игры "Быки и коровы".

Пример использования
--------------------

.. code-block:: python

    from src.endpoints.ai_games.101_basic_computer_games.en.BULLCOW import bullcow

    bullcow.play()
"""
import random
from src.logger.logger import logger  #  Импортируем логгер


def generate_target_number() -> int:
    """
    Генерирует случайное 4-значное число с неповторяющимися цифрами.

    :return: Случайное 4-значное число.
    :rtype: int
    """
    while True:
        digits = list(range(10))
        random.shuffle(digits)
        if digits[0] != 0:
            target = digits[0] * 1000 + digits[1] * 100 + digits[2] * 10 + digits[3]
            return target


def play():
    """
     Запускает игровой процесс "Быки и коровы".
    """
    target_number = generate_target_number()  # Генерируем загаданное число
    number_of_guesses = 0  # Инициализируем счетчик попыток

    while True:  # Основной игровой цикл
        number_of_guesses += 1  # Увеличиваем количество попыток
        try:
            user_guess = int(input("Введите 4-значное число: "))  # Запрашиваем ввод числа у пользователя
        except ValueError as ex:
            logger.error("Некорректный ввод. Пожалуйста, введите целое 4-значное число.", exc_info=ex)
            continue

        if not (1000 <= user_guess <= 9999):  # Проверяем что число 4-х значное
            logger.error("Некорректный ввод. Пожалуйста, введите 4-значное число.")
            continue

        bulls = 0  # Инициализация счетчика быков
        cows = 0  # Инициализация счетчика коров

        target_str = str(target_number)  # Преобразуем загаданное число в строку
        guess_str = str(user_guess)  # Преобразуем ввод пользователя в строку

        for i in range(4):  # Проходим по каждой цифре
            if guess_str[i] == target_str[i]:  # Если цифры на одной и той же позиции совпадают, это "бык"
                bulls += 1
            elif guess_str[i] in target_str:  # Если цифра есть в загаданном числе, но не на той же позиции, это "корова"
                cows += 1

        print(f"{bulls} быков, {cows} коров")  # Вывод количества быков и коров

        if bulls == 4:  # Проверка на победу
            print(f"ПОЗДРАВЛЯЮ! Вы угадали число за {number_of_guesses} попыток!")
            break  # Завершение игры при выигрыше


if __name__ == "__main__":
    play()
```