# Анализ кода модуля `cursor_spinner`

**Качество кода:**
   - **Соответствие стандартам**: 7
   - **Плюсы**:
     - Простой и понятный код для создания спиннера.
     - Использование генератора для спиннера.
     - Хорошая документация в формате docstring для функций.
   - **Минусы**:
     - Не хватает использования `logger` для обработки ошибок или каких-либо логирующих сообщений.
     - Отсутствует общий docstring для модуля, который бы описывал его предназначение в целом.
     - Использование двойных кавычек для строк.
     - Отсутствуют импорты из src.
     - Некоторые комментарии можно сделать более информативными.

**Рекомендации по улучшению:**

-   Добавьте общий docstring для модуля, описывающий его предназначение.
-   Используйте одинарные кавычки для строк в коде, а двойные кавычки только для вывода.
-   Удалите неиспользуемые директивы, такие как `#! venv/bin/python/python3.12`.
-   Добавьте `from src.logger import logger` для возможности логирования ошибок, даже если в данном коде это не нужно, для соблюдения общей практики проекта.
-   Комментарии внутри функций должны быть более информативными, указывая, что именно делается (например, "получаем" лучше заменить на "вызываем", "отображаем" и т.д.).
-   Следуйте стандарту PEP8 для форматирования (например, добавьте пустые строки между функциями).
-   Добавьте аннотации типов для параметров функций.
-   Документируйте функции в формате RST.

**Оптимизированный код:**
```python
# -*- coding: utf-8 -*-
"""
Модуль для отображения спиннера в консоли.
========================================

Этот модуль предоставляет утилиту для отображения спиннера (вращающегося курсора) в консоли,
для имитации процесса загрузки или ожидания.

Пример использования
--------------------
.. code-block:: python

   from src.utils.cursor_spinner import show_spinner

   print("Spinner for 3 seconds:")
   show_spinner(duration=3.0, delay=0.2)
   print("\\nDone!")

"""

import time
import sys

from src.logger import logger #  импорт логгера

def spinning_cursor() -> str:
    """
    Генератор для спиннера, который циклически проходит через символы |, /, -, \\.
    
    :yield: str: Следующий символ в последовательности курсора.

    :Example:
        >>> cursor = spinning_cursor()
        >>> next(cursor)
        '|'
        >>> next(cursor)
        '/'
        >>> next(cursor)
        '-'
        >>> next(cursor)
        '\\'
    """
    while True:
        for cursor in '|/-\\|': # Используем одинарные кавычки
            yield cursor


def show_spinner(duration: float = 5.0, delay: float = 0.1) -> None:
    """
    Отображает спиннер в консоли в течение заданного времени.

    :param duration:  Продолжительность работы спиннера в секундах. По умолчанию 5.0.
    :type duration: float
    :param delay: Задержка между каждой сменой символа спиннера в секундах. По умолчанию 0.1.
    :type delay: float
    :raises Exception:  В случае ошибки во время работы спиннера.
    
    :Example:
        >>> show_spinner(duration=3.0, delay=0.2)  # Отображает спиннер в течение 3 секунд
    """
    spinner = spinning_cursor()
    end_time = time.time() + duration

    while time.time() < end_time:
        try:
            sys.stdout.write(next(spinner))   # Выводим следующий символ спиннера
            sys.stdout.flush()                # Немедленно отправляем вывод в консоль
            time.sleep(delay)                 # Делаем паузу на заданное время
            sys.stdout.write('\b')            # Возвращаемся назад для перезаписи символа
        except Exception as e:
            logger.error(f"An error occurred while displaying the spinner: {e}") # Логируем ошибку
            break # выход из цикла если ошибка


if __name__ == "__main__":
    # Пример использования спиннера в скрипте
    print("Spinner for 5 seconds:") # Используем двойные кавычки для вывода
    show_spinner(duration=5.0, delay=0.1)
    print("\nDone!") # Используем двойные кавычки для вывода
```