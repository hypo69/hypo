# Модуль V50

## Обзор

Модуль `V50` предоставляет класс `V50`, который является устаревшим провайдером для взаимодействия с моделью GPT-3.5 Turbo через API `p5.v50.ltd`. Модуль предназначен для создания завершений (completions) на основе предоставленных сообщений, имитируя диалоговый интерфейс.

## Подробней

Данный модуль является частью устаревшего функционала и может быть неактуальным для использования в новых проектах. Он содержит реализацию для взаимодействия с определенным API, который может измениться или стать недоступным. Модуль отправляет запросы к API `p5.v50.ltd` для получения ответов модели на основе предоставленных сообщений.

## Классы

### `V50`

**Описание**: Класс `V50` предоставляет интерфейс для взаимодействия с API `p5.v50.ltd`. Он наследуется от `AbstractProvider` и реализует метод для создания завершений на основе входных данных.

**Наследует**:

- `AbstractProvider`: Абстрактный базовый класс для провайдеров.

**Атрибуты**:

- `url` (str): URL-адрес API `p5.v50.ltd`.
- `supports_gpt_35_turbo` (bool): Указывает, что провайдер поддерживает модель GPT-3.5 Turbo.
- `supports_stream` (bool): Указывает, что провайдер не поддерживает потоковую передачу данных.
- `needs_auth` (bool): Указывает, что провайдер не требует аутентификации.
- `working` (bool): Указывает, что провайдер находится в рабочем состоянии (но в коде он всегда `False`).

**Методы**:

- `create_completion()`: Статический метод для создания запроса к API и получения ответа.

## Функции

### `create_completion`

```python
    @staticmethod
    def create_completion(
        model: str,
        messages: list[dict[str, str]],
        stream: bool, **kwargs: Any) -> CreateResult:
        ...
```

**Назначение**: Метод `create_completion` создает запрос к API `p5.v50.ltd` и возвращает результат. Он формирует полезную нагрузку (payload) с учетом предоставленных сообщений и параметров, отправляет POST-запрос и возвращает ответ от API.

**Параметры**:

- `model` (str): Идентификатор используемой модели.
- `messages` (list[dict[str, str]]) : Список сообщений для отправки в API. Каждое сообщение представляет собой словарь, содержащий роли и контент.
- `stream` (bool): Указывает, использовать ли потоковую передачу данных (в данном случае всегда `False`).
- `**kwargs` (Any): Дополнительные аргументы, такие как температура, `top_p` и прокси.

**Возвращает**:

- `CreateResult`: Результат создания завершения.

**Как работает функция**:

1. **Формирование запроса**: Метод принимает список сообщений, объединяет их в строку, формируя запрос в формате "role: content". К запросу добавляется префикс "assistant: ".
2. **Создание полезной нагрузки (payload)**: Формируется словарь `payload`, содержащий запрос, параметры модели, температуру, `top_p` и уникальный идентификатор пользователя.
3. **Установка заголовков**: Определяются заголовки HTTP-запроса, включая `Content-Type`, `User-Agent` и другие необходимые параметры.
4. **Отправка POST-запроса**: Отправляется POST-запрос к API `p5.v50.ltd/api/chat-process` с использованием библиотеки `requests`.
5. **Обработка ответа**: Если ответ содержит подстроку "https://fk1.v50.ltd", результат возвращается с помощью `yield`.

**ASCII flowchart**:

```
A [Формирование запроса из сообщений]
|
B [Создание payload с параметрами]
|
C [Установка заголовков HTTP-запроса]
|
D [Отправка POST-запроса к API]
|
E [Проверка наличия "https://fk1.v50.ltd" в ответе]
|
F [Возврат результата через yield]
```

**Примеры**:

Пример 1:

```python
model = "gpt-3.5-turbo"
messages = [{"role": "user", "content": "Hello, how are you?"}]
stream = False
kwargs = {}
result = V50.create_completion(model, messages, stream, **kwargs)
for item in result:
    print(item)
```

Пример 2:

```python
model = "gpt-3.5-turbo"
messages = [{"role": "user", "content": "Translate 'hello' to Spanish"}]
stream = False
kwargs = {"temperature": 0.7, "top_p": 0.9}
result = V50.create_completion(model, messages, stream, **kwargs)
for item in result:
    print(item)