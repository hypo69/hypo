# Модуль для взаимодействия с Mishalsgpt

## Обзор

Модуль предоставляет интерфейс для взаимодействия с сервисом Mishalsgpt через его API. Он включает функцию для создания запросов на completion и обработки ответов, полученных от модели gpt-3.5-turbo.

## Подробней

Этот модуль позволяет отправлять запросы к Mishalsgpt для генерации текста на основе предоставленных сообщений. Он поддерживает потоковую передачу ответов и предназначен для использования с моделями gpt-3.5-turbo-16k-0613 и gpt-3.5-turbo. Модуль не требует аутентификации.

## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, stream: bool, **kwargs):
    """Создает запрос к Mishalsgpt для генерации текста на основе предоставленных сообщений.

    Args:
        model (str): Идентификатор модели для использования.
        messages (list): Список сообщений, которые будут переданы в модель.
        stream (bool): Флаг, указывающий, следует ли использовать потоковую передачу.
        **kwargs: Дополнительные параметры, которые будут переданы в запрос.

    Returns:
        Generator[str, None, None]: Генератор, возвращающий части сгенерированного текста.

    Raises:
        requests.exceptions.RequestException: Если происходит ошибка при отправке запроса.

    Примеры:
        >>> model_id = 'gpt-3.5-turbo'
        >>> messages_list = [{'role': 'user', 'content': 'Hello, how are you?'}]
        >>> stream_enabled = True
        >>> completion = _create_completion(model_id, messages_list, stream_enabled)
        >>> for part in completion:
        ...     print(part)
    """
```

**Назначение**: Создает запрос к Mishalsgpt для генерации текста на основе предоставленных сообщений.

**Параметры**:
- `model` (str): Идентификатор модели для использования.
- `messages` (list): Список сообщений, которые будут переданы в модель.
- `stream` (bool): Флаг, указывающий, следует ли использовать потоковую передачу.
- `**kwargs`: Дополнительные параметры, которые будут переданы в запрос.

**Возвращает**:
- `Generator[str, None, None]`: Генератор, возвращающий части сгенерированного текста.

**Вызывает исключения**:
- `requests.exceptions.RequestException`: Если происходит ошибка при отправке запроса.

**Как работает функция**:

1.  **Подготовка заголовков**: Функция начинает с подготовки заголовков HTTP-запроса, указывая, что содержимое запроса будет в формате JSON.
2.  **Подготовка данных**:  Далее формируются данные запроса, включая модель, температуру (степень случайности) и список сообщений.
3.  **Отправка запроса**:  Отправляется POST-запрос к API Mishalsgpt с указанными заголовками и данными. Используется потоковый режим для получения ответа частями.
4.  **Обработка ответа**:  Функция извлекает содержимое ответа из JSON-структуры и возвращает его в виде генератора.

```
Подготовка заголовков и данных запроса
↓
Отправка POST-запроса к API Mishalsgpt
↓
Получение потокового ответа
↓
Извлечение содержимого ответа из JSON
↓
Возврат содержимого в виде генератора
```

**Примеры**:

```python
model_id = 'gpt-3.5-turbo'
messages_list = [{'role': 'user', 'content': 'Hello, how are you?'}]
stream_enabled = True
completion = _create_completion(model_id, messages_list, stream_enabled)
for part in completion:
    print(part)