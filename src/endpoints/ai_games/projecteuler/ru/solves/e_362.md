## Ответ на Задачу No 362: Квадратные делители

### 1. Анализ задачи и решение

**Понимание задачи:**

*   Нам нужно найти количество целых чисел `m` от 1 до `n` (в нашем случае n = 10^15), таких что количество делителей `m` (обозначается как `d(m)`) является квадратом целого числа.

*   Ключевой момент:  Количество делителей числа `m` является квадратом тогда и только тогда, когда все показатели степеней в разложении `m` на простые множители четны.

    Например:
    *   `12 = 2^2 * 3^1`. Количество делителей `d(12) = (2+1) * (1+1) = 6`, которое не является квадратом.
    *   `36 = 2^2 * 3^2`. Количество делителей `d(36) = (2+1) * (2+1) = 9`, которое является квадратом.
    *   `16 = 2^4`. Количество делителей `d(16) = (4+1) = 5`, которое не является квадратом.
    *   `81 = 3^4`. Количество делителей `d(81) = (4+1) = 5`, которое не является квадратом.
    *    `25 = 5^2`. Количество делителей `d(25) = (2+1) = 3`, которое не является квадратом.

    На самом деле, если число `m` - точный квадрат, то количество его делителей не обязательно квадрат. Но, если количество его делителей является квадратом, то само число `m` должно быть полным квадратом, то есть все показатели степеней его простых множителей должны быть четными.

*   Следовательно, число `m` должно быть полным квадратом, и когда мы берем квадратный корень из него, это число  должно быть числом, у которого все показатели степеней его простых множителей не больше 1.

*   Поэтому, задача сводится к поиску числа `k` такого что `k*k <= n`, где `k` это число, у которого в разложении на простые числа все показатели степеней не больше 1. То есть `k` свободно от квадратов.
*  Нам нужно подсчитать количество `k`, таких что `k*k <= n`. Для этого нам нужно вычислить корень из n, то есть `sqrt(n)`. Затем, нам нужно найти количество чисел свободных от квадратов в диапазоне `[1, sqrt(n)]`.

**Решение:**

1.  **Вычисление верхней границы:** Найдем квадратный корень из `n` (10^15). Обозначим это значение как `limit`.

2.  **Подсчет чисел, свободных от квадратов:** Будем перебирать числа от 1 до `limit` и проверять, свободно ли число от квадратов.
3.  **Проверка на "свободность от квадратов":** число свободно от квадратов, если не делится на квадрат простого числа. Мы можем это сделать с помощью решета Эратосфена и модификации, которая помечает числа, делящиеся на квадрат простых.
4. **Подсчет результата:** Количество чисел, которые свободны от квадратов и чьи квадраты меньше `n`  - это наш результат.

### 2. Алгоритм решения

1.  Начать.
2.  Вычислить `limit = floor(sqrt(n))` где `n = 10^15`.
3.  Инициализировать `count = 0`.
4.  Создать массив `is_square_free` размером `limit + 1`, заполненный `True`.
5.  Для каждого простого числа `p`, такого что `p*p <= limit`:
    *   Для каждого числа `k`, которое кратно `p*p`  и не больше `limit`
        *   Присвоить `is_square_free[k] = False`
6.  Для каждого числа `i` от 1 до `limit`:
    *   Если `is_square_free[i]` равно `True`, увеличить `count` на 1.
7.  Вернуть `count`.
8.  Конец.

### 3. Реализация на Python 3.12
```python
import math

def count_square_divisor_numbers(n):
    """
    Counts the number of integers m such that 1 <= m <= n and d(m) is a square.

    Args:
        n: The upper bound.

    Returns:
        The count of such numbers.
    """

    limit = int(math.sqrt(n))
    is_square_free = [True] * (limit + 1)
    
    for p in range(2, int(math.sqrt(limit)) + 1):
        if is_square_free[p]:
            for k in range(p * p, limit + 1, p * p):
                is_square_free[k] = False
    
    count = 0
    for i in range(1, limit + 1):
        if is_square_free[i]:
            count += 1
    return count

# Example usage
n = 10**15
result = count_square_divisor_numbers(n)
print(result)
```

### 4. Блок-схема в формате mermaid
```mermaid
flowchart TD
    Start((Начало)) --> CalculateLimit((Вычислить limit = floor(sqrt(n))))
    CalculateLimit --> InitializeCount((Инициализировать count = 0))
    InitializeCount --> CreateSquareFreeArray((Создать is_square_free[limit+1] = True))
    CreateSquareFreeArray --> LoopPrimesStart((Начать цикл по простым p, пока p*p <= limit))
    LoopPrimesStart --> CheckSquareFree((Проверить is_square_free[p] == True?))
    CheckSquareFree -- Да --> LoopMultiplesStart((Начать цикл по k, кратным p*p, пока k <= limit))
    LoopMultiplesStart --> MarkNotSquareFree((is_square_free[k] = False))
    MarkNotSquareFree --> LoopMultiplesEnd((Конец цикла по k))
    LoopMultiplesEnd --> LoopPrimesEnd((Конец цикла по простым p))

    CheckSquareFree -- Нет --> LoopPrimesEnd
    LoopPrimesEnd --> LoopCheckSquareFreeStart((Начать цикл i от 1 до limit))
    LoopCheckSquareFreeStart --> CheckIsSquareFree((Проверить is_square_free[i] == True?))
    CheckIsSquareFree -- Да --> IncrementCount((count = count + 1))
    IncrementCount --> LoopCheckSquareFreeEnd((Конец цикла i от 1 до limit))
     CheckIsSquareFree -- Нет --> LoopCheckSquareFreeEnd
    LoopCheckSquareFreeEnd --> ReturnCount((Вернуть count))
    ReturnCount --> End((Конец))
```

**Легенда:**

*   **Начало, Конец:** Начало и конец алгоритма.
*   **Вычислить limit:** Вычисляет квадратный корень из n и сохраняет в переменную `limit`.
*   **Инициализировать count:** Инициализирует переменную `count` нулем.
*   **Создать is\_square\_free:** Создает массив `is_square_free` и заполняет его значениями `True` .
*    **Начать цикл по простым p:** Начало внешнего цикла перебора простых чисел до квадратного корня `limit`.
*  **Проверить is\_square\_free[p]:** Проверяем, является ли текущее число p  свободным от квадратов
*   **Начать цикл по k:** Начало внутреннего цикла для вычеркивания чисел, кратных квадрату простого числа `p`.
*   **is\_square\_free\[k] = False:** Помечает число k как не свободное от квадратов.
*  **Конец цикла по k:** Завершение внутреннего цикла
*  **Конец цикла по простым p:** Завершение внешнего цикла
*   **Начать цикл i от 1 до limit:** Начало цикла перебора чисел от 1 до `limit`.
*   **Проверить is\_square\_free\[i]:** Проверяет, является ли текущее число `i` свободным от квадратов.
*   **count = count + 1:** Увеличивает счетчик, если число i свободно от квадратов.
*   **Конец цикла i от 1 до limit:** Завершение цикла.
*   **Вернуть count:** Возвращает результат.
