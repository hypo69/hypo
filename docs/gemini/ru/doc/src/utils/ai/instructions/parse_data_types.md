# Модуль parse_data_types

## Обзор

Этот модуль предоставляет функции для анализа различных типов входных данных (JSON, CSV, XLS, объекты Python) и преобразования их в структурированный формат, удобный для создания PDF-документов. Модуль содержит функции для определения типа данных, извлечения данных и форматирования их для использования в PDF-шаблонах.


## Функции

### `detect_data_type`

**Описание**: Определяет тип входных данных.

**Параметры**:
- `data` (object): Входные данные.

**Возвращает**:
- `str`: Тип входных данных (JSON, CSV, XLS или Python object).


**Вызывает исключения**:
- `TypeError`: Если тип входных данных не распознан.


### `parse_json_data`

**Описание**: Парсит JSON-данные и возвращает структурированное представление.

**Параметры**:
- `data` (str): JSON-строка.

**Возвращает**:
- `dict`: Структурированные данные, готовые для использования в PDF.

**Вызывает исключения**:
- `JSONDecodeError`: Если входные данные не являются валидным JSON.


### `parse_csv_data`

**Описание**: Парсит CSV-данные и возвращает структурированное представление.

**Параметры**:
- `data` (str): CSV-строка.
- `delimiter` (str, optional): Разделитель столбцов. По умолчанию `,`.

**Возвращает**:
- `list[list]`: Список списков, где каждый внутренний список представляет строку CSV-данных.


**Вызывает исключения**:
- `ValueError`: Если входные данные не являются валидным CSV.


### `parse_xls_data`

**Описание**: Парсит XLS-данные и возвращает структурированное представление.

**Параметры**:
- `data` (object): Объект с данными XLS.

**Возвращает**:
- `dict`: Структурированные данные, готовые для использования в PDF.

**Вызывает исключения**:
- `TypeError`: Если `data` не является допустимым объектом, содержащим данные XLS.
- `ValueError`: Если данные XLS не могут быть проанализированы.


### `format_data_for_pdf`

**Описание**: Форматирует данные для создания PDF-документа.

**Параметры**:
- `data` (object): Данные, полученные из одной из вышеперечисленных функций.
- `data_type` (str): Тип входных данных (JSON, CSV, XLS или Python object).

**Возвращает**:
- `dict`: Форматированные данные, включая заголовки, таблицы и списки, необходимые для создания PDF-документа.

**Вызывает исключения**:
- `TypeError`: Если тип данных не соответствует ожидаемому.
- `ValueError`: Если входные данные содержат некорректные значения для выбранного формата.


## Примеры

В данном модуле приведены примеры использования функций для анализа JSON- и CSV- данных.


```python
# Пример использования функции detect_data_type
input_data = '{"name": "John", "age": 30}'
data_type = detect_data_type(input_data)
print(data_type)  # Вывод: JSON

# Пример использования функции parse_json_data
input_data = '{"name": "John", "age": 30}'
parsed_data = parse_json_data(input_data)
print(parsed_data)  # Вывод: {'name': 'John', 'age': 30}
```

```
```
```
```
```


```
```
```

```
```
```
```
```

```
```
```


```
```
```

```
```
```

```
```

```

```
```
```
```

```
```


```


```
```

```
```

```
```
```

```
```
```


```
```


```
```

```

```
```
```

```
```
```


```