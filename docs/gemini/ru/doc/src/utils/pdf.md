# Модуль hypotez/src/utils/pdf

## Обзор

Модуль `pdf` предназначен для преобразования HTML-контента или файлов в PDF-формат, используя различные библиотеки (pdfkit, FPDF, WeasyPrint, xhtml2pdf).  Он включает в себя функции для работы с различными библиотеками, а также поиск корневой директории проекта.

## Функции

### `set_project_root`

**Описание**: Находит корневую директорию проекта, начиная от директории текущего файла, поднимаясь вверх по дереву директорий и останавливаясь на первой директории, содержащей указанные файлы-маркеры (например, `pyproject.toml`, `requirements.txt`, `.git`).

**Параметры**:

- `marker_files` (tuple, опционально): кортеж строк, представляющих имена файлов или директорий, используемых для определения корневой директории проекта. По умолчанию `('pyproject.toml', 'requirements.txt', '.git')`.

**Возвращает**:

- `Path`: путь к корневой директории проекта, если она найдена. В противном случае возвращает путь к текущей директории.

**Примечания**:  Добавляет корневую директорию в `sys.path`, если она еще не присутствует.


### `PDFUtils.save_pdf_pdfkit`

**Описание**: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `pdfkit`.

**Параметры**:

- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:

- bool: `True`, если PDF успешно сохранен, иначе `False`.

**Возможные исключения**:

- `pdfkit.PDFKitError`: Ошибка генерации PDF через `pdfkit`.
- `OSError`: Ошибка доступа к файлу.
- `Exception`: Любая другая непредвиденная ошибка.

**Примечания**: Использование конфигурации `pdfkit.configuration` с путем к `wkhtmltopdf.exe` для корректного выполнения.


### `PDFUtils.save_pdf_fpdf`

**Описание**: Сохраняет текст в PDF с использованием библиотеки FPDF.

**Параметры**:

- `data` (str): Текст, который необходимо сохранить в PDF.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:

- bool: `True`, если PDF успешно сохранен, иначе `False`.

**Возможные исключения**:

- `Exception`: Любая другая непредвиденная ошибка, включая `FileNotFoundError` при отсутствии файлов шрифтов.

**Примечания**:  Метод устанавливает шрифты из `fonts.json` для корректного отображения текста. Проверяет существование файла `fonts.json` и соответствующих шрифтов.


### `PDFUtils.save_pdf_weasyprint`

**Описание**: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `WeasyPrint`.

**Параметры**:

- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:

- bool: `True`, если PDF успешно сохранен, иначе `False`.

**Возможные исключения**:

- `Exception`: Любая другая непредвиденная ошибка.


### `PDFUtils.save_pdf_xhtml2pdf`

**Описание**: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `xhtml2pdf`.

**Параметры**:

- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:

- bool: `True`, если PDF успешно сохранен, иначе `False`.

**Возможные исключения**:

- `Exception`: Любая другая непредвиденная ошибка, включая `UnicodeDecodeError` (если файл не в UTF-8) и ошибки при работе с файлами.

**Примечания**:  Принимает на вход как строку, так и путь к файлу с HTML кодом. Проверка кодировки на UTF-8 перед обработкой. Обработка ошибок `UnicodeDecodeError` и `Exception`.

## Переменные

### `MODE`

Строковая переменная, вероятно, определяющая режим работы модуля.

### `__root__`

Переменная, хранящая путь к корневой директории проекта. (Тип: `Path`)


##  Замечания


В модуле есть логирование ошибок и информации с использованием `logger` из модуля `src.logger`.  В блоках обработки исключений (`except`) используется `...` для пропуска действий.  Это потенциально небезопасно и может потребовать изменения.