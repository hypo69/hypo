# Модуль `hypotez/src/gui/context_menu/tkinter/main.py`

## Обзор

Модуль `hypotez/src/gui/context_menu/tkinter/main.py` предоставляет графический интерфейс (GUI) для управления контекстным меню в Windows Explorer. Он позволяет пользователю добавлять и удалять пользовательский пункт меню, который запускает заданный Python скрипт при нажатии правой кнопкой мыши на пустом месте рабочего стола или папки.

## Функции

### `add_context_menu_item()`

**Описание**: Добавляет пользовательский пункт меню в контекстное меню рабочего стола и папок. Создает запись в реестре Windows, чтобы добавить пункт меню "hypo AI assistant" в контекстное меню, который запускает Python скрипт при нажатии.

**Описание параметров**:

* Нет параметров.


**Возвращает**:

*  Не возвращает значение.


**Возможные исключения**:

* `FileNotFoundError`: Исключение возникает, если файл скрипта, указанный в пути, не найден. В этом случае выводится диалоговое окно с сообщением об ошибке.
* `Exception`:  Возникает при любых других ошибках при работе с реестром.  В этом случае выводится диалоговое окно с сообщением об ошибке.

### `remove_context_menu_item()`

**Описание**: Удаляет пользовательский пункт меню "hypo AI assistant" из контекстного меню.

**Описание параметров**:

* Нет параметров.

**Возвращает**:

* Не возвращает значение.

**Возможные исключения**:

* `FileNotFoundError`: Исключение возникает, если пункт меню не найден в реестре. В этом случае выводится диалоговое окно с предупреждением.
* `Exception`: Возникает при любых других ошибках при работе с реестром. В этом случае выводится диалоговое окно с сообщением об ошибке.


### `create_gui()`

**Описание**: Создает графический интерфейс пользователя (GUI) для управления контекстным меню.

**Описание параметров**:

* Нет параметров.

**Возвращает**:

* Не возвращает значение.

**Возможные исключения**:

*  Не предусматривает исключений.


## Модульные импорты

* `winreg` (alias `reg`): Модуль для взаимодействия с реестром Windows.
* `os`: Модуль для работы с операционной системой, в том числе для проверки существования файлов.
* `tkinter`: Модуль для создания GUI.
* `messagebox`: Подмодуль `tkinter` для создания диалоговых окон.
* `header`:  Предполагаемый модуль, вероятно, для инициализации настроек или констант.
* `gs`: Предполагаемый модуль, вероятно, для управления путями или структурой проекта.

##  Обработка исключений

В обоих функциях `add_context_menu_item` и `remove_context_menu_item` реализована обработка исключений (`try...except`).  Это важно для устойчивости программы.  Исключение `ex` или `e` обрабатываются, а пользователю выводится информативное сообщение об ошибке.

## Структура путей в реестре

Подробное описание путей в реестре Windows, используемых для добавления и удаления контекстного меню, приведено в документации функций `add_context_menu_item` и `remove_context_menu_item`.


```