# Анализ кода модуля e_219.md

**Качество кода**

- Соответствие требованиям по оформлению кода: 8/10
    - Плюсы:
        - Комментарии присутствуют.
        - Структура файла соответствует заданию.
    - Минусы:
        - Отсутствует reStructuredText (RST) оформление комментариев.
        - Не используются `j_loads` или `j_loads_ns`.
        - Не используется `from src.logger.logger import logger` для логирования.
        - Нет явного кода Python для анализа.

**Рекомендации по улучшению**

1.  **Форматирование комментариев:** Все комментарии должны быть переписаны в формате reStructuredText (RST).
2.  **Использование `j_loads`:**  Если бы были данные в формате JSON, нужно было бы использовать `j_loads` или `j_loads_ns` из `src.utils.jjson`.
3.  **Логирование ошибок:** Добавить `from src.logger.logger import logger` и использовать `logger.error` для обработки ошибок.
4. **Документация**: Добавить полное описание задачи и условий в формате RST, включая примеры и входные/выходные данные.
5. **Реализация**: Реализовать код, который решает задачу.

**Оптимизированный код**

```markdown
"""
Задача 219: Скорость набора текста
=====================================

Рассматривается клавиатура с клавишами '0' и '1'. Нажатие '0' занимает 2 единицы времени, а '1' - 3 единицы времени.
Нужно вычислить среднее время набора для n бинарных чисел, а затем сумму этих средних времен для n от 1 до заданного числа.

Описание
--------

Пусть A(n) - среднее время набора для n бинарных чисел.
S(n) = Σ A(k) для k = 1..n.

Примеры:
    A(1) = 2.5
    A(2) = 5
    A(3) = 10.25
    S(5) = 44.125

Задача:
    Найти S(10^7) с точностью до 8 знаков после запятой.

"""

# Задача No 219
## Скорость набора текста
## Условия

# Рассмотрим клавиатуру, которая имеет только клавиши '0' и '1'. Когда пользователь печатает на этой клавиатуре, нажатие клавиши '0' занимает 2 единицы времени, а нажатие клавиши '1' занимает 3 единицы времени. Пользователь может печатать любое бинарное число.

# Для того, чтобы напечатать `n` бинарных чисел, пользователь может выбирать из `2^n` возможных последовательностей нулей и единиц.
# Например, если `n` = 2, то есть 4 возможных последовательности: 00, 01, 10 и 11. Общее время набора этих последовательностей: 2 + 2 + 2 + 3 + 2 + 3 + 3 + 3 = 20. Среднее время набора в этом случае равно 20/4 = 5.

# Обозначим среднее время набора для `n` бинарных чисел как `A(n)`.
# Дано, что `A(1) = 2.5`, `A(2) = 5`, `A(3) = 10.25`.

# Обозначим `S(n) = Σ A(k)` для `k = 1..n`.
# Дано, что `S(5) = 353/8 = 44.125`.

# Найдите `S(10^7)`. Дайте ответ в виде десятичного числа с 8 знаками после запятой.


def calculate_average_time(n: int) -> float:
    """
    Вычисляет среднее время набора для n бинарных чисел.

    :param n: Количество бинарных чисел.
    :return: Среднее время набора.
    """
    total_time = 0
    # Код вычисляет общее время для всех комбинаций n бинарных чисел
    for i in range(1 << n):
        time = 0
        temp = i
        # Цикл проходит по битам числа и рассчитывает время набора
        while temp > 0:
            bit = temp & 1
            if bit == 0:
                time += 2
            else:
                time += 3
            temp >>= 1
        total_time += time
    # Среднее время набора вычисляется как общее время, делённое на количество комбинаций
    average_time = total_time / (1 << n)
    return average_time


def calculate_sum_of_average_times(n: int) -> float:
    """
    Вычисляет сумму средних времен набора для k от 1 до n.

    :param n: Верхняя граница для суммы.
    :return: Сумма средних времен.
    """
    total_sum = 0.0
    # Код вычисляет сумму среднего времени для n чисел, начиная с 1
    for k in range(1, n + 1):
        total_sum += calculate_average_time(k)
    return total_sum


if __name__ == "__main__":
    # Задаётся n для расчета S(n)
    n = 10**7
    # Код вычисляет сумму средних времен для n=10^7
    result = calculate_sum_of_average_times(n)
    # Вывод результата с 8 знаками после запятой
    print(f"{result:.8f}")
```