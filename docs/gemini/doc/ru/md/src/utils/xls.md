# Модуль `hypotez/src/utils/xls.py`

## Обзор

Модуль `xls.py` предоставляет функции для конвертации файлов Excel (`xls`) в JSON и обратно, обработки нескольких листов и сохранения JSON данных обратно в файлы Excel (`xls`).  Модуль предоставляет средства для обработки потенциальных ошибок во время работы с файлами.

## Функции

### `read_xls_as_dict`

**Описание**: Читает файл Excel и преобразует его в JSON.  Опционально, преобразует определенный лист и сохраняет результат в файл JSON. Обрабатывает ошибки.

**Параметры**:

- `xls_file` (str): Путь к файлу Excel.
- `json_file` (str, optional): Путь к файлу JSON для сохранения результатов. По умолчанию `None`.
- `sheet_name` (Union[str, int], optional): Имя или индекс листа для обработки. По умолчанию `None` (обрабатываются все листы).

**Возвращает**:

- Union[Dict, List[Dict], bool]: Если преобразование прошло успешно, возвращает словарь, где ключами являются имена листов, а значениями - списки словарей, представляющие строки. В случае ошибки возвращает `False`.

**Возможные исключения**:

- `FileNotFoundError`: Возникает, если файл Excel не найден.
- `Exception`: Возникает при любых других ошибках во время работы с файлом Excel или сохранением JSON.  Подробности ошибки выводятся в лог.


### `save_xls_file`

**Описание**: Сохраняет данные JSON в файл Excel. Обрабатывает ошибки.

**Параметры**:

- `data` (Dict[str, List[Dict]]): Словарь, где ключи - имена листов, а значения - списки словарей, представляющие строки данных для каждого листа.
- `file_path` (str): Путь к файлу Excel для сохранения.

**Возвращает**:

- bool: `True`, если сохранение прошло успешно, `False` - в случае ошибки.

**Возможные исключения**:

- `Exception`: Возникает при любых ошибках во время сохранения в файл Excel.  Подробности ошибки выводятся в лог.


## Логирование

Модуль использует `logging` для регистрации операций и ошибок.  Уровень логов по умолчанию - `INFO`.  Подробности ошибок выводятся в консоль.