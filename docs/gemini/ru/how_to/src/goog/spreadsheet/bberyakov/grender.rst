Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `GSRender`, предназначенный для форматирования и рендеринга Google таблиц.  Он предоставляет методы для создания заголовков таблиц, применения форматирования к ячейкам, слияния ячеек, задания направления текста, добавления строк и получения номера первой пустой строки.  Код использует библиотеку gspread для взаимодействия с Google Таблицами.

Шаги выполнения
-------------------------
1. **Импортирование библиотек:** Код импортирует необходимые библиотеки, такие как `gspread`, `spread_formatting`, `goog.helpers` и другие для работы с Google Таблицами и форматированием.

2. **Определение класса `GSRender`:** Создается класс `GSRender`, содержащий методы для управления таблицей.

3. **Метод `render_header`:** Этот метод форматирует заголовок таблицы, задавая цвет фона, выравнивание, шрифт и размер.  Он принимает в качестве аргументов worksheet (`ws`), заголовок таблицы (`world_title`), диапазон ячеек (`range`) и тип слияния (`merge_type`).  Метод `format_cell_range` применяет форматирование к указанному диапазону ячеек, а `merge_range` сливает ячейки в соответствии с типом слияния.

4. **Метод `merge_range`:** Этот метод сливает ячейки в Google Таблице.  Принимает на вход worksheet (`ws`), диапазон ячеек (`range`) и тип слияния (`merge_type`).

5. **Метод `set_worksheet_direction`:**  Метод изменяет направление текста в таблице на право-налево (rtl). Принимает на вход spreadsheet (`sh`), worksheet (`ws`) и направление (`direction`).

6. **Метод `header`:**  Метод добавляет строку заголовка в таблицу, принимает worksheet (`ws`), заголовок (`ws_header`) и необязательный номер строки (`row`).

7. **Метод `write_category_title`:**  Метод добавляет строку с категорией в таблицу, аналогично `header`.


8. **Метод `get_first_empty_row`:**  Метод находит первую пустую строку в таблице, учитывая указанную колонку.  Возвращает номер строки.  Важно, что он возвращает номер _следующей_ пустой строки (т.е. номер строки, _за_ последней заполненной).

Пример использования
-------------------------
.. code-block:: python

    from gspread_formatting import Color, TextFormat, BooleanRule, BooleanCondition, GridRange, ConditionalFormatRule
    from goog.spreadsheet.bberyakov.grender import GSRender
    from spread import Spreadsheet, Worksheet

    # Предполагается, что вы уже имеете подключение к Google Таблице через gspread
    spreadsheet = Spreadsheet(...)  # Подключение к книге
    worksheet = spreadsheet.worksheet('Название листа') # Доступ к листу

    # Создайте экземпляр класса GSRender
    renderer = GSRender()

    # Добавьте заголовок
    renderer.header(worksheet, 'Мой заголовок', 1)  # В первой строке

    # Примените форматирование к заголовку
    # ...


    #  (Оставленный комментарий из кода: ...)
    #  Предположим, что ws - это полученное gspread.Worksheet
    #  И вы хотите добавить заголовок "Имя продукта" в строке 2.