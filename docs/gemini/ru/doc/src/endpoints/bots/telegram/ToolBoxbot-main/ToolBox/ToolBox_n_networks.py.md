# Модуль для работы с нейронными сетями
========================================

Модуль содержит класс `neural_networks`, который предоставляет методы для взаимодействия с различными нейронными сетями, такими как FLUX.1-schnell, Mistral Large 2407 и Free GPT-4o mini.

## Обзор

Этот модуль предоставляет класс `neural_networks`, который включает методы для генерации изображений на основе текстовых запросов и для получения ответов от чат-ботов, использующих различные модели. Он использует внешние API для взаимодействия с этими моделями и требует наличия соответствующих токенов доступа.

## Подробнее

Этот код предназначен для облегчения взаимодействия с различными нейронными сетями, предоставляя унифицированный интерфейс для выполнения задач генерации изображений и обработки текста. Он может быть использован в различных приложениях, таких как автоматическое создание контента, чат-боты и другие.

## Классы

### `neural_networks`

**Описание**: Класс для взаимодействия с нейронными сетями.

**Как работает класс**:
Класс `neural_networks` содержит методы для отправки запросов к различным API нейронных сетей и обработки ответов. Он использует библиотеки `requests`, `json`, `os`, `io` и `PIL` для выполнения HTTP-запросов, обработки JSON-ответов, работы с переменными окружения, работы с потоками ввода-вывода и обработки изображений соответственно.

## Функции

### `_FLUX_schnell`

```python
def _FLUX_schnell(self, prompt: str, size: list[int, int], seed: int, num_inference_steps: int) -> str | None:
    """
    Отправляет запрос к API FLUX.1-schnell для генерации изображения на основе текстового запроса.

    Args:
        prompt (str): Текстовый запрос для генерации изображения.
        size (list[int, int]): Размеры изображения (ширина, высота).
        seed (int): Зерно для генерации случайных чисел.
        num_inference_steps (int): Количество шагов для генерации изображения.

    Returns:
        str | None: Объект `Image` с сгенерированным изображением или `None`, если не удалось получить изображение.

    Raises:
        Exception: Если возникает ошибка при отправке запроса или обработке ответа.

    Example:
        >>> nn = neural_networks()
        >>> image = nn._FLUX_schnell("A cat", [512, 512], 12345, 50)
        >>> if image:
        ...     image.save("cat.png")
    """
```

**Как работает функция**:
Функция `_FLUX_schnell` отправляет POST-запрос к API FLUX.1-schnell с заданным текстовым запросом, размерами изображения, зерном и количеством шагов для генерации изображения. Она пытается отправить запрос несколько раз, используя разные токены доступа из переменных окружения, пока не получит успешный ответ (status_code 200). Если запрос успешен, функция открывает изображение из полученного содержимого и возвращает его. Если ни один из запросов не удался, функция возвращает `None`.

**Параметры**:
- `prompt` (str): Текстовый запрос для генерации изображения.
- `size` (list[int, int]): Размеры изображения (ширина, высота).
- `seed` (int): Зерно для генерации случайных чисел.
- `num_inference_steps` (int): Количество шагов для генерации изображения.

**Возвращает**:
- `str | None`: Объект `Image` с сгенерированным изображением или `None`, если не удалось получить изображение.

**Вызывает исключения**:
- Отсутствуют явные исключения, но функция может вернуть `None` в случае ошибки.

### `__mistral_large_2407`

```python
def __mistral_large_2407(self, prompt: list[dict[str, str]]) -> tuple[str, int, int] | str:
    """
    Отправляет запрос к API Mistral Large 2407 для получения ответа на текстовый запрос.

    Args:
        prompt (list[dict[str, str]]): Список сообщений для чат-бота.

    Returns:
        tuple[str, int, int] | str: Кортеж, содержащий ответ, количество токенов в запросе и количество токенов в ответе,
                                    или строка с ошибкой, если запрос не удался.

    Raises:
        Exception: Если возникает ошибка при отправке запроса или обработке ответа.

    Example:
        >>> nn = neural_networks()
        >>> prompt = [{"role": "user", "content": "Hello, how are you?"}]
        >>> response, prompt_tokens, completion_tokens = nn.__mistral_large_2407(prompt)
        >>> print(response)
        >>> print(f"Prompt tokens: {prompt_tokens}, Completion tokens: {completion_tokens}")
    """
```

**Как работает функция**:
Функция `__mistral_large_2407` отправляет POST-запрос к API Mistral AI с заданным списком сообщений для чат-бота. Она преобразует ответ JSON в словарь и возвращает сообщение ответа, количество токенов в запросе и количество токенов в ответе. В случае ошибки возвращает строку с описанием ошибки.

**Параметры**:
- `prompt` (list[dict[str, str]]): Список сообщений для чат-бота.

**Возвращает**:
- `tuple[str, int, int] | str`: Кортеж, содержащий ответ, количество токенов в запросе и количество токенов в ответе,
                                    или строка с ошибкой, если запрос не удался.

**Вызывает исключения**:
- Отсутствуют явные исключения, но функция может вернуть строку с ошибкой в случае неудачи.

### `_free_gpt_4o_mini`

```python
def _free_gpt_4o_mini(self, prompt: list[dict[str, str]]) -> tuple[str, int, int] | str:
    """
    Отправляет запрос к API Free GPT-4o mini для получения ответа на текстовый запрос.

    Args:
        prompt (list[dict[str, str]]): Список сообщений для чат-бота.

    Returns:
        tuple[str, int, int] | str: Кортеж, содержащий ответ, количество токенов в запросе и количество токенов в ответе,
                                    или результат вызова `__mistral_large_2407`, если не удалось получить ответ от GPT-4o mini.

    Raises:
        Exception: Если возникает ошибка при отправке запроса или обработке ответа.

    Example:
        >>> nn = neural_networks()
        >>> prompt = [{"role": "user", "content": "Tell me a joke."}]
        >>> response, prompt_tokens, completion_tokens = nn._free_gpt_4o_mini(prompt)
        >>> print(response)
        >>> print(f"Prompt tokens: {prompt_tokens}, Completion tokens: {completion_tokens}")
    """
```

**Как работает функция**:
Функция `_free_gpt_4o_mini` отправляет POST-запрос к API Free GPT-4o mini с заданным списком сообщений для чат-бота. Она пытается отправить запрос несколько раз, используя разные токены доступа из переменных окружения, пока не получит успешный ответ (status_code 200). Если запрос успешен, функция преобразует ответ JSON в словарь и возвращает сообщение ответа, количество токенов в запросе и количество токенов в ответе. Если ни один из запросов не удался, функция вызывает `__mistral_large_2407` и возвращает результат этого вызова.

**Параметры**:
- `prompt` (list[dict[str, str]]): Список сообщений для чат-бота.

**Возвращает**:
- `tuple[str, int, int] | str`: Кортеж, содержащий ответ, количество токенов в запросе и количество токенов в ответе,
                                    или результат вызова `__mistral_large_2407`, если не удалось получить ответ от GPT-4o mini.

**Вызывает исключения**:
- Отсутствуют явные исключения, но функция может вызвать `__mistral_large_2407`, который также может вернуть строку с ошибкой.