# Модуль `src.scenario`

## Обзор

Модуль `src.scenario` предназначен для автоматизации взаимодействия с поставщиками, используя сценарии, описанные в JSON-файлах.  Он адаптирует процесс извлечения и обработки данных о продуктах с веб-сайтов поставщиков и синхронизирует эту информацию с базой данных (например, PrestaShop).

## Основные функции

* **Чтение сценариев:** Загрузка сценариев из JSON-файлов, содержащих информацию о продуктах и URL-адресах на сайтах поставщиков.
* **Взаимодействие с веб-сайтами:** Переход по URL-адресам, извлечение данных о продуктах.
* **Обработка данных:** Преобразование извлеченных данных в нужный формат и сохранение в базе данных.
* **Запись журнала выполнения:** Ведение журнала, содержащего детали выполнения сценариев и результаты работы.

## Основные компоненты

### `run_scenario_files(scenario_files_list)`

**Описание**: Принимает список файлов сценариев и выполняет их по очереди, используя функцию `run_scenario_file` для обработки каждого файла.

**Параметры**:
* `scenario_files_list` (list): Список путей к файлам сценариев.

**Возвращает**:
* `None`

### `run_scenario_file(scenario_file)`

**Описание**: Загружает сценарии из указанного файла и вызывает `run_scenario` для каждого сценария в файле.

**Параметры**:
* `scenario_file` (str): Путь к файлу сценария.

**Возвращает**:
* `None`

### `run_scenario(scenario)`

**Описание**: Обрабатывает отдельный сценарий. Переходит по URL, указанному в сценарии, извлекает данные о продуктах, сохраняет извлеченные данные в базе данных.

**Параметры**:
* `scenario` (dict): Словарь, содержащий данные сценария.

**Возвращает**:
* `None`

### `dump_journal(journal)`

**Описание**: Сохраняет журнал выполнения сценариев в файл для последующего анализа.

**Параметры**:
* `journal` (list): Список данных для сохранения в журнале.

**Возвращает**:
* `None`

### `main()`

**Описание**: Основная функция для запуска модуля.

**Возвращает**:
* `None`


## Пример сценария (JSON)

```json
{
    "scenarios": {
        "минерал+לחויותלפניםמינרליםותמציותצמחים": {
            "url": "https://hbdeadsea.co.il/product-category/facial/moisture-face/",
            "name": "минерал+לחויותלפניםמינרליםותמציותצמחים",
            "presta_categories": {
                "default_category": 11245,
                "additional_categories": [11288]
            }
        }
    }
}
```


## Обработка исключений

В коде модуля должны быть реализованы блоки `try...ex...` для обработки возможных исключений (например, при работе с файлами, API, базами данных).


## Как это работает

1. **Загрузка сценариев:** Модуль загружает сценарии из файлов и анализирует их.
2. **Извлечение данных:** Переходит по URL из сценария, извлекает ссылки на продукты и собирает информацию о них.
3. **Сохранение данных:** Обрабатывает и сохраняет собранные данные в базу данных, используя информацию о категориях из сценария.
4. **Отчеты и журналирование:** Ведет журнал выполнения сценариев, чтобы отслеживать процесс и фиксировать ошибки.


Этот модуль автоматизирует сбор и обработку данных о продуктах, упрощая интеграцию с различными поставщиками и системами управления товарами.