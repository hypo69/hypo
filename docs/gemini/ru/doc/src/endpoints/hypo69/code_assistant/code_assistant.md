# Модуль `hypotez/src/endpoints/hypo69/code_assistant/assistant.py`

## Обзор

Данный модуль предоставляет класс `CodeAssistant` для работы ассистента программиста с моделями ИИ (в частности, Gemini). Ассистент читает файлы кода, обрабатывает их с помощью выбранных моделей, а затем сохраняет результаты обработки в директории `docs/gemini`. Модуль также включает механизм для обработки командной строки и загрузки конфигурации.

## Классы

### `CodeAssistant`

**Описание**: Класс `CodeAssistant` предназначен для взаимодействия с моделями ИИ для обработки файлов кода и создания документации.

**Атрибуты**:

- `role` (str): Роль ассистента (например, `doc_writer_rst`).
- `lang` (str): Язык обработки (например, `ru`).
- `start_dirs` (Path | str | list[Path] | list[str]): Список директорий для обработки файлов. По умолчанию `[".."]`.
- `base_path` (Path): Базовая директория, используемая для работы.
- `config` (SimpleNamespace): Объект конфигурации, загруженный из файла `code_assistant.json`.
- `gemini_model` (GoogleGenerativeAI): Объект модели Gemini.
- `openai_model` (OpenAIModel): Объект модели OpenAI.
- `start_file_number` (int): Номер файла, с которого начинается обработка.

**Методы**:

#### `__init__(self, **kwargs)`

**Описание**: Инициализирует ассистент с заданными параметрами.

**Параметры**:
- `**kwargs`: Словарь параметров.
  - `role` (str): Роль ассистента (по умолчанию `doc_writer_rst`).
  - `lang` (str): Язык обработки (по умолчанию `EN`).
  - `model` (List[str]): Список используемых моделей (по умолчанию `["gemini"]`).
  - `start_dirs` (List[str]): Список директорий для обработки.
  
**Вызывает исключения**:
- Нет.

#### `_initialize_models(self, **kwargs)`

**Описание**: Инициализирует модели ИИ на основе заданных параметров.

**Параметры**:
- `**kwargs`: Словарь параметров.

**Вызывает исключения**:
- Нет.

#### `parse_args(self)`

**Описание**: Разбирает аргументы командной строки.

**Параметры**:
- Нет.

**Возвращает**:
- Словарь аргументов командной строки.

**Вызывает исключения**:
- Нет.

#### `system_instruction(self)`

**Описание**: Читает инструкцию из файла.

**Параметры**:
- Нет.

**Возвращает**:
- Строка с инструкцией или `False` при ошибке.

**Вызывает исключения**:
- `Exception`: При ошибке чтения файла.

#### `code_instruction(self)`

**Описание**: Читает инструкцию для обработки кода.

**Параметры**:
- Нет.

**Возвращает**:
- Строка с инструкцией или пустая строка при ошибке.

**Вызывает исключения**:
- `Exception`: При ошибке чтения файла.

#### `translations(self)`

**Описание**: Загружает переводы для ролей и языков.

**Параметры**:
- Нет.

**Возвращает**:
- Объект `SimpleNamespace` с переводами.

**Вызывает исключения**:
- Нет.

#### `process_files(self, start_file_number: Optional[int] = 1)`

**Описание**: Обрабатывает файлы, отправляет запросы в модели ИИ и сохраняет результаты.

**Параметры**:
- `start_file_number` (int): Номер файла, с которого начинается обработка (по умолчанию 1).

**Вызывает исключения**:
- `Exception`: При ошибке обработки файла или отправки запроса.


#### `_create_request(self, file_path: str, content: str) -> str`

**Описание**: Создание запроса к модели ИИ с учетом роли, языка и пути к файлу.

**Параметры**:
- `file_path` (str): Путь к файлу.
- `content` (str): Содержимое файла.

**Возвращает**:
- Строка с запросом.

**Вызывает исключения**:
- `Exception`: При ошибке создания запроса.


#### `_yield_files_content(self, start_dirs: List[Path] = [gs.path.src])`

**Описание**: Генерирует пути файлов и их содержимое из заданных директорий.

**Параметры**:
- `start_dirs` (List[Path]): Список директорий для обхода (по умолчанию `[gs.path.src]`).

**Возвращает**:
- Итератор кортежей (путь к файлу, содержимое).

**Вызывает исключения**:
- `Exception`: При ошибке чтения файла.


#### `_save_response(self, file_path: Path, response: str, model_name: str) -> None`

**Описание**: Сохраняет ответ модели в файл в указанной директории.

**Параметры**:
- `file_path` (Path): Исходный путь к файлу.
- `response` (str): Ответ модели.
- `model_name` (str): Имя модели.


**Вызывает исключения**:
- `OSError`: Если не удаётся создать директорию или записать в файл.
- `Exception`: При любых других ошибках.


#### `_remove_outer_quotes(self, response: str) -> str`

**Описание**: Удаляет внешние кавычки в строке.

**Параметры**:
- `response` (str): Строка для обработки.

**Возвращает**:
- Обработанную строку.

**Вызывает исключения**:
- `Exception`: При любой ошибке.


#### `run(self, start_file_number: int = 1)`

**Описание**: Запускает процесс обработки файлов.

**Параметры**:
- `start_file_number` (int): Номер файла для старта.


#### `_signal_handler(self, signal, frame)`

**Описание**: Обработка прерывания выполнения.


## Функции

### `main()`

**Описание**: Основная функция для запуска ассистента.

**Параметры**:
- Нет.

**Вызывает исключения**:
- Нет.