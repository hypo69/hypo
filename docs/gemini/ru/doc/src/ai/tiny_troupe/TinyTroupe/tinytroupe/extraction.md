# Модуль extraction

## Обзор

Этот модуль предоставляет инструменты для извлечения структурированных данных из элементов TinyTroupe, таких как агенты и миры. Он позволяет сокращать извлеченные данные до более компактной формы и экспортировать артефакты из элементов TinyTroupe. Модуль демонстрирует разницу между агентами-симуляциями и AI-помощниками, так как последние не предназначены для интроспекции таким образом.

## Классы

### `ResultsExtractor`

**Описание**: Класс для извлечения результатов из агентов и миров. Кэширует результаты извлечения для каждого типа извлечения.

**Методы**

* `extract_results_from_agent`
* `extract_results_from_world`
* `save_as_json`

#### `extract_results_from_agent`

**Описание**: Извлекает результаты из объекта `TinyPerson`.

**Параметры**

* `tinyperson` (TinyPerson): Экземпляр `TinyPerson`, для которого нужно извлечь результаты.
* `extraction_objective` (str): Цель извлечения.
* `situation` (str): Ситуация, которую нужно учитывать.
* `fields` (list, optional): Список полей для извлечения. Если `None`, извлекаются все поля по умолчанию.
* `verbose` (bool, optional):  Флаг для вывода отладочных сообщений. По умолчанию `False`.

**Возвращает**

* `dict | None`: Извлеченные результаты в виде словаря или `None`, если произошла ошибка.

**Вызывает исключения**

* `None`


#### `extract_results_from_world`

**Описание**: Извлекает результаты из объекта `TinyWorld`.

**Параметры**

* `tinyworld` (TinyWorld): Экземпляр `TinyWorld`, для которого нужно извлечь результаты.
* `extraction_objective` (str): Цель извлечения.
* `situation` (str): Ситуация, которую нужно учитывать.
* `fields` (list, optional): Список полей для извлечения. Если `None`, извлекаются все поля по умолчанию.
* `verbose` (bool, optional): Флаг для вывода отладочных сообщений. По умолчанию `False`.

**Возвращает**

* `dict | None`: Извлеченные результаты в виде словаря или `None`, если произошла ошибка.

**Вызывает исключения**

* `None`



#### `save_as_json`

**Описание**: Сохраняет результаты извлечения в файл JSON.

**Параметры**

* `filename` (str): Имя файла для сохранения.
* `verbose` (bool, optional): Флаг для вывода отладочных сообщений. По умолчанию `False`.

**Возвращает**

* `None`

**Вызывает исключения**

* `None`


### `ResultsReducer`

**Описание**: Класс для уменьшения размера результата извлечения.

**Методы**

* `add_reduction_rule`
* `reduce_agent`
* `reduce_agent_to_dataframe`

#### `add_reduction_rule`

**Описание**: Добавляет правило для сокращения.

**Параметры**

* `trigger` (str): Триггер для правила.
* `func` (callable): Функция, выполняющая сокращение.

**Возвращает**

* `None`

**Вызывает исключения**

* `Exception`: Если правило с таким триггером уже существует.



#### `reduce_agent`

**Описание**: Применяет правила сокращения к истории агента.

**Параметры**

* `agent` (TinyPerson): Объект агента.

**Возвращает**

* `list`: Список сокращенных результатов.


#### `reduce_agent_to_dataframe`

**Описание**: Преобразует результат сокращения в DataFrame Pandas.

**Параметры**

* `agent` (TinyPerson): Объект агента.
* `column_names` (list, optional): Имена столбцов DataFrame.


**Возвращает**

* `pd.DataFrame`: DataFrame с сокращенными данными.


### `ArtifactExporter`

**Описание**: Класс для экспорта артефактов из элементов TinyTroupe.

**Методы**

* `export`

#### `export`

**Описание**: Экспортирует артефакт в файл.

**Параметры**

* `artifact_name` (str): Имя артефакта.
* `artifact_data` (Union[dict, str]): Данные артефакта (словарь или строка).
* `content_type` (str): Тип содержимого.
* `content_format` (str, optional): Формат содержимого (e.g., md, csv). По умолчанию `None`.
* `target_format` (str): Целевой формат экспорта.
* `verbose` (bool, optional): Флаг для вывода отладочных сообщений. По умолчанию `False`.

**Возвращает**

* `None`

**Вызывает исключения**

* `ValueError`: Если формат не поддерживается.


### `Normalizer`

**Описание**: Класс для нормализации текстовых элементов.

**Методы**

* `__init__`
* `normalize`

#### `__init__`

**Описание**: Инициализирует нормализатор.

**Параметры**

* `elements` (list): Элементы для нормализации.
* `n` (int): Количество нормализованных элементов для вывода.
* `verbose` (bool, optional): Флаг для вывода отладочных сообщений. По умолчанию `False`.

**Возвращает**

* `None`

**Вызывает исключения**

* `None`



#### `normalize`

**Описание**: Нормализует указанный элемент или элементы.


**Параметры**

* `element_or_elements` (Union[str, List[str]]): Элемент или список элементов для нормализации.

**Возвращает**

* `str`: Нормализованный элемент, если вход был строкой.
* `list`: Нормализованные элементы, если вход был списком. Сохраняет порядок элементов.

**Вызывает исключения**

* `ValueError`: Если входной параметр не является строкой или списком.




## Функции

(Список функций, если они есть, с описанием каждого метода)