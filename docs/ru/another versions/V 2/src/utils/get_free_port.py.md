# Модуль `get_free_port`

## Обзор

Модуль `get_free_port` предназначен для поиска свободного сетевого порта. Он позволяет искать порты в заданном диапазоне или найти первый доступный порт, если диапазон не указан. Модуль предоставляет функциональность для проверки, является ли порт занятым, и обработки возможных ошибок при разборе диапазонов портов.

## Содержание

1.  [Функции](#Функции)
    *   [`get_free_port`](#get_free_port)
    *   [`_is_port_in_use`](#_is_port_in_use)
    *   [`_parse_port_range`](#_parse_port_range)
2.  [Пример использования](#Пример-использования)

## Функции

### `get_free_port`

**Описание**:
Находит и возвращает свободный порт в указанном диапазоне или первый доступный порт, если диапазон не задан.

**Параметры**:
- `host` (str): Адрес хоста для проверки доступных портов.
- `port_range` (Optional[str | List[str]], optional): Диапазон портов, заданный в виде строки "min-max" или списка строк. Например: "3000-3999", ["3000-3999", "8000-8010"], по умолчанию `None`.

**Возвращает**:
- `int`: Доступный номер порта.

**Вызывает исключения**:
- `ValueError`: Если не удается найти свободный порт в указанном диапазоне, или если диапазон портов недопустим.

### `_is_port_in_use`

**Описание**:
Проверяет, используется ли указанный порт на заданном хосте.

**Параметры**:
- `host` (str): Адрес хоста для проверки.
- `port` (int): Номер порта для проверки.

**Возвращает**:
- `bool`: `True`, если порт используется, в противном случае `False`.

### `_parse_port_range`

**Описание**:
Разбирает строку диапазона портов вида "min-max" в кортеж (min_port, max_port).

**Параметры**:
- `port_range_str` (str): Строка с диапазоном портов, например, "3000-3999".

**Возвращает**:
- `Tuple[int, int]`: Кортеж с минимальным и максимальным значениями порта.

**Вызывает исключения**:
- `ValueError`: Если формат строки диапазона портов недействителен или если минимальный порт больше или равен максимальному.

## Пример использования

```python
if __name__ == '__main__':
    host = 'localhost'

    # Пример с одним диапазоном:
    try:
        port = get_free_port(host, '3000-3005')
        print(f'Свободный порт: {port}')
    except ValueError as ex:
        print(f'Ошибка: {ex}')

    # Пример со списком диапазонов:
    try:
        port = get_free_port(host, ['3000-3005', '8000-8005'])
        print(f'Свободный порт: {port}')
    except ValueError as ex:
        print(f'Ошибка: {ex}')

    # Пример без диапазона (первый свободный):
    try:
        port = get_free_port(host)
        print(f'Свободный порт: {port}')
    except ValueError as ex:
        print(f'Ошибка: {ex}')

    # Пример с некорректным форматом
    try:
        port = get_free_port(host, '3000-')
        print(f'Свободный порт: {port}')
    except ValueError as ex:
        print(f'Ошибка: {ex}')

    # Пример с некорректными портами
    try:
        port = get_free_port(host, '5000-4000')
        print(f'Свободный порт: {port}')
    except ValueError as ex:
        print(f'Ошибка: {ex}')
    try:
        port = get_free_port(host, [5000, 4000])
        print(f'Свободный порт: {port}')
    except ValueError as ex:
        print(f'Ошибка: {ex}')
```