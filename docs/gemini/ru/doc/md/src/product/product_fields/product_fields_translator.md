# Модуль product_fields_translator

## Обзор

Этот модуль отвечает за перевод полей товара на языки клиентской базы данных. Он обрабатывает входной словарь полей товара, полученный с сайта поставщика, и преобразует его в формат, совместимый с клиентской базой данных.  Модуль использует схему языков клиента для корректного сопоставления языков.

## Функции

### `rearrange_language_keys`

**Описание**: Функция обновляет идентификаторы языков в словаре `presta_fields_dict` на соответствующие идентификаторы из схемы языков клиента.

**Параметры**:

- `presta_fields_dict` (dict): Словарь полей товара.
- `client_langs_schema` (list | dict): Схема языков клиента.
- `page_lang` (str): Язык страницы.

**Возвращает**:

- `dict`: Обновленный словарь `presta_fields_dict`.

**Вызывает исключения**:
- Нет.


### `translate_presta_fields_dict`

**Описание**: Функция переводит мультиязычные поля товара в соответствии со схемой значений идентификаторов языка в базе данных клиента.  Получает на вход словарь полей, содержащий данные с сайта поставщика, и возвращает переведённый словарь. Если перевода в базе данных нет, то функция добавляет новый перевод в базу данных.

**Параметры**:

- `presta_fields_dict` (dict): Словарь полей товара, полученный с сайта поставщика.  Должен содержать структуру типа `{ 'reference': str, 'name': { 'language': [ { 'attrs': { 'id': str, 'value': str } } ] } }`
- `client_langs_schema` (list | dict): Схема языков клиента, содержащая информацию об идентификаторах языков.
- `page_lang` (str, optional): Язык страницы. Если не задан, функция пытается определить язык по тексту.

**Возвращает**:

- `dict`: Словарь переведённых полей товара.

**Вызывает исключения**:

- `ProductFieldException`: Возникает при ошибках в процессе обработки данных.


**Примечания**:

* Функция `translate_presta_fields_dict` использует данные из таблицы переводов для перевода полей.
* Функция `translate_presta_fields_dict`  обрабатывает случаи, когда перевода в таблице переводов нет, добавляя новые записи в базу данных.
* Обратите внимание на важность правильного формата входного словаря `presta_fields_dict`.
* Обработка исключений (`try...except`) обеспечивает устойчивость кода к возможным ошибкам.
* Необходимо обеспечить правильную работу с глобальной переменной `record`.