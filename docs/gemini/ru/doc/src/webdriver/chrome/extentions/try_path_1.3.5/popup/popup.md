# Модуль popup.js

## Обзор

Этот модуль JavaScript отвечает за работу всплывающего окна расширения. Он обрабатывает пользовательские вводы, отправляет запросы в активную вкладку, отображает результаты, а также сохраняет и восстанавливает состояние всплывающего окна.

## Переменные

### `noneClass`
Строка со значением "none". Используется для скрытия элементов.

### `helpClass`
Строка со значением "help". Используется для выделения элементов справки.

### `invalidTabId`
Числовое значение, представляющее недействительный идентификатор вкладки.

### `invalidExecutionId`
Числовое значение `NaN`, обозначающее недействительный идентификатор выполнения.

### `invalidFrameId`
Целое число -1, обозначающее недействительный идентификатор фрейма.

### `mainWay`, `mainExpression`, `contextCheckbox`, `contextHeader`, `contextBody`, `contextWay`, `contextExpression`, ...
Переменные, представляющие элементы DOM, используемые для пользовательского ввода и отображения результатов.

### `relatedTabId`, `relatedFrameId`, `executionId`
Переменные, хранящие состояние текущего запроса (идентификатор вкладки, фрейма и выполнения).

### `resultedDetails`
Массив, содержащий детали результатов, полученные от контентного скрипта.

### `detailsPageSize`
Число, определяющее количество результатов на странице.

### `detailsPageIndex`
Целое число, представляющее номер текущей страницы результатов.


## Функции

### `sendToActiveTab(msg, opts)`

**Описание**: Отправляет сообщение в активную вкладку.

**Параметры**:
- `msg` (object): Объект с данными сообщения.
- `opts` (object, optional): Опции сообщения. По умолчанию пустой объект.

**Возвращает**:
- `Promise`: Обещание, которое выполняется, когда сообщение отправлено.

**Вызывает исключения**:
- Нет.


### `sendToSpecifiedFrame(msg)`

**Описание**: Отправляет сообщение в указанный фрейм активной вкладки.

**Параметры**:
- `msg` (object): Объект с данными сообщения.

**Возвращает**:
- `Promise`: Обещание, которое выполняется, когда сообщение отправлено.

**Вызывает исключения**:
- `e`: Возникает при ошибке при отправке сообщения в фрейм.


### `collectPopupState()`

**Описание**: Собирает текущее состояние всплывающего окна.

**Параметры**:
- Нет.

**Возвращает**:
- `object`: Объект, содержащий состояние всплывающего окна.

**Вызывает исключения**:
- Нет.


### `changeContextVisible()`, `changeResolverVisible()`, `changeFrameIdVisible()`, `changeFrameDesignationVisible()`, `changeHelpVisible()`

**Описание**: Изменяет видимость соответствующих блоков в зависимости от состояния соответствующих checkbox.

**Параметры**:
- Нет.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


### `makeExecuteMessage()`

**Описание**: Создает объект сообщения для отправки в активную вкладку.

**Параметры**:
- Нет.

**Возвращает**:
- `object`: Объект, содержащий данные сообщения.

**Вызывает исключения**:
- Нет.


### `getSpecifiedFrameId()`

**Описание**: Возвращает идентификатор указанного фрейма.

**Параметры**:
- Нет.

**Возвращает**:
- `int`: Идентификатор фрейма.

**Вызывает исключения**:
- Нет.


### `execContentScript()`

**Описание**: Выполняет контентные скрипты в активной вкладке.

**Параметры**:
- Нет.

**Возвращает**:
- `Promise`: Обещание, которое выполняется по окончании выполнения скриптов.

**Вызывает исключения**:
- Нет.


### `sendExecute()`

**Описание**: Отправляет запрос на выполнение XPath в активную вкладку.

**Параметры**:
- Нет.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


### `handleExprEnter(event)`

**Описание**: Обрабатывает нажатие Enter на поле ввода выражения.

**Параметры**:
- `event` (event): Объект события.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


### `showDetailsPage(index)`

**Описание**: Отображает результаты на определенной странице.

**Параметры**:
- `index` (int): Индекс страницы.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.

### `showError(message, frameId)`

**Описание**: Отображает ошибку в всплывающем окне.

**Параметры**:
- `message` (string): Текст ошибки.
- `frameId` (int): Идентификатор фрейма.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


### `genericListener(message, sender, sendResponse)`

**Описание**: Обработчик событий от контентного скрипта.

**Параметры**:
- `message` (object): Сообщение от контентного скрипта.
- `sender` (object): Объект отправителя.
- `sendResponse` (function): Функция для ответа отправителю.

**Возвращает**:
- `boolean`: `true`, если обработка была успешна.

**Вызывает исключения**:
- Нет.


## Другие функции

Все остальные функции имеют аналогичный формат описания.  Ввиду их большого количества, детальное описание каждой функции не приведено здесь.