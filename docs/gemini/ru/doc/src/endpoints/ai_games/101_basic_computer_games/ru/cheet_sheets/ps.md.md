# Руководство по командам PowerShell

## Обзор

Этот документ представляет собой руководство по основным командам PowerShell, сгруппированным по функциональности для облегчения навигации и понимания. Он охватывает команды для работы с файлами и каталогами, процессами, службами, сетью, реестром и другими общими операциями.

## Оглавление

1.  [Основы навигации и работы с файлами и каталогами](#основы-навигации-и-работы-с-файлами-и-каталогами)
2.  [Управление процессами](#управление-процессами)
3.  [Управление службами](#управление-службами)
4.  [Работа с сетью](#работа-с-сетью)
5.  [Работа с реестром](#работа-с-реестром)
6.  [Прочее](#прочее)

## Основы навигации и работы с файлами и каталогами

### `Get-ChildItem` (или `gci`, `ls`, `dir`)

**Описание**: Получает список файлов и подкаталогов в указанном местоположении.

**Параметры**:
-   `-Path` (string, optional): Указывает путь к каталогу.
-   `-Include` (string, optional): Фильтрует по имени файла (с подстановочными знаками `*` и `?`).
-   `-Exclude` (string, optional): Исключает файлы по имени.
-   `-Recurse` (Switch, optional): Показывает файлы и папки во всех подкаталогах.
-   `-Force` (Switch, optional): Показать скрытые файлы.
-   `-File` (Switch, optional): Показать только файлы.
-   `-Directory` (Switch, optional): Показать только папки.

**Примеры**:
-   `Get-ChildItem`: Список файлов и папок в текущем каталоге.
-   `Get-ChildItem -Path C:\Users\User\Documents`: Список файлов и папок в `C:\Users\User\Documents`.
-   `Get-ChildItem -Include *.txt`: Список только текстовых файлов в текущем каталоге.
-   `Get-ChildItem -Path C:\ -Recurse -Directory`: Показать все каталоги на диске C.
-  `Get-ChildItem -Force`: Показать все файлы, включая скрытые.

### `Set-Location` (или `sl`, `cd`)

**Описание**: Меняет текущий каталог.

**Параметры**:
-   `[путь]` (string): Указывает путь к новому каталогу.

**Примеры**:
-   `Set-Location C:\Windows`: Перейти в каталог `C:\Windows`.
-   `Set-Location ..`: Перейти в родительский каталог.
- `Set-Location /` - Перейти в корень диска.

### `New-Item`

**Описание**: Создает новый файл или каталог.

**Параметры**:
-   `-Path` (string): Указывает путь, где будет создан новый элемент.
-   `-ItemType` (string): Тип создаваемого элемента (`file` или `directory`).
-   `-Name` (string): Имя нового элемента.
-   `-Value` (string, optional): Содержимое файла.

**Примеры**:
-   `New-Item -ItemType directory -Name NewFolder`: Создать папку `NewFolder`.
-   `New-Item -ItemType file -Name myfile.txt`: Создать пустой файл `myfile.txt`.
-   `New-Item -ItemType file -Name myfile.txt -Value "Hello, world!"`: Создать файл `myfile.txt` с содержимым.

### `Remove-Item` (или `rm`, `del`, `erase`)

**Описание**: Удаляет файлы и каталоги.

**Параметры**:
-   `[путь]` (string): Указывает путь к удаляемому файлу или каталогу.
-   `-Recurse` (Switch, optional): Удалить все подкаталоги.
-   `-Force` (Switch, optional): Принудительное удаление (в том числе файлов "только для чтения" и каталогов).
-  `-Confirm` (Switch, optional): Запросить подтверждения на каждое удаление.

**Примеры**:
-   `Remove-Item myfile.txt`: Удалить файл `myfile.txt`.
-   `Remove-Item -Path C:\Temp -Recurse -Force`: Удалить папку `C:\Temp` со всеми вложенными папками и файлами.

### `Copy-Item`

**Описание**: Копирует файлы и каталоги.

**Параметры**:
-   `[исходный_путь]` (string): Путь к файлу или каталогу, который нужно скопировать.
-   `[целевой_путь]` (string): Путь, куда нужно скопировать файл или каталог.
-   `-Recurse` (Switch, optional): Копировать все подкаталоги.
-   `-Force` (Switch, optional): Перезаписать существующие файлы без запроса.

**Примеры**:
-   `Copy-Item -Path myfile.txt -Destination mycopy.txt`: Скопировать файл `myfile.txt` в `mycopy.txt`.
-   `Copy-Item -Path C:\Source -Destination D:\Backup -Recurse`: Скопировать папку `C:\Source` со всеми подкаталогами в папку `D:\Backup`.

### `Move-Item`

**Описание**: Перемещает файлы и каталоги.

**Параметры**:
-   `[исходный_путь]` (string): Путь к файлу или каталогу, который нужно переместить.
-   `[целевой_путь]` (string): Путь, куда нужно переместить файл или каталог.
-  `-Force` (Switch, optional): Принудительно переместить и перезаписать.

**Примеры**:
-   `Move-Item -Path myfile.txt -Destination D:\Documents`: Переместить файл `myfile.txt` в папку `D:\Documents`.
-  `Move-Item -Path "C:\MyFolder" -Destination "D:\" -Force`: Переместить папку C:\MyFolder в D:\ принудительно, даже если там уже существует папка с таким именем.

### `Rename-Item`

**Описание**: Переименовывает файл или каталог.

**Параметры**:
-   `-Path` (string): Путь к файлу или каталогу, который нужно переименовать.
-   `-NewName` (string): Новое имя файла или каталога.

**Пример**:
-   `Rename-Item -Path myfile.txt -NewName newfile.txt`: Переименовать файл `myfile.txt` в `newfile.txt`.

### `Get-Content` (или `gc`)

**Описание**: Отображает или получает содержимое файла.

**Параметры**:
-   `[путь]` (string): Путь к файлу, содержимое которого нужно отобразить.

**Пример**:
-   `Get-Content myfile.txt`: Показать содержимое файла `myfile.txt`.

### `Set-Content`

**Описание**: Заменяет или создает содержимое файла.

**Параметры**:
-  `[путь]` (string): Путь к файлу.
-   `-Value` (string): Текст для записи в файл.

**Пример**:
-  `Set-Content myfile.txt "Новый текст"`: Заменить текст файла `myfile.txt`.

### `Add-Content`

**Описание**: Добавляет содержимое в конец файла.

**Параметры**:
-  `[путь]` (string): Путь к файлу.
-  `-Value` (string): Текст для добавления.

**Пример**:
- `Add-Content myfile.txt "Еще текст"`: Добавить текст в конец `myfile.txt`.

## Управление процессами

### `Get-Process` (или `gps`)

**Описание**: Получает список запущенных процессов.

**Параметры**:
-   `-Name` (string, optional): Фильтровать по имени процесса.
-   `-Id` (int, optional): Фильтровать по идентификатору процесса.
-    `-IncludeUserName` (Switch, optional): Вывести пользователя запустившего процесс.

**Примеры**:
-   `Get-Process`: Список всех запущенных процессов.
-   `Get-Process -Name notepad`: Список процессов с именем `notepad`.
-    `Get-Process -IncludeUserName`: Список всех запущенных процессов с пользователями.

### `Stop-Process`

**Описание**: Завершает процесс.

**Параметры**:
-  `-Id` (int, optional): Указать id процесса.
-   `-Name` (string, optional): Указать имя процесса.
-  `-Force` (Switch, optional): Принудительно завершить процесс.

**Примеры**:
-   `Stop-Process -Name notepad`: Завершить все процессы `notepad`.
-   `Stop-Process -Id 1234`: Завершить процесс с идентификатором 1234.
-    `Stop-Process -Name chrome -Force`: Принудительно завершить все процессы `chrome`.

## Управление службами

### `Get-Service`

**Описание**: Получает список служб.

**Параметры**:
- `-Name` (string, optional): Вывести только службы с указанным именем.
- `-DisplayName` (string, optional): Вывести только службы с указанным отображаемым именем.
-   `-Status` (string, optional): Фильтрует по статусу (Running, Stopped).

**Примеры**:
-   `Get-Service`: Список всех служб.
-   `Get-Service -Name Spooler`: Вывести службу Spooler.
-   `Get-Service -Status Running`: Показать запущенные службы.

### `Start-Service`

**Описание**: Запускает службу.

**Параметры**:
-   `[имя_службы]` (string): Имя службы, которую нужно запустить.

**Пример**:
-   `Start-Service Spooler`: Запустить службу Spooler.

### `Stop-Service`

**Описание**: Останавливает службу.

**Параметры**:
-   `[имя_службы]` (string): Имя службы, которую нужно остановить.
- `-Force` (Switch, optional): Остановить службу принудительно.

**Примеры**:
-   `Stop-Service Spooler`: Остановить службу Spooler.
-    `Stop-Service Spooler -Force`: Остановить службу Spooler принудительно.

### `Restart-Service`

**Описание**: Перезапускает службу.

**Параметры**:
-   `[имя_службы]` (string): Имя службы, которую нужно перезапустить.

**Пример**:
- `Restart-Service Spooler`: Перезапустить службу Spooler.

## Работа с сетью

### `Test-NetConnection`

**Описание**: Проверяет сетевое соединение.

**Параметры**:
-   `[имя_хоста_или_ip-адрес]` (string): Имя хоста или IP-адрес для проверки соединения.
-   `-Port` (int, optional): Номер порта.

**Примеры**:
-   `Test-NetConnection google.com`: Проверить соединение с `google.com`.
- `Test-NetConnection google.com -Port 80`: Проверить соединение с google.com на порту 80.

### `Get-NetIPConfiguration`

**Описание**: Получает конфигурацию сети.

**Пример**:
-   `Get-NetIPConfiguration`: Отобразить конфигурацию сети.

### `Resolve-DnsName`

**Описание**: Запрашивает информацию о DNS.

**Параметры**:
-   `[имя_хоста]` (string): Имя хоста для запроса DNS-информации.

**Пример**:
-   `Resolve-DnsName google.com`: Запросить DNS-информацию для `google.com`.

## Работа с реестром

### `Get-ItemProperty`

**Описание**: Получает значение свойства из реестра.

**Параметры**:
-   `-Path` (string): Путь в реестре.

**Пример**:
-   `Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion"`

### `Set-ItemProperty`

**Описание**: Устанавливает значение свойства в реестре.

**Параметры**:
-   `-Path` (string): Путь в реестре.
-   `-Name` (string): Имя свойства.
-   `-Value` (string): Значение свойства.

**Пример**:
-   `Set-ItemProperty -Path "HKCU:\Control Panel\Desktop" -Name Wallpaper -Value "C:\image.jpg"`

## Прочее

### `Clear-Host`

**Описание**: Очищает экран консоли.

**Синтаксис**: `Clear-Host`

### `Get-Date`

**Описание**: Получает текущую дату и время.

**Синтаксис**: `Get-Date`

### `Start-Process`

**Описание**: Запускает программу или открывает файл.

**Параметры**:
-   `[имя_программы_или_файла]` (string): Имя программы или файла для запуска.
-   `[опции]` (string, optional): Дополнительные опции.

**Примеры**:
-   `Start-Process notepad.exe`: Запустить Блокнот.
-   `Start-Process myfile.txt`: Открыть файл `myfile.txt` программой по умолчанию.
-  `Start-Process -FilePath "C:\Program Files\Google\Chrome\Application\chrome.exe" -ArgumentList "https://www.google.com"`: Открыть сайт в хроме.

### `Get-Help`

**Описание**: Показывает справку по команде.

**Параметры**:
-   `[имя_команды]` (string): Имя команды, по которой нужно получить справку.

**Пример**:
-   `Get-Help Get-Process`: Показать справку по команде `Get-Process`.

### `Exit`

**Описание**: Завершает сеанс PowerShell.

**Синтаксис**: `Exit`

### `Get-Variable`

**Описание**: Показывает текущие переменные.

**Синтаксис**: `Get-Variable`

### `Get-Alias`

**Описание**: Показывает алиасы команд.

**Синтаксис**: `Get-Alias`

### `Set-Alias`

**Описание**: Создает псевдоним для команды.

**Параметры**:
-   `[имя_псевдонима]` (string): Имя псевдонима.
-   `[имя_команды]` (string): Имя команды.

**Пример**:
-  `Set-Alias gci Get-ChildItem`

## Примечания

*   `PowerShell` команды (cmdlets) обычно имеют вид `Глагол-Существительное` (например, `Get-Process`, `Set-Location`).
*   `PowerShell` не чувствителен к регистру, поэтому ты можешь писать команды как `Get-ChildItem` или `get-childitem`.
*   `PowerShell` работает с объектами, поэтому ты можешь использовать оператор `|` для передачи вывода одной команды на ввод другой (например, `Get-Process | Sort-Object -Property CPU`).
*  Многие команды поддерживают использование wildcards (*) для работы с несколькими файлами (например `Get-ChildItem *.txt`).
*   Для работы с некоторыми командами требуются права администратора.