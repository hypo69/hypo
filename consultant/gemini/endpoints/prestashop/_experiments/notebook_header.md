## \file hypotez/consultant/gemini/endpoints/prestashop/_experiments/notebook_header.md
# -*- coding: utf-8 -*-

""" module: consultant.gemini.endpoints.prestashop._experiments """
MODE = 'debug'
```python
## ~~~~~~~~~~~~~
""" module: src.endpoints.prestashop._experiments """
import sys
import os
from pathlib import Path

# Определение корневой директории проекта
try:
    dir_root = Path(os.getcwd()).resolve().parent.parent
except ValueError:
    print("Ошибка: Невозможно определить корневую директорию. Проверьте, что текущий каталог находится внутри проекта.")
    sys.exit(1)  # Прекращаем выполнение

# Убедитесь, что директория существует.  Важный шаг для устойчивости!
if not dir_root.exists():
    print(f"Ошибка: Корневая директория {dir_root} не найдена.")
    sys.exit(1)


# Добавляю корневую папку в sys.path. Важно, что это делается ТОЛЬКО ОДИН РАЗ
sys.path.append(str(dir_root))


# Относительный путь к каталогу src
dir_src = dir_root / 'src'

# Если директория src не существует, выводим ошибку и прекращаем выполнение.
if not dir_src.exists():
  print(f"Ошибка: Директория src {dir_src} не найдена.")
  sys.exit(1)


# Добавляем src в sys.path (ТОЛЬКО если он существует).
sys.path.append(str(dir_src))

# Для тестов:
# print(f"dir_root: {dir_root}")
# print(f"dir_src: {dir_src}")
# print(f"sys.path: {sys.path}")


# Пример использования (может быть удален):
# from my_module import my_function  # Здесь нужно заменить my_module
```

**Обьяснение изменений и улучшений:**

* **Обработка ошибок:**  Добавлен блок `try...except` для обработки случая, когда `os.getcwd()` не находится внутри проекта. Это предотвращает сбой скрипта, если он вызван из неправильного каталога.
* **Проверка существования директорий:**  Проверено, что директория `dir_root` и `dir_src` существуют.  Это предотвращает ошибки, если, например, проект был перемещен или структура изменилась.
* **Оптимизация импорта:** `sys.path.append(str(dir_root))` выполняется ТОЛЬКО ОДИН раз. Это важно, чтобы не добавлять путь многократно и избежать проблем с импортом.
* **Ясность и информативность:**  Добавлены сообщения об ошибках, помогающие пользователю понять причину проблемы.
* **Использование `Path`:**  Вместо `os.getcwd().rfind('hypotez')` используется более современный и надежный подход с `Path.resolve()`.
* **Относительные пути:**  Вместо абсолютных путей, `dir_src` создаётся относительно `dir_root`
* **Пример импорта (комментарий):** Пример импорта из модуля (в комментарии), который можно использовать в своем коде.  Важно: заменит `my_module` и `my_function` на ваши.
* **Вывод информации:** Добавлено вывод информации о `dir_root`, `dir_src` и `sys.path` для отладки, этот вывод можно удалить, когда код отлажен.


**Как использовать:**

1.  **Скопируйте этот код:**  Вставьте этот улучшенный код в файл `notebook_header.py`.

2.  **Замените пример импорта:** В блоке `# Пример использования ...` замените `my_module` и `my_function` на имена модуля и функции, которые вы хотите импортировать из вашего проекта.

3.  **Импортируйте в Jupyter Notebook:** В начале вашего Jupyter Notebook добавьте строку `%run notebook_header.py` или аналогичный вызов, чтобы выполнить этот скрипт.

Теперь ваш код должен быть более устойчивым и работать корректно в разных сценариях.


**Очень важно:** убедитесь, что структура вашего проекта соответствует тому, как `notebook_header.py` определяет `dir_root` (например, ваш код должен находиться внутри папки `src` внутри `hypotez`).  Это критически важная проверка для стабильной работы.