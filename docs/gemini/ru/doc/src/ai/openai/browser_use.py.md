# Документация модуля browser_use.py

## Обзор

Модуль предназначен для автоматизации поиска статей на сайте Habr.com по имени автора, открытия этих статей и генерации токсичных комментариев с использованием языковой модели OpenAI. Он включает функции для настройки агента, выполнения задачи поиска и генерации комментария, а также обработки возможных ошибок.

## Подробней

Данный код является частью проекта `hypotez` и предназначен для демонстрации работы с языковыми моделями для автоматической генерации контента (в данном случае, токсичных комментариев) на основе анализа статей с сайта Habr.com. Модуль использует библиотеку `langchain_openai` для взаимодействия с OpenAI API и класс `Agent` (предположительно, определенный в другом модуле проекта) для выполнения задачи.

## Функции

### `habra_toxic_commenter`

```python
async def habra_toxic_commenter(author_username: str, model_name: str = "gpt-4o") -> str | None:
    """
    Ищет статью на Хабре по указанному автору, открывает её и генерирует токсичный комментарий.

    Args:
        author_username (str): Имя пользователя на Хабре.
        model_name (str): Название языковой модели OpenAI для использования. По умолчанию gpt-4o.

    Returns:
        str | None: Строку с результатом работы агента, содержащую название статьи и сгенерированный комментарий.
                    Возвращает None, если произошла ошибка.
    """
```

**Назначение**: Функция `habra_toxic_commenter` ищет статью на Хабре по указанному имени автора, открывает её полную версию и генерирует токсичный комментарий на русском языке, связанный с содержанием статьи. Затем пытается опубликовать этот комментарий.

**Параметры**:
- `author_username` (str): Имя пользователя на Хабре, по которому будет производиться поиск статей.
- `model_name` (str, optional): Название языковой модели OpenAI, которую следует использовать для генерации комментария. По умолчанию используется модель "gpt-4o".

**Возвращает**:
- `str | None`: Строка, содержащая результат работы агента, включающая название найденной статьи и сгенерированный токсичный комментарий. Функция возвращает `None` в случае возникновения ошибки в процессе выполнения.

**Вызывает исключения**:
- `Exception`: В случае любой ошибки, возникшей в процессе выполнения функции (например, проблемы с подключением к Habr.com, ошибки при работе с OpenAI API и т.д.), будет перехвачено исключение и зарегистрировано в логе.

**Как работает функция**:

1. **Инициализация**: Создается инстанс `ChatOpenAI` с указанной языковой моделью.
2. **Формулировка задачи**: Определяется задача для агента, включающая поиск статьи указанного автора на Habr.com, открытие полной версии статьи и генерацию токсичного комментария на русском языке.
3. **Создание и запуск агента**: Создается инстанс `Agent` с заданной задачей и языковой моделью.
4. **Выполнение задачи**: Запускается асинхронная функция `agent.run()`, которая выполняет задачу поиска статьи, генерации комментария и его публикации.
5. **Обработка результата**: После завершения работы агента результат возвращается. В случае возникновения ошибки, информация об ошибке записывается в лог, и возвращается `None`.

```
Инициализация LLM (модели OpenAI)
↓
Формулировка задачи для агента (поиск статьи и генерация токсичного комментария)
↓
Создание агента с задачей и LLM
↓
Запуск агента для выполнения задачи
↓
Получение результата работы агента
↓
Возврат результата или None в случае ошибки
```

**Примеры**:

```python
import asyncio
async def main():
    author = "ElKornacio"
    result = await habra_toxic_commenter(author_username=author)

    if result:
        print("Результат работы агента:")
        print(result)
    else:
        print("Не удалось получить результат.")

if __name__ == "__main__":
    asyncio.run(main())
```

### `main`

```python
async def main():
    """
    Пример использования функции habra_toxic_commenter.
    """
```

**Назначение**: Функция `main` представляет собой пример использования функции `habra_toxic_commenter`.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- Отсутствует.

**Как работает функция**:

1. **Определение автора**: Устанавливается имя автора Habr, для которого будет производиться поиск статей и генерация комментариев.
2. **Вызов `habra_toxic_commenter`**: Вызывается функция `habra_toxic_commenter` с указанным именем автора.
3. **Обработка результата**: Если функция `habra_toxic_commenter` возвращает результат, он выводится на экран. В противном случае выводится сообщение об ошибке.

```
Определение автора для поиска статей
↓
Вызов habra_toxic_commenter с именем автора
↓
Обработка и вывод результата или сообщения об ошибке
```

**Примеры**:

```python
import asyncio

async def main():
    author = "ElKornacio"  # Замените на имя пользователя, статьи которого хотите найти
    result = await habra_toxic_commenter(author_username=author)

    if result:
        print("Результат работы агента:")
        print(result)
    else:
        print("Не удалось получить результат.")

if __name__ == "__main__":
    asyncio.run(main())