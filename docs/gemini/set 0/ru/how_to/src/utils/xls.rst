Как использовать модуль xls для работы с Excel-файлами
=============================================================================================

Описание
-------------------------
Модуль `xls.py` предоставляет функции для конвертации Excel-файлов (`xls`) в JSON и обратно.  Он позволяет работать с несколькими листами в файле. Модуль обрабатывает ошибки и записывает информацию в лог.

Шаги выполнения
-------------------------
1. **Импортирование модуля:**  Импортируйте модуль `xls` в ваш скрипт:

   ```python
   from hypotez.src.utils import xls
   ```

2. **Чтение Excel-файла в JSON (функция `read_xls_as_dict`):**

   - Передайте путь к Excel-файлу (`xls_file`) в качестве аргумента функции.
   - Опционально, укажите путь к файлу JSON (`json_file`), куда будет сохранено преобразованное данные.
   - Опционально, укажите имя листа (`sheet_name`), который нужно преобразовать. Если не указано, будут обработаны все листы.
   - Функция вернет словарь, где ключи - имена листов, а значения - список словарей, представляющих строки данных. Возвращает `False`, если возникла ошибка (например, файл не найден или ошибка чтения).

   ```python
   data = xls.read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')
   if data:
       print(data) # Пример вывода: {'Sheet1': [{...}]}
   ```


3. **Сохранение JSON-данных в Excel-файл (функция `save_xls_file`):**

   - Передайте словарь `data` (в формате, возвращаемом `read_xls_as_dict`) и путь к Excel-файлу (`file_path`) в функцию.
   - Функция сохранит данные в Excel-файл. Возвращает `True`, если сохранение прошло успешно, и `False` в противном случае (например, при ошибках открытия файла или записи).

   ```python
   data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
   success = xls.save_xls_file(data_to_save, 'output.xlsx')
   if success:
       print("Успешно сохранено в output.xlsx")
   ```


4. **Обработка ошибок:** Модуль содержит обработку ошибок (`try...except`).  Проверьте значение, возвращаемое функциями, чтобы убедиться, что операции прошли успешно.  В логах (система логирования `logging`) записывается информация об ошибках.


Пример использования
-------------------------
```python
from hypotez.src.utils import xls

# Чтение данных из Excel-файла
data = xls.read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')

if data:
    # Обработка данных
    print(data)

    # Сохранение данных в новый Excel-файл
    data_to_save = {'Sheet1': data['Sheet1']}  # копируем данные для записи в новый файл
    success = xls.save_xls_file(data_to_save, 'output_new.xlsx')
    if success:
        print("Успешно сохранено в output_new.xlsx")
```
```
```
```python

```
```


```
```
```
```

```

```
```


```
```
```

```
```
```
```

```
```
```
```
```

```