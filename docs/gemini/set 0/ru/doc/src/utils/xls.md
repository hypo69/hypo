# Модуль hypotez/src/utils/xls.py

## Обзор

Этот модуль предоставляет функции для преобразования файлов Excel (`xls`) в формат JSON и обратно, обработки нескольких листов и сохранения данных JSON обратно в файлы Excel (`xls`).  Он предназначен для удобной работы с данными, хранящимися в Excel, в приложениях, где требуется их преобразование в формат JSON или обратное преобразование. Модуль содержит обработку ошибок для повышения отказоустойчивости.

## Функции

### `read_xls_as_dict`

**Описание**: Читает файл Excel и преобразует его в JSON.  По желанию преобразует указанный лист и сохраняет результат в файл JSON.  Обрабатывает ошибки.

**Параметры**:
- `xls_file` (str): Путь к файлу Excel.
- `json_file` (str, optional): Путь к файлу JSON для сохранения. По умолчанию `None`.
- `sheet_name` (Union[str, int], optional): Имя или индекс листа для обработки. По умолчанию `None` (обрабатываются все листы).

**Возвращает**:
- `Union[Dict, List[Dict], bool]`: Словарь, представляющий данные из файла Excel в формате `{имя листа: данные} `, или список словарей (если указан один лист), либо `False` в случае ошибки.


**Обрабатывает исключения**:
- `FileNotFoundError`: Возникает, если файл Excel не найден.
- `Exception`: Возникает при других ошибках во время работы с файлом Excel, например, при проблемах с чтением или парсингом данных.

### `save_xls_file`

**Описание**: Сохраняет данные JSON в файл Excel. Обрабатывает ошибки.

**Параметры**:
- `data` (Dict[str, List[Dict]]): Словарь, содержащий данные для сохранения. Ключи - имена листов, значения - списки словарей, представляющих строки.
- `file_path` (str): Путь к файлу Excel для сохранения.

**Возвращает**:
- `bool`: `True` в случае успешного сохранения, `False` в случае ошибки.

**Обрабатывает исключения**:
- `Exception`: Возникает при ошибках во время сохранения данных в файл Excel.


## Логирование

Модуль использует `logging` для вывода сообщений об ошибках и успешном завершении операций. Уровень логирования по умолчанию - `INFO`.  Можно настроить уровень детальности логов с помощью `logging.basicConfig`.


## Примеры использования

```python
# Чтение файла Excel и сохранение в JSON (только лист "Sheet1")
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')
if data:
    print(data)

# Сохранение данных из JSON в Excel
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Файл успешно сохранен")

```
```
```
```
```