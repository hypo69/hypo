# Модуль `src.utils.convertors.md2dict`

## Обзор

Модуль предназначен для конвертации строк в формате Markdown в структурированные словари. Он включает функции для преобразования Markdown в HTML и последующего извлечения информации для формирования словарной структуры.

## Подробнее

Этот модуль предоставляет инструменты для обработки текста в формате Markdown, позволяя извлекать заголовки и содержимое разделов для структурированного представления данных. Он может быть использован для автоматической обработки документации, извлечения данных из текстовых файлов и других задач, где требуется структурирование Markdown-контента.

## Функции

### `md2html`

```python
def md2html(md_string: str, extras: List[str] = None) -> str:
    """
    Конвертирует строку Markdown в HTML.

    Args:
        md_string (str): Строка Markdown для конвертации.
        extras (list, optional): Список расширений markdown2. Defaults to None.

    Returns:
        str: HTML-представление Markdown.
    """
    ...
```

**Назначение**: Преобразует строку в формате Markdown в HTML.

**Параметры**:

- `md_string` (str): Строка, содержащая текст в формате Markdown, который необходимо преобразовать.
- `extras` (List[str], optional): Список расширений для библиотеки `markdown2`, используемых при конвертации. По умолчанию `None`.

**Возвращает**:

- `str`: HTML-представление входной Markdown-строки. В случае ошибки возвращает пустую строку.

**Вызывает исключения**:

- Возможные исключения, возникающие в процессе преобразования Markdown в HTML, логируются, но не обрабатываются, функция возвращает пустую строку.

**Как работает функция**:

1. Функция принимает строку в формате Markdown и список дополнительных расширений для обработки Markdown.
2. Использует функцию `markdown` из библиотеки `markdown2` для преобразования Markdown в HTML.
3. В случае возникновения ошибки при преобразовании, она логируется с использованием `logger.error`, и функция возвращает пустую строку.

```ascii
Начало
  ↓
Преобразование Markdown в HTML с использованием markdown2
  ↓
Обработка исключений: логирование ошибки, если преобразование не удалось
  ↓
Возврат HTML-представления или пустой строки в случае ошибки
  ↓
Конец
```

**Примеры**:

```python
from markdown2 import markdown

markdown("# Заголовок первого уровня")

"<h1>Заголовок первого уровня</h1>\n"
```

### `md2dict`

```python
def md2dict(md_string: str, extras: List[str] = None) -> Dict[str, list[str]]:
    """
    Конвертирует строку Markdown в структурированный словарь.

    Args:
        md_string (str): Строка Markdown для конвертации.
        extras (list, optional): Список расширений markdown2 для md2html. Defaults to None.

    Returns:
         Dict[str, list[str]]: Структурированное представление Markdown содержимого.
    """
    ...
```

**Назначение**: Преобразует строку в формате Markdown в структурированный словарь, где ключами являются заголовки разделов, а значениями - список строк содержимого этих разделов.

**Параметры**:

- `md_string` (str): Строка в формате Markdown, которую необходимо преобразовать в словарь.
- `extras` (List[str], optional): Список расширений для обработки Markdown, передаваемый в функцию `md2html`. По умолчанию `None`.

**Возвращает**:

- `Dict[str, list[str]]`: Словарь, представляющий структурированное содержимое Markdown. Ключи - заголовки разделов, значения - списки строк содержимого разделов. В случае ошибки возвращает пустой словарь.

**Вызывает исключения**:

- Возможные исключения, возникающие в процессе преобразования Markdown в словарь, логируются с использованием `logger.error`, и функция возвращает пустой словарь.

**Как работает функция**:

1. Функция принимает строку в формате Markdown и список дополнительных расширений для обработки Markdown.
2. Преобразует Markdown в HTML с использованием функции `md2html`.
3. Разделяет HTML на строки и итерируется по ним.
4. Определяет заголовки разделов на основе HTML-тегов `<h>`, извлекая уровень заголовка и текст заголовка.
5. Формирует словарь, где ключами являются заголовки первого уровня (`<h1>`), а значениями - списки строк, принадлежащих этому разделу. Строки добавляются в список текущего раздела, пока не встретится новый заголовок первого уровня.
6. В случае возникновения ошибки в процессе парсинга, она логируется с использованием `logger.error`, и функция возвращает пустой словарь.

```ascii
Начало
  ↓
Преобразование Markdown в HTML с использованием md2html
  ↓
Инициализация словаря для хранения структуры Markdown
  ↓
Разделение HTML на строки и итерация по ним
  ↓
Определение заголовков разделов на основе HTML-тегов <h>
  ↓
Формирование словаря: ключи - заголовки первого уровня, значения - списки строк содержимого
  ↓
Обработка исключений: логирование ошибки, если парсинг не удался
  ↓
Возврат структурированного словаря или пустого словаря в случае ошибки
  ↓
Конец
```

**Примеры**:

```python
from src.utils.convertors.md2dict import md2dict

markdown_text = """
# Заголовок 1
Содержимое раздела 1.

## Заголовок 2
Содержимое подраздела 2.
"""

result = md2dict(markdown_text)
print(result)

{'Заголовок 1': ['Содержимое раздела 1.', 'Заголовок 2', 'Содержимое подраздела 2.']}