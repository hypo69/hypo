### –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –º–æ–¥—É–ª—è `ToolBox_requests`

**–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**:
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º**: 6/10
- **–ü–ª—é—Å—ã**:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞.
    - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∏ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã.
    - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
    - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ ThreadPoolExecutor.
- **–ú–∏–Ω—É—Å—ã**:
    - –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–≤—ã—á–µ–∫ (—Å–º–µ—à–∏–≤–∞–Ω–∏–µ –æ–¥–∏–Ω–∞—Ä–Ω—ã—Ö –∏ –¥–≤–æ–π–Ω—ã—Ö).
    - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ RST –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–ª–∞—Å—Å–æ–≤.
    - –ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `try-except` –±–ª–æ–∫–æ–≤ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫.
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `time.sleep` –≤ —Ü–∏–∫–ª–∞—Ö, —á—Ç–æ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫.
    -  –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, —á—Ç–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç —á—Ç–µ–Ω–∏–µ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ.
    -  –ù–µ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `self` –≤ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏—è—Ö.
    -  –°–º–µ—à–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é**:
- –ü—Ä–∏–≤–µ—Å—Ç–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–¥–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –æ–¥–∏–Ω–∞—Ä–Ω—ã—Ö –∫–∞–≤—ã—á–µ–∫, –∞ –¥–≤–æ–π–Ω—ã–µ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
- –î–æ–±–∞–≤–∏—Ç—å RST-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–ª–∞—Å—Å–æ–≤.
- –ó–∞–º–µ–Ω–∏—Ç—å `time.sleep` –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã.
- –£–ø—Ä–æ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É, —Ä–∞–∑–¥–µ–ª–∏–≤ –Ω–∞ –±–æ–ª–µ–µ –º–µ–ª–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `logger.error` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö `try-except`.
- –ü—Ä–∏–≤–µ—Å—Ç–∏ –≤ –ø–æ—Ä—è–¥–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `self` –≤ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏—è—Ö.
- –†–∞–∑–¥–µ–ª–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ä–∞–∑–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–ª–∏ –º–µ—Ç–æ–¥—ã.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `from src.logger import logger` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ü—Ä–∏–≤–µ—Å—Ç–∏ –≤ –ø–æ—Ä—è–¥–æ–∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å PEP8.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `j_loads` –∏–ª–∏ `j_loads_ns` –≤–º–µ—Å—Ç–æ `json.load`.
- –í—ã—Ä–æ–≤–Ω—è—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ñ—É–Ω–∫—Ü–∏–π –∏ –∏–º–ø–æ—Ä—Ç–æ–≤.
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–∞–º –≥–¥–µ –µ—Å—Ç—å —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞

**–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥**:
```python
"""
–ú–æ–¥—É–ª—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ Telegram –±–æ—Ç–∞.
=============================================

–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–∞—Å—Å :class:`ToolBox`, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Telegram –±–æ—Ç–µ, –≤–∫–ª—é—á–∞—è —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π,
—Ç–∞—Ä–∏—Ñ—ã –∏ —Å–≤–æ–±–æ–¥–Ω—ã–π —Ä–µ–∂–∏–º.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
----------------------
.. code-block:: python

    toolbox = ToolBox()
    @bot.message_handler(commands=['start'])
    def start_handler(message):
        toolbox.start_request(message)
"""
import os
import concurrent.futures
import time
from random import randint
from telebot import TeleBot, types
from src.utils.jjson import j_loads
from src.logger import logger # –ò–∑–º–µ–Ω–µ–Ω –∏–º–ø–æ—Ä—Ç
from BaseSettings.AuxiliaryClasses import PromptsCompressor, keyboards
from ToolBox_n_networks import neural_networks

# Class initialization
pc = PromptsCompressor()

#Main functions class
class ToolBox(keyboards, neural_networks):
    """
    –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ Telegram –±–æ—Ç–∞.

    :param keyboards: –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞–º–∏.
    :type keyboards: src.BaseSettings.AuxiliaryClasses.keyboards
    :param neural_networks: –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏.
    :type neural_networks: ToolBox_n_networks.neural_networks
    """
    def __init__(self):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ ToolBox.
        
        –ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø—Ä–æ–º–ø—Ç—ã –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–æ—Ç–∞.
        """
        # Start buttons
        self.name = ['–¢–µ–∫—Å—Ç üìù', '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üé®', '–°–≤–æ–±–æ–¥–Ω—ã–π —Ä–µ–∂–∏–º üóΩ', '–¢–∞—Ä–∏—Ñ—ã üí∏'] # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        self.data = ['text', 'images', 'free', 'tariff']  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏

        # Prompts texts load
        with open('ToolBox/BaseSettings/prompts.json', 'r') as file:  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
            self.prompts_text = j_loads(file)  # –ò—Å–ø–æ–ª—å–∑—É–µ–º j_loads

        # Telegram bot initialization
        self.bot = TeleBot(token=os.environ['TOKEN']) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Inline keyboard blank lambda
        self.keyboard_blank = lambda name, data: super()._keyboard_two_blank(data, name) # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ self
        # Markup keyboard
        self.reply_keyboard = lambda name: super()._reply_keyboard(name) # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ self
        # Request delay
        self.__delay = lambda message: self.bot.send_message(message.chat.id, "–ü–æ–¥–æ–∂–¥–∏—Ç–µ, —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ . . .", parse_mode='html')  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Start request
        self.start_request = lambda message: self.bot.send_message(message.chat.id, self.prompts_text['hello'], reply_markup=self.keyboard_blank(self.name, self.data), parse_mode='html')  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Restart request
        self.restart = lambda message: self.bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –≤–∞–º –∑–∞–¥–∞—á—É", reply_markup=self.keyboard_blank(self.name, self.data), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Restart markup
        self.restart_markup = lambda message: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text="–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –≤–∞–º –∑–∞–¥–∞—á—É", reply_markup=self.keyboard_blank(self.name, self.data), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # One text request
        self.OneTextArea = lambda message, ind: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text=self.prompts_text['text_list'][ind] if type(self.prompts_text['text_list'][ind]) == str else self.prompts_text['text_list'][ind][0], reply_markup=self.keyboard_blank(['–ù–∞–∑–∞–¥'], ['text_exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Some texts request
        self.SomeTextsArea = lambda message, ind: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text=self.prompts_text['few_texts_list'][ind][0], reply_markup=self.keyboard_blank(['–ù–∞–∑–∞–¥'], ['text_exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Image size
        self.ImageSize = lambda message: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text="–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è", reply_markup=self.keyboard_blank(['9:16', '1:1', '16:9', '–í –º–µ–Ω—é'], ['576x1024', '1024x1024', '1024x576', 'exit']), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Image request
        self.ImageArea = lambda message: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π üñº", reply_markup=self.keyboard_blank(['–í –º–µ–Ω—é'], ['exit']), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Image change
        self.ImageChange = lambda message: self.bot.send_message(chat_id=message.chat.id, text="–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ", reply_markup=self.keyboard_blank(['–£–ª—É—á—à–∏—Ç—å ü™Ñ', 'üîÅ', '–ù–æ–≤–∞—è üñº', '–í –º–µ–Ω—é'], ['upscale', 'regenerate', 'images', 'exit']), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Message before upscale
        self.BeforeUpscale = lambda message: self.bot.send_message(chat_id=message.chat.id, text="–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ", reply_markup=self.keyboard_blank(['üîÅ', '–ù–æ–≤–∞—è üñº', '–í –º–µ–Ω—é'], ['regenerate', 'images', 'exit']), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Free mode request
        self.FreeArea = lambda message: self.bot.send_message(chat_id=message.chat.id, text="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å", reply_markup=self.reply_keyboard(['–í –º–µ–Ω—é']), parse_mode='html') # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Tariff request
        self.TariffArea = lambda message: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text="–¢–∞—Ä–∏—Ñ—ã", reply_markup=self.keyboard_blank(['BASIC', 'PRO', '–ü—Ä–æ–º–æ–∫–æ–¥', '–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞', '–í –º–µ–Ω—é'], ['basic', 'pro', 'promo', 'ref', 'exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Tariffs area exit
        self.TariffExit = lambda message: self.bot.send_message(chat_id=message.chat.id, text="–¢–∞—Ä–∏—Ñ—ã", reply_markup=self.keyboard_blank(['BASIC', 'PRO', '–ü—Ä–æ–º–æ–∫–æ–¥', '–í –º–µ–Ω—é'], ['basic', 'pro', 'promo', 'exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # End tariff
        self.TarrifEnd = lambda message: self.bot.send_message(chat_id=message.chat.id, text="–£ –≤–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –∑–∞–ø—Ä–æ—Å—ã, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–ª–∏—Ç—å –≤–∞—à —Ç–∞—Ä–∏—Ñ.", reply_markup=self.keyboard_blank(['BASIC', 'PRO', '–ü—Ä–æ–º–æ–∫–æ–¥', '–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞', '–í –º–µ–Ω—é'], ['basic', 'pro', 'promo', 'ref', 'exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Free tariff end
        self.FreeTariffEnd = lambda message: self.bot.send_message(chat_id=message.chat.id, text="–õ–∏–º–∏—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, —É–≤—ã, –∏—Å—á–µ—Ä–ø–∞–Ωüò¢ –ù–æ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –Ω–∞—à–∏—Ö –ø–ª–∞—Ç–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤. –ü—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∏—Ö –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ", reply_markup=self.keyboard_blank(['BASIC', 'PRO', '–ü—Ä–æ–º–æ–∫–æ–¥', '–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞', '–í –º–µ–Ω—é'], ['basic', 'pro', 'promo', 'ref', 'exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        # Select one or some texts
        self.SomeTexts = lambda message, ind: self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text="–•–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω —Ç–µ–∫—Å—Ç –∏–ª–∏ —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ?", reply_markup=self.keyboard_blank(['–û–¥–∏–Ω', '–ù–µ—Å–∫–æ–ª—å–∫–æ', '–ù–∞–∑–∞–¥'], [f'one_{ind}', f'some_{ind}', 'text_exit'])) # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏

#Private
    def __gpt_4o_mini(self, prompt: list[dict], message) -> tuple[dict[str, str], int, int]:
        """
        –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ GPT-4o mini.

        :param prompt: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏ –¥–ª—è –º–æ–¥–µ–ª–∏.
        :type prompt: list[dict]
        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :return: –ö–æ—Ä—Ç–µ–∂, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥—è—â–∏—Ö –∏ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤.
        :rtype: tuple[dict[str, str], int, int]
        """
        send = self.__delay(message) # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–¥–µ—Ä–∂–∫–µ
        try:
             response, incoming_tokens, outgoing_tokens = super()._free_gpt_4o_mini(prompt=prompt) # –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞
             self.bot.edit_message_text(chat_id=send.chat.id, message_id=send.message_id, text=PromptsCompressor.html_tags_insert(response['content']), parse_mode='html') # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ—Ç–≤–µ—Ç–æ–º
             return response, incoming_tokens, outgoing_tokens # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç–≤–µ—Ç –∏ —Ç–æ–∫–µ–Ω—ã
        except Exception as e: # –õ–æ–≤–∏–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è
             logger.error(f"Error in __gpt_4o_mini: {e}") # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
             self.bot.edit_message_text(chat_id=send.chat.id, message_id=send.message_id, text="–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞.") # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
             return {}, 0, 0 # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ

    def __FLUX_schnell(self, prompt: str, size: list[int], message, seed: int, num_inference_steps: int) -> None:
        """
        –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ FLUX_schnell.

        :param prompt: –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type prompt: str
        :param size: –°–ø–∏—Å–æ–∫ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type size: list[int]
        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :param seed: –ó–µ—Ä–Ω–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type seed: int
        :param num_inference_steps: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type num_inference_steps: int
        """
        send = self.__delay(message) # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–¥–µ—Ä–∂–∫–µ
        try:
            while True: # –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
                photo = super()._FLUX_schnell(prompt, size, seed, num_inference_steps) # –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞
                if photo: # –ï—Å–ª–∏ —Ñ–æ—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ
                    self.bot.send_photo(chat_id=message.chat.id, photo=photo) # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ
                    self.bot.delete_message(chat_id=send.chat.id, message_id=send.message_id) # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–¥–µ—Ä–∂–∫–µ
                    return
        except Exception as e: # –õ–æ–≤–∏–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è
            logger.error(f"Error in __FLUX_schnell: {e}") # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
            self.bot.edit_message_text(chat_id=send.chat.id, message_id=send.message_id, text="–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ") # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

#Public
    def Text_types(self, message):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä —Ç–∏–ø–∞ —Ç–µ–∫—Å—Ç–∞.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :return: –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤—ã–±–æ—Ä–æ–º —Ç–∏–ø–∞ —Ç–µ–∫—Å—Ç–∞.
        :rtype: telebot.types.Message
        """
        name = ['–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π  üõçÔ∏è', 'SMM üì±', '–ë—Ä–µ–π–Ω—à—Ç–æ—Ä–º üí°', '–†–µ–∫–ª–∞–º–∞ üì∫', '–ó–∞–≥–æ–ª–æ–≤–∫–∏ üîç', 'SEO üåê', '–ù–æ–≤–æ—Å—Ç—å üì∞', '–†–µ–¥–∞–∫—Ç—É—Ä–∞ üìù', '–í –º–µ–Ω—é'] # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        data = ['comm-text', 'smm-text', 'brainst-text', 'advertising-text', 'headlines-text', 'seo-text', 'news', 'editing', 'exit'] # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
        return self.bot.edit_message_text(chat_id=message.chat.id, message_id=message.message_id, text="üìù –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç–µ–∫—Å—Ç–∞", reply_markup=self.keyboard_blank(name, data))

    def Basic_tariff(self, message):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞ BASIC.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        """
        keyboard = types.InlineKeyboardMarkup() # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        keyboard.add(types.InlineKeyboardButton("–ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ BASIC", pay=True)) # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ–ø–ª–∞—Ç—ã
        keyboard.add(types.InlineKeyboardButton("–ö —Ç–∞—Ä–∏—Ñ–∞–º", callback_data="tariff_exit")) # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Ç–∞—Ä–∏—Ñ–∞–º
        price = [types.LabeledPrice(label='BASIC', amount=99 * 100)] # –°–æ–∑–¥–∞–µ–º —Ü–µ–Ω—É
        self.bot.delete_message(chat_id=message.chat.id, message_id=message.message_id) # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        self.bot.send_invoice(chat_id=message.chat.id, title='BASIC', # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω–≤–æ–π—Å
            description="–ë–µ–∑–ª–∏–º–∏—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ –≥–æ—Ç–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–∞–º.",
            invoice_payload='basic_invoice_payload',
            start_parameter='subscription',
            provider_token=os.environ['PROVIDE_TOKEN'],
            currency='RUB', prices=price, reply_markup=keyboard)

    def Pro_tariff(self, message):
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞ PRO.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        """
        keyboard = types.InlineKeyboardMarkup() # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
        keyboard.add(types.InlineKeyboardButton("–ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ PRO", pay=True)) # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ–ø–ª–∞—Ç—ã
        keyboard.add(types.InlineKeyboardButton("–ö —Ç–∞—Ä–∏—Ñ–∞–º", callback_data="tariff_exit")) # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Ç–∞—Ä–∏—Ñ–∞–º
        price = [types.LabeledPrice(label='PRO', amount=199 * 100)] # –°–æ–∑–¥–∞–µ–º —Ü–µ–Ω—É
        self.bot.delete_message(chat_id=message.chat.id, message_id=message.message_id) # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        self.bot.send_invoice(chat_id=message.chat.id, title='PRO', # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–Ω–≤–æ–π—Å
            description="–ë–µ–∑–ª–∏–º–∏—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (–≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ –≥–æ—Ç–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–∞–º) –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.",
            invoice_payload='pro_invoice_payload',
            start_parameter='subscription',
            provider_token=os.environ['PROVIDE_TOKEN'],
            currency='RUB', prices=price, reply_markup=keyboard)

    def TextCommands(self, message, ind: int) -> tuple[int, int, int]:
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :param ind: –ò–Ω–¥–µ–∫—Å –∫–æ–º–∞–Ω–¥—ã.
        :type ind: int
        :return: –ö–æ—Ä—Ç–µ–∂ —Å –≤—Ö–æ–¥—è—â–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏, –∏—Å—Ö–æ–¥—è—â–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ 1.
        :rtype: tuple[int, int, int]
        """
        info = [] # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        incoming_tokens = 0; outgoing_tokens = 0; response = None # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        if 'TEXT' in pc.commands_size[ind]: # –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç
            info.append(message.text) # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
            msg = self.bot.send_message(chat_id=message.chat.id, text=self.prompts_text['text_list'][ind][1]) # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∑–∞–ø—Ä–æ—Å–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
            def Text_next_step(message):
                nonlocal info, incoming_tokens, outgoing_tokens, response
                info += message.text.split(';') # –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                while len(info) < len(pc.commands_size[ind]): # –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
                    info.append("–ü–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç") # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ
                prompt = pc.get_prompt(ind=ind, info=info) # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–º–ø—Ç
                response, incoming_tokens, outgoing_tokens = self.__gpt_4o_mini(prompt=[{ "role": "user", "content": prompt }], message=message) # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–º–ø—Ç
                self.restart(message) # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
            self.bot.register_next_step_handler(msg, Text_next_step) # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
            while response is None: # –ñ–¥–µ–º –æ—Ç–≤–µ—Ç–∞
                time.sleep(0.5) # –ó–∞–¥–µ—Ä–∂–∫–∞
            return incoming_tokens, outgoing_tokens, 1 # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω—ã
        else:
            info = message.text.split(';') # –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            while len(info) < len(pc.commands_size[ind]): # –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
                info.append("–ü–∞—Ä–∞–º–µ—Ç—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç") # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ
            prompt = pc.get_prompt(ind=ind, info=info) # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–º–ø—Ç
            response, incoming_tokens, outgoing_tokens = self.__gpt_4o_mini(prompt=[{ "role": "user", "content": prompt }], message=message) # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–º–ø—Ç
            self.restart(message) # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
            return incoming_tokens, outgoing_tokens, 1 # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω—ã

    def SomeTextsCommand(self, message, ind: int, tokens: dict[str, int]) -> tuple[int, int, int]:
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :param ind: –ò–Ω–¥–µ–∫—Å –∫–æ–º–∞–Ω–¥—ã.
        :type ind: int
        :param tokens: –°–ª–æ–≤–∞—Ä—å —Å —Ç–æ–∫–µ–Ω–∞–º–∏.
        :type tokens: dict[str, int]
        :return: –ö–æ—Ä—Ç–µ–∂ —Å –≤—Ö–æ–¥—è—â–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏, –∏—Å—Ö–æ–¥—è—â–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–µ–∫—Å—Ç–æ–≤.
        :rtype: tuple[int, int, int]
        """
        try:
            n = int(message.text) # –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç–æ–≤
        except ValueError: # –ï—Å–ª–∏ –Ω–µ —á–∏—Å–ª–æ
            logger.error(f"Invalid input for number of texts: {message.text}") # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
            self.bot.send_message(chat_id=message.chat.id, text="–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ.") # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            return 0, 0, 0 # –í–æ–∑–≤—Ä–∞—â–∞–µ–º 0
        avalib = [0, 1, 3, 5, 6] # –°–ø–∏—Å–æ–∫ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
        ans = [] # –°–ø–∏—Å–æ–∫ –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
        for i in range(n): # –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª
            ans.append([]) # –î–æ–±–∞–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
            if "TEXT" in pc.commands_size[ind]: # –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç
                msg = self.bot.send_message(chat_id=message.chat.id, text=f"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ {i+1}") # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç
                text = None # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
                def Text_next_step(message):
                    nonlocal text, ans
                    text = message.text # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç
                    ans[i].append(text) # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ —Å–ø–∏—Å–æ–∫
                self.bot.register_next_step_handler(msg, Text_next_step) # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
                while text is None: # –ñ–¥–µ–º —Ç–µ–∫—Å—Ç
                    time.sleep(0.5) # –ó–∞–¥–µ—Ä–∂–∫–∞
        index = avalib.index(ind) # –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å
        for el in range(1, len(self.prompts_text["few_texts_list"][index])): # –¶–∏–∫–ª –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
            msg = self.bot.send_message(chat_id=message.chat.id, text=self.prompts_text["few_texts_list"][index][el]) # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            params = None # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            def Params_addition(message):
                nonlocal params, ans
                params = message.text # –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                params = params.split(';') # –†–∞–∑–±–∏–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                if len(params) < len(pc.commands_size[ind]): # –ï—Å–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
                    while len(params) < len(pc.commands_size[ind]): # –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                        params.append(None)
                param = params[0] # –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä
                [ans[i].append(param) if params[i] is None else ans[i].append(params[i]) for i in range(len(ans))] # –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Å–ø–∏—Å–æ–∫
            self.bot.register_next_step_handler(msg, Params_addition) # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
            while params is None: # –ñ–¥–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                 time.sleep(0.5) # –ó–∞–¥–µ—Ä–∂–∫–∞
        incoming_tokens = 0; outgoing_tokens = 0 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–∫–µ–Ω—ã
        def process_prompt(i):
            nonlocal incoming_tokens, outgoing_tokens # –û–±—ä—è–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            prompt = pc.get_prompt(ind=ind, info=ans[i]) # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–º–ø—Ç
            if tokens['incoming_tokens'] - incoming_tokens > 0 and tokens['outgoing_tokens'] - outgoing_tokens > 0 or tokens['free_requests'] - i > 0: # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω—ã
                response, in_tokens, out_tokens = self.__gpt_4o_mini(prompt=[{"role": "user", "content": prompt}], message=message) # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–º–ø—Ç
                return in_tokens, out_tokens # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω—ã
            return 0, 0 # –í–æ–∑–≤—Ä–∞—â–∞–µ–º 0
        with concurrent.futures.ThreadPoolExecutor() as executor: # –°–æ–∑–¥–∞–µ–º –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤
            results = list(executor.map(process_prompt, range(n))) # –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É
        for in_tokens, out_tokens in results:
            incoming_tokens += in_tokens # –°—á–∏—Ç–∞–µ–º –≤—Ö–æ–¥—è—â–∏–µ
            outgoing_tokens += out_tokens # –°—á–∏—Ç–∞–µ–º –∏—Å—Ö–æ–¥—è—â–∏–µ
        self.restart(message) # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
        return incoming_tokens, outgoing_tokens, n # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω—ã

    def ImageCommand(self, message, prompt: str, size: list[int]) -> int:
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :param prompt: –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type prompt: str
        :param size: –°–ø–∏—Å–æ–∫ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type size: list[int]
        :return: –ó–µ—Ä–Ω–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :rtype: int
        """
        seed = randint(1, 1000000) # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∑–µ—Ä–Ω–æ
        self.__FLUX_schnell(prompt=prompt, size=size, message=message, seed=seed, num_inference_steps=4) # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
        self.ImageChange(message) # –ó–∞–ø—É—Å–∫–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ
        return seed # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–µ—Ä–Ω–æ

    def Image_Regen_And_Upscale(self, message, prompt: str, size: list[int], seed, num_inference_steps=4) -> None:
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :param prompt: –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type prompt: str
        :param size: –°–ø–∏—Å–æ–∫ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type size: list[int]
        :param seed: –ó–µ—Ä–Ω–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type seed: int
        :param num_inference_steps: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        :type num_inference_steps: int
        """
        self.__FLUX_schnell(prompt=prompt, size=size, message=message, seed=seed, num_inference_steps=num_inference_steps) # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é

    def FreeCommand(self, message, prompts: list[str]) -> tuple[int, int, list[str]]:
        """
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ —Å–≤–æ–±–æ–¥–Ω–æ–º —Ä–µ–∂–∏–º–µ.

        :param message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram.
        :type message: telebot.types.Message
        :param prompts: –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–ø—Ç–æ–≤.
        :type prompts: list[str]
        :return: –ö–æ—Ä—Ç–µ–∂ —Å –≤—Ö–æ–¥—è—â–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏, –∏—Å—Ö–æ–¥—è—â–∏–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ —Å–ø–∏—Å–∫–æ–º –ø—Ä–æ–º–ø—Ç–æ–≤.
        :rtype: tuple[int, int, list[str]]
        """
        try:
            if type(prompts[-1].get('content', False))!=list: # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
                prompts.append({"content": message.text, "role": "user"}) # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–º–ø—Ç
        except Exception as e: # –õ–æ–≤–∏–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è
            logger.error(f"Error in FreeCommand: {e}") # –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
        response, incoming_tokens, outgoing_tokens = self.__gpt_4o_mini(prompt=prompts, message=message) # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ø—Ä–æ–º–ø—Ç
        prompts.append(response) # –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç
        return incoming_tokens, outgoing_tokens, prompts # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω—ã –∏ –ø—Ä–æ–º–ø—Ç—ã