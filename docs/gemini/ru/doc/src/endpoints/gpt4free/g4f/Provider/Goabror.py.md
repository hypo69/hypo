# Модуль `Goabror`

## Обзор

Модуль `Goabror` предоставляет асинхронный генератор для взаимодействия с API Goabror (goabror.uz). Он позволяет получать ответы от модели GPT, используя асинхронные запросы. Модуль поддерживает прокси и предоставляет базовый класс для асинхронных генераторов провайдеров.

## Подробней

Этот модуль является частью проекта `hypotez` и предназначен для обеспечения возможности взаимодействия с сервисом Goabror для генерации текста на основе модели GPT. Он использует библиотеку `aiohttp` для асинхронных HTTP-запросов и предоставляет функциональность для форматирования запросов и обработки ответов.

## Классы

### `Goabror`

**Описание**: Класс `Goabror` является асинхронным генератором провайдером и реализует методы для взаимодействия с API Goabror.

**Наследует**:
- `AsyncGeneratorProvider`: Предоставляет базовый класс для асинхронных генераторов провайдеров.
- `ProviderModelMixin`: Обеспечивает поддержку выбора модели.

**Атрибуты**:
- `url` (str): URL сервиса Goabror (`https://goabror.uz`).
- `api_endpoint` (str): URL API для взаимодействия (`https://goabror.uz/api/gpt.php`).
- `working` (bool): Флаг, указывающий на работоспособность провайдера (True).
- `default_model` (str): Модель, используемая по умолчанию (`gpt-4`).
- `models` (list[str]): Список поддерживаемых моделей (`[default_model]`).

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для получения ответов от API Goabror.

## Функции

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """Создает асинхронный генератор для получения ответов от API Goabror.

    Args:
        model (str): Модель для использования.
        messages (Messages): Список сообщений для отправки.
        proxy (str, optional): URL прокси-сервера. По умолчанию `None`.
        **kwargs: Дополнительные аргументы.

    Returns:
        AsyncResult: Асинхронный генератор, возвращающий ответы от API.

    Raises:
        aiohttp.ClientResponseError: Если HTTP-запрос завершается с ошибкой.
        json.JSONDecodeError: Если не удается декодировать JSON-ответ.
        Exception: Если возникает другая ошибка при обработке запроса.

    Пример:
        >>> async for message in Goabror.create_async_generator(model='gpt-4', messages=[{'role': 'user', 'content': 'Hello'}]):
        ...     print(message)
        "Hello from GPT-4"
    """
```

**Назначение**: Создает асинхронный генератор для взаимодействия с API Goabror и получения ответов на основе предоставленных сообщений.

**Параметры**:
- `cls` (Goabror): Ссылка на класс `Goabror`.
- `model` (str): Имя модели, которую следует использовать для генерации ответа.
- `messages` (Messages): Список сообщений, отправляемых в API для получения ответа.
- `proxy` (str, optional): URL прокси-сервера, если необходимо использовать прокси для подключения к API. По умолчанию `None`.
- `**kwargs`: Дополнительные параметры, которые могут быть переданы в API.

**Возвращает**:
- `AsyncResult`: Асинхронный генератор, который возвращает текстовые ответы от API Goabror.

**Как работает функция**:

1.  **Формирование заголовков**: Функция создает заголовки HTTP-запроса, включая `accept`, `accept-language` и `user-agent`.
2.  **Создание асинхронной сессии**: Используется `aiohttp.ClientSession` для выполнения асинхронных HTTP-запросов.
3.  **Формирование параметров запроса**: Функция подготавливает параметры запроса, включая форматированный промт и системное сообщение.
4.  **Выполнение GET-запроса**: Выполняется GET-запрос к API Goabror с использованием предоставленных параметров и прокси.
5.  **Обработка ответа**: Функция обрабатывает ответ от API, проверяет статус и извлекает данные.
6.  **Генерация результатов**: Функция возвращает асинхронный генератор, который выдает данные из ответа API.

**Внутренние функции**: Нет.

**Примеры**:

```python
# Пример использования create_async_generator
async for message in Goabror.create_async_generator(model='gpt-4', messages=[{'role': 'user', 'content': 'Hello'}]):
    print(message)
```

**ASCII flowchart**:

```
A: Формирование заголовков и создание сессии
|
B: Формирование параметров запроса (prompt, system)
|
C: Выполнение GET-запроса к API
|
D: Проверка статуса ответа
|
E: Обработка JSON ответа или текста
|
F: Генерация данных