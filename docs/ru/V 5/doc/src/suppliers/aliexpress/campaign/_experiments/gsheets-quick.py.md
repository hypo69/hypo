# Модуль gsheets-quick

## Обзор

Модуль `gsheets-quick.py` предназначен для быстрой работы с Google Sheets в контексте кампаний AliExpress. Он позволяет автоматизировать процессы, такие как чтение данных о продуктах и категориях из Google Sheets и сохранение информации о кампаниях. Модуль использует библиотеку `gspread` для взаимодействия с Google Sheets и включает функциональность для работы с различными типами кампаний и категорий продуктов.

## Подробней

Этот модуль является частью более крупной системы `hypotez` и используется для автоматизации задач, связанных с управлением кампаниями AliExpress. Он предназначен для упрощения процесса извлечения и сохранения данных из Google Sheets, что позволяет быстрее обновлять информацию о продуктах и кампаниях.

## Классы

### `AliCampaignGoogleSheet`

**Описание**: Класс для работы с Google Sheets, содержащими информацию о кампаниях AliExpress.

**Как работает класс**:
Класс инициализируется с именем кампании, языком и валютой. Он предоставляет методы для установки рабочего листа продуктов, сохранения категорий и кампаний из рабочего листа.

**Методы**:
- `set_products_worksheet(category_name: str) -> None`: Устанавливает рабочий лист продуктов на основе имени категории.
- `save_categories_from_worksheet(use_cache: bool = False) -> list[CategoryType]`: Сохраняет категории из рабочего листа.
- `save_campaign_from_worksheet() -> CampaignType`: Сохраняет кампанию из рабочего листа.

## Функции

### `set_products_worksheet`

```python
def set_products_worksheet(category_name: str) -> None:
    """
    Устанавливает рабочий лист продуктов на основе имени категории.

    Args:
        category_name (str): Имя категории.

    Returns:
        None

    """
```

**Описание**: Устанавливает активный рабочий лист (worksheet) для работы с продуктами, находящимися в указанной категории.

**Как работает функция**:
Функция принимает имя категории в качестве аргумента и использует его для поиска соответствующего рабочего листа в Google Sheets. После нахождения рабочего листа, он устанавливается как текущий рабочий лист продуктов для дальнейших операций.

**Параметры**:
- `category_name` (str): Имя категории, для которой необходимо установить рабочий лист.

**Возвращает**:
- `None`

**Примеры**:
```python
gs.set_products_worksheet('chandeliers')
```

### `save_categories_from_worksheet`

```python
def save_categories_from_worksheet(use_cache: bool = False) -> list[CategoryType]:
    """
    Сохраняет категории из рабочего листа.

    Args:
        use_cache (bool, optional): Использовать кэш. По умолчанию False.

    Returns:
        list[CategoryType]: Список категорий.

    """
```

**Описание**: Сохраняет данные о категориях товаров из Google Sheets в формате списка объектов `CategoryType`.

**Как работает функция**:
Функция извлекает данные из активного рабочего листа, преобразует их в объекты `CategoryType` и возвращает список этих объектов. Параметр `use_cache` определяет, использовать ли кэшированные данные.

**Параметры**:
- `use_cache` (bool, optional): Флаг, указывающий, следует ли использовать кэшированные данные. По умолчанию `False`.

**Возвращает**:
- `list[CategoryType]`: Список объектов `CategoryType`, представляющих категории товаров.

**Примеры**:
```python
categories = gs.save_categories_from_worksheet()
```

### `save_campaign_from_worksheet`

```python
def save_campaign_from_worksheet() -> CampaignType:
    """
    Сохраняет кампанию из рабочего листа.

    Returns:
        CampaignType: Объект кампании.

    """
```

**Описание**: Сохраняет информацию о кампании из Google Sheets в виде объекта `CampaignType`.

**Как работает функция**:
Функция извлекает данные о кампании из активного рабочего листа, преобразует их в объект `CampaignType` и возвращает этот объект. Это позволяет автоматизировать процесс обновления информации о кампаниях.

**Возвращает**:
- `CampaignType`: Объект `CampaignType`, представляющий кампанию.

**Примеры**:
```python
campaign = gs.save_campaign_from_worksheet()