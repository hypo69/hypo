Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код реализует FastAPI приложение, которое обрабатывает данные, полученные из HTML формы, и передает их внешнему скрипту (script.py).  Приложение обрабатывает ввод пользователя, запускает внешний скрипт с этими данными в качестве входных данных и возвращает результат выполнения скрипта.  Также код содержит endpoint, который перенаправляет запрос на страницу index.html.

Шаги выполнения
-------------------------
1. **Импортирует необходимые библиотеки**: Импортируются библиотеки `fastapi`, `subprocess`, `webbrowser`, `pathlib`, `staticfiles` для работы с FastAPI, запуском внешних процессов и открытием веб-страниц.
2. **Инициализирует FastAPI приложение**: Создается экземпляр `FastAPI` приложение и устанавливается `StaticFiles` для сервера, который обрабатывает статические файлы (например, HTML, CSS, JavaScript).
3. **Открывает веб-браузер на index.html**: Используя `webbrowser.open()`, открывается веб-страница index.html в браузере по адресу `http://localhost:8000/html/index.html`.
4. **Обрабатывает запросы POST на endpoint /process_data**:
   - Получает имя и фамилию пользователя из формы (`first_name`, `last_name`).
   - Проверяет, были ли переданы оба поля. Если нет, возвращает ошибку 400.
   - Формирует строку входных данных для внешнего скрипта, соединяя имя и фамилию.
   - Запускает внешний скрипт (`script.py`) с помощью `subprocess.Popen` и передает входные данные в качестве stdin.
   - Получает результат выполнения скрипта из stdout.
   - Обрабатывает возможные ошибки при выполнении скрипта, возвращая ошибку 500 в случае неудачи.
   - Возвращает результат работы скрипта в виде словаря.
5. **Обрабатывает запросы GET на endpoint /**:
   - Возвращает сообщение "Redirecting to index.html...".  Фактически перенаправляет на index.html

Пример использования
-------------------------
.. code-block:: python

    # Предполагается, что у вас есть HTML форма, которая отправляет данные на /process_data
    # Например, в файле index.html:
    
    <form method="POST" action="/process_data">
        <label for="first_name">Имя:</label><br>
        <input type="text" id="first_name" name="first_name"><br>
        <label for="last_name">Фамилия:</label><br>
        <input type="text" id="last_name" name="last_name"><br><br>
        <input type="submit" value="Отправить">
    </form>
    
    # В скрипте script.py (который нужно запустить отдельно) должна быть функция, принимающая данные из stdin:
    # import sys
    # def process_input(data):
    #     print(f"Input data: {data}") # Обработка данных и вычисление
    #     result = data.upper() # Пример обработки
    #     return result
    # input_data = sys.stdin.readline().strip()
    # result = process_input(input_data)
    # sys.stdout.write(result.encode())


    # Для запуска приложения:
    # uvicorn main:app --reload
    # Откройте браузер и перейдите по адресу http://localhost:8000/html/index.html.
    # Введите имя и фамилию в форму и нажмите "Отправить".
    # Результат, возвращенный скриптом script.py, будет выведен на странице.