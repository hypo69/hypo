# Модуль crypto.py

## Обзор

Модуль `crypto.py` содержит функции для выполнения криптографических операций, используемых в Mega API, включая шифрование и дешифрование AES, хеширование строк и подготовку ключей.

## Подробней

Этот модуль предоставляет набор криптографических функций, необходимых для обеспечения безопасности данных при взаимодействии с сервисом Mega. Он включает в себя функции для шифрования и дешифрования данных с использованием алгоритма AES в режиме CBC, а также функции для подготовки ключей и хеширования строк.

## Функции

### `aes_cbc_encrypt`

```python
def aes_cbc_encrypt(data, key):
    """
    Args:
        data: Данные для шифрования.
        key: Ключ шифрования.

    Returns:
        bytes: Зашифрованные данные.
    """
```

**Описание**: Шифрует данные с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `data`: Данные для шифрования.
- `key`: Ключ шифрования.

**Возвращает**:

- `bytes`: Зашифрованные данные.

**Примеры**:

```python
>>> key = b'\\x00' * 16
>>> data = b'test data'
>>> encrypted = aes_cbc_encrypt(data, key)
>>> print(encrypted)
b'g\\xbb\\x9c\\x94\\xfa\\xaf\\x84\\x9e\\xa2\\x8a\\x0e\\xd5\\x9b\\xa3\\xba'
```

### `aes_cbc_decrypt`

```python
def aes_cbc_decrypt(data, key):
    """
    Args:
        data: Данные для дешифрования.
        key: Ключ дешифрования.

    Returns:
        bytes: Дешифрованные данные.
    """
```

**Описание**: Дешифрует данные с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `data`: Данные для дешифрования.
- `key`: Ключ дешифрования.

**Возвращает**:

- `bytes`: Дешифрованные данные.

**Примеры**:

```python
>>> key = b'\\x00' * 16
>>> data = b'g\\xbb\\x9c\\x94\\xfa\\xaf\\x84\\x9e\\xa2\\x8a\\x0e\\xd5\\x9b\\xa3\\xba'
>>> decrypted = aes_cbc_decrypt(data, key)
>>> print(decrypted)
b'test data\\x06\\x06\\x06\\x06\\x06\\x06'
```

### `aes_cbc_encrypt_a32`

```python
def aes_cbc_encrypt_a32(data, key):
    """
    Args:
        data: Данные для шифрования в формате a32.
        key: Ключ шифрования в формате a32.

    Returns:
        list[int]: Зашифрованные данные в формате a32.
    """
```

**Описание**: Шифрует данные в формате a32 с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `data`: Данные для шифрования в формате a32.
- `key`: Ключ шифрования в формате a32.

**Возвращает**:

- `list[int]`: Зашифрованные данные в формате a32.

### `aes_cbc_decrypt_a32`

```python
def aes_cbc_decrypt_a32(data, key):
    """
    Args:
        data: Данные для дешифрования в формате a32.
        key: Ключ дешифрования в формате a32.

    Returns:
        list[int]: Дешифрованные данные в формате a32.
    """
```

**Описание**: Дешифрует данные в формате a32 с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `data`: Данные для дешифрования в формате a32.
- `key`: Ключ дешифрования в формате a32.

**Возвращает**:

- `list[int]`: Дешифрованные данные в формате a32.

### `stringhash`

```python
def stringhash(s, aeskey):
    """
    Args:
        s (str): Строка для хеширования.
        aeskey (list[int]): Ключ AES для хеширования.

    Returns:
        str: Хеш строки в формате base64.
    """
```

**Описание**: Вычисляет хеш строки с использованием AES.

**Параметры**:

- `s` (str): Строка для хеширования.
- `aeskey` (list[int]): Ключ AES для хеширования.

**Возвращает**:

- `str`: Хеш строки в формате base64.

**Примеры**:

```python
>>> key = [0x00] * 4
>>> data = 'test'
>>> hash_str = stringhash(data, key)
>>> print(hash_str)
'ASECsg'
```

### `prepare_key`

```python
def prepare_key(a):
    """
    Args:
        a (list[int]): Список целых чисел для подготовки ключа.

    Returns:
        list[int]: Подготовленный ключ.
    """
```

**Описание**: Подготавливает ключ для шифрования.

**Параметры**:

- `a` (list[int]): Список целых чисел для подготовки ключа.

**Возвращает**:

- `list[int]`: Подготовленный ключ.

### `encrypt_key`

```python
def encrypt_key(a, key):
    """
    Args:
        a (list[int]): Ключ для шифрования.
        key (list[int]): Ключ шифрования.

    Returns:
        list[int]: Зашифрованный ключ.
    """
```

**Описание**: Шифрует ключ с использованием AES.

**Параметры**:

- `a` (list[int]): Ключ для шифрования.
- `key` (list[int]): Ключ шифрования.

**Возвращает**:

- `list[int]`: Зашифрованный ключ.

### `decrypt_key`

```python
def decrypt_key(a, key):
    """
    Args:
        a (list[int]): Ключ для дешифрования.
        key (list[int]): Ключ дешифрования.

    Returns:
        list[int]: Дешифрованный ключ.
    """
```

**Описание**: Дешифрует ключ с использованием AES.

**Параметры**:

- `a` (list[int]): Ключ для дешифрования.
- `key` (list[int]): Ключ дешифрования.

**Возвращает**:

- `list[int]`: Дешифрованный ключ.

### `enc_attr`

```python
def enc_attr(attr, key):
    """
    Args:
        attr (dict): Атрибуты для шифрования.
        key (list[int]): Ключ шифрования.

    Returns:
        bytes: Зашифрованные атрибуты.
    """
```

**Описание**: Шифрует атрибуты с использованием AES.

**Параметры**:

- `attr` (dict): Атрибуты для шифрования.
- `key` (list[int]): Ключ шифрования.

**Возвращает**:

- `bytes`: Зашифрованные атрибуты.

**Примеры**:

```python
>>> key = [0x00] * 4
>>> data = {'test': 'value'}
>>> enc_attr_value = enc_attr(data, key)
>>> print(enc_attr_value)
b'MEGAb\'{"test": "value"}\\'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'
```

### `dec_attr`

```python
def dec_attr(attr, key):
    """
    Args:
        attr (bytes): Зашифрованные атрибуты.
        key (list[int]): Ключ дешифрования.

    Returns:
        dict: Дешифрованные атрибуты.
    """
```

**Описание**: Дешифрует атрибуты с использованием AES.

**Параметры**:

- `attr` (bytes): Зашифрованные атрибуты.
- `key` (list[int]): Ключ дешифрования.

**Возвращает**:

- `dict`: Дешифрованные атрибуты.

**Примеры**:

```python
>>> key = [0x00] * 4
>>> data = b'MEGAb\'{"test": "value"}\\'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'
>>> dec_attr_value = dec_attr(data, key)
>>> print(dec_attr_value)
{'test': 'value'}