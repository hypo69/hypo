# Модуль для настройки обработки исключений и логирования

## Обзор

Модуль `_logging.py` предназначен для настройки обработки исключений и логирования в проекте. Он содержит функции для перехвата и обработки необработанных исключений, а также для интеграции стандартного модуля `logging` с системой логирования `loguru` (хотя в текущей версии кода эта интеграция закомментирована).

## Подробней

Этот модуль предоставляет возможность централизованно управлять обработкой исключений и логированием, что упрощает отладку и мониторинг работы приложения. В частности, он позволяет перехватывать исключения, возникающие в программе, и выполнять определенные действия, такие как завершение работы при нажатии `Ctrl+C` (KeyboardInterrupt).

## Функции

### `__exception_handle`

```python
def __exception_handle(e_type, e_value, e_traceback):
    """
    Обработчик необработанных исключений.

    Args:
        e_type: Тип исключения.
        e_value: Значение исключения.
        e_traceback: Информация о стеке вызовов в момент возникновения исключения.

    Returns:
        None

    Raises:
        None

    Как работает функция:

    1. Проверяет, является ли тип исключения KeyboardInterrupt (возникает при нажатии Ctrl+C).
    2. Если это так, выводит сообщение "Bye..." и завершает программу с кодом 0.
    3. Если это не KeyboardInterrupt, вызывает стандартный обработчик исключений `sys.__excepthook__` для дальнейшей обработки исключения.

    Внутри функции происходят следующие действия:

    Проверка типа исключения -> Вывод сообщения и выход (если KeyboardInterrupt) или передача стандартному обработчику.

    Примеры:

    ```python
    # Пример вызова (обычно вызывается автоматически при возникновении необработанного исключения)
    __exception_handle(TypeError, "Неверный тип данных", "traceback info")
    ```
    """
    ...
```

### `hook_except_handle`

```python
def hook_except_handle():
    """
    Устанавливает пользовательский обработчик исключений.

    Args:
        None

    Returns:
        None

    Raises:
        None

    Как работает функция:

    1. Заменяет стандартный обработчик исключений `sys.excepthook` на пользовательский обработчик `__exception_handle`.
    2. После вызова этой функции все необработанные исключения будут перехватываться функцией `__exception_handle`.

    Внутри функции происходит следующее действие:

    Замена обработчика исключений.

    Примеры:

    ```python
    # Пример вызова для установки обработчика исключений
    hook_except_handle()
    ```
    """
    ...
```
```python
#class __InterceptHandler(logging.Handler):
#    def emit(self, record):
#        try:
#            level = logger.level(record.levelname).name
#        except ValueError:
#            level = record.levelno
#
#        frame, depth = logging.currentframe(), 2
#        while frame.f_code.co_filename == logging.__file__:
#            frame = frame.f_back
#            depth += 1
#
#        logger.opt(depth=depth, exception=record.exc_info).log(\
#            level, record.getMessage()\
#        )
```
Закомментированный код класса `__InterceptHandler` используется для перехвата сообщений, отправленных через стандартный модуль `logging`, и перенаправления их в систему логирования `loguru`. 
Он преобразует уровни логирования и добавляет информацию о стеке вызовов для более точной идентификации источника сообщения.

**Принцип работы**:
1.  Метод `emit` вызывается каждый раз, когда модуль `logging` генерирует новое сообщение.
2.  Внутри `emit` уровень логирования преобразуется в формат, понятный `loguru`.
3.  Определяется глубина стека вызовов, чтобы указать, откуда было отправлено сообщение.
4.  Сообщение передается в `loguru` для дальнейшей обработки и записи.
```python
#def hook_logging(**kwargs):
#    logging.basicConfig(handlers=[__InterceptHandler()], **kwargs)
```

Закомментированная функция `hook_logging` предназначена для интеграции стандартного модуля `logging` с `loguru`. 
Она настраивает базовую конфигурацию `logging`, добавляя обработчик `__InterceptHandler`, который перехватывает все сообщения `logging` и передает их в `loguru`.

**Параметры**:
- `**kwargs`: Дополнительные параметры, которые передаются в `logging.basicConfig`.

**Принцип работы**:
1.  Вызывается `logging.basicConfig` с указанием `__InterceptHandler` в качестве обработчика.
2.  Любые дополнительные параметры передаются в `logging.basicConfig` для настройки логирования.

```