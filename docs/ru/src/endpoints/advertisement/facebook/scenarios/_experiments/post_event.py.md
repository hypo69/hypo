# Модуль для обработки и отправки данных о мероприятиях на Facebook

## Обзор

Модуль `post_event.py` предназначен для автоматизации процесса публикации информации о мероприятиях в группах Facebook. Он считывает данные о мероприятиях из JSON-файлов, расположенных в Google Drive, и использует `FacebookPromoter` для отправки этих данных в указанные группы Facebook.

## Подробней

Этот модуль является частью системы автоматизации маркетинга в Facebook и предназначен для упрощения и ускорения процесса публикации информации о мероприятиях. Он позволяет загружать данные о мероприятиях из структурированных JSON-файлов и автоматически публиковать их в нескольких группах Facebook, управляемых пользователем.

## Функции

### `post_events`

```python
def post_events():
    """Обрабатывает и отправляет мероприятия на Facebook.

    Функция получает данные о мероприятиях из указанной директории, загружает детали мероприятий из JSON-файлов
    и отправляет их на Facebook. Мероприятия хранятся в структуре директорий под папкой `facebook/events`.

    Raises:
        FileNotFoundError: Если JSON-файл с информацией о мероприятии отсутствует.
    """
    ...
```

**Как работает функция**:

1.  **Инициализация драйвера**: Создает инстанс драйвера Chrome для управления браузером.
2.  **Получение директорий мероприятий**: Использует функцию `get_directory_names` для получения списка директорий с мероприятиями из папки `aliexpress/events` в Google Drive. Эти директории содержат JSON-файлы с информацией о каждом мероприятии.
3.  **Получение файлов групп**: Использует функцию `get_filenames` для получения списка файлов групп Facebook, в которые планируется отправлять сообщения о мероприятиях. Эти файлы находятся в папке `facebook/groups` в Google Drive.
4.  **Инициализация промоутера**: Создает экземпляр класса `FacebookPromoter`, передавая ему драйвер и список файлов групп. `FacebookPromoter` отвечает за публикацию мероприятий в группах Facebook.
5.  **Обработка каждого файла мероприятия**: Для каждой директории мероприятия:
    *   Загружает данные мероприятия из JSON-файла с использованием `j_loads_ns`.
    *   Вызывает метод `process_groups` у экземпляра `FacebookPromoter` для отправки информации о мероприятии в соответствующие группы Facebook. Указывается, что это мероприятие (`is_event=True`).

**Параметры**:

*   Отсутствуют.

**Возвращает**:

*   `None`

**Вызывает исключения**:

*   `FileNotFoundError`: Если JSON-файл с информацией о мероприятии не найден.

### `post_to_my_group`

```python
def post_to_my_group(event):
    """"""
    ...
```

**Как работает функция**:

1.  **Загрузка информации о группах**: Загружает информацию о группах Facebook из файла `my_managed_groups.json`, расположенного в Google Drive. Используется функция `j_loads_ns` для загрузки данных в виде пространства имен.
2.  **Инициализация драйвера**: Создает инстанс драйвера Chrome для управления браузером.
3.  **Перебор групп**: Перебирает все группы Facebook, информация о которых была загружена из JSON-файла.
4.  **Формирование URL группы**: Для каждой группы формирует URL страницы мероприятия.
5.  **Переход по URL**: Использует драйвер для перехода по сформированному URL группы.
6.  **Публикация мероприятия**: Вызывает функцию `post_event` для публикации информации о мероприятии в текущей группе.

**Параметры**:

*   `event`: Данные о мероприятии, которые будут опубликованы в группе Facebook.

**Возвращает**:

*   `None`

**Вызывает исключения**:

*   Отсутствуют.

## Запуск модуля

При запуске модуля (`if __name__ == "__main__":`) происходит следующее:

1.  **Загрузка данных о мероприятии**: Загружает данные о конкретном мероприятии (`sep_11_2024_over60_pricedown.json`) из Google Drive.
2.  **Публикация мероприятий**: Вызывается функция `post_events()`, которая обрабатывает и отправляет мероприятия на Facebook, используя данные, загруженные из JSON-файлов.

```python
if __name__ == "__main__":
    event = j_loads_ns(gs.path.google_drive / 'aliexpress' / 'events'  / 'sep_11_2024_over60_pricedown' / 'sep_11_2024_over60_pricedown.json')
    #post_to_my_group(event)
    post_events()
    # Дополнительная обработка или логика, если потребуется