# Модуль `main.py`

## Обзор

Модуль `main.py` представляет собой основной модуль графического интерфейса (GUI) для управления рекламными кампаниями, редактором продуктов и редактором категорий. Он использует библиотеку `PyQt6` для создания интерфейса и `qasync` для интеграции асинхронных операций.

## Подробнее

Этот модуль является точкой входа в приложение, которое предоставляет пользователю возможность управлять рекламными кампаниями, редактировать продукты и категории. Он состоит из нескольких вкладок, каждая из которых отвечает за свою функциональность. Модуль также включает в себя меню с опциями для работы с файлами (открытие, сохранение, выход) и редактирования (копирование, вставка).

## Классы

### `MainApp`

**Описание**: Главное окно приложения, которое содержит вкладки для редактора JSON, редактора кампаний и редактора продуктов.

**Принцип работы**:
Класс `MainApp` наследует класс `QtWidgets.QMainWindow` и является основным окном приложения. Он инициализирует интерфейс, создает вкладки для различных редакторов (JSON, кампании, продукты) и добавляет их в виджет вкладок. Также создает меню с опциями для работы с файлами и редактирования.

**Методы**:

- `__init__(self)`:
    - Инициализирует главное окно приложения, устанавливает заголовок и размеры окна.
    - Создает виджет вкладок и добавляет в него вкладки для редактора JSON, редактора кампаний и редактора продуктов.
    - Создает экземпляры классов `CampaignEditor`, `CategoryEditor` и `ProductEditor` и связывает их с соответствующими вкладками.
    - Вызывает метод `create_menubar()` для создания меню.

- `create_menubar(self)`:
    - Создает строку меню с опциями для работы с файлами и редактирования.
    - Добавляет действия "Open", "Save" и "Exit" в меню "File", связывая их с соответствующими методами.
    - Добавляет действия "Copy" и "Paste" в меню "Edit", связывая их с соответствующими методами.
    - Добавляет действие "Open Product File" в меню "File", связывая его с методом `open_file` класса `ProductEditor`.

- `open_file(self)`:
    - Открывает диалоговое окно выбора файла для выбора JSON-файла.
    - Если файл выбран, вызывает метод `load_file()` для загрузки файла.

- `save_file(self)`:
    - Определяет текущую активную вкладку и вызывает соответствующий метод сохранения в зависимости от вкладки.
    - Если активна вкладка "JSON Editor", вызывает метод `save_changes()` класса `CampaignEditor`.
    - Если активна вкладка "Product Editor", вызывает метод `save_product()` класса `ProductEditor`.

- `exit_application(self)`:
    - Закрывает приложение.

- `copy(self)`:
    - Копирует выделенный текст в буфер обмена.
    - Определяет виджет, находящийся в фокусе.
    - Если виджет является `QLineEdit`, `QTextEdit` или `QPlainTextEdit`, вызывает метод `copy()` этого виджета.
    - В противном случае выводит предупреждающее сообщение.

- `paste(self)`:
    - Вставляет текст из буфера обмена.
    - Определяет виджет, находящийся в фокусе.
    - Если виджет является `QLineEdit`, `QTextEdit` или `QPlainTextEdit`, вызывает метод `paste()` этого виджета.
    - В противном случае выводит предупреждающее сообщение.

- `load_file(self, campaign_file: str)`:
    - Загружает JSON-файл.
    - Пытается загрузить файл с помощью метода `load_file()` класса `CampaignEditor`.
    - В случае ошибки выводит сообщение об ошибке.

**Параметры**:

- `self`: Экземпляр класса `MainApp`.

**Примеры**:

```python
app = QtWidgets.QApplication(sys.argv)
main_app = MainApp()
main_app.show()
```

## Функции

### `main()`

**Назначение**: Инициализирует и запускает приложение.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- Отсутствует.

**Вызывает исключения**:
- Не вызывает.

**Как работает функция**:

1. **Инициализация приложения**: Создает экземпляр класса `QtWidgets.QApplication`, который необходим для работы графического интерфейса.
2. **Создание цикла событий**: Создает цикл событий `QEventLoop` и устанавливает его как текущий цикл событий для асинхронных операций. Это позволяет приложению обрабатывать асинхронные задачи, не блокируя основной поток.
3. **Создание и отображение главного окна**: Создает экземпляр класса `MainApp`, который представляет собой главное окно приложения, и отображает его.
4. **Запуск цикла событий**: Запускает цикл событий, который обрабатывает пользовательский ввод и другие события. Цикл событий работает до тех пор, пока приложение не будет закрыто.

**Примеры**:

```python
if __name__ == "__main__":
    main()