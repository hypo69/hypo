# Планировщик задач Windows: Автоматизируем рутину



## Что такое Планировщик задач?

Планировщик задач (Task Scheduler) - системная служба Windows, которая позволяет создавать и управлять автоматизированными задачами. Задачи могут быть настроены для запуска в определенное время, при определенных событиях (например, при входе пользователя в систему) или при соблюдении определенных условий.

## Как открыть Планировщик задач?

Есть несколько способов:

*   **Через поиск Windows:** Введите "Планировщик задач" в поле поиска на панели задач и выберите соответствующий результат.
*   **Через команду "Выполнить":** Нажмите `Win + R`, введите `taskschd.msc` и нажмите `Enter`.
*   **Через панель управления:** Откройте панель управления, выберите "Система и безопасность", а затем "Администрирование" и "Планировщик заданий".

## Создание задачи: пошаговая инструкция

1.  **Открыть Планировщик задач:** (см. выше).
2.  **Создать задачу:** В левой панели выберите "Библиотека планировщика заданий". В правой панели нажмите "Создать простую задачу..." или "Создать задачу...".
    *   **Простая задача:** Помогает быстро настроить основные параметры задачи, такие как имя, описание, расписание и действие.
    *   **Создать задачу:** Предоставляет больше возможностей для настройки, включая триггеры, действия, условия и параметры.
3.  **Заполнить параметры задачи:**
    *   **Имя и описание:** Укажите понятное имя и описание, чтобы легко идентифицировать задачу в будущем.
    *   **Триггеры:** Определите, когда задача должна запускаться. Это может быть расписание (ежедневно, еженедельно, ежемесячно), событие (при входе пользователя в систему, при запуске компьютера) или условие (при простое системы).
    *   **Действия:** Укажите, что должна делать задача. Чаще всего это запуск программы или скрипта, но также можно отправить электронное письмо или отобразить сообщение.
    *   **Условия:** Укажите дополнительные условия, при которых задача должна запускаться (например, только при питании от сети).
    *   **Параметры:** Настройте дополнительные параметры, такие как время выполнения, поведение при ошибках и т. д.
4.  **Нажать "ОК":** После настройки всех параметров нажмите "ОК", чтобы сохранить задачу.

## Полезные примеры использования

### 1. Автоматическое резервное копирование файлов

Создайте задачу, которая будет ежедневно или еженедельно выполнять резервное копирование важных файлов на внешний жесткий диск или в облачное хранилище. Для этого можно использовать сторонние программы для резервного копирования или написать простой скрипт на Python или PowerShell.

**Пример (PowerShell):**

```powershell
# Путь к папке, которую нужно скопировать
$Source = "C:\Users\YourName\Documents"
# Путь к папке для резервной копии
$Destination = "D:\Backup\Documents"
# Копировать папку и все подпапки
Copy-Item -Path $Source -Destination $Destination -Recurse -Force
Write-Host "Резервное копирование завершено!"
```

Сохраните этот скрипт как `backup.ps1` и создайте задачу в Планировщике задач, чтобы запускать его по расписанию.

*   **Триггер:** Еженедельно, в воскресенье в 2:00 ночи.
*   **Действие:** Запустить программу `powershell.exe` с аргументом `-File "C:\path\to\backup.ps1"`.

### 2. Очистка временных файлов

Настройте задачу, которая будет регулярно очищать временные файлы, освобождая место на диске и улучшая производительность системы.

**Пример (Использование команды `cleanmgr`):**

*   **Триггер:** Ежемесячно, в первое воскресенье месяца в 3:00 ночи.
*   **Действие:** Запустить программу `cleanmgr.exe` с аргументом `/autoclean`.  (Этот параметр выполняет автоматическую очистку диска без запросов пользователя)

### 3. Автоматическое обновление программного обеспечения

Хотя многие программы имеют встроенную функцию автоматического обновления, можно создать задачу, которая будет проверять наличие обновлений и устанавливать их для программ, у которых такой функции нет.

**Пример (Использование Chocolatey Package Manager):**

Если вы используете Chocolatey Package Manager, можно создать задачу, которая будет обновлять все установленные пакеты.

*   **Триггер:** Еженедельно, по субботам в 4:00 ночи.
*   **Действие:** Запустить программу `cmd.exe` с аргументом `/c choco upgrade all -y`.

### 4. Отображение напоминаний

Используйте Планировщик задач, чтобы отображать напоминания о важных событиях или задачах.  Для этого можно создать скрипт, который будет отображать всплывающее окно с напоминанием.

**Пример (PowerShell):**

```powershell
[System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")
[System.Windows.Forms.MessageBox]::Show("Напоминание: Позвонить клиенту!", "Напоминание", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Information)
```

Сохраните этот скрипт как `reminder.ps1` и создайте задачу в Планировщике задач, чтобы запускать его по расписанию.

*   **Триггер:** Ежедневно, в 9:00 утра.
*   **Действие:** Запустить программу `powershell.exe` с аргументом `-File "C:\path\to\reminder.ps1"`.

### 5. Запуск скрипта при простое системы

Можно создать задачу, которая будет запускать скрипт только тогда, когда система находится в режиме простоя (неактивности) в течение определенного времени.  Это может быть полезно для выполнения ресурсоемких задач, которые не будут мешать работе пользователя.

*   **Триггер:** Нет триггера, задачу запускаем только по условию простоя.
*   **Действие:** Запустить программу или скрипт.
*   **Условия:**
    *   "Запускать задачу, только если компьютер не используется в течение": Установите желаемое время простоя (например, 15 минут).
    *   "Остановить, если компьютер перестанет находиться в режиме простоя": Установите флажок, чтобы задача прекратила работу, если пользователь снова начнет использовать компьютер.

## Создание задач через командную строку (schtasks)

Для автоматизации создания задач можно использовать команду `schtasks`.

**Пример: Создание еженедельной задачи для запуска скрипта**

```
schtasks /create /tn "MyWeeklyBackup" /tr "C:\path\to\backup.bat" /sc weekly /d MON /st 10:00
```

*   `/tn "MyWeeklyBackup"`: Имя задачи.
*   `/tr "C:\path\to\backup.bat"`: Путь к исполняемому файлу.
*   `/sc weekly`: Запуск раз в неделю.
*   `/d MON`: Запуск по понедельникам (можно заменить на `TUE`, `WED` и т. д.).
*   `/st 10:00`: Запуск в 10:00 утра.

**Другие полезные команды `schtasks`:**

*   `schtasks /query`: Вывод списка всех задач.
*   `schtasks /run /tn "MyWeeklyBackup"`: Немедленный запуск задачи.
*   `schtasks /delete /tn "MyWeeklyBackup" /f`: Удаление задачи.

## Заключение

Планировщик задач Windows - это мощный и гибкий инструмент, который позволяет автоматизировать множество рутинных задач.  Используя приведенные примеры в качестве отправной точки, вы сможете настроить планировщик задач для решения самых разных задач и оптимизировать свою работу с компьютером. Помните, что безопасность - превыше всего. Проверяйте скрипты на наличие вредоносного кода, прежде чем добавлять их в планировщик задач.
```
