## <algorithm>

1.  **התחלה:** תחילת התוכנית.
    *   דוגמה: תחילת ריצת הסקריפט `anagram_generator.py`.
2.  **ייבוא ספריות:** ייבוא הספריות `google.generativeai` ו- `re`.
    *   דוגמה: `import google.generativeai as genai` , `import re`.
    *   זרימת נתונים: אין זרימת נתונים, רק ייבוא פונקציונליות.
3.  **הגדרת מחלקה `GoogleGenerativeAI`:** הגדרת מחלקה האחראית ליצירת אנאגרמות.
    *   דוגמה: `class GoogleGenerativeAI:`.
    *   זרימת נתונים: אין זרימת נתונים, רק הגדרת מבנה.
4.  **אתחול מחלקה:** אתחול המחלקה עם API KEY של Gemini.
    *   דוגמה: `def __init__(self, api_key):`.
    *   זרימת נתונים: קבלת `api_key` כקלט.
5.  **הגדרת הוראת מערכת:** הגדרת הוראת המערכת (system prompt) עבור מודל Gemini.
    *   דוגמה: `self.system_instruction`.
    *   זרימת נתונים: יצירת מחרוזת המכילה את ההוראה.
6.  **פונקציה `generate_anagram(self, q)`:** קבלת מחרוזת קלט `q` המכילה אותיות, וניסיון לייצר אנאגרמה.
    *   דוגמה: `def generate_anagram(self, q):`.
    *   זרימת נתונים: קבלת `q` כקלט.
7.  **ניקוי קלט:** ניקוי המחרוזת `q` מתווים שאינם אותיות רוסיות.
    *   דוגמה: `q = re.sub(r"[^а-яА-ЯёЁ]", "", q)`.
    *   זרימת נתונים: המחרוזת `q` לאחר ניקוי מוחזרת.
8.  **בדיקה האם הקלט ריק:** בדיקה האם המחרוזת `q` ריקה לאחר הניקוי.
    *   דוגמה: `if not q: return "Нет анаграмм"`.
    *   זרימת נתונים: המחרוזת `q` נבדקת, אם ריקה מוחזר "Нет анаграмм".
9.  **שליחת בקשה ל-Gemini:** שליחת מחרוזת הקלט למודל Gemini וקבלת תגובה.
    *   דוגמה: `response = self.model.generate_content(q)`.
    *   זרימת נתונים: `q` נשלח ל-Gemini, תגובה נשמרת ב `response`.
10. **טיפול בשגיאות:** טיפול בשגיאות שעלולות לקרות בעת שליחת בקשה ל-API של Gemini.
     * דוגמה: `try...except Exception as e:`
     * זרימת נתונים: לכידת שגיאה, אם מתרחשת, והחזרת הודעת שגיאה.
11. **חילוץ אנאגרמה מהתגובה:** חילוץ האנאגרמה מתוך התגובה שהתקבלה מ-Gemini.
      * דוגמה: `return response.text`.
      * זרימת נתונים: טקסט האנאגרמה מוחזר.
12. **לולאה ראשית:** קליטת קלט מהמשתמש והצגת אנאגרמה.
     * דוגמה: `while True:`.
     * זרימת נתונים: לולאה אינסופית המקבלת קלט מהמשתמש.
13. **קלט משתמש:** קבלת מחרוזת אותיות מהמשתמש.
     * דוגמה: `q = input(...)`.
     * זרימת נתונים: קבלת מחרוזת מהמשתמש ושמירתה במשתנה `q`.
14. **יצירת אנאגרמה:** יצירת אנאגרמה מהקלט באמצעות המחלקה `GoogleGenerativeAI`.
    *   דוגמה: `anagram = gemini.generate_anagram(q)`.
    *   זרימת נתונים: הקלט `q` נשלח לפונקציה generate_anagram והתוצאה נשמרת ב- `anagram`.
15. **הדפסת אנאגרמה:** הדפסת האנאגרמה למסך.
    *   דוגמה: `print(anagram)`.
    *   זרימת נתונים: פלט האנאגרמה מודפס למסך.
16. **חזרה ללולאה הראשית:** חזרה לשלב קליטת קלט מהמשתמש.
17. **סיום:** התוכנית ממשיכה לרוץ עד לעצירה ידנית.
    *   דוגמה: סיום ריצת הסקריפט.

## <mermaid>

```mermaid
flowchart TD
    Start[התחלה] --> ImportLibraries[ייבוא ספריות: <code>google.generativeai</code>, <code>re</code>];
    ImportLibraries --> DefineClass[הגדרת מחלקה <code>GoogleGenerativeAI</code>];
    DefineClass --> InitializeClass[אתחול המחלקה עם API Key];
    InitializeClass --> DefineSystemInstruction[הגדרת הוראת מערכת עבור Gemini];
    DefineSystemInstruction --> GenerateAnagramFunction[הגדרת פונקציה <code>generate_anagram(q)</code>];
    GenerateAnagramFunction --> CleanInput[ניקוי קלט: הסרת תווים שאינם אותיות רוסיות];
    CleanInput --> CheckIfInputEmpty[בדיקה אם הקלט ריק];
    CheckIfInputEmpty -- Yes --> ReturnNoAnagram[החזרת "Нет анаграмм"];
    CheckIfInputEmpty -- No --> SendRequestToGemini[שליחת בקשה ל-Gemini];
    SendRequestToGemini --> HandleErrors[טיפול בשגיאות API];
    HandleErrors -- Error --> ReturnErrorMessage[החזרת הודעת שגיאה];
    HandleErrors -- No Error --> ExtractAnagramFromResponse[חילוץ אנאגרמה מהתגובה];
    ExtractAnagramFromResponse --> ReturnAnagram[החזרת האנאגרמה];
    ReturnNoAnagram --> MainLoop[לולאה ראשית: קבלת קלט והצגת אנאגרמה];
     ReturnErrorMessage --> MainLoop
    ReturnAnagram --> MainLoop;
    MainLoop --> GetUserInput[קבלת קלט מהמשתמש];
    GetUserInput --> GenerateAnagramCall[קריאה לפונקציה <code>generate_anagram</code>];
    GenerateAnagramCall --> PrintAnagram[הדפסת האנאגרמה];
    PrintAnagram --> MainLoop;

```

## <explanation>

**ייבואים (Imports)**:

*   `import google.generativeai as genai`: מייבאת את הספרייה `google.generativeai` ומכנה אותה `genai`. ספרייה זו משמשת ליצירת אינטראקציה עם מודל השפה Gemini של גוגל.
*   `import re`: מייבאת את הספרייה `re`, אשר מספקת תמיכה בפעולות של ביטויים רגולריים. משמשת כאן לניקוי הקלט, להסרת כל התווים שאינם אותיות רוסיות.

**מחלקות (Classes)**:

*   `class GoogleGenerativeAI`: המחלקה הזו עוטפת את הלוגיקה של יצירת אנאגרמות באמצעות מודל Gemini.
    *   `__init__(self, api_key)`: פעולה בונה (constructor) של המחלקה. היא מקבלת את מפתח ה-API של Gemini כפרמטר, מאחסנת אותו ויוצרת מופע של המודל.
    *   `generate_anagram(self, q)`: הפונקציה המרכזית של המחלקה. היא מקבלת מחרוזת `q` (אשר מהווה את קלט האותיות מהן יש לייצר אנאגרמה), מנקה אותה מתווים לא רצויים (שאינם אותיות רוסיות), שולחת בקשה למודל Gemini ומחזירה את האנאגרמה או הודעה במקרה שלא נמצאה.

**פונקציות (Functions)**:

*   `__init__(self, api_key)`: (ראו הסבר במחלקות).
*   `generate_anagram(self, q)`:
    *   **פרמטרים**:
        *   `self`: מצביע למופע המחלקה.
        *   `q`: מחרוזת המכילה את האותיות מהן יש לייצר אנאגרמה.
    *   **ערך מוחזר**: מחרוזת המכילה את האנאגרמה או "Нет анаграмм" (אם לא נמצאה אנאגרמה) או הודעת שגיאה במקרה של שגיאה.
    *   **מטרה**: הפונקציה הזו היא ליבת הפעולה, היא מקבלת מחרוזת של אותיות מהמשתמש, מנקה אותה, שולחת שאילתה למודל Gemini ומחזירה את התשובה.
    *   **דוגמה**: אם הקלט `q` הוא "сон", אז הפונקציה תחזיר "нос".

**משתנים (Variables)**:

*   `api_key`: מחרוזת המכילה את מפתח ה-API של Gemini. משמשת לאימות גישה למודל.
*   `system_instruction`: מחרוזת המגדירה את ההוראה למודל Gemini. משמשת כהנחיה ראשונית למה שהמודל צריך לעשות.
*   `model`: מופע של מודל Gemini. נוצר באמצעות `genai.GenerativeModel('gemini-pro')` ומשמש לשליחת שאילתות למודל.
*   `q`: משתנה המשמש לאחסון קלט המשתמש.
*   `response`: משתנה המכיל את תגובת מודל Gemini.
*   `anagram`: משתנה המכיל את תוצאת האנאגרמה שהוחזרה על ידי הפונקציה `generate_anagram`.

**בעיות אפשריות או תחומים לשיפור**:

*   **טיפול בשגיאות**: הקוד מטפל בשגיאות כלליות (`Exception as e`) אך ייתכן ויהיה צורך לטפל בסוגים ספציפיים של שגיאות (כמו שגיאות רשת או שגיאות API) בצורה מפורטת יותר.
*   **הגבלות קצב:** מודלי שפה לעתים קרובות מוגבלים בקצב השליחה של בקשות API, יש לשקול הוספת מנגנוני עיכוב/ניהול קצב כדי להימנע משגיאות.
*   **תלות בחיבור אינטרנט**: הקוד דורש חיבור אינטרנט פעיל כדי לפנות ל-API של Gemini.
*   **מפתח API:** השימוש במפתח API קשיח הוא לא מומלץ לשימוש בפרויקט, אלא מומלץ להשתמש ב-environment variables או במנגנוני ניהול סודות אחרים.
*   **הוראות Gemini:** אפשר לשפר את ההנחיות למודל על מנת לקבל תוצאות מדוייקות יותר.

**שרשרת קשרים עם חלקים אחרים בפרויקט (אם רלוונטי):**
*   אין קשרים עם חלקים אחרים בפרויקט בקוד הספציפי הזה, אך ניתן לראות את הקשר עם ה-API של Gemini.

הקוד הזה מדגים אינטראקציה עם מודל שפה של גוגל באמצעות ה-API שלו ומשמש כדוגמה פשוטה ליצירת אנאגרמות. הקוד פשוט יחסית אך מכסה את רוב הפונקציונליות הנדרשת כדי לעבוד עם המודל Gemini.