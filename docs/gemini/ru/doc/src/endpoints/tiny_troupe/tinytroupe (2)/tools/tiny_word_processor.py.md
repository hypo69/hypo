# Модуль `tiny_word_processor.py`

## Обзор

Модуль предоставляет класс `TinyWordProcessor`, который является инструментом для создания и обработки текстовых документов. Класс позволяет агентам (agents) писать документы, обогащать их содержимое и экспортировать в различных форматах. Этот инструмент предназначен для использования в проектах, где требуется автоматизированное создание и управление текстовыми данными.

## Подробнее

Модуль `tiny_word_processor.py` является частью проекта `hypotez` и предназначен для работы с текстовыми документами в автоматическом режиме. Он предоставляет функциональность для создания, обогащения и экспорта документов. Класс `TinyWordProcessor` наследуется от класса `TinyTool` и предоставляет методы для записи документов, обработки действий и определения подсказок и ограничений для действий.

## Классы

### `TinyWordProcessor`

**Описание**: Класс `TinyWordProcessor` представляет собой инструмент для создания и обработки текстовых документов.

**Наследует**:
- `TinyTool`: Класс `TinyWordProcessor` наследуется от класса `TinyTool`, что позволяет ему использовать общую функциональность инструментов в проекте `hypotez`.

**Атрибуты**:
- `owner` (str, optional): Владелец инструмента. По умолчанию `None`.
- `exporter` (object, optional): Объект для экспорта документов. По умолчанию `None`.
- `enricher` (object, optional): Объект для обогащения контента документов. По умолчанию `None`.

**Методы**:
- `__init__(self, owner=None, exporter=None, enricher=None)`: Инициализирует экземпляр класса `TinyWordProcessor`.
- `write_document(self, title, content, author=None)`: Записывает документ с заданным заголовком, содержимым и автором.
- `_process_action(self, agent, action) -> bool`: Обрабатывает действие агента.
- `actions_definitions_prompt(self) -> str`: Возвращает подсказки для определения действий.
- `actions_constraints_prompt(self) -> str`: Возвращает ограничения для действий.

### `__init__`

```python
def __init__(self, owner=None, exporter=None, enricher=None):
    """
    Инициализирует экземпляр класса `TinyWordProcessor`.

    Args:
        owner (str, optional): Владелец инструмента. По умолчанию `None`.
        exporter (object, optional): Объект для экспорта документов. По умолчанию `None`.
        enricher (object, optional): Объект для обогащения контента документов. По умолчанию `None`.
    """
    ...
```

**Назначение**: Инициализирует объект класса `TinyWordProcessor` с заданными параметрами.

**Параметры**:
- `owner` (str, optional): Владелец инструмента. Используется для указания, кто отвечает за данный инструмент. По умолчанию `None`.
- `exporter` (object, optional): Объект, отвечающий за экспорт созданных документов в различные форматы. По умолчанию `None`.
- `enricher` (object, optional): Объект, отвечающий за обогащение контента документов, например, добавление деталей и дополнительной информации. По умолчанию `None`.

**Как работает функция**:
1. Вызывается конструктор родительского класса `TinyTool` с передачей имени инструмента (`wordprocessor`), описания, владельца, флага `real_world_side_effects` (установлен в `False`, что указывает на отсутствие реальных побочных эффектов) и объектов `exporter` и `enricher`.

**Примеры**:

```python
from tinytroupe.tools.tiny_word_processor import TinyWordProcessor

# Создание экземпляра класса TinyWordProcessor
word_processor = TinyWordProcessor(owner="John Doe")
```

### `write_document`

```python
def write_document(self, title, content, author=None):
    """
    Записывает документ с заданным заголовком, содержимым и автором.

    Args:
        title (str): Заголовок документа.
        content (str): Содержимое документа.
        author (str, optional): Автор документа. По умолчанию `None`.
    """
    ...
```

**Назначение**: Метод `write_document` предназначен для создания и сохранения текстового документа. Он принимает заголовок, контент и автора документа, а также использует объекты `enricher` и `exporter` для обогащения контента и экспорта документа в различных форматах.

**Параметры**:
- `title` (str): Заголовок документа. Обязательный параметр, определяющий название создаваемого документа.
- `content` (str): Содержимое документа. Представляет собой текст, который будет записан в документ.
- `author` (str, optional): Автор документа. Необязательный параметр, указывающий автора создаваемого документа. По умолчанию `None`.

**Как работает функция**:

```
A: Логирование заголовка и контента
│
B: Проверка наличия enricher
│
C: Обогащение контента (если enricher присутствует)
│
D: Проверка наличия exporter
│
E: Экспорт документа в различных форматах (если exporter присутствует)
```

1. **Логирование заголовка и контента**: В начале функции выполняется логирование заголовка и контента документа с использованием `logger.debug`.
2. **Проверка наличия enricher**: Проверяется, установлен ли объект `enricher`. Если `enricher` установлен, выполняется обогащение контента.
3. **Обогащение контента**: Если `enricher` присутствует, вызывается метод `enrich_content` объекта `enricher` для обогащения контента документа.
4. **Проверка наличия exporter**: Проверяется, установлен ли объект `exporter`. Если `exporter` установлен, выполняется экспорт документа.
5. **Экспорт документа в различных форматах**: Если `exporter` присутствует, вызывается метод `export` объекта `exporter` для экспорта документа в форматах `md`, `docx` и `json`.

**Примеры**:

```python
from tinytroupe.tools.tiny_word_processor import TinyWordProcessor

# Создание экземпляра класса TinyWordProcessor
word_processor = TinyWordProcessor(owner="John Doe")

# Запись документа
word_processor.write_document(title="Example Document", content="This is an example document.", author="Jane Doe")
```

### `_process_action`

```python
def _process_action(self, agent, action) -> bool:
    """
    Обрабатывает действие агента.

    Args:
        agent (object): Агент, выполняющий действие.
        action (dict): Словарь, содержащий информацию о действии.

    Returns:
        bool: `True`, если действие было успешно обработано, `False` в противном случае.
    """
    ...
```

**Назначение**: Метод `_process_action` предназначен для обработки действий, выполняемых агентами. Он анализирует тип действия и его содержимое, извлекает необходимую информацию и вызывает соответствующие методы для выполнения действия.

**Параметры**:
- `agent` (object): Агент, выполняющий действие. Объект, представляющий агента, который инициировал действие.
- `action` (dict): Словарь, содержащий информацию о действии. Словарь, содержащий параметры действия, такие как тип действия и содержимое.

**Как работает функция**:

```
A: Проверка типа действия и наличия контента
│
B: Преобразование контента из JSON (если необходимо)
│
C: Проверка валидности полей контента
│
D: Вызов метода write_document для создания документа
│
E: Обработка исключений
```

1. **Проверка типа действия и наличия контента**: В начале функции проверяется, является ли тип действия `WRITE_DOCUMENT` и присутствует ли контент (`action['content']`).
2. **Преобразование контента из JSON (если необходимо)**: Если контент представлен в виде строки, он преобразуется в JSON-объект с использованием функции `utils.extract_json`.
3. **Проверка валидности полей контента**: Проверяется, содержатся ли в контенте только допустимые поля (`title`, `content`, `author`) с использованием функции `utils.check_valid_fields`.
4. **Вызов метода `write_document` для создания документа**: Вызывается метод `write_document` с параметрами, извлеченными из контента, для создания документа.
5. **Обработка исключений**: Если в процессе обработки действия возникают исключения, такие как `json.JSONDecodeError` или `Exception`, они логируются с использованием `logger.error`, и функция возвращает `False`.

**Примеры**:

```python
from tinytroupe.tools.tiny_word_processor import TinyWordProcessor

# Создание экземпляра класса TinyWordProcessor
word_processor = TinyWordProcessor(owner="John Doe")

# Пример действия
action = {
    "type": "WRITE_DOCUMENT",
    "content": {
        "title": "Example Document",
        "content": "This is an example document.",
        "author": "Jane Doe"
    }
}

# Обработка действия
result = word_processor._process_action(agent="ExampleAgent", action=action)
print(result)  # Вывод: True
```

### `actions_definitions_prompt`

```python
def actions_definitions_prompt(self) -> str:
    """
    Возвращает подсказки для определения действий.

    Returns:
        str: Строка с подсказками для определения действий.
    """
    ...
```

**Назначение**: Метод `actions_definitions_prompt` предназначен для предоставления подсказок и инструкций агентам о том, какие действия они могут выполнять. Он возвращает строку с описанием возможных действий и их параметров.

**Возвращает**:
- `str`: Строка с подсказками для определения действий. Строка, содержащая описание действия `WRITE_DOCUMENT` и его параметров (`title`, `content`, `author`).

**Как работает функция**:
1. Формируется строка `prompt` с описанием действия `WRITE_DOCUMENT` и его параметров.
2. Используется функция `utils.dedent` для удаления общих отступов в строке `prompt`.
3. Строка `prompt` возвращается в качестве результата.

**Примеры**:

```python
from tinytroupe.tools.tiny_word_processor import TinyWordProcessor

# Создание экземпляра класса TinyWordProcessor
word_processor = TinyWordProcessor(owner="John Doe")

# Получение подсказок для определения действий
prompt = word_processor.actions_definitions_prompt()
print(prompt)
```

### `actions_constraints_prompt`

```python
def actions_constraints_prompt(self) -> str:
    """
    Возвращает ограничения для действий.

    Returns:
        str: Строка с ограничениями для действий.
    """
    ...
```

**Назначение**: Метод `actions_constraints_prompt` предназначен для предоставления агентам ограничений и правил, которые они должны соблюдать при выполнении действий. Он возвращает строку с описанием ограничений для действия `WRITE_DOCUMENT`.

**Возвращает**:
- `str`: Строка с ограничениями для действий. Строка, содержащая описание ограничений для действия `WRITE_DOCUMENT`, таких как необходимость записи всего контента сразу, использование JSON для передачи контента и следование дополнительным рекомендациям.

**Как работает функция**:
1. Формируется строка `prompt` с описанием ограничений для действия `WRITE_DOCUMENT`.
2. Используется функция `utils.dedent` для удаления общих отступов в строке `prompt`.
3. Строка `prompt` возвращается в качестве результата.

**Примеры**:

```python
from tinytroupe.tools.tiny_word_processor import TinyWordProcessor

# Создание экземпляра класса TinyWordProcessor
word_processor = TinyWordProcessor(owner="John Doe")

# Получение ограничений для действий
prompt = word_processor.actions_constraints_prompt()
print(prompt)
```

## Функции

В данном модуле отсутствуют отдельные функции, не входящие в классы.