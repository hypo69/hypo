# Документация для разработчика: `Supplier`

## Обзор

Документация предоставляет подробное описание класса `Supplier`, который служит основой для управления взаимодействиями с поставщиками. Класс выполняет инициализацию, настройку, аутентификацию и запуск сценариев для различных источников данных.

## Подробнее

Класс `Supplier` предназначен для унификации работы с различными поставщиками данных, такими как `amazon.com`, `walmart.com`, `mouser.com` и `digikey.com`. Он предоставляет интерфейс для настройки, аутентификации и запуска сценариев, специфичных для каждого поставщика. Клиенты могут расширять этот класс для добавления поддержки новых поставщиков.

## Классы

### `Supplier`

**Описание**: Базовый класс для всех поставщиков.

**Как работает класс**:

Класс `Supplier` предоставляет основу для работы с различными поставщиками данных. Он выполняет следующие функции:

-   Инициализация основных параметров поставщика, таких как префикс, локаль и WebDriver.
-   Загрузка настроек и локаторов, специфичных для каждого поставщика.
-   Аутентификация на сайте поставщика.
-   Выполнение сценариев, определяющих последовательность действий для получения данных.

**Атрибуты**:

-   **`supplier_id`** *(int)*: Уникальный идентификатор поставщика.
-   **`supplier_prefix`** *(str)*: Префикс поставщика, например, `'amazon'`, `'aliexpress'`.
-   **`supplier_settings`** *(dict)*: Настройки поставщика, загружаемые из JSON-файла.
-   **`locale`** *(str)*: Код локализации (по умолчанию: `'en'`).
-   **`price_rule`** *(str)*: Правила расчета цен (например, правила НДС).
-   **`related_modules`** *(module)*: Модули-помощники для работы с конкретным поставщиком.
-   **`scenario_files`** *(list)*: Список файлов сценариев для выполнения.
-   **`current_scenario`** *(dict)*: Выполняемый в текущий момент сценарий.
-   **`login_data`** *(dict)*: Данные для аутентификации.
-   **`locators`** *(dict)*: Словарь локаторов веб-элементов.
-   **`driver`** *(Driver)*: Экземпляр WebDriver для взаимодействия с сайтом поставщика.
-   **`parsing_method`** *(str)*: Метод парсинга данных (например, `'webdriver'`, `'api'`, `'xls'`, `'csv'`).

**Методы**:

-   `__init__`: Конструктор класса.
-   `_payload`: Загружает настройки поставщика и инициализирует WebDriver.
-   `login`: Обрабатывает аутентификацию на сайте поставщика.
-   `run_scenario_files`: Выполняет один или несколько файлов сценариев.
-   `run_scenarios`: Выполняет указанные сценарии.

## Методы

### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs):
    """Инициализация экземпляра Supplier.

    Args:
        supplier_prefix (str): Префикс поставщика.
        locale (str, optional): Код локализации. По умолчанию 'en'.
        webdriver (str | Driver | bool, optional): Тип WebDriver. По умолчанию 'default'.

    Raises:
        DefaultSettingsException: Если настройки по умолчанию не настроены корректно.
    """
```

**Описание**: Инициализирует экземпляр класса `Supplier`.

**Как работает функция**:

Метод `__init__` является конструктором класса `Supplier`. Он принимает префикс поставщика, локаль и тип WebDriver в качестве аргументов. Префикс поставщика используется для загрузки настроек и локаторов, специфичных для данного поставщика. Локаль определяет язык и региональные настройки, используемые при взаимодействии с сайтом поставщика. Тип WebDriver определяет, какой браузер будет использоваться для автоматизации взаимодействия с сайтом.

**Параметры**:

-   `supplier_prefix` (str): Префикс поставщика.
-   `locale` (str, optional): Код локализации. По умолчанию `'en'`.
-   `webdriver` (str | Driver | bool, optional): Тип WebDriver. По умолчанию `'default'`.

**Вызывает исключения**:

-   `DefaultSettingsException`: Если настройки по умолчанию не настроены корректно.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
```

### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
    """Загружает настройки, локаторы и инициализирует WebDriver.

    Args:
        webdriver (str | Driver | bool): Тип WebDriver.

    Returns:
        bool: Возвращает `True`, если загрузка выполнена успешно.
    """
```

**Описание**: Загружает настройки поставщика, локаторы и инициализирует WebDriver.

**Как работает функция**:

Метод `_payload` выполняет загрузку настроек и локаторов, специфичных для каждого поставщика. Он также инициализирует WebDriver, который используется для автоматизации взаимодействия с сайтом поставщика. Метод возвращает `True`, если загрузка выполнена успешно, и `False` в противном случае.

**Параметры**:

-   `webdriver` (str | Driver | bool): Тип WebDriver.

**Возвращает**:

-   `bool`: Возвращает `True`, если загрузка выполнена успешно.

**Примеры**:

```python
supplier._payload(webdriver='firefox')
```

### `login`

```python
def login(self) -> bool:
    """Производит аутентификацию пользователя на сайте поставщика.

    Returns:
        bool: Возвращает `True`, если вход выполнен успешно.
    """
```

**Описание**: Производит аутентификацию пользователя на сайте поставщика.

**Как работает функция**:

Метод `login` выполняет аутентификацию пользователя на сайте поставщика. Он использует данные для входа, хранящиеся в атрибуте `login_data`. Метод возвращает `True`, если вход выполнен успешно, и `False` в противном случае.

**Возвращает**:

-   `bool`: Возвращает `True`, если вход выполнен успешно.

**Примеры**:

```python
supplier.login()
```

### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool:
    """Запускает предоставленные файлы сценариев.

    Args:
        scenario_files (str | List[str], optional): Список или путь к файлам сценариев.

    Returns:
        bool: Возвращает `True`, если сценарии выполнены успешно.
    """
```

**Описание**: Запускает предоставленные файлы сценариев.

**Как работает функция**:

Метод `run_scenario_files` выполняет один или несколько файлов сценариев. Файлы сценариев определяют последовательность действий, которые необходимо выполнить для получения данных с сайта поставщика. Метод возвращает `True`, если все сценарии выполнены успешно, и `False` в противном случае.

**Параметры**:

-   `scenario_files` (str | List[str], optional): Список или путь к файлам сценариев.

**Возвращает**:

-   `bool`: Возвращает `True`, если сценарии выполнены успешно.

**Примеры**:

```python
supplier.run_scenario_files(['example_scenario.json'])
```

### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool:
    """Запускает указанные сценарии.

    Args:
        scenarios (dict | list[dict]): Сценарии для выполнения.

    Returns:
        bool: Возвращает `True`, если все сценарии выполнены успешно.
    """
```

**Описание**: Запускает указанные сценарии.

**Как работает функция**:

Метод `run_scenarios` выполняет указанные сценарии. Сценарии представляют собой словари, определяющие последовательность действий, которые необходимо выполнить для получения данных с сайта поставщика. Метод возвращает `True`, если все сценарии выполнены успешно, и `False` в противном случае.

**Параметры**:

-   `scenarios` (dict | list[dict]): Сценарии для выполнения.

**Возвращает**:

-   `bool`: Возвращает `True`, если все сценарии выполнены успешно.

**Примеры**:

```python
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```