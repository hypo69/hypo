# Документация для модуля автоматизированной отправки сообщений WhatsApp

## Обзор

Данная документация описывает создание и использование скрипта Python для автоматической отправки сообщений через WhatsApp. В руководстве рассматриваются необходимые компоненты, процесс разработки и возможные проблемы с решениями.

## Оглавление

- [Введение](#введение)
- [Необходимые компоненты](#необходимые-компоненты)
- [Процесс разработки](#процесс-разработки)
  - [Функция отправки сообщений (`send_whatsapp_message`)](#функция-отправки-сообщений-send_whatsapp_message)
  - [Банк сообщений](#банк-сообщений)
  - [Пользовательский ввод](#пользовательский-ввод)
  - [Основной цикл отправки](#основной-цикл-отправки)
- [Возможные проблемы и решения](#возможные-проблемы-и-решения)
- [Выполнение скрипта](#выполнение-скрипта)

## Введение

### Назначение

Документ описывает процесс разработки автоматизированного скрипта на языке Python, предназначенного для отправки случайных сообщений WhatsApp в течение определенного периода времени.

### Целевая аудитория

Руководство предназначено для разработчиков, имеющих базовые знания языка Python и понимание работы с командной строкой.

### Предпосылки

Перед использованием данного руководства, необходимо наличие установленного Python 3.6+ и менеджера пакетов `pip`.

## Необходимые компоненты

### Библиотеки Python

- `pywhatkit`: Для взаимодействия с веб-версией WhatsApp и отправки сообщений.
- `pyautogui`: Для автоматизации действий мыши и клавиатуры.
- `pynput`: Для контроля клавиатурного ввода.
- `emoji`: Для добавления эмодзи в сообщения.
- `random`: Для генерации случайных сообщений и времени.
- `time`: Для управления задержками и временем выполнения.

### Зависимости

Установка указанных библиотек выполняется посредством `pip`:

```bash
pip install pywhatkit pyautogui pynput emoji
```

### Требования к системе

Операционная система с установленным веб-браузером (например, Chrome или Firefox) и возможностью подключения к WhatsApp Web.

## Процесс разработки

### Функция отправки сообщений (`send_whatsapp_message`)

**Назначение**: Функция отправляет сообщение WhatsApp заданному номеру телефона в указанное время.

**Как работает функция**:

1.  Использует `pywhatkit.sendwhatmsg` для инициализации отправки сообщения.
2.  Применяет `time.sleep` для задержки загрузки веб-версии WhatsApp.
3.  Использует `pyautogui` и `pynput` для имитации нажатия клавиши "Enter" для отправки сообщения.
4.  Обрабатывает исключения с помощью блока `try...except` для вывода ошибок.

**Параметры**:

- `phone_number` (str): Номер телефона получателя (с кодом страны).
- `message` (str): Текст сообщения.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минуты отправки сообщения (0-59).

**Пример**:

```python
# Пример вызова функции send_whatsapp_message
# send_whatsapp_message('+79991234567', 'Привет!', 10, 30)
```

### Банк сообщений

**Назначение**: Создание списка сообщений для отправки.

**Как работает**:

1.  Создается список строк (`messages`) для хранения сообщений.
2.  Используется `emoji.emojize` для добавления эмодзи.
3.  Применяется `random.choice` для случайного выбора сообщения из списка.

### Пользовательский ввод

**Назначение**: Получение пользовательского ввода для определения параметров отправки сообщений.

**Как работает**:

1.  Получение количества сообщений (`num_messages`) с помощью функции `input`.
2.  Получение начального часа (`start_hour`) и конечного часа (`end_hour`) диапазона отправки с помощью `input`.

### Основной цикл отправки

**Назначение**: Организация цикла отправки сообщений в заданном количестве и временном диапазоне.

**Как работает**:

1.  Цикл `while` выполняется, пока счетчик сообщений (`message_count`) не достигнет заданного количества (`num_messages`).
2.  Генерация случайного часа и минут с помощью `random.randint`.
3.  Вызов функции `send_whatsapp_message` с полученными данными.
4.  Увеличение счетчика сообщений.

## Возможные проблемы и решения

- **Проблемы с `pywhatkit`:** В случае неудачной автоматической отправки сообщения, использовать `pyautogui` и `pynput` для эмуляции нажатия клавиш и отправки сообщения.
- **Подключение к WhatsApp Web:** При первом использовании необходимо подключение к веб-версии WhatsApp через веб-браузер.
- **Динамическая задержка:** Скорость загрузки веб-версии WhatsApp может меняться, поэтому для стабильности увеличьте время задержки.
- **Зависимость от браузера и версии WhatsApp:** Изменения в браузере или веб-версии WhatsApp могут потребовать корректировки скрипта.

## Выполнение скрипта

- Сохраните скрипт в файл с расширением `.py`.
- Выполните скрипт в терминале с помощью команды: `python имя_файла.py`
- Следуйте инструкциям на экране для ввода необходимых данных.