# Модуль `supplier`

## Обзор

Модуль `supplier` содержит класс `Supplier`, который является базовым классом для представления поставщиков. Он управляет загрузкой конфигурации, выполнением сценариев и входом на сайты поставщиков.

## Оглавление

- [Классы](#классы)
  - [`Supplier`](#supplier)
- [Функции](#функции)
  - [`_payload`](#_payload)
  - [`login`](#login)
  - [`run_scenario_files`](#run_scenario_files)
  - [`run_scenarios`](#run_scenarios)

## Классы

### `Supplier`

**Описание**: Базовый класс для представления поставщиков. Управляет загрузкой конфигурации, выполнением сценариев и входом на сайты поставщиков.

**Параметры**:

- `supplier_id` (Optional[str]): Идентификатор поставщика. По умолчанию `None`.
- `supplier_prefix` (str): Префикс поставщика (обязательное поле).
- `locale` (str): Код локали поставщика. По умолчанию `en`.
- `price_rule` (Optional[str]): Правило расчета цен. По умолчанию `None`.
- `related_modules` (Optional[ModuleType]): Модуль, содержащий специфические функции для поставщика. По умолчанию `None`.
- `scenario_files` (List[str]): Список файлов сценариев для поставщика. По умолчанию пустой список `[]`.
- `current_scenario` (Optional[Dict[str, Any]]): Текущий исполняемый сценарий. По умолчанию `None`.
- `locators` (Optional[Dict[str, str]]): Локаторы для элементов страницы. По умолчанию `None`.
- `driver` (Optional[`Driver`]): Экземпляр веб-драйвера. По умолчанию `None`.

**Методы**:

- `__init__(self, **data)`:
    - **Описание**: Инициализирует объект поставщика, загружает настройки через метод `_payload()`.
    - **Параметры**:
        - `data` (Dict[str, Any]): Словарь с данными для инициализации объекта.
    - **Вызывает исключения**:
        - `DefaultSettingsException`: Если загрузка настроек не удалась.

- `_payload(self)`:
    - **Описание**: Загружает настройки поставщика из JSON-файла, используя `j_loads_ns`, и динамически импортирует модуль, связанный с поставщиком.
    - **Возвращает**:
        - `bool`: `True`, если настройки успешно загружены, `False` в противном случае.

- `login(self)`:
    - **Описание**: Выполняет вход на сайт поставщика, вызывая метод `login` из модуля, связанного с поставщиком.
    - **Возвращает**:
        - `bool | None`: `True`, если вход успешен, `False`, если вход не удался или `None`, если метод `login` не реализован.

- `run_scenario_files(self, scenario_files: Optional[str | List[str]] = None)`:
    - **Описание**: Выполняет сценарии, указанные в файлах.
    - **Параметры**:
        - `scenario_files` (Optional[str | List[str]], optional): Список файлов сценариев или путь к одному файлу. Если не указан, использует `self.scenario_files`. По умолчанию `None`.
    - **Возвращает**:
        - `bool`: `True`, если все сценарии выполнены успешно, `False` в противном случае.

- `run_scenarios(self, scenarios: dict | List[dict])`:
    - **Описание**: Выполняет сценарии, переданные как словарь или список словарей.
    - **Параметры**:
        - `scenarios` (dict | List[dict]): Словарь или список словарей, представляющих сценарии.
    - **Возвращает**:
       -  `bool`: `True`, если все сценарии выполнены успешно, `False` в противном случае.

- `check_supplier_prefix(cls, value)`:
    - **Описание**: Валидатор для проверки, что `supplier_prefix` не пустая строка.
    - **Параметры**:
        - `value` (str): Значение `supplier_prefix`.
    - **Возвращает**:
        - `str`: Проверенное значение `value`
    - **Вызывает исключения**:
        - `ValueError`: Если `value` пустая строка.

## Функции

### `_payload`

**Описание**: Загружает настройки поставщика из JSON-файла.

**Параметры**:
-   `self` (Supplier): Экземпляр класса `Supplier`.

**Возвращает**:
-   `bool`: `True` в случае успешной загрузки, `False` в случае ошибки.

**Детали**:
    - Загружает конфигурационные данные поставщика (правила цен, локаль, файлы сценариев, локаторы) и сохраняет их в атрибуты объекта поставщика.
    - Использует `j_loads_ns` для загрузки данных из JSON-файла.
    - Динамически импортирует модуль поставщика, используя `importlib`.

### `login`

**Описание**: Выполняет вход на сайт поставщика.

**Параметры**:
-   `self` (Supplier): Экземпляр класса `Supplier`.

**Возвращает**:
-   `bool | None`: `True` в случае успешного входа, `False` если вход не удался или `None`, если метод `login` не реализован в модуле поставщика.

**Детали**:
-   Вызывает метод `login` из динамически загруженного модуля поставщика.
-   Если модуль не реализует метод `login`, возвращает `None`.

### `run_scenario_files`

**Описание**: Выполняет сценарии, указанные в файлах.

**Параметры**:
-   `self` (Supplier): Экземпляр класса `Supplier`.
-   `scenario_files` (Optional[str | List[str]]): Список файлов сценариев или путь к одному файлу. Если не указан, использует `self.scenario_files`. По умолчанию `None`.

**Возвращает**:
-   `bool`: `True`, если все сценарии выполнены успешно, `False` в противном случае.

**Детали**:
-   Вызывает функцию `run_scenario_files` из модуля `src.scenario` для выполнения сценариев.
-   Если `scenario_files` не указан, то используется `self.scenario_files`

### `run_scenarios`

**Описание**: Выполняет один или несколько сценариев.

**Параметры**:
-   `self` (Supplier): Экземпляр класса `Supplier`.
-   `scenarios` (dict | List[dict]): Словарь или список словарей, представляющих сценарии.

**Возвращает**:
-   `bool`: `True`, если все сценарии выполнены успешно, `False` в противном случае.

**Детали**:
-   Вызывает функцию `run_scenarios` из модуля `src.scenario` для выполнения сценариев.