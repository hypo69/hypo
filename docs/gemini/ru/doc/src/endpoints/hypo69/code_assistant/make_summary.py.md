# Модуль `src.endpoints.hypo69.code_assistant.make_summary`

## Обзор

Модуль `src.endpoints.hypo69.code_assistant.make_summary` предназначен для создания файла `SUMMARY.md`, который используется для компиляции документации с помощью `mdbook`. Он рекурсивно обходит указанную директорию, формируя оглавление из `.md` файлов. Поддерживается фильтрация файлов по языку (русский или английский).

## Подробней

Этот модуль автоматизирует создание файла `SUMMARY.md`, необходимого для генерации документации с использованием `mdbook`. Он сканирует указанную директорию (`src`), находит все `.md` файлы и добавляет их в оглавление `SUMMARY.md`.  Код фильтрует файлы по языковому признаку (окончание `.ru.md` для русских файлов) и формирует ссылки на эти файлы, используя относительные пути.  Полученный файл `SUMMARY.md` сохраняется в директории `docs`, соответствующей структуре проекта.

## Функции

### `make_summary`

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md, рекурсивно обходя папку.

    Args:
        docs_dir (Path): Путь к исходной директории 'src'.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Как работает функция**:
1. Функция `make_summary` принимает путь к исходной директории (`docs_dir`) и язык фильтрации (`lang`) в качестве аргументов.
2. Сначала формируется путь к файлу `SUMMARY.md` с помощью функции `prepare_summary_path`.
3. Создается директория для файла `SUMMARY.md`, если она не существует.
4. Вызывается внутренняя функция `_make_summary` для рекурсивного обхода директории и создания содержимого файла `SUMMARY.md`.

**Параметры**:
- `docs_dir` (Path): Путь к исходной директории `src`.
- `lang` (str): Язык фильтрации файлов. Возможные значения: `ru` или `en`. По умолчанию `'en'`.

**Возвращает**:
- `None`: Функция ничего не возвращает.

**Вызывает исключения**:
- Отсутствуют явные исключения, но могут возникнуть исключения при работе с файловой системой.

### `_make_summary`

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Как работает функция**:

1. Функция `_make_summary` рекурсивно обходит указанную директорию (`src_dir`) и создает файл `SUMMARY.md` с главами, основанными на `.md` файлах.
2. Проверяется, существует ли уже файл `SUMMARY.md`. Если да, то выводится сообщение о том, что он будет перезаписан.
3. Открывается файл `SUMMARY.md` для записи с кодировкой UTF-8.
4. Записывается заголовок `# Summary\n\n`.
5. Перебираются все `.md` файлы в директории `src_dir` и её поддиректориях.
6. Исключается файл `SUMMARY.md` из обработки.
7. Файлы фильтруются по языку в зависимости от значения параметра `lang`.
8. Формируется относительный путь к файлу и записывается строка в формате `- [{path.stem}]({relative_path.as_posix()})\n` в файл `SUMMARY.md`.
9. В случае успешного выполнения возвращается `True`, иначе `False`.

**Параметры**:
- `src_dir` (Path): Путь к папке с исходными `.md` файлами.
- `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`.
- `lang` (str): Язык фильтрации файлов. Возможные значения: `ru` или `en`. По умолчанию `'en'`.

**Возвращает**:
- `bool`: `True`, если файл успешно создан, `False` в случае ошибки.

**Вызывает исключения**:
- `Exception`: В случае ошибки при создании файла.

### `prepare_summary_path`

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути 'src' на 'docs' и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с 'src'.
        file_name (str): Имя файла, который нужно создать. По умолчанию 'SUMMARY.md'.

    Returns:
        Path: Новый путь к файлу.
    """
    ...
```

**Как работает функция**:

1. Функция `prepare_summary_path` формирует путь к файлу `SUMMARY.md`, заменяя часть пути `src` на `docs` и добавляя имя файла.
2. Определяется новый путь к директории `docs` на основе корневого пути проекта.
3. Формируется полный путь к файлу `SUMMARY.md` путем объединения нового пути к директории и имени файла.

**Параметры**:
- `src_dir` (Path): Исходный путь с `src`.
- `file_name` (str): Имя файла, который нужно создать. По умолчанию `'SUMMARY.md'`.

**Возвращает**:
- `Path`: Новый путь к файлу.