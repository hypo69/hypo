# Модуль _experiments.kazarinov

## Обзор

Модуль `_experiments.kazarinov` представляет собой экспериментальный модуль для взаимодействия с OpenAI API. Он включает в себя функциональность для инициализации чата с использованием OpenAI, отправки запросов и получения ответов. Модуль предоставляет класс `OpenAIChat` для управления сессией чата и функцию `chat` для интерактивного взаимодействия с пользователем.

## Подробней

Модуль предназначен для экспериментов с OpenAI API и может использоваться для создания чат-ботов или других приложений, требующих взаимодействия с OpenAI.

Модуль содержит следующие компоненты:

- Загрузка системной инструкции из файла `system_instruction.txt`.
- Класс `OpenAIChat` для управления сессией чата с OpenAI.
- Функция `chat` для интерактивного взаимодействия с пользователем.

## Классы

### `OpenAIChat`

**Описание**: Класс `OpenAIChat` предназначен для управления сессией чата с OpenAI. Он инициализирует API-ключ, загружает системную инструкцию и предоставляет метод `ask` для отправки запросов и получения ответов.

**Как работает класс**:

1.  При инициализации класса `OpenAIChat` устанавливается API-ключ OpenAI и загружается системная инструкция.
2.  Если системная инструкция предоставлена, она добавляется в список сообщений в качестве первого сообщения с ролью "system".
3.  Метод `ask` отправляет запрос в модель OpenAI и получает ответ. Запрос добавляется в список сообщений с ролью "user", а ответ добавляется в список сообщений с ролью "assistant".

**Методы**:

*   `__init__(self, api_key: str, system_instruction: str = None)`: Инициализация класса `OpenAIChat`.
*   `ask(self, prompt: str) -> str`: Отправка вопроса в модель OpenAI и получение ответа.

#### `__init__`

```python
def __init__(self, api_key: str, system_instruction: str = None):
    """
    Инициализация класса OpenAIChat.

    Args:
        api_key (str): API-ключ OpenAI.
        system_instruction (str, optional): Системная инструкция для модели. По умолчанию None.
    """
    ...
```

**Как работает функция**:

1.  Устанавливает API-ключ OpenAI.
2.  Инициализирует атрибут `system_instruction` значением, переданным в аргументе `system_instruction`.
3.  Инициализирует пустой список `messages` для хранения сообщений чата.
4.  Если `system_instruction` не равен `None`, добавляет системное сообщение с ролью "system" и содержимым `system_instruction` в список `messages`.

**Параметры**:

*   `api_key` (str): API-ключ OpenAI.
*   `system_instruction` (str, optional): Системная инструкция для модели. По умолчанию `None`.

**Возвращает**:

*   Нет.

#### `ask`

```python
def ask(self, prompt: str) -> str:
    """Отправка вопроса в модель OpenAI и получение ответа"""
    ...
```

**Как работает функция**:

1.  Добавляет сообщение пользователя с ролью "user" и содержимым `prompt` в список `messages`.
2.  Вызывает API OpenAI для создания ответа на основе списка сообщений.
3.  Извлекает содержимое ответа из результата API и добавляет его в список `messages` с ролью "assistant".
4.  Возвращает содержимое ответа.
5.  В случае ошибки логирует сообщение об ошибке и возвращает сообщение об ошибке.

**Параметры**:

*   `prompt` (str): Вопрос пользователя.

**Возвращает**:

*   `str`: Ответ модели OpenAI.

**Вызывает исключения**:

*   `Exception`: Если возникает ошибка при вызове API OpenAI.

## Функции

### `chat`

```python
def chat():
    """ """
    ...
```

**Как работает функция**:

1.  Выводит приветственные сообщения.
2.  Запрашивает у пользователя API-ключ OpenAI.
3.  Инициализирует экземпляр класса `OpenAIChat` с использованием предоставленного API-ключа и системной инструкции.
4.  Входит в бесконечный цикл, в котором запрашивает у пользователя вопрос, отправляет его в модель OpenAI и выводит полученный ответ.
5.  Если пользователь вводит "exit", завершает цикл и выводит сообщение о завершении чата.

**Параметры**:

*   Нет.

**Возвращает**:

*   Нет.