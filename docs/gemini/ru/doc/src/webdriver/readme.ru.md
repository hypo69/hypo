# Модуль WebDriver Executor: Руководство

## Обзор

Модуль `WebDriver Executor` предоставляет фреймворк для навигации и взаимодействия с веб-страницами с использованием WebDriver. Он обрабатывает скрипты и локаторы для выполнения автоматизированных действий с веб-элементами.

## Основные функции

- **Обработка локаторов:**
  - **Инициализация:** Класс `ExecuteLocator` инициализируется экземпляром WebDriver и, необязательно, списком аргументов и ключевых аргументов. Он настраивает WebDriver и цепочки действий для взаимодействия с веб-элементами.
  - **Выполнение локатора:** Метод `execute_locator` обрабатывает словарь локатора, содержащий информацию о том, как найти и взаимодействовать с веб-элементами. Он обрабатывает различные типы локаторов и действий на основе предоставленной конфигурации.
  - **Получение элемента:** Метод `get_webelement_by_locator` получает веб-элементы на основе информации локатора (например, XPath, ID или CSS-селекторы). Он ожидает появления элементов и может вернуть один элемент, список элементов или `False`, если элементы не найдены.
  - **Получение атрибута:** Метод `get_attribute_by_locator` получает атрибуты найденных элементов по локатору. Поддерживает как отдельные, так и множественные элементы.
  - **Отправка сообщения:** Метод `send_message` отправляет текстовый ввод в веб-элементы. Поддерживает имитацию набора текста с настраиваемой скоростью и необязательным взаимодействием с мышкой.

- **Скриншоты:**
  - **Скриншот элемента:** Метод `get_webelement_as_screenshot` делает скриншот веб-элемента и возвращает его в формате PNG. Поддерживает захват скриншотов нескольких элементов и обрабатывает ошибки, если элементы больше не присутствуют в DOM.

- **Действие клика:**
  - **Клик по элементу:** Метод `click` выполняет действие клика по веб-элементу, идентифицированному локатором. Обрабатывает случаи, когда клик приводит к переходу на новую страницу или открытию нового окна. Записывает ошибки, если клик не выполняется.

- **Оценивание локатора:**
  - **Оценивание атрибутов:** Метод `evaluate_locator` оценивает атрибуты локатора, включая обработку специальных случаев, когда атрибуты представлены как плейсхолдеры (например, `%EXTERNAL_MESSAGE%`).


## Обработка ошибок

Модуль использует блоки `try-except` для перехвата и записи ошибок во время различных операций, таких как поиск элементов, отправка сообщений и захват скриншотов. Конкретные исключения, такие как `NoSuchElementException` и `TimeoutException`, перехватываются для обработки случаев, когда элементы не найдены или истекает время ожидания.


## Использование

### Инициализация

Создайте экземпляр `ExecuteLocator` с экземпляром WebDriver.

### Выполнение локатора

Вызовите метод `execute_locator` со словарем локатора для выполнения действий или получения данных от веб-элементов.

### Обработка результатов

Используйте методы, такие как `get_webelement_by_locator`, `send_message` и `get_webelement_as_screenshot`, для взаимодействия с веб-элементами и обработки результатов.


## Зависимости

Модуль использует Selenium для операций с WebDriver, включая поиск элементов, отправку нажатий клавиш и взаимодействие со страницами. Он также использует встроенные библиотеки Python для обработки исключений и управления временем.


## Примеры использования

См. примеры в исходном коде.


## Документация по другим модулям

- [Документация по классу `Driver`](https://github.com/hypo69/hypo/tree/master/src/webdriver/driver.ru.md)
- [Документация по классу `Executor`](https://github.com/hypo69/hypo/tree/master/src/webdriver/executor.ru.md)
- [Документация по локаторам](https://github.com/hypo69/hypo/tree/master/src/webdriver/locator.ru.md)


**Примечание:**  Для корректной работы необходимо убедиться, что установлены необходимые библиотеки, такие как Selenium.  Пути к файлам настроек и другие ресурсы должны быть правильно настроены в `gs` (глобальные настройки).