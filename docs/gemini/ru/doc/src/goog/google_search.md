# Модуль google_search

## Обзор

Модуль `google_search` содержит класс `GoogleHtmlParser` для парсинга HTML-страниц поисковой выдачи Google.  Он позволяет извлечь органические результаты, карточки знаний, featured snippet и данные из скроллируемых виджетов.  Модуль обрабатывает как мобильную, так и десктопную версии HTML.

## Оглавление

- [Модуль google_search](#модуль-google_search)
- [Обзор](#обзор)
- [Класс GoogleHtmlParser](#класс-googlehtmlparser)
    - [`__init__`](#__init__)
    - [\_clean](#_clean)
    - [\_normalize\_dict\_key](#_normalize_dict_key)
    - [\_get\_estimated\_results](#_get_estimated_results)
    - [\_get\_organic](#_get_organic)
    - [\_get\_featured\_snippet](#_get_featured_snippet)
    - [\_get\_knowledge\_card](#_get_knowledge_card)
    - [\_get\_scrolling\_sections](#_get_scrolling_sections)
    - [get\_data](#get_data)

## Класс `GoogleHtmlParser`

**Описание**:  Класс для парсинга HTML с Google Search. Парсит HTML страницы поисковой выдачи Google и преобразует её в словарь. Работает как с мобильной, так и с десктопной версией HTML.

**Атрибуты**:

- `tree` (html.Element): Дерево документа, полученное через `html.fromstring()`.
- `user_agent` (str): User agent, использованный для получения HTML Google Search.


### `__init__`

**Описание**: Инициализация парсера. Создает дерево документа из строки HTML.

**Параметры**:

- `html_str` (str): HTML Google Search в виде строки.
- `user_agent` (str, optional): User agent для получения HTML. Может быть 'mobile' или 'desktop'. По умолчанию 'desktop'.

**Возвращает**:
- `None`


### `_clean`

**Описание**: Очистка строки от лишних символов. Очищает строку от пробелов и лишних символов.

**Параметры**:

- `content` (str): Строка для очистки.

**Возвращает**:
- `str`: Очищенная строка.

### `_normalize_dict_key`

**Описание**: Нормализация строки для использования в качестве ключа словаря. Заменяет пробелы на подчеркивания, убирает двоеточия, приводит к нижнему регистру.

**Параметры**:

- `content` (str): Строка для нормализации.

**Возвращает**:
- `str`: Нормализованная строка.

### `_get_estimated_results`

**Описание**: Получение количества результатов поиска. Возвращает количество найденных результатов для десктопной версии Google Search.

**Возвращает**:
- `int`: Число результатов поиска.


### `_get_organic`

**Описание**: Получение органических результатов поиска. Возвращает список органических результатов без дополнительных фич (snippet, featured snippet и т.д.).

**Возвращает**:
- `list`: Список словарей с органическими результатами.


### `_get_featured_snippet`

**Описание**: Получение featured snippet. Если существует, возвращает featured snippet с заголовком и URL.

**Возвращает**:
- `dict | None`: Словарь с заголовком и URL или `None`.


### `_get_knowledge_card`

**Описание**: Получение карточки знаний. Возвращает карточку знаний с заголовком, подзаголовком и описанием, если существует.

**Возвращает**:
- `dict | None`: Словарь с данными карточки знаний или `None`.

### `_get_scrolling_sections`

**Описание**: Получение данных из скроллируемых виджетов. Возвращает список данных из виджетов, например, топовые истории или твиты.

**Возвращает**:
- `list`: Список словарей с данными из виджетов.


### `get_data`

**Описание**: Получение итоговых данных с поисковой страницы. Собирает данные с результатов поиска: органические результаты, карточка знаний и др.

**Возвращает**:
- `dict`: Словарь с данными поисковой страницы.