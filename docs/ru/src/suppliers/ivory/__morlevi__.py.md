# Модуль `__morlevi__.py`

## Обзор

Модуль `__morlevi__.py` предназначен для работы с поставщиком Morlevi. Он включает в себя функции для авторизации на сайте поставщика, сбора информации о продуктах и навигации по категориям.

## Подробнее

Модуль содержит функции для логина на сайт `morlevi.co.il`, извлечения информации о товарах с отдельных страниц и получения списка товаров из категорий с учетом пагинации. Он использует библиотеки `pathlib`, `requests`, `pandas` и `selenium` для выполнения HTTP-запросов и парсинга HTML-страниц. Модуль также включает классы `Product` и `StringFormatter` для представления данных о продуктах и форматирования строк.

## Функции

### `login`

```python
def login(supplier):
    """
    Выполняет авторизацию на сайте поставщика Morlevi.

    Args:
        supplier: Объект поставщика, содержащий настройки и драйвер.

    Returns:
        bool: `True`, если вход выполнен успешно, иначе `None`.

    Raises:
        Exception: Если не удается закрыть всплывающее окно или войти в систему.

    Как работает функция:
     1. Функция пытается войти на сайт `morlevi.co.il`.
     2. Если вход не удался, пытается закрыть модальные окна сайта и повторить вход.
     3. Использует локаторы для поиска элементов на странице и выполнения действий (нажатий, ввода данных).

     Внутри функции происхоят следующие действия и преобразования:
     Открытие страницы -> Попытка входа -> Закрытие всплывающих окон (если необходимо) -> Повторная попытка входа
    """
```

### `_login`

```python
def _login(_s):
    """
    Внутренняя функция для выполнения фактического входа в систему Morlevi.

    Args:
        _s: Объект поставщика, содержащий настройки и драйвер.

    Returns:
        bool: `True`, если вход выполнен успешно, иначе `None`.

    Raises:
        Exception: Если возникает ошибка во время входа в систему.

    Как работает функция:
     1. Обновляет страницу для избежания проблем с устаревшими элементами.
     2. Использует локаторы для поиска полей ввода email, пароля и кнопки входа.
     3. Выполняет ввод данных и нажатие кнопки входа.

     Внутри функции происхоят следующие действия и преобразования:
     Обновление страницы -> Поиск элементов для ввода данных -> Ввод данных -> Нажатие кнопки входа
    """
```

### `grab_product_page`

```python
def grab_product_page(s):
    """
    Извлекает информацию о продукте со страницы товара.

    Args:
        s: Объект поставщика, содержащий настройки, драйвер и локаторы.

    Returns:
        Product: Объект `Product`, содержащий извлеченную информацию о продукте.

    Raises:
        Exception: Если не удается найти цену товара.

    Как работает функция:
     1. Функция создает экземпляр класса `Product`
     2. Закрывает модальное окно, которое может появиться на странице.
     3. Использует внутренние функции (`set_id`, `set_sku_suppl` и т.д.) для извлечения и установки различных полей продукта.
     4. Возвращает заполненный объект `Product`.

    Внутри функции происхоят следующие действия и преобразования:
     Создание экземпляра `Product` -> Закрытие модального окна -> Извлечение и установка ID товара -> Извлечение и установка SKU поставщика -> Извлечение и установка SKU товара -> Извлечение и установка заголовка -> Извлечение и установка цены -> Извлечение и установка описания -> Извлечение и установка изображений
    """
    def set_id():
        """
        Извлекает и устанавливает ID продукта.
        """
    def set_sku_suppl():
        """
        Устанавливает SKU поставщика на основе ID продукта.
        """
    def set_sku_prod():
        """
        Формирует и устанавливает SKU товара на основе ID продукта.
        """
    def set_title():
        """
        Устанавливает заголовок продукта, беря его из заголовка страницы.
        """
    def set_summary():
        """
        Извлекает и устанавливает краткое описание продукта.
        """
    def set_description():
        """
        Извлекает и устанавливает полное описание продукта.
        """
    def set_cost_price():
        """
        Извлекает и устанавливает цену продукта, применяя правила форматирования.
        """
    def set_before_tax_price():
        """
        Устанавливает цену продукта без учета налога.
        """
    def set_delivery():
        """
        Устанавливает информацию о доставке продукта (TODO: перенести в комбинации).
        """
    def set_images(via_ftp=False):
        """
        Извлекает и устанавливает URL изображения продукта.
        """
    def set_combinations():
        """
        Устанавливает комбинации продукта (TODO).
        """
    def set_qty():
        """
        Устанавливает количество продукта (TODO).
        """
    def set_specification():
        """
        Извлекает и устанавливает спецификацию продукта.
        """
    def set_customer_reviews():
        """
        Устанавливает отзывы клиентов о продукте (TODO).
        """
    def set_supplier():
        """
        Устанавливает ID поставщика.
        """
    def set_rewritted_URL():
        """
        Устанавливает переписанный URL продукта (TODO).
        """
```

### `list_products_in_category_from_pagination`

```python
def list_products_in_category_from_pagination(supplier):
    """
    Получает список ссылок на продукты в категории, учитывая пагинацию.

    Args:
        supplier: Объект поставщика, содержащий настройки, драйвер и локаторы.

    Returns:
        list: Список URL-адресов продуктов в категории.

    Как работает функция:
     1. Функция получает список товаров на странице категории.
     2. Если список пуст, возвращает пустой список.
     3. Если товары найдены, добавляет их в общий список.
     4. Переходит по страницам пагинации и добавляет товары с каждой страницы.
     5. Удаляет дубликаты из списка и возвращает его.

    Внутри функции происхоят следующие действия и преобразования:
     Получение списка товаров с текущей страницы -> Проверка на пустоту списка -> Добавление товаров в общий список -> Переход на следующую страницу -> Повторение процесса для каждой страницы -> Удаление дубликатов
    """
```

### `get_list_products_in_category`

```python
def get_list_products_in_category(s, scenario, presath):
    """
    Получает список продуктов в категории.

    Args:
        s: Supplier
        scenario: JSON
        presath: PrestaShopWebServiceDict
    """
```

### `get_list_categories_from_site`

```python
def get_list_categories_from_site(s, scenario_file, brand=''):
    """
    ...
    """