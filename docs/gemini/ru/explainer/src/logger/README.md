# Документация модуля `src.logger`

## <input code>

```
### Документация для модуля `src.logger`

Модуль `src.logger` предоставляет гибкую систему логирования, поддерживающую консольное, файловое и JSON-логирование. Он использует паттерн Singleton, чтобы гарантировать, что в приложении используется только один экземпляр логгера. Логгер поддерживает различные уровни логирования (например, `INFO`, `ERROR`, `DEBUG`) и включает цветной вывод для консольных логов. Также можно настраивать форматы вывода логов и управлять логированием в различные файлы.

---

### Классы:
- **SingletonMeta**: Метакласс, реализующий паттерн Singleton для логгера.
- **JsonFormatter**: Пользовательский форматер, который выводит логи в формате JSON.
- **Logger**: Основной класс логгера, поддерживающий консольное, файловое и JSON-логирование.

---

### Функции:

#### `__init__`
Инициализирует экземпляр `Logger` с заглушками для различных типов логгеров (консоль, файл и JSON).

#### `_configure_logger(name: str, log_path: str, level: Optional[int] = logging.DEBUG, formatter: Optional[logging.Formatter] = None, mode: Optional[str] = 'a') -> logging.Logger`
Конфигурирует и возвращает экземпляр логгера.

**Параметры:**
- `name`: Имя логгера.
- `log_path`: Путь к файлу лога.
- `level`: Уровень логирования, например, `logging.DEBUG`. По умолчанию `logging.DEBUG`.
- `formatter`: Пользовательский форматер (необязательно).
- `mode`: Режим файла, например, `'a'` для добавления (по умолчанию).

**Возвращает:** Экземпляр настроенного логгера `logging.Logger`.

#### `initialize_loggers(info_log_path: Optional[str] = '', debug_log_path: Optional[str] = '', errors_log_path: Optional[str] = '', json_log_path: Optional[str] = '')`
Инициализирует логгеры для консольного и файлового логирования (информация, отладка, ошибка и JSON).

**Параметры:**
- `info_log_path`: Путь к файлу лога информации (необязательно).
- `debug_log_path`: Путь к файлу лога отладки (необязательно).
- `errors_log_path`: Путь к файлу лога ошибок (необязательно).
- `json_log_path`: Путь к файлу лога в формате JSON (необязательно).

#### `log(level, message, ex=None, exc_info=False, color=None)`
Записывает сообщение на указанном уровне (например, `INFO`, `DEBUG`, `ERROR`) с необязательными исключениями и форматированием цвета.

#### `info(message, ex=None, exc_info=False, colors: Optional[tuple] = None)`
Записывает сообщение уровня информации.

#### `success(message, ex=None, exc_info=False, colors: Optional[tuple] = None)`
Записывает сообщение об успехе.

#### `warning(message, ex=None, exc_info=False, colors: Optional[tuple] = None)`
Записывает предупреждение.

#### `debug(message, ex=None, exc_info=True, colors: Optional[tuple] = None)`
Записывает сообщение отладки.

#### `error(message, ex=None, exc_info=True, colors: Optional[tuple] = None)`
Записывает сообщение об ошибке.

#### `critical(message, ex=None, exc_info=True, colors: Optional[tuple] = None)`
Записывает критическое сообщение.


---

### Параметры для логгера
Класс `Logger` принимает несколько необязательных параметров для настройки поведения логирования.

- **Уровень**: Управляет серьезностью регистрируемых логов. Общие уровни:
  - `logging.DEBUG`: Детальная информация, полезная для диагностики проблем.
  - `logging.INFO`: Общая информация, например, успешные операции.
  - `logging.WARNING`: Предупреждения, которые не требуют немедленного действия.
  - `logging.ERROR`: Сообщения об ошибках.
  - `logging.CRITICAL`: Критические ошибки, требующие немедленного внимания.

- **Форматировщик**: Определяет, как форматируются сообщения лога. По умолчанию сообщения форматируются как `'%(asctime)s - %(levelname)s - %(message)s'`. Можно указать пользовательский форматер для разных форматов, например, JSON.

- **Цвет**: Цвета сообщений лога в консоли. Цвета задаются как кортеж с двумя элементами:
  - **Цвет текста**: Указывает цвет текста (например, `colorama.Fore.RED`).
  - **Цвет фона**: Указывает цвет фона (например, `colorama.Back.WHITE`).

Цвет можно настраивать для разных уровней логирования (например, зелёный для информации, красный для ошибок).


---

### Настройка файлового логирования (`config`)
Для записи сообщений в файл можно указать пути к файлам в конфигурации.

```python
config = {
    'info_log_path': 'logs/info.log',
    'debug_log_path': 'logs/debug.log',
    'errors_log_path': 'logs/errors.log',
    'json_log_path': 'logs/log.json'
}
```

Пути к файлам, указанные в `config`, используются для записи логов в соответствующие файлы для каждого уровня логирования.

---

### Пример использования

#### 1. Инициализация логгера:
```python
logger: Logger = Logger()
config = {
    'info_log_path': 'logs/info.log',
    'debug_log_path': 'logs/debug.log',
    'errors_log_path': 'logs/errors.log',
    'json_log_path': 'logs/log.json'
}
logger.initialize_loggers(**config)
```

#### 2. Логирование сообщений на разных уровнях:
```python
logger.info('Это сообщение информации')
logger.success('Это сообщение успеха')
logger.warning('Это предупреждение')
logger.debug('Это сообщение отладки')
logger.error('Это сообщение об ошибке')
logger.critical('Это критическое сообщение')
```

#### 3. Настройка цветов:
```python
logger.info('Это сообщение будет зелёного цвета', colors=(colorama.Fore.GREEN, colorama.Back.BLACK))
logger.error('Это сообщение с красным фоном', colors=(colorama.Fore.WHITE, colorama.Back.RED))
```

---

### Заключение
Этот модуль предоставляет полную и гибкую систему логирования для приложений Python. Можно настроить консольное и файловое логирование с различными форматами и цветами, управлять уровнями логирования и обрабатывать исключения. Конфигурация для файлового логирования хранится в словаре `config`, что позволяет легко настроить её.
```

## <algorithm>

(Блок-схема отсутствует, т.к. это текстовое описание кода, а не код программы)

Алгоритм работы модуля `src.logger` основан на настройке и использовании объекта `logging.Logger` с использованием паттерна Singleton. 
Функция `initialize_loggers` создаёт и конфигурирует логгеры для разных уровней логирования (info, debug, error, JSON), записывая их в указанные файлы.
Функции `log`, `info`, `success`, `warning`, `debug`, `error`, `critical` обрабатывают входящие сообщения, устанавливая уровень логирования и отправляя их в созданные логгеры.



## <mermaid>

```mermaid
graph TD
    subgraph "src.logger"
        A[Logger] --> B(initialize_loggers);
        B --> C{Config};
        C -.> D[info_log];
        C -.> E[debug_log];
        C -.> F[error_log];
        C -.> G[json_log];
        D -.> H[Create info logger];
        E -.> I[Create debug logger];
        F -.> J[Create error logger];
        G -.> K[Create JSON logger];
        subgraph "Logging functions"
            L[log] --> M[info/error/etc];
            M --> N[message];
            N --> O{Level check};
            O --Level match--> P[write to appropriate logger];
            O --Level mismatch--> Q[skip];
        end
    end
    style A fill:#ccf;
```


## <explanation>

**Импорты:**  Код не содержит явных импортов. Предполагается, что он импортирует необходимые модули (например, `logging`, `colorama`), которые используются для логирования и форматирования вывода в консоли.
`Optional` и `logging` — это встроенные модули Python, предоставляющие функциональность для обработки необязательных параметров и логирования, соответственно.

**Классы:**

* **`SingletonMeta`**:  Метакласс, который обеспечивает реализацию паттерна Singleton для класса `Logger`. Это гарантирует, что в приложении существует только один экземпляр `Logger`. 
* **`JsonFormatter`**:  Пользовательский форматер для вывода сообщений в формате JSON. Позволяет настроить специфический формат вывода.
* **`Logger`**:  Главный класс для логирования. Он хранит экземпляры логгеров для разных уровней и путей, обрабатывает входные сообщения и направляет их на соответствующие логгеры, управляет файлами и уровнями логирования.


**Функции:**

* **`__init__`**: Инициализирует логгер, но не отвечает за логирование непосредственно.
* **`_configure_logger`**:  Настраивает экземпляр `logging.Logger`. Принимает имя логгера, путь к файлу, уровень, форматер и режим файла.  Ключевой метод, выполняющий конфигурацию логирования.
* **`initialize_loggers`**:  Инициализирует логгеры для разных уровней логирования, создавая соответствующие экземпляры `logging.Logger` и настраивая их для работы с файлами. Важно для настройки файлового логирования.
* **`log`, `info`, `success`, `warning`, `debug`, `error`, `critical`**:  Функции для записи сообщений различных уровней в лог.  Принимают сообщение, опционально исключение и информацию об ошибке, а также необязательный параметр `colors` для настройки форматирования в консоли.


**Переменные:**
* `config`: Словарь, содержащий конфигурацию для путей к файлам логов.
* `logger`: Переменная, хранящая экземпляр класса `Logger`.

**Возможные ошибки или области для улучшений:**

* Отсутствие проверки на существование файлов или путей перед созданием логгеров. Если файл не существует, то будет исключение. Необходимо добавить проверку или предложить способ создания директории, если она не существует.
* Отсутствие явной обработки исключений. Было бы хорошо добавить обработку исключений `IOError` или аналогичных при работе с файлами.
* Отсутствие описания зависимостей от других модулей (вроде `colorama`). В примере использования упоминается `colorama`, но импорт не показан.


**Взаимосвязь с другими частями проекта:**

Этот модуль `src.logger` напрямую взаимодействует с модулем `logging` (или аналогичным).  Проект использует его для логирования событий и информации.  Непосредственная взаимосвязь с другими частями приложения зависит от того, как используется `Logger`.