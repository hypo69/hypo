# Модуль для отправки сообщений в WhatsApp
## Обзор

Модуль предназначен для автоматической отправки сообщений в WhatsApp с использованием библиотеки `pywhatkit` и `pyautogui`. Он предоставляет функцию для отправки сообщений по заданному номеру телефона, времени и тексту. Также в коде реализован выбор случайного сообщения из предопределенного списка и отправка заданного количества сообщений в случайное время в указанном диапазоне часов.

## Подробней

Модуль автоматизирует процесс отправки сообщений в WhatsApp через веб-интерфейс. Сначала пользователь вводит номер телефона, количество сообщений для отправки, начальный и конечный час для отправки. Затем программа выбирает случайное сообщение из списка, генерирует случайное время в заданном диапазоне и отправляет сообщение. Для отправки сообщений используется библиотека `pywhatkit`, а для эмуляции нажатия клавиши Enter используется библиотека `pyautogui`.

## Функции

### `send_whatsapp_message`

```python
def send_whatsapp_message(phone_number, message, hour, minutes):
    """Sends a WhatsApp message using pywhatkit and pyautogui."""
```

**Назначение**: Отправляет сообщение WhatsApp с использованием библиотек `pywhatkit` и `pyautogui`.

**Параметры**:
- `phone_number` (str): Номер телефона получателя с кодом страны.
- `message` (str): Текст сообщения для отправки.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минута отправки сообщения (0-59).

**Возвращает**:
- `None`

**Вызывает исключения**:
- `Exception`: Если происходит ошибка при отправке сообщения.

**Как работает функция**:

1.  Функция `send_whatsapp_message` использует `pywhatkit.sendwhatmsg` для отправки сообщения через WhatsApp Web. `pywhatkit` автоматически открывает веб-версию WhatsApp в браузере и вводит сообщение.
2.  Функция ожидает 20 секунд, чтобы дать время для загрузки WhatsApp Web.
3.  Имитируется нажатие клавиши Enter с помощью `pyautogui`, что приводит к отправке сообщения.
4.  В случае возникновения ошибки, информация об ошибке выводится в консоль.

```
 Отправка сообщения с использованием pywhatkit
 |
 Ожидание загрузки WhatsApp Web
 |
 Имитация нажатия Enter для отправки сообщения
```

**Примеры**:

```python
send_whatsapp_message("+79991234567", "Hello! How are you?", 10, 30)
send_whatsapp_message("+79991234567", "Thinking of you! :heart:", 14, 00)
```

### Основная часть кода

**Назначение**: Основная часть кода отвечает за получение входных данных от пользователя, выбор случайного сообщения из списка и отправку заданного количества сообщений в случайное время в указанном диапазоне часов.

**Как работает**:

1.  **Получение входных данных**: Код запрашивает у пользователя номер телефона, количество сообщений для отправки, начальный и конечный час для отправки сообщений.
2.  **Цикл отправки сообщений**:
    *   В цикле, который выполняется `num_messages` раз, генерируется случайный час и минута в заданном диапазоне.
    *   Выбирается случайное сообщение из списка `messages`.
    *   Вызывается функция `send_whatsapp_message` для отправки сообщения с заданным номером телефона, сообщением, часом и минутой.
    *   Счетчик отправленных сообщений увеличивается на 1.

```
Получение входных данных от пользователя (номер телефона, количество сообщений, время)
 |
Выбор случайного времени отправки сообщения
 |
Выбор случайного сообщения из списка
 |
Отправка сообщения с использованием функции send_whatsapp_message
```

**Переменные**:

-   `messages` (List[str]): Список сообщений для отправки. Содержит текстовые сообщения и эмодзи.
-   `phone_number` (str): Номер телефона получателя, введенный пользователем.
-   `num_messages` (int): Количество сообщений для отправки, введенное пользователем.
-   `start_hour` (int): Начальный час для отправки сообщений, введенный пользователем.
-   `end_hour` (int): Конечный час для отправки сообщений, введенный пользователем.
-   `message_count` (int): Счетчик отправленных сообщений.
-   `random_hour` (int): Случайный час для отправки сообщения.
-   `random_minutes` (int): Случайная минута для отправки сообщения.
-   `random_message` (str): Случайное сообщение, выбранное из списка `messages`.