# Модуль `hypotez/src/suppliers/ivory/__morlevi__.py`

Этот файл содержит код для работы с поставщиком "Morlevi". Он реализует функции для авторизации на сайте поставщика, получения списка продуктов из категории и сбора данных о каждом продукте.

**Основные функции:**

* **`login(supplier)`:** Функция для входа на сайт Morlevi.
    * Проверяет вход после перехода на страницу и возможного закрытия модальных окон.
    * Использует логгирование для отслеживания событий и ошибок.
    * `_login(_s)` - Внутренняя функция для непосредственного выполнения действий входа. Обращает внимание на возможные ошибки.
    * Обрабатывает ситуации, когда модальные окна не закрываются корректно.

* **`grab_product_page(s)`:** Функция для сбора данных о продукте с конкретной страницы.
    * Создает объект `Product`.
    * Извлекает данные о продукте из локейторов (locators) на странице.
    * Обрабатывает цену, используя `StringFormatter.clear_price()` для очистки от ненужных символов и вычисления стоимости с учётом правила `settings['price_rule']`.
    * Собирает изображения продукта.
    *  Обрабатывает случай, когда цена не найдена, выводит ошибку и возвращает `None`.

* **`list_products_in_category_from_pagination(supplier)`:** Функция для получения списка ссылок на продукты в определенной категории с учётом постраничной навигации.
    * Извлекает список ссылок на продукты с текущей страницы.
    * Обрабатывает случаи, когда список продуктов пуст, или возвращается один элемент.
    * Переходит к следующим страницам, используя ссылки для навигации.
    * Останавливает перебор, если текущая и предыдущая ссылки на страницу совпадают (дошел до конца).
    * Убирает дубликаты в списке ссылок.

* **`get_list_products_in_category(s, scenario, presath)`:** Функция для получения списка продуктов в категории. Использует `list_products_in_category_from_pagination`.

* **`get_list_categories_from_site(s,scenario_file,brand='')`:**  Функция (фрагмент), предположительно для получения списка категорий со страницы.

**Особенности кода:**

* **Локейторы (locators):** Функции используют `s.locators` для поиска элементов на странице.  Важно правильно определить эти локейторы для корректного извлечения данных.
* **Обработка ошибок:** Использует `try...except` блоки для обработки потенциальных ошибок при взаимодействии с сайтом (например, при отсутствии элементов).  Это важно для устойчивости скрипта.
* **Логгирование:** Используется `logger` для записи сообщений об ошибках и других важных событий.
* **Классы `Product` и `StringFormatter`:** Используются для структурирования данных и обработки строк.
* **Работа с Selenium:** Использует `selenium` для взаимодействия с браузером.
* **Работа с `pandas`:** Использует `pandas` для работы с данными.
* **Работа с `requests`:** Использует `requests` для взаимодействия с внешними ресурсами.
* **Функции `set_*()`:** Структурированно определяют как собирать данные о продуктах.
* **Обработка списка элементов:** Функции корректно обрабатывают ситуации, когда элемент может быть списком.

**Комментарий:**

Код демонстрирует структуру для веб-скрапинга данных с сайта Morlevi. Важно иметь локейторы (locators) и информацию о структуре сайта для корректной работы. Код нуждается в корректных данных и дополнительных обработках для надежности и работоспособности.