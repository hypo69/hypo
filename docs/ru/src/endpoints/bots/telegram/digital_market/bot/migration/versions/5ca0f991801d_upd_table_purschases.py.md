# Модуль обновления таблицы покупок

## Обзор

Модуль содержит функции `upgrade` и `downgrade`, которые используются для миграции базы данных с помощью Alembic. Он добавляет столбец `payment_type` в таблицу `purchases` и создает уникальное ограничение для столбца `payment_id`. Функция `downgrade` выполняет обратные действия, удаляя ограничение и столбец.

## Подробней

Этот код является частью системы миграции базы данных Alembic. Он определяет, какие изменения следует внести в схему базы данных при обновлении до новой версии и как вернуться к предыдущей версии. В данном случае, миграция добавляет информацию о типе платежа к таблице покупок.

## Функции

### `upgrade`

```python
def upgrade() -> None:
    """
    Обновляет схему базы данных, добавляя столбец 'payment_type' в таблицу 'purchases' и создавая уникальное ограничение для столбца 'payment_id'.
    
    Args:
        None
    
    Returns:
        None
    """
```

**Как работает функция**:

1.  **Добавление столбца `payment_type`**: В таблицу `purchases` добавляется новый столбец с именем `payment_type`, который хранит тип платежа. Указано, что столбец не может быть `NULL` (`nullable=False`), то есть каждое значение в этом столбце должно быть заполнено.
2.  **Создание уникального ограничения**: Создается уникальное ограничение для столбца `payment_id` в таблице `purchases`. Это означает, что каждое значение в столбце `payment_id` должно быть уникальным.

```
A: Добавление столбца 'payment_type' в таблицу 'purchases'
|
B: Создание уникального ограничения для столбца 'payment_id'
```

**Примеры**:

```python
# Пример вызова функции upgrade (обычно вызывается Alembic автоматически)
upgrade()
```

### `downgrade`

```python
def downgrade() -> None:
    """
    Откатывает схему базы данных, удаляя уникальное ограничение для столбца 'payment_id' и столбец 'payment_type' из таблицы 'purchases'.
    
    Args:
        None
    
    Returns:
        None
    """
```

**Как работает функция**:

1.  **Удаление уникального ограничения**: Удаляется уникальное ограничение, которое было создано для столбца `payment_id` в таблице `purchases`.
2.  **Удаление столбца `payment_type`**: Удаляется столбец `payment_type` из таблицы `purchases`.

```
A: Удаление уникального ограничения для столбца 'payment_id'
|
B: Удаление столбца 'payment_type' из таблицы 'purchases'
```

**Примеры**:

```python
# Пример вызова функции downgrade (обычно вызывается Alembic автоматически)
downgrade()