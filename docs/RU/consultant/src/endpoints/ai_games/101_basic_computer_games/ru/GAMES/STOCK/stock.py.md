# Анализ кода модуля stock.py

**Качество кода**
8
-  Плюсы
    - Код хорошо структурирован и логически понятен, с подробными комментариями, описывающими каждый этап игры.
    -  Используется `random.uniform` для более реалистичного изменения цены акции.
    -  Обработка ввода пользователя с проверками на корректность и достаточность средств/акций.
    -  Наличие подробной блок-схемы в комментариях, облегчающей понимание логики игры.
-  Минусы
    - Отсутствует обработка ошибок ввода (кроме `ValueError`), что может привести к некорректному поведению программы.
    - Не используются константы для параметров игры, таких как `numberOfDays`.
    -  Нет логирования ошибок.
    -  Используется стандартный print вместо logger для вывода информации.
    -  Отсутствует docstring модуля.
    -  Отсутствует форматирование RST в комментариях.
    
**Рекомендации по улучшению**

1. **Документация**:
   - Добавить docstring для модуля в формате RST.
   - Добавить docstring для всех переменных.
   - Переписать все комментарии в формате RST.
2. **Обработка ошибок**:
   -  Использовать `logger.error` для записи ошибок вместо `print`
   - Добавить общую обработку исключений для более устойчивой работы программы.
3. **Улучшения кода**:
   -  Использовать константы для параметров игры, таких как количество дней.
   -  Использовать f-строки для форматирования вывода.
   - Добавить логирование для отслеживания состояния игры и ошибок.

**Оптимизированный код**
```python
"""
Модуль для имитации игры на бирже.
=========================================================================================

Этот модуль реализует простую экономическую симуляцию, в которой игрок покупает и продает акции, чтобы максимизировать свою прибыль.

Пример использования
--------------------

.. code-block:: python

    python stock.py
"""
import random
from src.logger.logger import logger  # подключаем logger


#: Количество дней в игре
NUMBER_OF_DAYS = 20
#: Начальное количество денег у игрока
INITIAL_MONEY = 1000


def main():
    """
    Основная функция, запускающая игру "STOCK".

    Инициализирует параметры игры, обрабатывает ввод пользователя и выводит итоговое состояние игры.
    """
    # Инициализация параметров игры
    current_day = 1  #: Текущий день игры
    money = INITIAL_MONEY  #: Текущее количество денег
    stock_price = random.randint(5, 50)  #: Текущая цена акции
    number_of_stocks = 0  #: Текущее количество акций

    # Вывод приветствия и начального состояния
    print("Добро пожаловать в игру STOCK!")
    print(f"Начальное состояние: День {current_day}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}\n")

    # Основной игровой цикл
    while current_day <= NUMBER_OF_DAYS:
        # Изменяем цену акции случайным образом
        stock_price = round(random.uniform(stock_price * 0.9, stock_price * 1.1), 2)

        # Выводим текущее состояние
        print(f"День {current_day}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}")

        # Запрашиваем действие пользователя
        action = input("Купить (buy) или продать (sell) акции? (или нажмите Enter для перехода к следующему дню): ").lower()

        # Обработка действий пользователя
        if action == 'buy':
            try:
                stocks_to_buy = int(input("Сколько акций купить? "))
                if money >= stocks_to_buy * stock_price:
                    money -= stocks_to_buy * stock_price
                    number_of_stocks += stocks_to_buy
                    print("Покупка совершена")
                else:
                    print("Недостаточно денег для покупки.")
            except ValueError as e:
                logger.error(f'Некорректный ввод. Пожалуйста, введите целое число. {e}')
        elif action == 'sell':
            try:
                stocks_to_sell = int(input("Сколько акций продать? "))
                if number_of_stocks >= stocks_to_sell:
                    money += stocks_to_sell * stock_price
                    number_of_stocks -= stocks_to_sell
                    print("Продажа совершена")
                else:
                    print("Недостаточно акций для продажи.")
            except ValueError as e:
                logger.error(f'Некорректный ввод. Пожалуйста, введите целое число. {e}')
        else:
            print("Переходим к следующему дню.")
        
        current_day += 1
        print("-----------------")

    # Вывод итогового состояния игры
    print("Игра окончена!")
    print(f"Итоговое состояние: День {current_day - 1}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}")

if __name__ == "__main__":
    main()