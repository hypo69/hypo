# Модуль `category.py`

## Обзор

Модуль предназначен для сбора информации о категориях и товарах с сайта поставщика hb.co.il. Он использует веб-драйвер для навигации по сайту, извлечения данных и обработки информации о товарах.

## Подробней

Этот модуль является частью системы, отвечающей за взаимодействие с поставщиком hb.co.il. Он включает в себя функции для сбора списка категорий товаров, а также для извлечения списка товаров из каждой категории. Собранные данные могут быть использованы для синхронизации с PrestaShop или другими платформами.

## Функции

### `get_list_products_in_category`

```python
def get_list_products_in_category (s: Supplier) -> list[str, str, None]:
    """ Returns list of products urls from category page
    Если надо пролистстать - страницы категорий - листаю ??????

    Attrs:
        s - Supplier
    @returns
        list or one of products urls or None
    """
    ...
```

**Назначение**: Извлекает список URL товаров со страницы категории.

**Параметры**:
- `s` (Supplier): Объект поставщика, содержащий информацию о текущем сценарии, локаторы элементов на странице и инстанс веб-драйвера.

**Возвращает**:
- `list[str, str, None]`: Список URL товаров, найденных на странице категории. Может вернуть `None`, если товары не найдены.

**Как работает функция**:

1. **Инициализация**: Извлекает драйвер и локаторы из объекта поставщика.
2. **Ожидание и закрытие баннера**: Ожидает загрузки страницы и пытается закрыть всплывающий баннер, если он есть.
3. **Прокрутка страницы**: Выполняет прокрутку страницы для загрузки всех элементов, которые могут быть подгружены динамически.
4. **Поиск ссылок на товары**: Извлекает список веб-элементов, соответствующих ссылкам на товары, используя локаторы.
5. **Обработка пагинации**: Если на странице есть пагинация, функция итерируется по страницам, собирая ссылки на товары с каждой страницы.
6. **Формирование результата**: Преобразует список веб-элементов в список URL.
7. **Логирование**: Записывает в лог информацию о количестве найденных товаров в категории.

**Внутренние функции**: Отсутствуют.

**Примеры**:
```python
# Пример вызова функции
supplier = Supplier(...)
list_products = get_list_products_in_category(supplier)
if list_products:
    for product_url in list_products:
        print(product_url)
```

### `paginator`

```python
def paginator(d:Driver, locator: dict, list_products_in_category: list):
    """ Листалка """
    response = d.execute_locator(locator['pagination']['<-'])
    if not response or (isinstance(response, list) and len(response) == 0): 
        ...
        return
    return True
```

**Назначение**: Осуществляет навигацию по страницам пагинации на сайте.

**Параметры**:
- `d` (Driver): Объект веб-драйвера, используемый для взаимодействия с браузером.
- `locator` (dict): Словарь с локаторами элементов пагинации.
- `list_products_in_category` (list): Список ссылок на товары в категории

**Возвращает**:
- `True`: Если удалось перейти на следующую страницу.
- `None`: Если не удалось перейти на следующую страницу или пагинация отсутствует.

**Как работает функция**:

1. **Поиск кнопки пагинации**: Ищет кнопку "назад" или "предыдущая страница" на странице, используя предоставленный локатор.
2. **Проверка наличия**: Проверяет, найдена ли кнопка и активна ли она. Если кнопка не найдена или неактивна, функция завершает свою работу.
3. **Переход на следующую страницу**: Кликает на кнопку пагинации для перехода на следующую страницу.
4. **Возврат результата**: Возвращает `True`, если переход на следующую страницу был успешен.

**Примеры**:
```python
# Пример вызова функции
driver = Driver(browser_type='chrome')
locator = {'pagination': {'<-': {'by': 'css', 'value': '.pagination-button'}}}
product_list = []
paginator(driver, locator, product_list)
```

### `get_list_categories_from_site`

```python
def get_list_categories_from_site(s):
    """ сборщик актуальных категорий с сайта """
    ...
```

**Назначение**: Собирает список актуальных категорий с сайта.

**Параметры**:
- `s` (Supplier): Объект поставщика.

**Возвращает**:
- `list`: Список категорий, найденных на сайте.

**Как работает функция**:

1.  Функция <извлекает список категорий с сайта поставщика>.
2.  Внутри функции происхоят следующие действия и преобразования:
    A.  `Инициализация драйвера и получение локаторов`: Получает необходимые инструменты для взаимодействия с веб-сайтом.
    |
    B.  `Навигация по сайту`: Переходит на страницу категорий.
    |
    C.  `Извлечение категорий`: Извлекает список категорий, используя заданные локаторы.

**Примеры**:

```python
# Пример вызова функции
supplier = Supplier(...)
categories = get_list_categories_from_site(supplier)
if categories:
    for category in categories:
        print(category)