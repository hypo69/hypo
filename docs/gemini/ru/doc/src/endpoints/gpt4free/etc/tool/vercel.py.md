# Модуль для получения и преобразования информации о моделях Vercel AI SDK

## Обзор

Модуль предназначен для получения информации о моделях, доступных в Vercel AI SDK, их преобразования и вывода в определенном формате. Он использует библиотеки `quickjs`, `curl_cffi` и `re` для получения данных с веб-сайта Vercel AI SDK, извлечения информации о моделях из JavaScript-кода, преобразования этой информации и вывода ее в формате JSON или в виде Python-кода для дальнейшего использования.

## Подробнее

Этот модуль выполняет следующие шаги:

1.  Получает HTML-код главной страницы Vercel AI SDK.
2.  Извлекает пути к JavaScript-файлам, содержащим информацию о моделях.
3.  Получает содержимое этих JavaScript-файлов.
4.  Извлекает информацию о моделях из JavaScript-кода с использованием регулярных выражений.
5.  Преобразует полученную информацию в более удобный формат.
6.  Выводит преобразованную информацию в формате JSON, а также в виде Python-кода для определения моделей и их соответствия.

## Функции

### `get_model_info`

```python
def get_model_info() -> dict[str, Any]:
    """
    Получает информацию о моделях с веб-сайта Vercel AI SDK.

    Args:
        None

    Returns:
        dict[str, Any]: Словарь, содержащий информацию о моделях. Возвращает пустой словарь, если информация не найдена.

    Raises:
        None

    Как работает функция:
     1. Делает GET-запрос на URL "https://sdk.vercel.ai".
     2. Извлекает HTML-код из ответа.
     3. Находит пути к JavaScript-файлам, используя регулярное выражение `paths_regex`.
     4. Формирует полные URL для каждого найденного пути.
     5. Делает GET-запросы к каждому URL и получает содержимое JavaScript-файлов.
     6. Извлекает строку, содержащую информацию о моделях, используя регулярное выражение `models_regex`.
     7. Преобразует строку с информацией о моделях в JSON-формат, используя библиотеку `quickjs`.
     8. Возвращает словарь с информацией о моделях.

    Flowchart:

    A: GET запрос к "https://sdk.vercel.ai" -> HTML
    |
    B: Извлечение путей к JS файлам
    |
    C: GET запросы к JS файлам -> Script
    |
    D: Поиск информации о моделях в JS файлах
    |
    E: Преобразование в JSON
    |
    F: Возврат словаря с информацией о моделях

    Примеры:
        >>> get_model_info()
        {'model1': {'id': 'model1_id', 'parameters': {...}}, 'model2': {'id': 'model2_id', 'parameters': {...}}, ...}
    """
    ...
```

### `convert_model_info`

```python
def convert_model_info(models: dict[str, Any]) -> dict[str, Any]:
    """
    Преобразует информацию о моделях в формат, удобный для дальнейшего использования.

    Args:
        models (dict[str, Any]): Словарь с информацией о моделях, полученный из `get_model_info`.

    Returns:
        dict[str, Any]: Словарь, содержащий преобразованную информацию о моделях, где ключ - имя модели,
                         а значение - словарь с 'id' и 'default_params'.

    Raises:
        None

    Как работает функция:
     1. Итерируется по всем моделям в словаре `models`.
     2. Для каждой модели извлекает параметры и преобразует их в параметры по умолчанию, используя функцию `params_to_default_params`.
     3. Формирует новый словарь, где ключом является имя модели, а значением - словарь с 'id' и 'default_params'.

    Flowchart:

    A: Получение словаря моделей
    |
    B: Итерация по моделям
    |
    C: Преобразование параметров в параметры по умолчанию
    |
    D: Формирование словаря с 'id' и 'default_params'
    |
    E: Возврат преобразованного словаря

    Примеры:
        >>> models = {'model1': {'id': 'model1_id', 'parameters': {...}}, 'model2': {'id': 'model2_id', 'parameters': {...}}}
        >>> convert_model_info(models)
        {'model1': {'id': 'model1_id', 'default_params': {...}}, 'model2': {'id': 'model2_id', 'default_params': {...}}}
    """
    ...
```

### `params_to_default_params`

```python
def params_to_default_params(parameters: dict[str, Any]):
    """
    Преобразует параметры модели в параметры по умолчанию.

    Args:
        parameters (dict[str, Any]): Словарь с параметрами модели.

    Returns:
        dict[str, Any]: Словарь, содержащий параметры по умолчанию.

    Raises:
        None

    Как работает функция:
     1. Итерируется по всем параметрам в словаре `parameters`.
     2. Если ключ параметра равен "maximumLength", то он переименовывается в "maxTokens".
     3. Значение каждого параметра сохраняется в новом словаре `defaults`.

    Flowchart:

    A: Получение словаря параметров
    |
    B: Итерация по параметрам
    |
    C: Замена "maximumLength" на "maxTokens"
    |
    D: Сохранение значений параметров в словаре `defaults`
    |
    E: Возврат словаря `defaults`

    Примеры:
        >>> parameters = {'param1': {'value': 'value1'}, 'maximumLength': {'value': 100}}
        >>> params_to_default_params(parameters)
        {'param1': 'value1', 'maxTokens': 100}
    """
    ...
```

### `get_model_names`

```python
def get_model_names(model_info: dict[str, Any]):
    """
    Извлекает список имен моделей из словаря с информацией о моделях.

    Args:
        model_info (dict[str, Any]): Словарь с информацией о моделях.

    Returns:
        list[str]: Список имен моделей, отсортированный в алфавитном порядке, исключая "openai:gpt-4" и "openai:gpt-3.5-turbo".

    Raises:
        None

    Как работает функция:
     1. Получает список имен моделей из ключей словаря `model_info`.
     2. Исключает модели "openai:gpt-4" и "openai:gpt-3.5-turbo" из списка.
     3. Сортирует оставшиеся имена моделей в алфавитном порядке.

    Flowchart:

    A: Получение словаря `model_info`
    |
    B: Извлечение имен моделей
    |
    C: Исключение "openai:gpt-4" и "openai:gpt-3.5-turbo"
    |
    D: Сортировка имен моделей
    |
    E: Возврат списка имен моделей

    Примеры:
        >>> model_info = {'model1': {...}, 'openai:gpt-4': {...}, 'model2': {...}}
        >>> get_model_names(model_info)
        ['model1', 'model2']
    """
    ...
```

### `print_providers`

```python
def print_providers(model_names: list[str]):
    """
    Выводит Python-код для определения моделей с указанием имени, базового провайдера и лучшего провайдера.

    Args:
        model_names (list[str]): Список имен моделей.

    Returns:
        None

    Raises:
        None

    Как работает функция:
     1. Итерируется по списку имен моделей.
     2. Для каждого имени модели разделяет его на части, используя разделители ":" и "/".
     3. Извлекает базового провайдера из первой части имени.
     4. Формирует имя переменной на основе последней части имени, заменяя "-" на "_" и удаляя ".".
     5. Выводит строку Python-кода, определяющую модель с указанием имени, базового провайдера и лучшего провайдера (Vercel).

    Flowchart:

    A: Получение списка имен моделей
    |
    B: Итерация по именам моделей
    |
    C: Разделение имени модели на части
    |
    D: Извлечение базового провайдера
    |
    E: Формирование имени переменной
    |
    F: Вывод строки Python-кода

    Примеры:
        >>> model_names = ['anthropic:claude-v1', 'google:palm-2']
        >>> print_providers(model_names)
        claude_v1 = Model(name="anthropic:claude-v1", base_provider="anthropic", best_provider=Vercel,)
        palm_2 = Model(name="google:palm-2", base_provider="google", best_provider=Vercel,)
    """
    ...
```

### `print_convert`

```python
def print_convert(model_names: list[str]):
    """
    Выводит Python-код для создания словаря, сопоставляющего ключи с переменными моделей.

    Args:
        model_names (list[str]): Список имен моделей.

    Returns:
        None

    Raises:
        None

    Как работает функция:
     1. Итерируется по списку имен моделей.
     2. Для каждого имени модели разделяет его на части, используя разделители ":" и "/".
     3. Извлекает ключ из последней части имени.
     4. Формирует имя переменной на основе последней части имени, заменяя "-" на "_" и удаляя ".".
     5. Выводит строку Python-кода, создающую элемент словаря, сопоставляющий ключ с переменной модели.

    Flowchart:

    A: Получение списка имен моделей
    |
    B: Итерация по именам моделей
    |
    C: Разделение имени модели на части
    |
    D: Извлечение ключа
    |
    E: Формирование имени переменной
    |
    F: Вывод строки Python-кода

    Примеры:
        >>> model_names = ['anthropic:claude-v1', 'google:palm-2']
        >>> print_convert(model_names)
                "claude-v1": claude_v1,
                "palm-2": palm_2,
    """
    ...
```

### `main`

```python
def main():
    """
    Основная функция, выполняющая получение, преобразование и вывод информации о моделях.

    Args:
        None

    Returns:
        None

    Raises:
        None

    Как работает функция:
     1. Получает информацию о моделях, вызывая функцию `get_model_info`.
     2. Преобразует полученную информацию, вызывая функцию `convert_model_info`.
     3. Выводит преобразованную информацию в формате JSON.
     4. Получает список имен моделей, вызывая функцию `get_model_names`.
     5. Выводит Python-код для определения моделей, вызывая функцию `print_providers`.
     6. Выводит Python-код для создания словаря, сопоставляющего ключи с переменными моделей, вызывая функцию `print_convert`.

    Flowchart:

    A: Получение информации о моделях
    |
    B: Преобразование информации о моделях
    |
    C: Вывод информации в формате JSON
    |
    D: Получение списка имен моделей
    |
    E: Вывод Python-кода для определения моделей
    |
    F: Вывод Python-кода для создания словаря

    Примеры:
        >>> main()
        {
          "model1": {
            "id": "model1_id",
            "default_params": {
              ...
            }
          },
          "model2": {
            "id": "model2_id",
            "default_params": {
              ...
            }
          }
        }
        ------------------------------------------------------------------------------------------------------------------------
        claude_v1 = Model(name="anthropic:claude-v1", base_provider="anthropic", best_provider=Vercel,)
        palm_2 = Model(name="google:palm-2", base_provider="google", best_provider=Vercel,)
        ------------------------------------------------------------------------------------------------------------------------
                "claude-v1": claude_v1,
                "palm-2": palm_2,
    """
    ...
```