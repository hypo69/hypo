Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код JavaScript собирает информацию о текущей загруженной странице (заголовок, URL и содержимое) и отправляет ее в виде JSON на сервер по адресу `http://127.0.0.1/hypotez.online/api/` с помощью метода POST.  Код использует `fetch` API для выполнения запроса и обрабатывает возможные ошибки при отправке и получении ответа.  Полученный ответ от сервера также выводится в консоль.

Шаги выполнения
-------------------------
1. **Определение функции `onPageLoad`:**  Создается функция `onPageLoad`, которая будет вызываться при загрузке страницы.
2. **Сбор данных:** Внутри функции собираются данные о странице:  `document.title` (заголовок), `window.location.href` (URL) и `document.body.innerHTML` (содержимое тела страницы).
3. **Формирование объекта данных:** Данные собираются в объект JavaScript `data` с ключами `title`, `url` и `body`.
4. **Отправка запроса:** Используя `fetch`, отправляется POST запрос на сервер по указанному адресу с объектом данных `data`, преобразованным в JSON.
5. **Обработка ответа:**  Используется `.then` для обработки ответа от сервера:
    - Проверяется корректность ответа (`response.ok`). При ошибке выводится ошибка в консоль.
    - Преобразуется ответ в JSON (`response.json()`).
    - Выводится ответ от сервера в консоль.
6. **Обработка ошибок:**  Используется `.catch` для обработки ошибок при отправке запроса или обработке ответа. Ошибка выводится в консоль.
7. **Добавление обработчика события:** К объекту `window` добавляется обработчик события `load`, который вызовет функцию `onPageLoad` при загрузке страницы.

Пример использования
-------------------------
.. code-block:: javascript

    // Создаем обработчик события для загрузки страницы
    function onPageLoad() {
        // Собираем информацию о странице
        var title = document.title;
        var url = window.location.href;
        var body = document.body.innerHTML;

        // Формируем объект с данными для отправки
        var data = {
            title: title,
            url: url,
            body: body
        };

        // Отправляем данные на указанный адрес
        fetch('http://127.0.0.1/hypotez.online/api/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(json => {
            console.log('Response:', json);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }

    // Добавляем обработчик события для загрузки страницы
    window.addEventListener('load', onPageLoad);