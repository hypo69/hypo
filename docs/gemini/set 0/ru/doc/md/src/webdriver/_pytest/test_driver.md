# Модуль hypotez/src/webdriver/_pytest/test_driver.py

## Обзор

Данный модуль содержит тесты для класса `DriverBase`, покрывая различные его методы. Тестирование осуществляется с использованием фреймворка `pytest` и `unittest.mock` для эмуляции внешних зависимостей.

## Фикстуры

### `driver_base`

**Описание**: Фикстура, возвращающая экземпляр класса `DriverBase` для использования в тестах.

**Возвращает**:
- `DriverBase`: Экземпляр класса `DriverBase`.

## Тесты

### `test_driver_payload`

**Описание**: Тестирует метод `driver_payload` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `patch` для подмены объектов `JavaScript` и `ExecuteLocator` фиктивными объектами.

**Проверяемые утверждения**:
- Проверка того, что методы класса `DriverBase`, вызываемые внутри `driver_payload`, взаимодействуют с ожидаемыми фиктивными объектами.

### `test_scroll`

**Описание**: Тестирует метод `scroll` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `Mock` для подмены методов `execute_script` и `wait`.
- Вызов метода `scroll` с различными параметрами.

**Проверяемые утверждения**:
- Проверка вызовов метода `execute_script` с ожидаемыми аргументами (window.scrollBy).

### `test_locale`

**Описание**: Тестирует свойство `locale` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `Mock` для подмены метода `find_element`.
- Два сценария:
    - Найден тег `meta` с атрибутом `content` равным 'en'.
    - Тег `meta` не найден.

**Проверяемые утверждения**:
- Проверка значения свойства `locale` в обоих случаях.

### `test_get_url`

**Описание**: Тестирует метод `get_url` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `Mock` для подмены методов `get`, `ready_state`, `wait` и `_save_cookies_localy`.
- Вызов метода `get_url` с новым URL.

**Проверяемые утверждения**:
- Проверка вызова метода `get` с новым URL.
- Проверка вызова метода `_save_cookies_localy`.
- Проверка корректного значения `previous_url`.

### `test_extract_domain`

**Описание**: Тестирует метод `extract_domain` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Вызов метода `extract_domain` с различными URL.

**Проверяемые утверждения**:
- Проверка возвращаемого значения - домена.

### `test_save_cookies_localy`

**Описание**: Тестирует метод `_save_cookies_localy` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `patch` для подмены `open` и `pickle.dump`.
- Инициализация `Path` объекта для файла куки.

**Проверяемые утверждения**:
- Проверка того, что `open` был вызван с режимом `wb`.
- Проверка вызова `pickle.dump` с ожидаемыми аргументами.

### `test_page_refresh`

**Описание**: Тестирует метод `page_refresh` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `Mock` для подмены метода `get_url`.
- Вызов метода `page_refresh`.

**Проверяемые утверждения**:
- Проверка вызова метода `get_url` с текущим URL.

### `test_wait`

**Описание**: Тестирует метод `wait` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Использование `patch` для подмены метода `time.sleep`.
- Вызов метода `wait`.

**Проверяемые утверждения**:
- Проверка вызова метода `time.sleep` с ожидаемым аргументом.

### `test_delete_driver_logs`

**Описание**: Тестирует метод `delete_driver_logs` класса `DriverBase`.

**Параметры**:
- `driver_base` (`DriverBase`): Экземпляр класса `DriverBase` для тестирования.

**Действия**:
- Инициализация переменной `temp_dir`.
- Использование `patch` для подмены методов `Path.iterdir`, `Path.is_file`, `Path.unlink`, и `Path.is_dir`.
- Вызов метода `delete_driver_logs`.

**Проверяемые утверждения**:
- Проверка вызова метода `Path.unlink` для каждого файла в директории.