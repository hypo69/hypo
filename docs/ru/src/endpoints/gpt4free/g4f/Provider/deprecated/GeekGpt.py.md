# Модуль для работы с провайдером GeekGpt
=========================================

Модуль содержит класс :class:`GeekGpt`, который является устаревшим провайдером для взаимодействия с API GeekGpt.
Провайдер позволяет генерировать текст на основе предоставленных сообщений, используя модели GPT-3.5 Turbo и GPT-4.
Модуль использует библиотеку `requests` для выполнения HTTP-запросов.

## Обзор

Модуль предназначен для интеграции с сервисом GeekGpt для создания текстовых завершений на основе моделей GPT.
Он поддерживает потоковую передачу ответов и работу с историей сообщений.

## Классы

### `GeekGpt(AbstractProvider)`

**Описание**:
Класс `GeekGpt` предоставляет интерфейс для взаимодействия с API GeekGpt. Он наследуется от класса `AbstractProvider`.

**Наследует**:
`AbstractProvider` - абстрактный класс, определяющий интерфейс для провайдеров.

**Атрибуты**:
- `url` (str): URL-адрес API GeekGpt.
- `working` (bool): Флаг, указывающий, работает ли провайдер.
- `supports_message_history` (bool): Флаг, указывающий, поддерживает ли провайдер историю сообщений.
- `supports_stream` (bool): Флаг, указывающий, поддерживает ли провайдер потоковую передачу ответов.
- `supports_gpt_35_turbo` (bool): Флаг, указывающий, поддерживает ли провайдер модель GPT-3.5 Turbo.
- `supports_gpt_4` (bool): Флаг, указывающий, поддерживает ли провайдер модель GPT-4.

**Методы**:
- `create_completion()`: Создает завершение на основе предоставленных параметров.

## Функции

### `create_completion`

```python
    @classmethod
    def create_completion(
        cls,
        model: str,
        messages: Messages,
        stream: bool,
        **kwargs
    ) -> CreateResult:
        """Создает завершение текста на основе предоставленных параметров.

        Args:
            model (str): Имя используемой модели. Если не указано, используется "gpt-3.5-turbo".
            messages (Messages): Список сообщений для создания завершения.
            stream (bool): Флаг, указывающий, следует ли использовать потоковую передачу.
            **kwargs: Дополнительные аргументы, такие как `temperature`, `presence_penalty`, `top_p` и `frequency_penalty`.

        Returns:
            CreateResult: Генератор строк, содержащий сгенерированный текст.

        Raises:
            RuntimeError: Если возникает ошибка при обработке ответа от API.

        Как работает функция:
        1. Функция `create_completion` подготавливает данные для запроса к API GeekGpt.
        2. Отправляет POST-запрос к API и обрабатывает ответ, возвращая текст в виде потока.

        Внутри функции происходят следующие действия и преобразования:
        A. Подготовка данных запроса:
        |
        -- B. Преобразование данных в формат JSON:
        |
        C. Отправка POST-запроса к API:
        |
        D. Обработка потока ответов от API:
        |
        -- E. Извлечение содержимого из каждого чанка:
        |
        F. Генерация содержимого

        Где:
        A. `Подготовка данных запроса`:  Формирование JSON-структуры с параметрами запроса, такими как сообщения, модель, температура и штрафы.
        B. `Преобразование данных в формат JSON`: Преобразование JSON-структуры в строку с использованием `json.dumps`.
        C. `Отправка POST-запроса к API`: Отправка HTTP-запроса к API GeekGpt с использованием библиотеки `requests`.
        D. `Обработка потока ответов от API`: Чтение ответов от API по частям (чанками) с использованием `response.iter_lines()`.
        E. `Извлечение содержимого из каждого чанка`:  Поиск и извлечение содержимого сгенерированного текста из каждого чанка JSON.
        F. `Генерация содержимого`:  Возвращение извлеченного содержимого в виде генератора.
        """
```

**Примеры**:

```python
# Пример использования функции create_completion
model = "gpt-3.5-turbo"
messages = [{"role": "user", "content": "Hello, how are you?"}]
stream = True
temperature = 0.7
result = GeekGpt.create_completion(model=model, messages=messages, stream=stream, temperature=temperature)
for chunk in result:
    print(chunk, end="")