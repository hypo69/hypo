## <алгоритм>

1. **Начало:**
   - Определяется переменная `MODE` со значением `'dev'`.
   - Импортируются необходимые модули: `sys`, `json`, `packaging.version.Version`, `pathlib.Path`.

2. **Функция `set_project_root`:**
   - Принимает на вход кортеж `marker_files` (по умолчанию `('pyproject.toml', 'requirements.txt', '.git')`).
   - Определяет текущий путь к файлу `__file__` и его родительский каталог `current_path`.
   - Инициализирует переменную `__root__` значением `current_path`.
   - Проходит циклом по `current_path` и его родительским каталогам.
      - Для каждого родительского каталога проверяется наличие хотя бы одного из `marker_files`.
      - Если `marker_file` найден, то `__root__` устанавливается в родительский каталог и цикл прерывается.
   - Проверяется, если `__root__` отсутствует в `sys.path`, добавляет его в начало.
   - Возвращает `__root__` как путь к корневой директории проекта.
   - *Пример:* Если скрипт находится в `hypotez/src/suppliers/visualdg/header.py` и в `hypotez/` есть `pyproject.toml`, то `set_project_root` вернет `hypotez/`.

3. **Определение `__root__`:**
   - Вызывается функция `set_project_root()` и её результат присваивается глобальной переменной `__root__`.

4. **Импорт `gs`:**
   - Импортируется модуль `src.gs`.
5. **Чтение `settings.json`:**
   - Инициализируется переменная `settings` со значением `None`.
   - Пытается открыть файл `settings.json` из каталога `src` относительно `__root__`.
   - Если файл найден, то загружает JSON из файла в словарь `settings`.
   - В случае ошибок `FileNotFoundError` или `json.JSONDecodeError`, ошибки игнорируются (используется `...`).
   - *Пример:* Если `__root__` это `hypotez`, то ищется файл `hypotez/src/settings.json`.

6. **Чтение `README.md`:**
    - Инициализируется переменная `doc_str` со значением `None`.
    - Пытается открыть файл `README.MD` из каталога `src` относительно `__root__`.
    - Если файл найден, то считывает содержимое файла в строку `doc_str`.
    - В случае ошибок `FileNotFoundError` или `json.JSONDecodeError`, ошибки игнорируются (используется `...`).
    - *Пример:* Если `__root__` это `hypotez`, то ищется файл `hypotez/src/README.MD`.
7. **Определение глобальных переменных:**
   - Глобальные переменные инициализируются на основе данных из `settings` или значения по умолчанию:
      - `__project_name__`: Значение `'project_name'` из `settings` или `'hypotez'`.
      - `__version__`: Значение `'version'` из `settings` или `''`.
      - `__doc__`: Значение `doc_str`, если он определен, иначе `''`.
      - `__details__`: Пустая строка.
      - `__author__`: Значение `'author'` из `settings` или `''`.
      - `__copyright__`: Значение `'copyrihgnt'` из `settings` или `''`.
      - `__cofee__`: Значение `'cofee'` из `settings` или строка "Treat the developer to a cup of coffee for boosting enthusiasm in development: https://boosty.to/hypo69".

## <mermaid>

```mermaid
graph LR
    A[Начало] --> B{Определение MODE};
    B --> C[Импорт модулей];
    C --> D{set_project_root(marker_files)};
    D --> E{Поиск marker_files в текущем каталоге и его родителях};
    E -- Найдено --> F[Установка __root__];
    E -- Не найдено --> F
    F --> G{Добавление __root__ в sys.path};
    G --> H[Возврат __root__];
    H --> I{__root__ = set_project_root()};
    I --> J[Импорт gs];
    J --> K{Открытие settings.json};
    K -- Успех --> L[Загрузка settings];
    K -- Ошибка --> L;
    L --> M{Открытие README.MD};
     M -- Успех --> N[Загрузка doc_str];
    M -- Ошибка --> N;
    N --> O{Инициализация глобальных переменных};
    O --> P[Конец];
    
    
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style P fill:#f9f,stroke:#333,stroke-width:2px
    style H fill:#ccf,stroke:#333,stroke-width:2px
    style I fill:#ccf,stroke:#333,stroke-width:2px
    style J fill:#ccf,stroke:#333,stroke-width:2px

```

**Объяснение зависимостей:**

- `Начало` -> `Определение MODE`: Начало выполнения скрипта, определяет начальный режим работы.
- `Определение MODE` -> `Импорт модулей`: Импортирует модули `sys`, `json`, `packaging.version.Version`, `pathlib.Path`, необходимые для работы скрипта.
- `Импорт модулей` -> `set_project_root(marker_files)`:  Вызывает функцию для определения корневой директории проекта, используя `pathlib.Path` и `sys`.
- `set_project_root(marker_files)` -> `Поиск marker_files в текущем каталоге и его родителях`:  Функция ищет маркерные файлы в текущей и родительских директориях
- `Поиск marker_files в текущем каталоге и его родителях` -> `Установка __root__`: Функция устанавливает корень проекта
- `Поиск marker_files в текущем каталоге и его родителях` -> `Установка __root__`: Если не находит маркерные файлы, то корень будет директория, в которой расположен скрипт.
- `Установка __root__` ->  `Добавление __root__ в sys.path`: Добавляет путь к корню проекта в список путей поиска модулей.
- `Добавление __root__ в sys.path` -> `Возврат __root__`: Возвращает путь к корню проекта.
- `Возврат __root__` ->  `__root__ = set_project_root()`: Присваивает возвращенное значение `__root__`.
-  `__root__ = set_project_root()` -> `Импорт gs`: Импортирует модуль `gs` из пакета `src`.
- `Импорт gs` -> `Открытие settings.json`: Пытается открыть файл настроек.
- `Открытие settings.json` -- `Успех`-> `Загрузка settings`: Загружает данные из файла JSON.
- `Открытие settings.json` -- `Ошибка`-> `Загрузка settings`: Если файл не найден или имеет неверный формат, то `settings` останется `None`.
- `Загрузка settings` -> `Открытие README.MD`: Пытается открыть файл README.MD
- `Открытие README.MD` -- `Успех` -> `Загрузка doc_str`: Загружает содержимое из файла в переменную `doc_str`
- `Открытие README.MD` -- `Ошибка` -> `Загрузка doc_str`: Если файл не найден, то переменная `doc_str` останется `None`
- `Загрузка doc_str` -> `Инициализация глобальных переменных`: Инициализирует глобальные переменные на основе данных из `settings` и `doc_str` или значения по умолчанию.
- `Инициализация глобальных переменных` -> `Конец`: Завершение выполнения скрипта.

## <объяснение>

**Импорты:**

- `sys`: Модуль для работы с параметрами и функциями интерпретатора Python. Используется для добавления пути к корневой директории проекта в список путей поиска модулей (`sys.path`).
- `json`: Модуль для работы с JSON-данными. Используется для загрузки настроек из файла `settings.json`.
- `packaging.version.Version`: Модуль для работы с версиями. В коде не используется, но импортируется. Вероятно, планировалось использовать для версионирования проекта.
- `pathlib.Path`: Модуль для работы с путями к файлам и директориям. Используется для определения корневой директории проекта и для формирования путей к файлам `settings.json` и `README.MD`.
- `src.gs`: Пользовательский модуль, который, судя по коду, содержит глобальные пути, скорее всего, в `src.gs.path.root`.

**Функция `set_project_root`:**

- **Аргументы**: `marker_files` - кортеж строк, содержащий имена файлов или директорий, которые считаются маркерами корневой директории проекта. По умолчанию это `('pyproject.toml', 'requirements.txt', '.git')`.
- **Возвращаемое значение**: `Path` - объект `pathlib.Path`, представляющий путь к корневой директории проекта. Если маркер не найден, возвращает путь к директории, в которой находится текущий скрипт.
- **Назначение**: Функция ищет корневую директорию проекта, поднимаясь вверх по структуре каталогов, пока не найдет маркерный файл или директорию. Она добавляет эту директорию в список путей поиска модулей (`sys.path`), что позволяет импортировать модули проекта из любого места.
- **Пример**: Если скрипт `header.py` находится в `hypotez/src/suppliers/visualdg`, а `pyproject.toml` находится в `hypotez`, то функция вернет `Path("hypotez")`.

**Переменные:**

- `MODE`: Строка, определяющая режим работы приложения. В данном случае всегда `'dev'`.
- `__root__`: Объект `Path`, представляющий путь к корневой директории проекта. Задается функцией `set_project_root`.
- `settings`: Словарь, содержащий настройки, загруженные из `settings.json`. Может быть `None`, если загрузка не удалась.
- `doc_str`: Строка, содержащая содержимое файла `README.MD`. Может быть `None`, если загрузка не удалась.
- `__project_name__`: Строка, представляющая имя проекта. Берется из файла `settings.json`, если он есть, иначе `'hypotez'`.
- `__version__`: Строка, представляющая версию проекта. Берется из файла `settings.json`, если он есть, иначе `''`.
- `__doc__`: Строка, содержащая документацию проекта. Задается содержимым файла `README.MD`, если он есть, иначе `''`.
- `__details__`: Строка, которая в данном случае всегда пуста, возможно для дальнейшего использования.
- `__author__`: Строка, представляющая автора проекта. Берется из файла `settings.json`, если он есть, иначе `''`.
- `__copyright__`: Строка, представляющая авторские права проекта. Берется из файла `settings.json`, если он есть, иначе `''`.
- `__cofee__`: Строка, представляющая сообщение для поддержки разработчика. Берется из файла `settings.json`, если он есть, иначе стандартное сообщение.

**Потенциальные ошибки и области для улучшения:**

- **Обработка ошибок:** Используется `...` для игнорирования ошибок `FileNotFoundError` и `json.JSONDecodeError`, что может скрыть важные проблемы. Лучше использовать `try-except` блоки с более конкретной обработкой ошибок и логированием.
- **`packaging.version.Version`:** Импортируется, но не используется. Можно удалить импорт или использовать для версионирования проекта.
- **Неиспользуемые переменные:**  Переменная `__details__` всегда пустая. Можно рассмотреть ее использование или удаление.
- **Универсальность поиска `settings.json` и `README.MD`:** Сейчас поиск настроен для поиска этих файлов в папке `src`. Если расположить их в другой папке, то код нужно будет изменить. Возможно, нужно продумать более гибкий механизм поиска.
- **Жестко заданные значения по умолчанию:** Значения по умолчанию для `__project_name__`, `__version__`, `__author__`, `__copyright__` и `__cofee__` жёстко закодированы. Можно рассмотреть возможность их настройки через переменные окружения или аргументы командной строки.

**Взаимосвязи с другими частями проекта:**

- **`src.gs`**: Модуль используется для получения пути к корневой директории проекта. Предположительно он содержит глобальные пути, определенные в проекте.
- **`settings.json`**: Файл используется для хранения настроек проекта, таких как имя проекта, версия, автор, и т.д.
- **`README.MD`**: Файл используется для получения документации проекта.

Этот скрипт является отправной точкой для инициализации проекта, устанавливает корень проекта, загружает настройки и документацию, что позволяет использовать эти данные в других частях проекта.