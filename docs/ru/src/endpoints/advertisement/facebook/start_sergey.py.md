# Модуль для запуска рекламных кампаний в Facebook

## Обзор

Модуль `src.endpoints.advertisement.facebook.start_sergey` предназначен для автоматизации процесса публикации рекламных объявлений в группах Facebook. Он использует веб-драйвер для взаимодействия с Facebook и выполняет циклическую публикацию объявлений на разных языках и с разными валютами.

## Подробней

Модуль предназначен для автоматической публикации рекламных объявлений в группах Facebook. Он поддерживает мультиязычность и позволяет настраивать рекламные кампании для разных языковых групп. Код использует модуль `webdriver` для эмуляции действий пользователя в браузере, что позволяет автоматически проходить аутентификацию и размещать объявления.

## Функции

### `run_campaign`

```python
def run_campaign(d: Driver, promoter_name: str, campaigns: list | str, group_file_paths: list, language: str, currency: str):
    """Запуск рекламной кампании.

    Args:
        d (Driver): Экземпляр драйвера.
        promoter_name (str): Имя рекламодателя.
        campaigns (list): Список кампаний.
        group_file_paths (list): Пути к файлам с группами.
        language (str): Язык рекламной кампании.
        currency (str): Валюта рекламной кампании.
    """
    ...
```

**Назначение**: Запускает рекламную кампанию для указанного рекламодателя в заданных группах Facebook.

**Параметры**:

-   `d` (Driver): Экземпляр драйвера, используемый для управления браузером.
-   `promoter_name` (str): Имя рекламодателя, например, "kazarinov" или "aliexpress".
-   `campaigns` (list | str): Список кампаний, которые необходимо запустить.
-   `group_file_paths` (list): Список путей к файлам, содержащим информацию о группах, в которых будет размещаться реклама.
-   `language` (str): Язык, на котором будет отображаться рекламное объявление.
-   `currency` (str): Валюта, в которой будет указана цена товара или услуги в объявлении.

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Вызывает исключения**:

-   Не обрабатывает исключения напрямую, но может вызвать исключения, если возникнут проблемы с веб-драйвером или API Facebook.

**Как работает функция**:

1.  Создает экземпляр класса `FacebookPromoter`, который отвечает за управление рекламной кампанией в Facebook.
2.  Вызывает метод `run_campaigns` класса `FacebookPromoter` с передачей необходимых параметров.
3.  Метод `run_campaigns` выполняет всю логику, связанную с входом в Facebook, нахождением групп и размещением рекламных объявлений.

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
# Пример вызова функции run_campaign
driver = Driver(Chrome)
run_campaign(
    d=driver,
    promoter_name='kazarinov',
    campaigns=['kazarinov_ru'],
    group_file_paths=['sergey_pages.json', 'ru_ils.json'],
    language='RU',
    currency='ILS'
)
```

### `campaign_cycle`

```python
def campaign_cycle(d: Driver):
    """Цикл для управления запуском кампаний.

    Args:
        d (Driver): Экземпляр драйвера.
        aliexpress_adv (bool): Флаг для определения рекламодателя.
    """
    ...
```

**Назначение**: Управляет циклом запуска рекламных кампаний на разных языках и для разных рекламодателей.

**Параметры**:

-   `d` (Driver): Экземпляр драйвера, используемый для управления браузером.

**Возвращает**:

-   `True`: Функция всегда возвращает `True` после завершения цикла.

**Вызывает исключения**:

-   Не обрабатывает исключения напрямую, но может вызвать исключения, если возникнут проблемы с веб-драйвером или API Facebook.

**Как работает функция**:

1.  Определяет пути к файлам с группами и объявлениями для русского и ивритского языков.
2.  Создает список словарей, содержащих пары язык-валюта.
3.  Перебирает пары язык-валюта и запускает рекламные кампании для каждого языка.
4.  Определяет список кампаний для каждого языка.
5.  Запускает кампании для рекламодателя "kazarinov".
6.  Получает список кампаний для рекламодателя "aliexpress" из директории Google Drive.
7.  Запускает кампании для рекламодателя "aliexpress".

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
# Пример вызова функции campaign_cycle
driver = Driver(Chrome)
campaign_cycle(d=driver)
```

### `main`

```python
def main():
    """Основная функция для запуска рекламных кампаний."""
    ...
```

**Назначение**: Основная функция для запуска рекламных кампаний.

**Параметры**:

-   `None`: Функция не принимает параметров.

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Вызывает исключения**:

-   `KeyboardInterrupt`: Обрабатывает исключение, возникающее при прерывании программы пользователем (Ctrl+C).

**Как работает функция**:

1.  Создает экземпляр драйвера `Chrome`.
2.  Открывает страницу Facebook.
3.  Запускает бесконечный цикл, в котором:
    -   Проверяет, не наступило ли время для перерыва (ночь).
    -   Запускает цикл рекламных кампаний.
    -   Логирует время и засыпает на случайный промежуток времени.
4.  Обрабатывает исключение `KeyboardInterrupt`, которое возникает при прерывании программы пользователем.

**Примеры**:

```python
# Пример вызова функции main
if __name__ == "__main__":
    main()
```

## Переменные

-   `group_file_paths_ru` (list[str]): Список путей к файлам, содержащим информацию о группах Facebook на русском языке.
-   `adv_file_paths_ru` (list[str]): Список путей к файлам, содержащим рекламные объявления на русском языке.
-   `group_file_paths_he` (list[str]): Список путей к файлам, содержащим информацию о группах Facebook на иврите.
-   `adv_file_paths_he` (list[str]): Список путей к файлам, содержащим рекламные объявления на иврите.
-   `group_categories_to_adv` (list[str]): Список категорий групп, в которых будет размещаться реклама.
-   `language_currency_pairs` (list[dict]): Список словарей, содержащих пары язык-валюта для рекламных кампаний.

## ASCII Flowchart для `run_campaign`

```
    Создание экземпляра FacebookPromoter
    │
    └──> Вызов метода run_campaigns
```

## ASCII Flowchart для `campaign_cycle`

```
    Определение путей к файлам и списка язык-валюта
    │
    ├──> Перебор язык-валюта
    │   │
    │   └──> Определение списка кампаний
    │   │
    │   └──> Запуск run_campaign для kazarinov
    │   │
    │   └──> Получение списка кампаний для aliexpress
    │   │
    │   └──> Запуск run_campaign для aliexpress
    │
    └──> Возврат True
```

## ASCII Flowchart для `main`

```
    Создание экземпляра драйвера Chrome
    │
    └──> Открытие страницы Facebook
    │
    └──> Бесконечный цикл
    │   │
    │   ├──> Проверка времени для перерыва
    │   │   │
    │   │   └──> Засыпание
    │   │
    │   └──> Запуск campaign_cycle
    │   │
    │   └──> Логирование и засыпание
    │
    └──> Обработка KeyboardInterrupt