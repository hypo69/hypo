# Модуль options.js

## Обзор

Этот скрипт JavaScript управляет диалоговым окном настроек расширения `try_xpath_1.3.5`. Он позволяет пользователю изменять атрибуты и стили отображения всплывающего окна.  Скрипт получает настройки из хранилища настроек браузера и обновляет поля формы. При сохранении новых настроек скрипт сохраняет их в хранилище и выводит сообщение об успехе или ошибке.


## Переменные

* `defaultAttributes`: Объект, содержащий значения по умолчанию для атрибутов.
* `defaultPopupBodyStyles`: Объект, содержащий значения по умолчанию для стилей всплывающего окна.
* `elementAttr`, `contextAttr`, `focusedAttr`, `ancestorAttr`, `frameAttr`, `frameAncestorAttr`: Переменные, хранящие ссылки на элементы DOM.
* `style`, `popupBodyWidth`, `popupBodyHeight`: Переменные, хранящие ссылки на элементы DOM.
* `message`: Переменная, хранящая ссылку на элемент DOM для вывода сообщений.
* `testElement`: Переменная, используемая для тестирования валидации атрибутов.



## Функции

### `isValidAttrName`

**Описание**: Проверяет, является ли имя атрибута допустимым.

**Параметры**:
- `name` (str): Имя атрибута.

**Возвращает**:
- `bool`: `True`, если имя атрибута допустимо, иначе `False`.

**Вызывает исключения**:
- `Error`:  Возникает, если возникает ошибка при установке атрибута.


### `isValidAttrNames`

**Описание**: Проверяет, являются ли имена атрибутов допустимыми.

**Параметры**:
- `names` (dict): Словарь с именами атрибутов.

**Возвращает**:
- `bool`: `True`, если все имена атрибутов допустимы, иначе `False`.

**Вызывает исключения**:
- `Error`:  Возникает, если возникает ошибка при установке атрибута.

### `isValidStyleLength`

**Описание**: Проверяет, является ли значение длины стиля допустимым.

**Параметры**:
- `len` (str): Значение длины.

**Возвращает**:
- `bool`: `True`, если значение длины допустимо, иначе `False`.

### `loadDefaultCss`

**Описание**: Загружает CSS-стили по умолчанию.

**Возвращает**:
- `Promise<string>`: Обещание, содержащее ответ с CSS.


**Вызывает исключения**:
- `Error`: Если произошла ошибка при загрузке CSS.

### `extractBodyStyles`

**Описание**: Извлекает стили `width` и `height` из CSS-строки.

**Параметры**:
- `css` (str): CSS-строка.

**Возвращает**:
- `object`: Объект со стилями `width` и `height`.


### `createPopupCss`

**Описание**: Создает CSS-строку для всплывающего окна на основе заданных стилей.

**Параметры**:
- `bodyStyles` (object): Объект со стилями `width` и `height`.

**Возвращает**:
- `string`: CSS-строка для всплывающего окна.


### Обработчик события `load`

**Описание**: Обрабатывает событие `load`, выполняя инициализацию элементов и обработку кликов по кнопке сохранения.

**Параметры**: Нет.

**Возвращает**:
- Нет.


**Обрабатывает исключения**:
- `Error`: При ошибках в процессе получения данных или сохранения.




## Обработчики событий


### `save`

Обработчик события `click` для кнопки сохранения. Сохраняет настройки пользователя в хранилище настроек браузера.

### `show-default`

Обработчик события `click` для кнопки "Показать настройки по умолчанию".  Восстанавливает значения атрибутов и стилей до значений по умолчанию.

## Дополнительные замечания


Этот скрипт использует `browser.runtime.sendMessage` для связи с содержанием расширения, `browser.storage.sync` для сохранения настроек и `XMLHttpRequest` для загрузки внешнего CSS.