# Документация для файла background.js

## Обзор

Файл `background.js` отвечает за обработку сообщений от других частей расширения Chrome.  Он слушает сообщения с действием `'collectData'`, получая URL страницы, и отправляет собранные данные на сервер.  Также он обрабатывает клики по значку расширения, отправляя соответствующее сообщение в активную вкладку.

## Оглавление

- [Функции](#функции)
- [Обработчик событий `chrome.browserAction.onClicked`](#обработчик-событий-chrome-browseraction-onclicked)
- [Обработчик сообщений `chrome.runtime.onMessage`](#обработчик-сообщений-chrome-runtime-onmessage)
- [Функция `sendDataToServer`](#функция-senddatatoserver)


## Обработчик событий `chrome.browserAction.onClicked`

### `chrome.browserAction.onClicked.addListener`

**Описание**:  Слушает события кликов по значку расширения.

**Параметры**:

- `tab` (object): Объект, содержащий информацию о вкладке, на которую был нажат значок.


**Вызывает**:
- `chrome.tabs.sendMessage`: Отправляет сообщение в активную вкладку с запросом на сбор данных.


## Обработчик сообщений `chrome.runtime.onMessage`

### `chrome.runtime.onMessage.addListener`

**Описание**: Слушает сообщения, отправленные в контексте расширения.

**Параметры**:

- `message` (object): Объект сообщения, отправленного отправителем.
- `sender` (object): Объект, содержащий информацию об отправителе сообщения.
- `sendResponse` (function): Функция, используемая для отправки ответа обратно отправителю (если нужно).


**Обрабатывает сообщения**:

- **`message.action === 'collectData'`**: Вызывает функцию `sendDataToServer` с переданным URL.


## Функция `sendDataToServer`

### `sendDataToServer(url: string)`

**Описание**: Отправляет собранные данные на сервер.

**Параметры**:

- `url` (string): URL страницы, для которой требуется собрать данные.


**Возвращает**:
- Возвращает значение, полученное в результате выполнения `fetch` запроса.  Если запрос не удался, то выбрасывается исключение.


**Вызывает исключения**:

- `Error`: В случае, если запрос к серверу не успешен.



## Функции

### `sendDataToServer(url: string)`

**Описание**: Отправляет данные на сервер с помощью запроса `POST`.

**Параметры**:

- `url` (string): Адрес сервера.

**Возвращает**:
- Обещает `Promise`, разрешение которого зависит от успешного выполнения запроса или ошибки.

**Вызывает исключения**:

- `Error`: Если запрос не удается.

**Примечание**: Значение переменной `serverUrl` должно быть заменено на реальный URL сервера.