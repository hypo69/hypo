# Анализ кода модуля ROCKSP

**Качество кода**
9
-  Плюсы
    - Документ подробно описывает игровую логику и шаги реализации.
    - Чётко определены правила игры, условия победы и ограничения.
    - Приведены примеры работы программы и рекомендации по улучшению.
-  Минусы
    - Документ не содержит исполняемого кода, что затрудняет оценку его качества.
    - Отсутствует описание конкретной структуры данных для представления доски.
    - Нет подробного описания функций, используемых для реализации игры.

**Рекомендации по улучшению**

1. **Добавить структуру данных:**
   - Описать структуру данных для представления игровой доски, например, двумерный массив.
   - Указать, как представляются камни игроков на доске (например, символами 'R' и 'B').

2. **Детализировать функции:**
   - Описать функции, которые будут использоваться для проверки допустимости хода, проверки победы и т.д.
   - Указать типы аргументов и возвращаемые значения для каждой функции.

3. **Указать алгоритмы:**
   - Описать алгоритмы для проверки условий победы (например, блокирование противника).
   - Описать алгоритм проверки доступности ходов.

4. **Учесть ввод пользователя:**
    - Детализировать обработку ввода пользователя, включая проверку на корректность формата координат.

5. **Рекомендации по GUI:**
    - Дать более подробные рекомендации по реализации графического интерфейса.

6. **Рефакторинг и улучшения**:
     - Привести пример кода на Python с соблюдением правил стиля.
     - Добавить комментарии в формате reStructuredText.
     - Использовать `logger` для отслеживания ошибок.
     - Показать примеры обработки ошибок с использованием `try-except`.

**Оптимизированный код**

```markdown
### Название игры: **ROCKSP** (Камни)
=========================================================================================

Игра ROCKSP - это стратегическая игра для двух игроков, где целью является блокировка ходов соперника путем размещения камней на игровой доске. Игра заканчивается, когда один из игроков не может сделать ход или достигнуто максимальное количество ходов.

#### Описание
-----------------------------------------------------------------------------------------
**ROCKSP** — это логическая игра, в которой игроки по очереди размещают камни на доске. Цель игры — заблокировать соперника, чтобы он не смог сделать ход. Игра продолжается до тех пор, пока один из игроков не заблокирует соперника или пока не будет достигнуто максимальное количество ходов.

---

### Пошаговая инструкция для реализации
-----------------------------------------------------------------------------------------

#### 1. **Инициализация игры**
   - Программа выводит приветственное сообщение и объясняет правила:
     ```
     Добро пожаловать в ROCKSP!
     Ваша задача — заблокировать соперника, размещая камни на доске.
     Игра продолжается до тех пор, пока один из игроков не заблокирует соперника или пока не будет достигнуто максимальное количество ходов.
     Удачи!
     ```
   - Программа создаёт игровую доску размером 6x6.
   - Игроки поочерёдно делают ходы, размещая свои камни на доске.

---

#### 2. **Основной процесс игры**
-----------------------------------------------------------------------------------------

##### **2.1. Ход игрока:**
   - Игрок выбирает клетку, куда хочет разместить свой камень, указывая координаты (например, B2).
   - Программа проверяет, является ли ход допустимым:
     - Камень должен быть размещён на пустую клетку.
     - Камень не может быть размещён за пределы доски.

   - Если ход допустим, программа размещает камень и отображает текущее состояние доски:
     ```
     Текущее состояние доски:
     A B C D E F
     1 [ ][ ][ ][ ][ ][ ]
     2 [ ][R][ ][ ][ ][ ]
     3 [ ][ ][ ][ ][ ][ ]
     4 [ ][ ][ ][ ][ ][ ]
     5 [ ][ ][ ][ ][ ][ ]
     6 [ ][ ][ ][ ][ ][ ]
     ```

   - Если ход недопустим, программа сообщает об ошибке и предлагает игроку повторить ход:
     ```
     Недопустимый ход. Попробуйте снова.
     ```

##### **2.2. Проверка условий победы:**
   - После каждого хода программа проверяет, может ли соперник сделать ход.
   - Если соперник не может сделать ход, программа объявляет победителя:
     ```
     Игра окончена! Победил Игрок 1.
     ```

##### **2.3. Проверка условий завершения игры:**
   - Игра заканчивается, если достигнуто максимальное количество ходов (например, 20 ходов).
   - Программа объявляет ничью:
     ```
     Игра окончена! Ничья.
     ```

---

#### 3. **Завершение игры**
-----------------------------------------------------------------------------------------
   - После завершения игры программа предлагает сыграть снова:
     ```
     Хотите сыграть снова? (да/нет)
     ```
   - Если игрок выбирает "да", игра начинается заново с новой доски.

---

### Пример работы программы
-----------------------------------------------------------------------------------------

1. **Начало игры:**
   ```
   Добро пожаловать в ROCKSP!
   Игрок 1, ваш ход.
   Введите координаты клетки, куда хотите разместить камень (например, B2):
   > B2
   Камень размещён на клетку B2.
   ```

2. **Игровой процесс:**
   ```
   Игрок 2, ваш ход.
   Введите координаты клетки, куда хотите разместить камень:
   > C3
   Камень размещён на клетку C3.

   Игрок 1, ваш ход.
   Введите координаты клетки, куда хотите разместить камень:
   > D4
   Камень размещён на клетку D4.
   ```

3. **Завершение игры:**
   ```
   Игра окончена! Победил Игрок 1.
   Хотите сыграть снова? (да/нет):
   > нет
   Спасибо за игру!
   ```

---

### Возможные ограничения
-----------------------------------------------------------------------------------------
- Игрок должен вводить координаты в правильном формате (например, A1, B2).
- Программа должна обрабатывать неверный ввод и предлагать повторить попытку.
- Камни не могут быть размещены на занятые клетки или за пределы доски.

---

### Реализация
-----------------------------------------------------------------------------------------
Игра может быть реализована на Python с использованием следующих возможностей:
- **Массивы или списки** для представления доски и положения камней.
- **Циклы и условия** для проверки ввода игрока и обработки его ходов.
- **Функции** для проверки условий победы и завершения игры.

**Пример кода:**
```python
"""
Модуль для реализации игры ROCKSP (Камни)
=========================================================================================
"""
from typing import List, Tuple
from src.logger.logger import logger

# Константы
BOARD_SIZE = 6
MAX_MOVES = 20


def create_board() -> List[List[str]]:
    """
    Создаёт пустую игровую доску 6x6.

    :return: Двумерный список, представляющий игровую доску.
    """
    return [[' ' for _ in range(BOARD_SIZE)] for _ in range(BOARD_SIZE)]


def print_board(board: List[List[str]]) -> None:
    """
    Выводит текущее состояние игровой доски.

    :param board: Двумерный список, представляющий игровую доску.
    """
    print('  ' + ' '.join(chr(ord('A') + i) for i in range(BOARD_SIZE)))
    for i, row in enumerate(board):
        print(f'{i + 1} {" ".join(row)}')


def is_valid_move(board: List[List[str]], move: str) -> bool:
    """
    Проверяет, является ли ход допустимым.

    :param board: Двумерный список, представляющий игровую доску.
    :param move: Строка, представляющая ход (например, 'B2').
    :return: True, если ход допустим, иначе False.
    """
    if len(move) != 2:
        return False
    try:
        col = ord(move[0].upper()) - ord('A')
        row = int(move[1]) - 1
    except (ValueError, TypeError):
        return False

    if not (0 <= col < BOARD_SIZE and 0 <= row < BOARD_SIZE):
        return False
    return board[row][col] == ' '


def make_move(board: List[List[str]], move: str, player: str) -> None:
    """
    Размещает камень игрока на доске.

    :param board: Двумерный список, представляющий игровую доску.
    :param move: Строка, представляющая ход (например, 'B2').
    :param player: Символ, представляющий игрока ('R' или 'B').
    """
    col = ord(move[0].upper()) - ord('A')
    row = int(move[1]) - 1
    board[row][col] = player


def get_possible_moves(board: List[List[str]]) -> List[str]:
    """
    Возвращает список всех возможных ходов.

    :param board: Двумерный список, представляющий игровую доску.
    :return: Список строк, представляющих возможные ходы.
    """
    moves = []
    for row in range(BOARD_SIZE):
        for col in range(BOARD_SIZE):
            move = chr(ord('A') + col) + str(row + 1)
            if is_valid_move(board, move):
                moves.append(move)
    return moves


def check_winner(board: List[List[str]], current_player: str) -> bool:
    """
    Проверяет, есть ли победитель.

    :param board: Двумерный список, представляющий игровую доску.
    :param current_player: Символ, представляющий текущего игрока ('R' или 'B').
    :return: True, если победитель есть, иначе False.
    """
    opponent = 'B' if current_player == 'R' else 'R'
    possible_moves = get_possible_moves(board)
    if not possible_moves:
        return True
    return False


def play_game() -> None:
    """
    Основная функция для запуска игры.
    """
    board = create_board()
    current_player = 'R'
    moves_count = 0

    print("Добро пожаловать в ROCKSP!")
    print("Ваша задача — заблокировать соперника, размещая камни на доске.")
    print("Игра продолжается до тех пор, пока один из игроков не заблокирует соперника или пока не будет достигнуто максимальное количество ходов.")
    print("Удачи!")

    while moves_count < MAX_MOVES:
        print_board(board)
        print(f"Игрок {current_player}, ваш ход.")
        move = input("Введите координаты клетки, куда хотите разместить камень (например, B2): ").strip()

        if not is_valid_move(board, move):
            print("Недопустимый ход. Попробуйте снова.")
            continue

        make_move(board, move, current_player)
        moves_count += 1

        if check_winner(board, current_player):
            print_board(board)
            print(f"Игра окончена! Победил Игрок {'R' if current_player == 'B' else 'B'}.")
            break

        current_player = 'B' if current_player == 'R' else 'R'

    if moves_count == MAX_MOVES:
        print_board(board)
        print("Игра окончена! Ничья.")

    play_again = input("Хотите сыграть снова? (да/нет): ").strip().lower()
    if play_again == 'да':
        play_game()
    else:
        print("Спасибо за игру!")


if __name__ == '__main__':
    try:
        play_game()
    except Exception as ex:
        logger.error('Произошла ошибка в игре', ex)
```

---

### Рекомендуемые улучшения
-----------------------------------------------------------------------------------------
- Добавить возможность игры с компьютером.
- Реализовать графический интерфейс для визуализации доски и ходов.
- Добавить возможность выбора размера доски (например, 8x8 или 10x10).
```