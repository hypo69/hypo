# Документация модуля нормализации данных `normalizer`

## Обзор

Модуль `normalizer` предоставляет набор функций для нормализации различных типов данных, включая строки, булевы значения, целые числа, числа с плавающей запятой и даты. Он также включает вспомогательные функции для обработки текста, такие как удаление HTML-тегов и специальных символов.

## Подробней

Этот модуль предоставляет удобные утилиты для предварительной обработки и очистки данных, что особенно полезно при работе с пользовательским вводом, данными из внешних источников или при подготовке данных для машинного обучения. Он помогает обеспечить консистентность и корректность данных, упрощая дальнейший анализ и обработку.

## Функции модуля

### `normalize_boolean`

```python
def normalize_boolean(input_data: Any) -> bool:
    """
    Преобразует входное значение в булево значение.

    Args:
        input_data (Any): Данные, которые могут представлять булево значение (строка, число, булев тип).

    Returns:
        bool: Преобразованное булево значение.

    Example:
        >>> normalize_boolean('yes')
        True
        >>> normalize_boolean(0)
        False
    """
```

**Назначение**: Преобразует различные типы входных данных в булево значение.

**Параметры**:
- `input_data` (Any): Входные данные любого типа, которые могут быть интерпретированы как булево значение.

**Возвращает**:
- `bool`: Булево значение, полученное в результате преобразования.

**Как работает функция**:
1. Функция принимает входные данные `input_data`.
2. Входные данные преобразуются в булево значение на основе их типа и значения.
3. Если входные данные являются строкой, то проверяется, соответствуют ли они значениям `'true'`, `'yes'` (игнорируя регистр).
4. Если входные данные являются числом, то проверяется, равно ли оно нулю.
5. Если входные данные уже являются булевым значением, то они возвращаются без изменений.

**ASCII Flowchart**:

```
Начало --> Проверка типа данных (Строка?)
Строка? -- Да --> Преобразование в нижний регистр --> Проверка на 'true'/'yes' --> Булево значение (True/False)
Строка? -- Нет --> Проверка типа данных (Число?)
Число? -- Да --> Проверка на равенство нулю --> Булево значение (True/False)
Число? -- Нет --> Возврат исходного значения (если это булево значение)
```

**Примеры**:
- `normalize_boolean('yes')` возвращает `True`.
- `normalize_boolean('No')` возвращает `False`.
- `normalize_boolean(1)` возвращает `True`.
- `normalize_boolean(0)` возвращает `False`.
- `normalize_boolean(True)` возвращает `True`.
- `normalize_boolean(False)` возвращает `False`.

---

### `normalize_string`

```python
def normalize_string(input_data: str | list) -> str:
    """
    Преобразует строку или список строк в нормализованную строку, удаляя лишние пробелы, HTML теги и специальные символы.

    Args:
        input_data (str | list): Строка или список строк.

    Returns:
        str: Очищенная строка в кодировке UTF-8.

    Example:
        >>> normalize_string(['  Example string  ', '<b>with HTML</b>'])
        'Example string with HTML'
    """
```

**Назначение**: Преобразует входную строку или список строк в нормализованную строку, очищая ее от лишних пробелов, HTML-тегов и специальных символов.

**Параметры**:
- `input_data` (str | list): Строка или список строк для нормализации.

**Возвращает**:
- `str`: Очищенная строка в кодировке UTF-8.

**Как работает функция**:
1. Функция принимает входные данные `input_data`, которые могут быть строкой или списком строк.
2. Если `input_data` - это список, он объединяется в одну строку с пробелами между элементами.
3. Из полученной строки удаляются HTML-теги.
4. Удаляются символы новой строки.
5. Удаляются специальные символы.
6. В начале и в конце строки обрезаются лишние пробелы.

**ASCII Flowchart**:

```
Начало --> Проверка типа данных (Список?)
Список? -- Да --> Объединение списка в строку с пробелами
Список? -- Нет --> Исходная строка
|
--> Удаление HTML-тегов
|
--> Удаление символов новой строки
|
--> Удаление специальных символов
|
--> Удаление лишних пробелов в начале и конце строки
|
--> Возврат очищенной строки
```

**Примеры**:
- `normalize_string(['<h1>Header</h1>', ' text with spaces '])` возвращает `'Header text with spaces'`.
- `normalize_string(' Special chars: @#$ ')` возвращает `'Special chars: '`.
- `normalize_string('Line breaks:\ntext')` возвращает `'Line breaks:text'`.

---

### `normalize_int`

```python
def normalize_int(input_data: str | int | float | Decimal) -> int:
    """
    Преобразует входное значение в целое число.

    Args:
        input_data (str | int | float | Decimal): Число или его строковое представление.

    Returns:
        int: Преобразованное целое число.

    Example:
        >>> normalize_int('42')
        42
        >>> normalize_int(3.14)
        3
    """
```

**Назначение**: Преобразует входное значение (число или его строковое представление) в целое число.

**Параметры**:
- `input_data` (str | int | float | Decimal): Число или его строковое представление.

**Возвращает**:
- `int`: Преобразованное целое число.

**Как работает функция**:
1. Функция принимает входные данные `input_data`, которые могут быть строкой, целым числом, числом с плавающей точкой или Decimal.
2. Если `input_data` является строкой, она преобразуется в число с плавающей точкой, а затем в целое число.
3. Если `input_data` является числом (целым или с плавающей точкой), оно преобразуется в целое число.

**ASCII Flowchart**:

```
Начало --> Проверка типа данных (Строка?)
Строка? -- Да --> Преобразование строки в число с плавающей точкой --> Преобразование в целое число
Строка? -- Нет --> Проверка типа данных (Число?)
Число? -- Да --> Преобразование в целое число
|
--> Возврат целого числа
```

**Примеры**:
- `normalize_int('42')` возвращает `42`.
- `normalize_int(3.14)` возвращает `3`.
- `normalize_int(42.99)` возвращает `42`.

---

### `normalize_float`

```python
def normalize_float(value: Any) -> float | List[float] | None:
    """
    Преобразует входное значение в число с плавающей запятой.

    Args:
        value (Any): Число, строка или список чисел.

    Returns:
        float | List[float] | None: Число с плавающей запятой, список чисел с плавающей запятой или `None` в случае ошибки.

    Example:
        >>> normalize_float('3.14')
        3.14
        >>> normalize_float([1, '2.5', 3])
        [1.0, 2.5, 3.0]
    """
```

**Назначение**: Преобразует входное значение в число с плавающей запятой.

**Параметры**:
- `value` (Any): Число, строка или список чисел.

**Возвращает**:
- `float | List[float] | None`: Число с плавающей запятой, список чисел с плавающей запятой или `None` в случае ошибки.

**Как работает функция**:
1. Функция принимает входные данные `value`, которые могут быть числом, строкой или списком чисел.
2. Если `value` является строкой, она преобразуется в число с плавающей точкой.
3. Если `value` является числом, оно преобразуется в число с плавающей точкой.
4. Если `value` является списком, каждый элемент списка преобразуется в число с плавающей точкой.

**ASCII Flowchart**:

```
Начало --> Проверка типа данных (Список?)
Список? -- Да --> Преобразование каждого элемента списка в число с плавающей точкой
Список? -- Нет --> Проверка типа данных (Строка?)
Строка? -- Да --> Преобразование строки в число с плавающей точкой
Строка? -- Нет --> Преобразование в число с плавающей точкой
|
--> Возврат числа с плавающей точкой или списка чисел с плавающей точкой
```

**Примеры**:
- `normalize_float('3.14')` возвращает `3.14`.
- `normalize_float([1, '2.5', 3])` возвращает `[1.0, 2.5, 3.0]`.
- `normalize_float(5)` возвращает `5.0`.

---

### `remove_line_breaks`

```python
def remove_line_breaks(input_str: str) -> str:
    """
    Удаляет символы новой строки из строки.

    Args:
        input_str (str): Входная строка.

    Returns:
        str: Строка без символов новой строки.

    Example:
        >>> remove_line_breaks('String\\nwith line breaks\\r')
        'String with line breaks'
    """
```

**Назначение**: Удаляет символы новой строки (`\n` и `\r`) из входной строки.

**Параметры**:
- `input_str` (str): Входная строка.

**Возвращает**:
- `str`: Строка без символов новой строки.

**Как работает функция**:
1. Функция принимает входную строку `input_str`.
2. Из строки удаляются все символы новой строки (`\n` и `\r`).

**ASCII Flowchart**:

```
Начало --> Получение входной строки
|
--> Удаление символов '\n'
|
--> Удаление символов '\r'
|
--> Возврат строки без символов новой строки
```

**Примеры**:
- `remove_line_breaks('String\nwith line breaks\r')` возвращает `'Stringwith line breaks'`.
- `remove_line_breaks('Another\nString')` возвращает `'AnotherString'`.

---

### `remove_html_tags`

```python
def remove_html_tags(input_html: str) -> str:
    """
    Удаляет HTML теги из строки.

    Args:
        input_html (str): Входная строка с HTML тегами.

    Returns:
        str: Строка без HTML тегов.

    Example:
        >>> remove_html_tags('<p>Example text</p>')
        'Example text'
    """
```

**Назначение**: Удаляет HTML-теги из входной строки.

**Параметры**:
- `input_html` (str): Входная строка, содержащая HTML-теги.

**Возвращает**:
- `str`: Строка, из которой удалены все HTML-теги.

**Как работает функция**:
1. Функция принимает входную строку `input_html`.
2. С использованием регулярного выражения из строки удаляются все HTML-теги.

**ASCII Flowchart**:

```
Начало --> Получение входной строки с HTML
|
--> Удаление HTML-тегов с использованием регулярного выражения
|
--> Возврат строки без HTML-тегов
```

**Примеры**:
- `remove_html_tags('<p>Example text</p>')` возвращает `'Example text'`.
- `remove_html_tags('<div>Text with <b>bold</b></div>')` возвращает `'Text with bold'`.

---

### `remove_special_characters`

```python
def remove_special_characters(input_str: str | list) -> str | list:
    """
    Удаляет специальные символы из строки или списка строк.

    Args:
        input_str (str | list): Строка или список строк.

    Returns:
        str | list: Строка или список строк без специальных символов.

    Example:
        >>> remove_special_characters('Hello@World!')
        'HelloWorld'
    """
```

**Назначение**: Удаляет специальные символы из входной строки или списка строк.

**Параметры**:
- `input_str` (str | list): Строка или список строк, из которых нужно удалить специальные символы.

**Возвращает**:
- `str | list`: Строка или список строк без специальных символов.

**Как работает функция**:
1. Функция принимает входные данные `input_str`, которые могут быть строкой или списком строк.
2. Если `input_str` является строкой, то из нее удаляются все символы, не являющиеся буквенно-цифровыми.
3. Если `input_str` является списком, то к каждому элементу списка применяется операция удаления специальных символов.

**ASCII Flowchart**:

```
Начало --> Проверка типа данных (Список?)
Список? -- Да --> Применение операции удаления специальных символов к каждому элементу списка
Список? -- Нет --> Удаление специальных символов из строки
|
--> Возврат строки или списка строк без специальных символов
```

**Примеры**:
- `remove_special_characters('Hello@World!')` возвращает `'HelloWorld'`.
- `remove_special_characters(['String#1', 'String$2'])` возвращает `['String1', 'String2']`.

---

### `normalize_sql_date`

```python
def normalize_sql_date(input_data: str | datetime) -> str:
    """
    Преобразует строку или объект `datetime` в стандартный формат SQL даты (`YYYY-MM-DD`).

    Args:
        input_data (str | datetime): Строка или объект `datetime`, представляющий дату.

    Returns:
        str: Нормализованная дата в формате строки `YYYY-MM-DD`.

    Example:
        >>> normalize_sql_date('2024-12-06')
        '2024-12-06'
        >>> normalize_sql_date(datetime(2024, 12, 6))
        '2024-12-06'
    """
```

**Назначение**: Преобразует строку или объект `datetime` в стандартный формат SQL даты (`YYYY-MM-DD`).

**Параметры**:
- `input_data` (str | datetime): Строка или объект `datetime`, представляющий дату.

**Возвращает**:
- `str`: Нормализованная дата в формате строки `YYYY-MM-DD`.

**Как работает функция**:
1. Функция принимает входные данные `input_data`, которые могут быть строкой или объектом `datetime`.
2. Если `input_data` является строкой, она преобразуется в объект `datetime`.
3. Если `input_data` является объектом `datetime`, он форматируется в строку в формате `YYYY-MM-DD`.

**ASCII Flowchart**:

```
Начало --> Проверка типа данных (Строка?)
Строка? -- Да --> Преобразование строки в объект datetime
Строка? -- Нет --> Проверка типа данных (Datetime?)
Datetime? -- Да --> Форматирование объекта datetime в строку 'YYYY-MM-DD'
|
--> Возврат строки в формате 'YYYY-MM-DD'
```

**Примеры**:
- `normalize_sql_date('2024-12-06')` возвращает `'2024-12-06'`.
- `normalize_sql_date(datetime(2024, 12, 6))` возвращает `'2024-12-06'`.

## Пример использования

```python
from src.utils.string.normalizer import normalize_string, normalize_boolean, normalize_int, normalize_float, normalize_sql_date

# Нормализация строки
clean_str = normalize_string(['<h1>Header</h1>', '  text with spaces  '])
print(clean_str)  # 'Header text with spaces'

# Нормализация булевого значения
is_active = normalize_boolean('Yes')
print(is_active)  # True

# Нормализация целого числа
integer_value = normalize_int('42')
print(integer_value)  # 42

# Нормализация числа с плавающей запятой
float_value = normalize_float('3.14159')
print(float_value)  # 3.14159

# Нормализация SQL даты
sql_date = normalize_sql_date('2024-12-06')
print(sql_date)  # '2024-12-06'
```

## Требования

- Python 3.10 или выше.
- Модуль `src.logger` для логирования.

## Логирование

Все ошибки и предупреждения записываются через `logger`:
- Ошибки записываются с использованием `logger.error`.
- Неожиданные значения записываются с использованием `logger.debug` или `logger.warning`.