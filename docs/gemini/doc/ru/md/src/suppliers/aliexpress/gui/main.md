# Модуль `hypotez/src/suppliers/aliexpress/gui/main.py`

## Обзор

Данный модуль предоставляет основное окно приложения для управления рекламными кампаниями на AliExpress. Он содержит класс `MainApp`, реализующий интерфейс пользователя с вкладками для редактирования JSON-файлов, кампаний и продуктов.  Модуль использует библиотеки PyQt6 для построения графического интерфейса и asyncio для асинхронных операций.

## Оглавление

- [Модуль `main.py`](#модуль-mainpy)
- [Класс `MainApp`](#класс-mainapp)
- [Функция `main`](#функция-main)


## Классы

### `MainApp`

**Описание**: Главный класс приложения, управляющий интерфейсом пользователя.

**Методы**:

- `__init__(self)`:
    **Описание**: Инициализирует главное окно приложения с вкладками для редактирования JSON, кампаний и продуктов. Настраивает размеры окна, добавляет виджеты QTabWidget, добавляет вкладку JSON-редактора, кампаний и продуктов. Создает и добавляет элементы меню.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при ошибках инициализации.

- `create_menubar(self)`:
    **Описание**: Создает строку меню приложения. Добавляет пункты "File" (Открыть, Сохранить, Выход), "Edit" (Копировать, Вставить).  Связывает действия с соответствующими обработчиками.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при ошибках создания меню.

- `open_file(self)`:
    **Описание**: Открывает диалоговое окно для выбора и загрузки JSON-файла. Загружает файл в выбранную вкладку.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при ошибках работы с файлом.

- `save_file(self)`:
    **Описание**: Сохраняет текущий файл в выбранной вкладке.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при ошибках сохранения файла.

- `exit_application(self)`:
    **Описание**: Закрывает приложение.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при ошибках закрытия.

- `copy(self)`:
    **Описание**: Копирует выделенный текст в буфер обмена.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при отсутствии выделенного текста.

- `paste(self)`:
    **Описание**: Вставляет текст из буфера обмена.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при отсутствии активного виджета.


- `load_file(self, campaign_file)`:
    **Описание**: Загружает JSON-файл.
    **Параметры**:
        - `self`: ссылка на текущий экземпляр класса.
        - `campaign_file` (str): Путь к файлу.
    **Возвращает**:
        - None
    **Вызывает исключения**:
        - `Exception`: Возникает при ошибках загрузки файла.

## Функции

### `main`

**Описание**: Функция запуска приложения. Инициализирует приложение PyQt6, создает главный экземпляр `MainApp` и запускает главный цикл обработки событий.

**Параметры**:
    - Нет
**Возвращает**:
    - None
**Вызывает исключения**:
    - `Exception`: Возникает при ошибках запуска приложения.