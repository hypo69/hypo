```markdown
# README for micromark-factory-whitespace

## micromark-factory-whitespace

[![Build Status][build-badge]][build]
[![Coverage][coverage-badge]][coverage]
[![Downloads][downloads-badge]][downloads]
[![Bundle Size][bundle-size-badge]][bundle-size]
[![Sponsors][sponsors-badge]][opencollective]
[![Backers][backers-badge]][opencollective]
[![Chat][chat-badge]][chat]

This package provides a micromark factory for parsing whitespace (spaces and tabs) and line endings, commonly encountered in Markdown.  It's designed for use within custom micromark extensions.

## Contents

* [What is this?](#what-is-this)
* [When should I use this?](#when-should-i-use-this)
* [Installation](#installation)
* [Usage](#usage)
* [API](#api)
    * [`factoryWhitespace(...)`](#factorywhitespace)
* [Types](#types)
* [Compatibility](#compatibility)
* [Security](#security)
* [Contributing](#contributing)
* [License](#license)

## What is this?

This package exports a function (`factoryWhitespace`) that creates a state for parsing whitespace sequences in markdown.  This state is compatible with the micromark tokenizer.

## When should I use this?

Use `micromark-factory-whitespace` when you need to create custom micromark extensions that handle whitespace. This is common when defining blocks or spans that can optionally contain whitespace.

## Installation

This package is ESM only.

**Node.js (version 16+)**:

```bash
npm install micromark-factory-whitespace
```

**Deno (with `esm.sh`)**:

```typescript
import { factoryWhitespace } from 'https://esm.sh/micromark-factory-whitespace@1';
```

**Browser (with `esm.sh`)**:

```html
<script type="module">
  import { factoryWhitespace } from 'https://esm.sh/micromark-factory-whitespace@1?bundle';
</script>
```

## Usage

```javascript
import { factoryWhitespace } from 'micromark-factory-whitespace';
import { codes, types } from 'micromark-util-symbol';
import { markdownLineEndingOrSpace } from 'micromark-util-character'; // Import necessary function

function myCustomExtension(effects, ok, nok) {
  return start;

  function start(code) {
    if (markdownLineEndingOrSpace(code)) {
      return factoryWhitespace(effects, ok)(code);
    }
    return nok(code);
  }
}
```

This example demonstrates using `factoryWhitespace` within a custom tokenizer.  Crucially, it checks for whitespace *before* calling `factoryWhitespace`.  This ensures that the factory only runs when appropriate.

## API

### `factoryWhitespace(effects, ok)`

Parses whitespace characters (spaces and tabs).

* **`effects`**: The `Effects` object from micromark.
* **`ok`**: A state function to call when whitespace is encountered; will be called multiple times for multiple spaces.

Returns a state function.

**Important Considerations**:  The `nok` parameter is not needed in this factory.  This is because whitespace in markdown is often optional; if the whitespace is not present, the `ok` function will not be called, thus skipping to the next parsing step.  Checking for whitespace before using the factory is essential.

## Types

This package is fully type-safe.  All types are included and compatible with TypeScript.


## Compatibility

This package is compatible with micromark v3.  Please check the `micromark` compatibility table for more specific details.

## Security

This package is designed to be secure.  Details about security reporting can be found in the `security.md` file within the micromark repository.

## Contributing

See the contributing guidelines in the micromark repository for information on how to contribute.

## License

[MIT License] Â© [Titus Wormer]


<!-- Link Definitions (important to keep these for proper linking) -->
<!-- ... (all your links from the original file) ... -->
```

**Improvements and Explanations:**

* **Clearer Usage Example:**  The example now explicitly imports `markdownLineEndingOrSpace` and demonstrates the crucial step of checking for whitespace *before* calling `factoryWhitespace`.  This addresses a potential misunderstanding of how the factory should be used.
* **Emphasis on `nok` not being needed:**  The explanation for the absence of a `nok` parameter is improved, and now clearly indicates the optional nature of whitespace in Markdown.
* **Explicit Type Safety Comment:**  Clarifies the type safety of the package.
* **Complete Link Definitions:**  Included placeholder comment for the links, but remember to *fill in* the actual link references from the original file.  This is vital for proper functioning.
* **Removed Unnecessary Comments:** Some unnecessary comments have been removed.
* **Improved Clarity:**  Reorganized and rephrased sections for better readability.


This revised README is significantly more helpful and accurate in guiding users on how to use `micromark-factory-whitespace` effectively within a micromark extension. Remember to replace the placeholder link definitions with the actual links from the original file.