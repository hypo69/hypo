# Модуль reach_spreadsheet

## Обзор

Модуль `reach_spreadsheet` предоставляет средства для взаимодействия с Google Sheets API v4. Он позволяет создавать, изменять и получать доступ к данным в электронных таблицах Google.  Модуль содержит класс `ReachSpreadsheet`, который предоставляет методы для выполнения различных операций, таких как создание листов, изменение размеров ячеек, добавление данных и совместное использование электронных таблиц.

## Классы

### `SpreadsheetError`

**Описание**: Базовый класс для исключений, связанных с ошибками работы с электронными таблицами.

**Подклассы**:
- `SpreadsheetNotSetError`
- `SheetNotSetError`

### `SpreadsheetNotSetError`

**Описание**: Исключение, которое возникает, когда не задан идентификатор электронный таблицы.

### `SheetNotSetError`

**Описание**: Исключение, которое возникает, когда не задан идентификатор листа.


### `ReachSpreadsheet`

**Описание**: Класс для взаимодействия с Google Sheets API.


**Методы**:

#### `__init__(self, debugMode=False)`

**Описание**: Конструктор класса.

**Параметры**:
- `debugMode` (bool, необязательно): Флаг отладки. По умолчанию `False`.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возникает при ошибке создания учетных данных.


#### `create(self, title, sheetTitle, rows=1000, cols=26, locale='en-US', timeZone='Etc/GMT')`

**Описание**: Создает новую электронную таблицу с заданными параметрами.

**Параметры**:
- `title` (str): Заголовок электронной таблицы.
- `sheetTitle` (str): Заголовок листа.
- `rows` (int, необязательно): Количество строк в листе. По умолчанию 1000.
- `cols` (int, необязательно): Количество столбцов в листе. По умолчанию 26.
- `locale` (str, необязательно): Локаль. По умолчанию 'en-US'.
- `timeZone` (str, необязательно): Часовой пояс. По умолчанию 'Etc/GMT'.

**Возвращает**:
- `dict`: Словарь с информацией о созданной электронной таблице.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.

#### `share(self, shareRequestBody)`

**Описание**: Добавляет или обновляет разрешения для доступа к электронной таблице.

**Параметры**:
- `shareRequestBody` (dict): Данные о разрешении доступа.

**Возвращает**:
- `dict`: Словарь с информацией о результате операции.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если идентификатор электронной таблицы не задан.

#### `shareWithEmailForReading(self, email)`

**Описание**: Добавляет разрешение на чтение для пользователя по email.

**Параметры**:
- `email` (str): Email пользователя.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.


#### `shareWithEmailForWriting(self, email)`

**Описание**: Добавляет разрешение на запись для пользователя по email.

**Параметры**:
- `email` (str): Email пользователя.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.


#### `shareWithAnybodyForReading(self)`

**Описание**: Разрешает чтение для всех пользователей.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.


#### `shareWithAnybodyForWriting(self)`

**Описание**: Разрешает запись для всех пользователей.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.


#### `getSheetURL(self)`

**Описание**: Возвращает URL электронной таблицы.

**Возвращает**:
- `str`: URL электронной таблицы.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если идентификатор электронной таблицы не задан.
- `SheetNotSetError`: Если идентификатор листа не задан.


#### `setSpreadsheetById(self, spreadsheetId)`

**Описание**: Устанавливает текущую электронную таблицу по ее идентификатору.

**Параметры**:
- `spreadsheetId` (str): Идентификатор электронной таблицы.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.



#### `runPrepared(self, valueInputOption='USER_ENTERED')`

**Описание**: Выполняет подготовленные запросы к Google Sheets API.

**Параметры**:
- `valueInputOption` (str, необязательно): Способ ввода данных. По умолчанию 'USER_ENTERED'.

**Возвращает**:
- `tuple`: Кортеж с результатами запросов batchUpdate.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если идентификатор электронной таблицы не задан.



#### `prepare_addSheet(self, sheetTitle, rows=1000, cols=26)`

**Описание**: Подготавливает запрос на добавление нового листа.

**Параметры**:
- `sheetTitle` (str): Название листа.
- `rows` (int, необязательно): Количество строк. По умолчанию 1000.
- `cols` (int, необязательно): Количество столбцов. По умолчанию 26.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- `Exception`: Возможны ошибки при взаимодействии с API.


#### `addSheet(self, sheetTitle, rows=1000, cols=26)`

**Описание**: Добавляет новый лист и устанавливает его как текущий.

**Параметры**:
- `sheetTitle` (str): Название листа.
- `rows` (int, необязательно): Количество строк. По умолчанию 1000.
- `cols` (int, необязательно): Количество столбцов. По умолчанию 26.

**Возвращает**:
- `int`: Идентификатор добавленного листа.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если идентификатор электронной таблицы не задан.
- `Exception`: Возможны ошибки при взаимодействии с API.



#### `toGridRange(self, cellsRange)`

**Описание**: Преобразует строковое представление диапазона ячеек в словарь GridRange.

**Параметры**:
- `cellsRange` (str | dict): Диапазон ячеек в формате "A1:B2" или словарь GridRange.

**Возвращает**:
- `dict`: Словарь с данными диапазона ячеек.

**Вызывает исключения**:
- `SheetNotSetError`: Если идентификатор листа не задан.


#### `prepare_setDimensionPixelSize(self, dimension, startIndex, endIndex, pixelSize)`

**Описание**: Подготавливает запрос на изменение размера ячеек.


#### `prepare_setColumnsWidth(self, startCol, endCol, width)`

#### `prepare_setColumnWidth(self, col, width)`

#### `prepare_setRowsHeight(self, startRow, endRow, height)`

#### `prepare_setRowHeight(self, row, height)`


#### `prepare_setValues(self, cellsRange, values, majorDimension='ROWS')`

#### `prepare_mergeCells(self, cellsRange, mergeType='MERGE_ALL')`

#### `prepare_setCellStringFormatterormat(self, cellsRange, formatJSON, fields='userEnteredFormat')`

#### `prepare_setCellStringFormatterormats(self, cellsRange, formatsJSON, fields='userEnteredFormat')`

**Описание**: Подготавливают запросы на форматирование ячеек. (Более подробные описания этих методов требуют более подробного анализа кода и значений параметров `formatJSON` и `formatsJSON`.)


## Функции

### `htmlColorToJSON(htmlColor)`

**Описание**: Преобразует HTML-цвет в JSON-формат.

**Параметры**:
- `htmlColor` (str): HTML-цвет в формате "#RRGGBB".

**Возвращает**:
- `dict`: Словарь с компонентами цвета.


## Тесты (функции)

Документированные тесты для класса `ReachSpreadsheet`  приведены в коде.