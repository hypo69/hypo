```markdown
# whatwg-url

`whatwg-url` предоставляет полную реализацию стандарта WHATWG [URL](https://url.spec.whatwg.org/).  Его можно использовать автономно, но также он экспонирует множество внутренних алгоритмов, полезных для интеграции парсера URL в проекты, такие как [jsdom](https://github.com/tmpvar/jsdom).

## Текущий статус

`whatwg-url` в настоящее время соответствует спецификации URL до коммита [a62223](https://github.com/whatwg/url/commit/a622235308342c9adc7fc2fd1659ff059f7d5e2a).

## API

### Конструктор `URL`

Основной API — экспорт [`URL`](https://url.spec.whatwg.org/#url), который полностью соответствует поведению спецификации (включая, например, преобразование `USVString`). Большинство пользователей этой библиотеки будут использовать именно его.

### Низкоуровневый API стандарта URL

Следующие методы экспортируются для использования такими инструментами, как jsdom, которые нуждаются в реализации функций, подобных [`HTMLHyperlinkElementUtils`](https://html.spec.whatwg.org/#htmlhyperlinkelementutils). Они работают с "внутренним URL" или типом ["запись URL"](https://url.spec.whatwg.org/#concept-url).

- [Парсер URL](https://url.spec.whatwg.org/#concept-url-parser): `parseURL(input, { baseURL, encodingOverride })`
- [Базовый парсер URL](https://url.spec.whatwg.org/#concept-basic-url-parser): `basicURLParse(input, { baseURL, encodingOverride, url, stateOverride })`
- [Сериализатор URL](https://url.spec.whatwg.org/#concept-url-serializer): `serializeURL(urlRecord, excludeFragment)`
- [Сериализатор хоста](https://url.spec.whatwg.org/#concept-host-serializer): `serializeHost(hostFromURLRecord)`
- [Сериализация целого числа](https://url.spec.whatwg.org/#serialize-an-integer): `serializeInteger(number)`
- [Происхождение (origin)](https://url.spec.whatwg.org/#concept-url-origin) [сериализатор](https://html.spec.whatwg.org/multipage/browsers.html#serialization-of-an-origin): `serializeURLOrigin(urlRecord)`
- [Установка имени пользователя](https://url.spec.whatwg.org/#set-the-username): `setTheUsername(urlRecord, usernameString)`
- [Установка пароля](https://url.spec.whatwg.org/#set-the-password): `setThePassword(urlRecord, passwordString)`
- [Отсутствие имени пользователя/пароля/порта](https://url.spec.whatwg.org/#cannot-have-a-username-password-port): `cannotHaveAUsernamePasswordPort(urlRecord)`

Параметр `stateOverride` может принимать следующие значения (состояния):

- [`"scheme start"`](https://url.spec.whatwg.org/#scheme-start-state)
- [`"scheme"`](https://url.spec.whatwg.org/#scheme-state)
- ... (и другие состояния, как перечислены в спецификации)

Тип "запись URL" имеет следующие свойства:

- [`scheme`](https://url.spec.whatwg.org/#concept-url-scheme)
- [`username`](https://url.spec.whatwg.org/#concept-url-username)
- [`password`](https://url.spec.whatwg.org/#concept-url-password)
- [`host`](https://url.spec.whatwg.org/#concept-url-host)
- [`port`](https://url.spec.whatwg.org/#concept-url-port)
- [`path`](https://url.spec.whatwg.org/#concept-url-path) (массив)
- [`query`](https://url.spec.whatwg.org/#concept-url-query)
- [`fragment`](https://url.spec.whatwg.org/#concept-url-fragment)
- [`cannotBeABaseURL`](https://url.spec.whatwg.org/#url-cannot-be-a-base-url-flag) (булево)

Обращайтесь с этими свойствами осторожно, поскольку изменение их может привести к несогласованному состоянию записи URL, пока не будет выполнено соответствующее вызов `basicURLParse`, чтобы исправить ситуацию. Примеры этого есть в спецификации URL, где есть много последовательностей шагов, подобных "4. Установите фрагмент url контекстного объекта в пустую строку. 5. Выполните базовый анализ URL _input_ с url контекстного объекта в качестве _url_ и состоянием фрагмента в качестве _state override_". Между этими шагами запись URL может быть в непригодном состоянии.

Возвращаемое значение "ошибка" в спецификации представлено строкой `"failure"`. То есть, такие функции, как `parseURL` и `basicURLParse`, могут вернуть _либо_ запись URL, _либо_ строку `"failure"`.
```