# Модуль `campaign`

## Обзор

Модуль `campaign` предназначен для управления процессом создания и публикации рекламных кампаний в Facebook. Он включает в себя функциональность для инициализации параметров кампании (имя, язык, валюта), создания структуры каталогов, сохранения конфигураций для новой кампании, сбора и сохранения данных о продуктах через `ali` или `html`, генерации рекламных материалов, просмотра кампании и публикации ее в Facebook.

## Подробней

Модуль предоставляет набор функций и классов для автоматизации процесса создания и управления рекламными кампаниями, начиная от инициализации и настройки кампании до сбора данных о продуктах и генерации рекламных материалов, и заканчивая публикацией кампании. Он облегчает процесс подготовки и запуска рекламных кампаний, сокращая время и усилия, необходимые для ручной работы.

## Классы

В данном модуле не представлены классы для детального описания. Описание фокусируется на общем процессе и логике работы с рекламными кампаниями.

## Функции

В данном разделе представлено описание высокоуровневой логики работы с рекламными кампаниями, а не конкретные функции или методы. Описаны шаги и процессы, необходимые для создания, редактирования и подготовки рекламной кампании.

### Создание рекламной кампании для размещения в Facebook

**Назначение**: Описывает процесс создания рекламной кампании для размещения в Facebook, начиная с инициализации и заканчивая публикацией.

**Как работает функция**:

1.  **Начало**: Процесс начинается.
2.  **Инициализация деталей кампании**: Определяются название кампании, язык и валюта. Пример: Название кампании: "Летняя распродажа", Язык: "Английский", Валюта: "USD".
3.  **Создание каталогов кампании и категорий**: Создаются необходимые каталоги и файлы для кампании. Пример: Создается структура папок в файловой системе для хранения активов кампании.
4.  **Сохранение конфигурации кампании**: Сохраненные детали кампании. Пример: Данные записываются в базу данных или файл конфигурации.
5.  **Сбор данных о продукте**: Собираются данные, относящиеся к продуктам, которые будут продвигаться в рамках кампании. Пример: ID продукта, описания, изображения и цены извлекаются из системы инвентаризации.
6.  **Сохранение данных о продукте**: Сохраненные данные о продукте. Пример: Данные записываются в таблицу базы данных, посвященную продуктам кампании.
7.  **Создание рекламных материалов**: Создаются или выбираются графики, баннеры и другие рекламные активы. Пример: Изображения и описания адаптированы для привлечения клиентов.
8.  **Обзор кампании**: Процесс проверки подтверждает, что компоненты кампании готовы. Пример: Человеческий или системный обзор оценивает качество и полноту всех компонентов кампании.
9.  **Кампания готова?**: Проверка для определения того, является ли кампания полной и готовой к публикации. Пример: Логический флаг сигнализирует "Да", если все на месте, в противном случае "Нет", инициируя возврат к предыдущему шагу для внесения исправлений.
10. **Публикация кампании**: Кампания становится активной на платформе, готовой к маркетинговым усилиям. Пример: Вызовы API выполняются для публикации кампании на соответствующей платформе.
11. **Конец**: Процесс создания кампании завершен.

**ASCII flowchart**:

```
Начало
    ↓
Инициализация деталей кампании
    ↓
Создание каталогов кампании и категорий
    ↓
Сохранение конфигурации кампании
    ↓
Сбор данных о продукте
    ↓
Сохранение данных о продукте
    ↓
Создание рекламных материалов
    ↓
Обзор кампании
    ↓
Кампания готова?
    ├ Да → Публикация кампании
    └ Нет → Обзор кампании
    ↓
Конец
```

### Редактирование кампании

**Назначение**: Описывает процесс редактирования рекламной кампании, включая удаление, обновление продуктов, изменение свойств кампании и категорий.

**Как работает функция**:

1.  **Ввод данных пользователя**: Пользователь вводит имя кампании, язык и валюту.
2.  **Инициализация AliCampaignEditor**: Вызывается конструктор класса `AliCampaignEditor`.
3.  **Инициализация AliPromoCampaign**: Вызывается конструктор класса `AliPromoCampaign`.
4.  **Удаление продукта**: Проверяется наличие партнерской ссылки, читается список продуктов из файла `sources.txt`, и если продукт найден, он удаляется и файл сохраняется.
5.  **Обновление продукта**: Обновляются детали продукта и вызывается функция `dump_category_products_files` для обновления категории с новым продуктом.
6.  **Обновление кампании**: Обновляются параметры кампании, такие как описание.
7.  **Обновление категории**: Обновляется категория в JSON-файле. Читаются данные категории, обновляются и записываются обратно в файл.
8.  **Получение категории**: Получение категории по имени. Если категория существует, возвращаются детали категории. Если нет, записывается предупреждение.
9.  **Перечисление категорий**: Перечисляются все категории в кампании. Если категории существуют, возвращается список имен категорий. Если нет, записывается предупреждение.
10. **Получение продуктов категории**: Получение продуктов для определенной категории. Строится путь к продуктам категории, извлекаются JSON-файлы продуктов, загружаются данные продуктов и возвращается список продуктов.

**ASCII flowchart**:

```
Ввод данных пользователя (campaign_name, language, currency)
    ↓
AliCampaignEditor.__init__
    ↓
AliPromoCampaign.__init__
    ↓
Инициализация: AliCampaignEditor constructor
    ↓
AliCampaignEditor
    ├── Удаление продукта: Проверка партнерской ссылки → Чтение списка продуктов из sources.txt → Итерация и проверка product_id → Удаление и сохранение (если совпадает)
    ├── Обновление продукта: Вызов dump_category_products_files
    ├── Обновление кампании: Обновление параметров кампании
    ├── Обновление категории: Чтение JSON-файла → Обновление данных → Запись в JSON-файл
    ├── Получение категории: Проверка существования → Возврат деталей категории
    └── Перечисление категорий: Проверка наличия категорий → Возврат списка категорий
    ↓
Другие методы
```

### Подготовка кампании

**Назначение**: Описывает процесс подготовки кампании, который включает в себя обработку всех кампаний или конкретной кампании, с учетом языка, валюты и категорий.

**Как работает функция**:

1.  **Начало**: Начало процесса.
2.  **Обработка всех кампаний?**: Проверка, нужно ли обработать все кампании или конкретную.
3.  **Язык и валюта предоставлены?**: Если обрабатываются все кампании, проверяется, предоставлены ли язык и валюта.
4.  **Обработка конкретных категорий?**: Если обрабатывается конкретная кампания, проверяется, указаны ли категории.
5.  **Обработка кампании для всех локалей**: Обрабатывается кампания для всех локалей, если не указаны язык и валюта.
6.  **Обработка конкретных категорий кампании**: Обрабатываются конкретные категории кампании, если они указаны.

**ASCII flowchart**:

```
Начало
    ↓
Обработка всех кампаний?
    ├── Да → Язык и валюта предоставлены?
    │       ├── Да → Обработка каждой кампании с предоставленным языком и валютой
    │       └── Нет → Обработка всех локалей для каждой кампании
    └── Нет → Категории указаны?
                ├── Да → Обработка конкретных категорий для кампании
                └── Нет → Обработка всей кампании
    ↓
Конец