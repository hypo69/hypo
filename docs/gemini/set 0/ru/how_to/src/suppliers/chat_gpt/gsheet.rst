Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `GptGs`, который взаимодействует с Google Таблицами для управления кампаниями AliExpress. Он наследуется от класса `SpreadSheet` и предоставляет методы для записи, чтения и обновления данных о категориях, продуктах и кампаниях.  Код включает методы для очистки таблиц, обновления данных в определенных листах, получения данных из таблиц и копирования шаблона листов.  В основном, он предназначен для работы с данными кампании, включая чтение, запись и обновление информации о категориях и продуктах.

Шаги выполнения
-------------------------
1. **Импортирование необходимых библиотек:** Код импортирует необходимые модули, такие как `time`, `SimpleNamespace`, `List`, `Worksheet`, `SpreadSheet`, `j_dumps`, `pprint`, и `logger`.  Эти импорты обеспечивают необходимые инструменты для работы с Google Таблицами, манипуляции данными и ведения логирования.

2. **Определение класса `GptGs`:** Класс `GptGs` наследуется от `SpreadSheet`, что подразумевает, что он использует методы и атрибуты родительского класса для работы с Google Таблицами.

3. **Инициализация класса `GptGs`:** Конструктор `__init__` класса `GptGs` принимает идентификатор Google Таблицы и инициализирует объекты, необходимые для работы с Google Таблицами.  В примере используется ID `'1nu4mNNFMzSePlggaaL_QM2vdKVP_NNBl2OG7R9MNrs0'`.

4. **Метод `clear`:** Этот метод очищает таблицу, удаляя листы продуктов и очищая данные на листах категорий и других определенных листах.

5. **Метод `update_chat_worksheet`:** Этот метод записывает данные кампании (переданные в качестве параметра `data`) в лист Google Таблицы, который задается параметром `conversation_name`.  Он извлекает данные из `SimpleNamespace` объекта и записывает их в отдельные ячейки листа.

6. **Метод `get_campaign_worksheet`:** Этот метод считывает данные кампании с листа `'campaign'`. Он возвращает объект `SimpleNamespace` с данными кампании.

7. **Метод `set_category_worksheet`:** Этот метод записывает данные из объекта `SimpleNamespace` (представляющего категорию) в лист `'category'` Google Таблицы. Данные записываются вертикально.

8. **Метод `get_category_worksheet`:** Этот метод считывает данные категории с листа `'category'`. Он возвращает объект `SimpleNamespace` с данными категории.

9. **Метод `set_categories_worksheet`:** Этот метод записывает данные из списка объектов `SimpleNamespace` (представляющих категории) в лист `'categories'`. Он работает с данными по очереди, обновляя лист в соответствии со значениями, полученными из параметров.

10. **Метод `get_categories_worksheet`:** Этот метод считывает данные со столбцов A-E с листа `'categories'`, начиная со второй строки.  Он возвращает данные в формате списка списков строк.

11. **Метод `set_product_worksheet`:** Этот метод создает новый лист в Google Таблице, копируя шаблон `'product_template'`, и записывает данные продукта в этот новый лист.

12. **Метод `get_product_worksheet`:** Этот метод считывает данные продукта с листа `'products'`. Он возвращает объект `SimpleNamespace` с данными продукта.

13. **Метод `set_products_worksheet`:** Этот метод записывает данные из списка объектов `SimpleNamespace` в лист `'products'`.

14. **Метод `delete_products_worksheets`:** Этот метод удаляет все листы из Google Таблицы, за исключением `'categories'` и `'product_template'`.

15. **Методы `save_categories_from_worksheet` и `save_campaign_from_worksheet`:** Эти методы сохраняют данные, полученные из Google Таблицы, в соответствующие объекты,  для дальнейшей обработки.

Пример использования
-------------------------
.. code-block:: python

    # Предположим, у вас есть объект campaign_data
    from types import SimpleNamespace
    campaign_data = SimpleNamespace(name="My Campaign", title="Campaign Title", description="Campaign Description", tags=["tag1", "tag2"], products_count=10)

    # Создание экземпляра класса GptGs
    gsheet_obj = GptGs()

    # Обновление данных в листе
    try:
        gsheet_obj.update_chat_worksheet(campaign_data, 'CampaignDataSheet')
    except Exception as e:
        print(f"Ошибка: {e}")