# Модуль hypotez/src/utils/jjson.py

## Обзор

Модуль `jjson` предназначен для работы с JSON и CSV файлами. Он предоставляет функции для загрузки, выгрузки, слияния, преобразования данных в различных форматах (JSON, CSV, SimpleNamespace) и обработки Markdown строк, содержащих JSON фрагменты.

## Функции

### `j_dumps`

**Описание**: Функция выгрузки данных в формате JSON в файл или возвращает данные в формате JSON как словарь.

**Параметры**:

- `data` (Dict | SimpleNamespace | List[Dict] | List[SimpleNamespace]): Данные, совместимые с JSON, или объекты SimpleNamespace, подлежащие выгрузке.
- `file_path` (Optional[Path], опционально): Путь к выходному файлу. Если None, возвращает JSON-данные как словарь. По умолчанию None.
- `ensure_ascii` (bool, опционально): Если True, экранирует не-ASCII символы в выводе. По умолчанию True.
- `mode` (str, опционально): Режим открытия файла ('w', 'a+', '+a'). По умолчанию 'w'.
- `exc_info` (bool, опционально): Если True, регистрирует исключения с трассировкой стека. По умолчанию True.


**Возвращает**:

- Optional[Dict]: JSON-данные как словарь при успехе, или ничего при ошибке.


**Возможные исключения**:

- `ValueError`: Если режим файла не поддерживается.
- `Exception`: При других ошибках обработки файлов (например, проблемы с кодировкой, неверный формат JSON).


### `j_loads`

**Описание**: Функция загрузки данных из JSON или CSV файла, директории или строки.

**Параметры**:

- `jjson` (Path | dict | str): Путь к файлу, директории, JSON-данные в виде строки или JSON-объект.
- `ordered` (bool, опционально): Если True, возвращает OrderedDict для сохранения порядка элементов. По умолчанию False.
- `exc_info` (bool, опционально): Если True, регистрирует исключения с трассировкой стека. По умолчанию True.


**Возвращает**:

- Any: Словарь или список словарей при успехе, или ничего при ошибке.


**Возможные исключения**:

- `FileNotFoundError`: Если указанный файл не найден.
- `json.JSONDecodeError`: Если данные JSON не могут быть распарсены.
- `Exception`: При других ошибках обработки файлов (например, проблемы с кодировкой, неверный формат JSON).


### `j_loads_ns`

**Описание**: Загружает JSON или CSV данные из файла, директории или строки и преобразует их в объекты SimpleNamespace.

**Параметры**:

- `jjson` (Path | SimpleNamespace | Dict | str): Путь к файлу, директории или JSON-данные в виде строки, или JSON-объект.
- `ordered` (bool, опционально): Если True, возвращает OrderedDict вместо обычного словаря, чтобы сохранить порядок элементов. По умолчанию False.
- `exc_info` (bool, опционально): Если True, регистрирует исключения с трассировкой стека. По умолчанию True.


**Возвращает**:

- Optional[SimpleNamespace | List[SimpleNamespace]]: Возвращает SimpleNamespace или список объектов SimpleNamespace при успехе. Возвращает None, если jjson не найден или не может быть прочитан.


**Возможные исключения**:

- `FileNotFoundError`: Если указанный файл не найден.
- `json.JSONDecodeError`: Если данные JSON не могут быть распарсены.
- `Exception`: При других ошибках обработки файлов (например, проблемы с кодировкой, неверный формат JSON).


### `process_json_file`

**Описание**: Обрабатывает JSON файл, заменяя ключ "name" на "category_name".

**Параметры**:

- `json_file` (Path): Путь к JSON файлу.


**Возвращает**:

- (None).  Функция изменяет сам файл на месте.


### `recursive_process_json_files`

**Описание**: Рекурсивно обходит папки и обрабатывает JSON файлы.

**Параметры**:

- `directory` (Path): Путь к директории, которую нужно обработать.


**Возвращает**:

- (None). Функция изменяет файлы в указанной директории на месте.


### `extract_json_from_string`

**Описание**: Извлекает JSON содержимое из строки Markdown между маркерами ```json и ```.

**Параметры**:

- `md_string` (str): Строка Markdown, содержащая JSON, заключенный в ```json ```.


**Возвращает**:

- str: Извлеченная строка JSON или пустая строка, если не найдена.


**Возможные исключения**:

- `Exception`: При ошибках обработки Markdown (например, регулярное выражение не найдено, неверный формат JSON).