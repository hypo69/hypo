# Модуль `Supplier`

## Обзор

Класс `Supplier` является базовым классом для управления поставщиками данных в вашем приложении. Он предоставляет основу для взаимодействия с различными источниками данных, такими как Amazon, AliExpress, Walmart и другие. Этот класс обрабатывает инициализацию настроек, специфичных для поставщика, управляет сценариями сбора данных и предоставляет методы для входа в систему и выполнения сценариев.

## Содержание

- [Обзор](#обзор)
- [Компоненты класса `Supplier`](#компоненты-класса-supplier)
  - [Атрибуты класса](#атрибуты-класса)
  - [Методы](#методы)
- [Как это работает](#как-это-работает)
- [Визуальное представление](#визуальное-представление)
- [Пример использования](#пример-использования)
- [Заключение](#заключение)

## Компоненты класса `Supplier`

### Атрибуты класса

- `supplier_id`: Уникальный идентификатор поставщика.
- `supplier_prefix`: Префикс поставщика, например, `aliexpress` или `amazon`.
- `supplier_settings`: Настройки поставщика, загруженные из файла конфигурации.
- `locale`: Код локализации (например, `en` для английского, `ru` для русского).
- `price_rule`: Правило для расчета цен (например, добавление НДС или применение скидок).
- `related_modules`: Модуль, содержащий специфические для поставщика функции.
- `scenario_files`: Список файлов сценариев для выполнения.
- `current_scenario`: Текущий выполняемый сценарий.
- `login_data`: Данные для входа на сайт поставщика (если требуется).
- `locators`: Локаторы для веб-элементов на сайте поставщика.
- `driver`: Веб-драйвер для взаимодействия с сайтом поставщика.
- `parsing_method`: Метод для разбора данных (например, `webdriver`, `api`, `xls`, `csv`).

### Методы

#### `__init__`
**Описание**: Конструктор, который инициализирует атрибуты на основе префикса поставщика и других параметров.

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs)
```

**Параметры**:
- `supplier_prefix` (str): Префикс поставщика, например, `aliexpress` или `amazon`.
- `locale` (str, optional): Код локализации. По умолчанию `en`.
- `webdriver` (str | Driver | bool, optional): Веб-драйвер для взаимодействия с сайтом поставщика. По умолчанию `default`.
- `*attrs`: Дополнительные позиционные аргументы.
- `**kwargs`: Дополнительные именованные аргументы.

**Возвращает**:
- `None`

**Вызывает исключения**:
- `None`

#### `_payload`
**Описание**: Загружает специфические для поставщика конфигурации, локаторы и инициализирует веб-драйвер.

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool
```

**Параметры**:
- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом поставщика.
- `*attrs`: Дополнительные позиционные аргументы.
- `**kwargs`: Дополнительные именованные аргументы.

**Возвращает**:
- `bool`: Возвращает `True`, если конфигурация загружена успешно, иначе `False`.

**Вызывает исключения**:
- `None`

#### `login`
**Описание**: Обрабатывает процесс входа на сайт поставщика, если требуется аутентификация.

```python
def login(self) -> bool
```

**Параметры**:
- `None`

**Возвращает**:
- `bool`: Возвращает `True`, если вход выполнен успешно, иначе `False`.

**Вызывает исключения**:
- `None`

#### `run_scenario_files`
**Описание**: Выполняет один или несколько файлов сценариев.

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool
```

**Параметры**:
- `scenario_files` (str | List[str], optional): Список файлов сценариев для выполнения. По умолчанию `None`.

**Возвращает**:
- `bool`: Возвращает `True`, если все сценарии выполнены успешно, иначе `False`.

**Вызывает исключения**:
- `None`

#### `run_scenarios`
**Описание**: Выполняет один или несколько сценариев.

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool
```

**Параметры**:
- `scenarios` (dict | list[dict]): Список словарей, представляющих сценарии для выполнения.

**Возвращает**:
- `bool`: Возвращает `True`, если все сценарии выполнены успешно, иначе `False`.

**Вызывает исключения**:
- `None`

## Как это работает

1. **Инициализация**:
   При создании объекта класса `Supplier` метод `__init__` инициализирует префикс поставщика, локаль и веб-драйвер.

   ```python
   supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
   ```

2. **Загрузка конфигурации**:
   Метод `_payload` загружает файлы конфигурации для поставщика, включая настройки, локаторы и инициализирует веб-драйвер.

   ```python
   def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
       # Загружает файлы конфигурации и настраивает веб-драйвер
   ```

3. **Вход в систему**:
   Метод `login` обрабатывает процесс аутентификации на веб-сайте поставщика.

   ```python
   supplier.login()
   ```

4. **Выполнение сценариев**:
   - Метод `run_scenario_files` запускает сценарии из списка файлов.

     ```python
     supplier.run_scenario_files(['example_scenario.json'])
     ```

   - Метод `run_scenarios` запускает сценарии на основе определенных условий или задач.

     ```python
     supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
     ```

## Визуальное представление

Класс `Supplier` действует как чертеж для управления сбором данных от различных поставщиков. Он определяет общие методы и атрибуты, которые могут быть использованы или расширены конкретными реализациями для различных поставщиков. Класс централизует управление поставщиками, включая конфигурацию, вход в систему и выполнение сценариев.

## Пример использования

Вот пример того, как можно использовать класс `Supplier`:

```python
# Создаем объект Supplier для 'aliexpress'
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')

# Выполняем вход на сайт поставщика
supplier.login()

# Выполняем файлы сценариев
supplier.run_scenario_files(['example_scenario.json'])

# Или выполняем определенные сценарии
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```

## Заключение

В заключение, класс `Supplier` предоставляет структурированный способ взаимодействия с поставщиками данных путем управления конфигурациями, выполнения входов в систему и выполнения сценариев сбора данных. Он служит основополагающим компонентом, который может быть расширен для конкретных поставщиков путем наследования от этого базового класса и добавления или переопределения функциональности по мере необходимости.