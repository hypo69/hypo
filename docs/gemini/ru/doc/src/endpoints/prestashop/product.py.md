# Модуль для взаимодействия с товарами в PrestaShop (`src.endpoints.prestashop.product`)

## Обзор

Модуль `src.endpoints.prestashop.product` предназначен для управления товарами в PrestaShop. Он предоставляет классы и функции для получения информации о товарах, добавления новых товаров и взаимодействия с API PrestaShop.

## Подробнее

Этот модуль является частью проекта `hypotez` и обеспечивает интеграцию с платформой электронной коммерции PrestaShop. Он включает в себя классы для конфигурации подключения к API PrestaShop и выполнения операций с товарами, такие как добавление новых товаров, получение информации о существующих товарах и управление категориями товаров. Модуль использует различные утилиты для преобразования данных между форматами XML и JSON, а также для логирования событий и ошибок.

## Классы

### `Config`

**Описание**: Класс конфигурации для настроек продукта PrestaShop.

**Принцип работы**: Этот класс содержит статические переменные, необходимые для подключения к API PrestaShop, такие как `API_DOMAIN` и `API_KEY`. Он также определяет формат данных для отправки (`POST_FORMAT`) и режим работы (`MODE`). В зависимости от значения `USE_ENV`, он может использовать переменные окружения или значения, заданные в файле конфигурации (`gs.credentials`).

**Атрибуты**:
- `USE_ENV` (bool): Указывает, использовать ли переменные окружения для конфигурации API.
- `MODE` (str): Режим работы ('dev', 'dev8' или другой).
- `POST_FORMAT` (str): Формат данных для отправки запросов (XML или JSON).
- `API_DOMAIN` (str): Домен API PrestaShop.
- `API_KEY` (str): Ключ API PrestaShop.

### `PrestaProduct`

**Описание**: Класс для управления товарами в PrestaShop.

**Принцип работы**: Этот класс наследует функциональность от класса `PrestaShop` и предоставляет методы для получения схемы продукта, добавления новых продуктов и получения информации о продуктах. Он использует API PrestaShop для выполнения этих операций.

**Методы**:
- `__init__(self, api_key: Optional[str] = '', api_domain: Optional[str] = '', *args, **kwargs) -> None`: Инициализирует объект `PrestaProduct`.
- `get_product_schema(self, resource_id: Optional[str  |  int] = None, schema: Optional[str] = 'blank') -> dict`: Получает схему ресурса продукта из PrestaShop.
- `get_parent_category(self, id_category: int) -> Optional[int]`: Рекурсивно извлекает родительские категории из PrestaShop для данной категории.
- `_add_parent_categories(self, f: ProductFields) -> None`: Вычисляет и добавляет все родительские категории для списка ID категорий к объекту `ProductFields`.
- `get_product(self, id_product: int, **kwards) -> dict`: Возвращает словарь полей товара из магазина PrestaShop.
- `add_new_product(self, f: ProductFields) -> dict`: Добавляет новый продукт в PrestaShop.

## Функции

### `example_add_new_product() -> None`

**Назначение**: Пример добавления товара в PrestaShop.

**Параметры**:
- Нет.

**Возвращает**:
- Ничего (None).

**Как работает функция**:
1. Создает экземпляр класса `PrestaProduct` с использованием ключа API и домена API из класса `Config`.
2. Загружает пример данных о продукте из JSON-файла.
3. Преобразует данные о продукте в формат XML, используя функцию `presta_fields_to_xml`.
4. Сохраняет XML-представление данных продукта в файл.
5. Выполняет POST-запрос к API PrestaShop для добавления нового продукта.
6. Выводит ответ от API PrestaShop.

```
Создание экземпляра PrestaProduct
↓
Загрузка данных о продукте из JSON
↓
Преобразование данных в XML
↓
Сохранение XML в файл
↓
Выполнение POST-запроса к API PrestaShop
↓
Вывод ответа от API PrestaShop
```

**Примеры**:
```python
example_add_new_product()
```

### `example_get_product(id_product: int, **kwards) -> None`

**Назначение**: Пример получения информации о товаре из PrestaShop.

**Параметры**:
- `id_product` (int): ID товара в PrestaShop.
- `**kwards`: Дополнительные параметры запроса.

**Возвращает**:
- Ничего (None).

**Как работает функция**:
1. Создает экземпляр класса `PrestaProduct` с использованием ключа API и домена API из класса `Config`.
2. Определяет параметры запроса, такие как формат данных, отображение и схема.
3. Вызывает метод `get_product` для получения информации о товаре по его ID.
4. Извлекает информацию о товаре из ответа API.
5. Сохраняет информацию о товаре в JSON-файл.

```
Создание экземпляра PrestaProduct
↓
Определение параметров запроса
↓
Получение информации о товаре по ID
↓
Извлечение информации о товаре из ответа API
↓
Сохранение информации о товаре в JSON-файл
```

**Примеры**:
```python
example_get_product(id_product=2191)