# Модуль code_assistant

## Обзор

Модуль `code_assistant` предназначен для обучения модели машинного обучения на основе кодовой базы, создания документации к проекту, примеров кода и тестов. Он содержит класс `CodeAssistant`, который читает файлы кода, передает их в модели, обрабатывает код и сохраняет результаты в директории `docs/gemini` в зависимости от роли.

## Подробней

Этот модуль является частью проекта `hypotez` и отвечает за автоматизацию задач, связанных с анализом и обработкой кода с использованием моделей машинного обучения. Он позволяет генерировать документацию, примеры кода и тесты на основе существующей кодовой базы.

## Классы

### `Config`

**Описание**: Класс, содержащий конфигурационные параметры для `CodeAssistant`.

**Параметры**:
- `base_path` (Path): Базовый путь к файлам конфигурации.
- `config` (SimpleNamespace): Объект, содержащий загруженные из `code_assistant.json` конфигурационные параметры.
- `role` (str): Роль, выполняемая ассистентом (по умолчанию `'doc_writer_md'`).
- `lang` (str): Язык, используемый ассистентом (по умолчанию `'ru'`).
- `system_instruction` (str): Системная инструкция для модели ИИ.
- `gemini` (SimpleNamespace): Конфигурация для модели Gemini, включая имя модели и ключ API.

### `CodeAssistant`

**Описание**: Класс для работы ассистента программиста с моделями ИИ.

**Методы**:
- `__init__`: Инициализация ассистента с заданными параметрами.
- `_initialize_models`: Инициализация моделей на основе заданных параметров.
- `send_file`: Отправка файла в модель.
- `process_files`: Компиляция, отправка запроса и сохранение результата.
- `_create_request`: Создание запроса с учетом роли и языка.
- `_yield_files_content`: Генерация путей файлов и их содержимого по указанным шаблонам.
- `_save_response`: Сохранение ответа модели в файл с добавлением суффикса.
- `_remove_outer_quotes`: Удаление внешних кавычек в начале и в конце строки, если они присутствуют.
- `run`: Запуск процесса обработки файлов.
- `_signal_handler`: Обработка прерывания выполнения.

**Параметры**:
- `role` (Optional[str]): Роль для выполнения задачи (по умолчанию `'doc_writer_md'`).
- `lang` (Optional[str]): Язык выполнения (по умолчанию `'en'`).
- `models_list` (Optional[list[str, str] | str]): Список моделей для инициализации (по умолчанию `['gemini']`).
- `system_instruction` (Optional[str | Path]): Инструкция для системы (текст или путь к файлу).

**Примеры**
```python
assistant = CodeAssistant(role='code_checker', lang='ru', models_list=['gemini'])
assistant.process_files()
```

## Функции

### `parse_args`

```python
def parse_args() -> dict:
    """Разбор аргументов командной строки."""
    ...
```

**Описание**: Разбор аргументов командной строки.

**Возвращает**:
- `dict`: Словарь с аргументами командной строки.

**Примеры**:

```python
args = parse_args()
print(args['role'])
```

### `main`

```python
def main() -> None:
    """
    Функция запускает бесконечный цикл, в котором выполняется обработка файлов с учетом ролей и языков, указанных в конфигурации.
    Конфигурация обновляется в каждом цикле, что позволяет динамически изменять настройки в файле `code_assistant.json` во время работы программы.
    Для каждой комбинации языка и роли создается экземпляр класса :class:`CodeAssistant`, который обрабатывает файлы, используя заданную модель ИИ.
    """
    ...
```

**Описание**: Функция запускает бесконечный цикл обработки файлов с учетом ролей и языков, указанных в конфигурации.

**Параметры**:
- Нет параметров.

**Возвращает**:
- None

**Примеры**:
```python
if __name__ == '__main__':
    main()