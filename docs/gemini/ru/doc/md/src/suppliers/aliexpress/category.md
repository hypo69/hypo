# Модуль `hypotez/src/suppliers/aliexpress/category.py`

## Обзор

Модуль `hypotez/src/suppliers/aliexpress/category.py` содержит функции для управления категориями на сайте AliExpress. Он предоставляет инструменты для получения списка товаров в категории, обновления списка категорий в сценарии и взаимодействия с базой данных для работы с категориями.

## Функции

### `get_list_products_in_category`

**Описание**: Функция получает список URL товаров в заданной категории.  Функция обрабатывает возможные страницы с товарами в категории, переходя к следующей странице, пока не будут получены все URL.

**Параметры**:

- `s` (`Supplier`): Экземпляр класса `Supplier`, содержащий информацию о поставщике, веб-драйвер и локаторы элементов.
- `run_async` (`bool`, необязательный):  Устанавливает синхронность/асинхронность исполнения функции `async_get_list_products_in_category()`. По умолчанию значение не задано.

**Возвращает**:

- `list[str, str]`: Список URL товаров. Возвращает пустой список, если в категории нет товаров.

### `get_prod_urls_from_pagination`

**Описание**: Функция собирает ссылки на товары со страницы категории с перелистыванием страниц.


**Параметры**:

- `s` (`Supplier`): Экземпляр класса `Supplier`, содержащий информацию о поставщике, веб-драйвер и локаторы элементов.

**Возвращает**:

- `list[str]`: Список URL товаров. Возвращает пустой список, если в категории нет товаров.

**Обработка исключений**:

-  Функция потенциально может зациклиться, если на сайте нет механизма остановки. ( Необходим дополнительный контроль и обработка ошибок в реальном сценарии.)


### `update_categories_in_scenario_file`

**Описание**: Функция сравнивает список категорий в файле сценария с данными, полученными с сайта AliExpress и обновляет файл, если обнаружены различия.

**Параметры**:

- `s` (`Supplier`): Экземпляр класса `Supplier`, содержащий информацию о поставщике, веб-драйвер и локаторы элементов.
- `scenario_filename` (str): Имя файла сценария.

**Возвращает**:

- `bool`: `True`, если список категорий обновлен, `False` в противном случае.

**Обработка исключений**:

- Функция может вызвать исключение `KeyError`, если ключ 'category ID on site' отсутствует в JSON файле сценария.
- Функция может вызвать исключение при запросе JSON файла категорий магазина (обработка кода `response.status_code`).


### `get_list_categories_from_site`

**Описание**: Функция получает список категорий с сайта.

**Параметры**:

- `s` (`Supplier`): Экземпляр класса `Supplier`.
- `scenario_file` (str): Имя файла сценария.
- `brand` (str, необязательный): Фильтр по брендам. По умолчанию пустая строка.


**Возвращает**:
- `list`: Список словарей, содержащих информацию о категориях.


**Обработка исключений**:

- Возможна ошибка `requests.get()` при запросе файла JSON с категориями.


## Класс `DBAdaptor`

**Описание**: Класс для взаимодействия с базой данных, предоставляющий методы для выполнения операций SELECT, INSERT, UPDATE и DELETE в таблице `AliexpressCategory`.

**Методы**:

- `select(cat_id: int = None, parent_id: int = None, project_cat_id: int = None)`: Выполняет операцию SELECT в таблице `AliexpressCategory` на основе переданных параметров.
- `insert()`: Выполняет операцию INSERT в таблицу `AliexpressCategory`.
- `update()`: Выполняет операцию UPDATE в таблице `AliexpressCategory`.
- `delete()`: Выполняет операцию DELETE в таблице `AliexpressCategory`.

**Примечание:** В приведенных примерах используются placeholder'ы, которые должны быть заменены реальными значениями.

##  Константы

`MODE`: Строка, определяющая режим работы модуля ('dev' в данном примере).

`credentials`: Данные аутентификации для работы с базой данных (в данном случае, для базы данных с переводами).

`manager`: Экземпляр `CategoryManager` для работы с базой данных.

`gs.db_translations_credentials`, `gs.dir_scenarios`: переменные, используемые для доступа к необходимым данным. Эти переменные вероятно определены в другом модуле (`src`).


## Замечания

- Модуль использует класс `Supplier`,  который предполагает наличие других зависимостей (например, `web_driver`). 
- Модуль использует `gs`, `j_dumps`, `j_loads`, `logger`.  Эти объекты предположительно определены в других модулях, и для полной функциональности требуется импортировать эти модули.
- `json_dump` и `json_loads` (не указано где они определены).
- `send`: функция (не указано где она определена), предполагается, что она отвечает за отправку уведомлений.
- `categories_in_file`: предполагается, что это глобальная переменная.

Этот файл нуждается в дальнейшей детализации для полноценной документации.  Необходимо добавить комментарии к каждой строке кода, особенно в `update_categories_in_scenario_file`, объяснить, как работает сравнение категорий и какие типы ошибок могут возникнуть.