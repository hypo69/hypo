# Модуль командной строки g4f

## Обзор

Модуль `cli.py` предназначен для запуска и управления приложением `gpt4free` через интерфейс командной строки. Он предоставляет возможность запуска API и графического интерфейса (GUI) с различными параметрами конфигурации.

## Подробнее

Этот модуль позволяет пользователям настраивать параметры запуска API, такие как адрес привязки, порт, режим отладки, выбор модели и провайдера, использование прокси, количество рабочих процессов и другие параметры. Также поддерживается запуск графического интерфейса. Модуль использует `argparse` для обработки аргументов командной строки и запуска соответствующих функций в зависимости от выбранного режима.

## Функции

### `get_api_parser`

```python
def get_api_parser() -> ArgumentParser:
    """
    Создает и возвращает парсер аргументов командной строки для API.

    Args:
        None

    Returns:
        ArgumentParser: Парсер аргументов для API.
    """
```

**Как работает функция**:

1.  Создает экземпляр `ArgumentParser` с описанием "Run the API and GUI".
2.  Добавляет различные аргументы, такие как `--bind`, `--port`, `--debug`, `--gui`, `--model`, `--provider`, `--image-provider`, `--proxy`, `--workers`, `--disable-colors`, `--ignore-cookie-files`, `--g4f-api-key`, `--ignored-providers`, `--cookie-browsers`, `--reload`, `--demo`, `--ssl-keyfile`, `--ssl-certfile`, `--log-config`.
3.  Настраивает типы аргументов, значения по умолчанию и подсказки.
4.  Возвращает настроенный парсер аргументов.

**Примеры**:

```python
parser = get_api_parser()
args = parser.parse_args(['--port', '8080', '--debug'])
print(args.port)  # Вывод: 8080
print(args.debug) # Вывод: True
```

### `main`

```python
def main() -> None:
    """
    Главная функция для запуска приложения gpt4free.
    Определяет режим работы (API или GUI) и запускает соответствующие функции.

    Args:
        None

    Returns:
        None
    """
```

**Как работает функция**:

1.  Создает основной парсер аргументов с описанием "Run gpt4free".
2.  Добавляет подпарсеры для режимов `api` и `gui`, используя `get_api_parser` и `gui_parser` соответственно.
3.  Обрабатывает аргументы командной строки с помощью `parser.parse_args()`.
4.  В зависимости от выбранного режима (`args.mode`) вызывает `run_api_args` или `run_gui_args`.
5.  Если режим не указан, выводит справку и завершает программу с кодом ошибки 1.

**Примеры**:

```python
# Пример запуска с аргументами для API
# python cli.py api --port 8080 --debug

# Пример запуска с аргументами для GUI
# python cli.py gui --theme dark
```

### `run_api_args`

```python
def run_api_args(args: argparse.Namespace) -> None:
    """
    Запускает API с заданными аргументами.

    Args:
        args (argparse.Namespace): Аргументы командной строки, полученные от парсера.

    Returns:
        None
    """
```

**Как работает функция**:

1.  Импортирует `AppConfig` и `run_api` из модуля `g4f.api`.
2.  Устанавливает конфигурацию приложения с помощью `AppConfig.set_config`, передавая значения из аргументов командной строки (`args`).
3.  Если указаны браузеры для cookie (`args.cookie_browsers`), обновляет список браузеров в `g4f.cookies.browsers`.
4.  Запускает API с помощью `run_api`, передавая параметры, такие как `bind`, `port`, `debug`, `workers`, `use_colors`, `reload`, `ssl_keyfile`, `ssl_certfile`, `log_config`.

**Примеры**:

```python
# Пример вызова функции с аргументами
# run_api_args(args)
```
```

## Запуск модуля

Модуль можно запустить напрямую, используя `python cli.py`, после чего необходимо указать режим работы (`api` или `gui`) и соответствующие аргументы.