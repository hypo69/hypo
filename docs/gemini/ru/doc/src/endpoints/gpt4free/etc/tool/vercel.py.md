# Модуль для получения и преобразования информации о моделях Vercel AI SDK

## Обзор

Модуль предназначен для получения информации о моделях, доступных в Vercel AI SDK, преобразования этой информации в удобный формат и вывода результатов. Он использует библиотеки `quickjs`, `curl_cffi` и `re` для выполнения HTTP-запросов, обработки HTML и JavaScript кода. Модуль полезен для автоматического получения списка доступных моделей и их параметров для использования в других частях проекта `hypotez`.

## Подробнее

Модуль выполняет следующие шаги:

1.  Получает HTML-код страницы Vercel AI SDK.
2.  Извлекает пути к JavaScript файлам, содержащим информацию о моделях.
3.  Загружает содержимое этих JavaScript файлов.
4.  Извлекает информацию о моделях из JavaScript кода, используя регулярные выражения и библиотеку `quickjs`.
5.  Преобразует информацию о моделях в удобный формат, содержащий ID модели и параметры по умолчанию.
6.  Выводит информацию о моделях в формате JSON.
7.  Создает код для определения моделей в Python.
8.  Создает код для преобразования имен моделей в объекты моделей.

## Функции

### `get_model_info`

```python
def get_model_info() -> dict[str, Any]:
    """
    Получает информацию о моделях из Vercel AI SDK.

    Args:
        None

    Returns:
        dict[str, Any]: Словарь, содержащий информацию о моделях.

    Как работает функция:
    1.  Выполняет GET-запрос к странице Vercel AI SDK.
    2.  Извлекает пути к JavaScript файлам, содержащим информацию о моделях.
    3.  Загружает содержимое этих JavaScript файлов.
    4.  Извлекает информацию о моделях из JavaScript кода, используя регулярные выражения и библиотеку `quickjs`.
    5.  Преобразует информацию о моделях в словарь Python.

    ASCII flowchart:
    A - Получение HTML страницы
    |
    B - Извлечение путей к JS файлам
    |
    C - Загрузка содержимого JS файлов
    |
    D - Извлечение информации о моделях
    |
    E - Преобразование в словарь Python
    |
    F - Возврат словаря

    Примеры:
    >>> get_model_info()
    {'model1': {'id': 'model1_id', 'parameters': {...}}, 'model2': {...}}
    """
```

### `convert_model_info`

```python
def convert_model_info(models: dict[str, Any]) -> dict[str, Any]:
    """
    Преобразует информацию о моделях в формат, содержащий ID модели и параметры по умолчанию.

    Args:
        models (dict[str, Any]): Словарь, содержащий информацию о моделях.

    Returns:
        dict[str, Any]: Словарь, содержащий ID модели и параметры по умолчанию для каждой модели.

    Как работает функция:
    1.  Итерируется по словарю моделей.
    2.  Для каждой модели извлекает параметры по умолчанию с помощью функции `params_to_default_params`.
    3.  Сохраняет ID модели и параметры по умолчанию в новом словаре.

    ASCII flowchart:
    A - Итерация по моделям
    |
    B - Извлечение параметров по умолчанию
    |
    C - Сохранение ID и параметров
    |
    D - Возврат нового словаря

    Примеры:
    >>> models = {'model1': {'id': 'model1_id', 'parameters': {...}}, 'model2': {...}}
    >>> convert_model_info(models)
    {'model1': {'id': 'model1_id', 'default_params': {...}}, 'model2': {...}}
    """
```

### `params_to_default_params`

```python
def params_to_default_params(parameters: dict[str, Any]):
    """
    Извлекает параметры по умолчанию из словаря параметров модели.

    Args:
        parameters (dict[str, Any]): Словарь, содержащий параметры модели.

    Returns:
        dict[str, Any]: Словарь, содержащий параметры по умолчанию.

    Как работает функция:
    1.  Итерируется по словарю параметров.
    2.  Извлекает значение параметра из каждого параметра.
    3.  Если ключ параметра равен `"maximumLength"`, он переименовывается в `"maxTokens"`.
    4.  Сохраняет значение параметра в новом словаре.

    ASCII flowchart:
    A - Итерация по параметрам
    |
    B - Извлечение значения параметра
    |
    C - Переименование ключа, если необходимо
    |
    D - Сохранение значения в новом словаре
    |
    E - Возврат нового словаря

    Примеры:
    >>> parameters = {'param1': {'value': 'value1'}, 'maximumLength': {'value': 100}}
    >>> params_to_default_params(parameters)
    {'param1': 'value1', 'maxTokens': 100}
    """
```

### `get_model_names`

```python
def get_model_names(model_info: dict[str, Any]):
    """
    Получает список имен моделей из словаря информации о моделях.

    Args:
        model_info (dict[str, Any]): Словарь, содержащий информацию о моделях.

    Returns:
        list[str]: Список имен моделей, отсортированный в алфавитном порядке.

    Как работает функция:
    1.  Извлекает имена моделей из словаря `model_info`.
    2.  Исключает модели `"openai:gpt-4"` и `"openai:gpt-3.5-turbo"` из списка.
    3.  Сортирует список имен моделей в алфавитном порядке.

    ASCII flowchart:
    A - Извлечение имен моделей
    |
    B - Исключение нежелательных моделей
    |
    C - Сортировка списка
    |
    D - Возврат списка

    Примеры:
    >>> model_info = {'model1': {...}, 'openai:gpt-4': {...}, 'model2': {...}}
    >>> get_model_names(model_info)
    ['model1', 'model2']
    """
```

### `print_providers`

```python
def print_providers(model_names: list[str]):
    """
    Выводит код для определения моделей в Python.

    Args:
        model_names (list[str]): Список имен моделей.

    Returns:
        None

    Как работает функция:
    1.  Итерируется по списку имен моделей.
    2.  Разделяет имя модели на части, используя разделители `:` и `/`.
    3.  Формирует имя переменной на основе последней части имени модели, заменяя символы `-` и `.` на `_`.
    4.  Формирует строку кода для определения модели, используя класс `Model`.
    5.  Выводит строку кода.

    ASCII flowchart:
    A - Итерация по именам моделей
    |
    B - Разделение имени
    |
    C - Формирование имени переменной
    |
    D - Формирование строки кода
    |
    E - Вывод строки кода

    Примеры:
    >>> model_names = ['anthropic:claude-instant-v1', 'google:gemini-1.5-pro']
    >>> print_providers(model_names)
    claude_instant_v1 = Model(name="anthropic:claude-instant-v1", base_provider="anthropic", best_provider=Vercel,)
    gemini_1_5_pro = Model(name="google:gemini-1.5-pro", base_provider="google", best_provider=Vercel,)
    """
```

### `print_convert`

```python
def print_convert(model_names: list[str]):
    """
    Выводит код для преобразования имен моделей в объекты моделей.

    Args:
        model_names (list[str]): Список имен моделей.

    Returns:
        None

    Как работает функция:
    1.  Итерируется по списку имен моделей.
    2.  Разделяет имя модели на части, используя разделители `:` и `/`.
    3.  Формирует ключ на основе последней части имени модели.
    4.  Формирует имя переменной на основе последней части имени модели, заменяя символы `-` и `.` на `_`.
    5.  Формирует строку кода для преобразования имени модели в объект модели.
    6.  Выводит строку кода.

    ASCII flowchart:
    A - Итерация по именам моделей
    |
    B - Разделение имени
    |
    C - Формирование ключа
    |
    D - Формирование имени переменной
    |
    E - Формирование строки кода
    |
    F - Вывод строки кода

    Примеры:
    >>> model_names = ['anthropic:claude-instant-v1', 'google:gemini-1.5-pro']
    >>> print_convert(model_names)
            "claude-instant-v1": claude_instant_v1,
            "gemini-1.5-pro": gemini_1_5_pro,
    """
```

### `main`

```python
def main():
    """
    Основная функция, которая выполняет получение, преобразование и вывод информации о моделях.

    Args:
        None

    Returns:
        None

    Как работает функция:
    1.  Получает информацию о моделях с помощью функции `get_model_info`.
    2.  Преобразует информацию о моделях с помощью функции `convert_model_info`.
    3.  Выводит информацию о моделях в формате JSON.
    4.  Получает список имен моделей с помощью функции `get_model_names`.
    5.  Выводит код для определения моделей с помощью функции `print_providers`.
    6.  Выводит код для преобразования имен моделей в объекты моделей с помощью функции `print_convert`.

    ASCII flowchart:
    A - Получение информации о моделях
    |
    B - Преобразование информации
    |
    C - Вывод информации в JSON
    |
    D - Получение списка имен моделей
    |
    E - Вывод кода для определения моделей
    |
    F - Вывод кода для преобразования имен

    Примеры:
    >>> main()
    {...}
    -------...
    ...
    -------...
    ...
    """