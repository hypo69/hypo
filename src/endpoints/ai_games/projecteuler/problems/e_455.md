# Задача No 455
## Динамические перестановки
## Условия
Пусть *s* = s<sub>1</sub>s<sub>2</sub>...s<sub>n</sub> — строка, состоящая из строчных латинских букв.
Мы можем определить перестановку строки *s* как последовательность позиций (p<sub>1</sub>, p<sub>2</sub>, ..., p<sub>n</sub>) целых чисел от 1 до *n*, где все p<sub>i</sub> различны, а строка, полученная применением этой перестановки, равна s<sub>p1</sub>s<sub>p2</sub>...s<sub>pn</sub>.
Например, строка "abc" может быть переставлена в "acb", если мы используем перестановку (1, 3, 2).

Теперь мы определяем динамическую перестановку следующим образом. Дана строка *s*, начинаем с перестановки (1, 2, ..., *n*). Затем мы выполняем итеративный процесс: на каждой итерации мы применяем перестановку, которая состоит из позиций, полученных в предыдущей итерации.
Иными словами, пусть p<sup>0</sup> = (1, 2, ..., *n*) — начальная перестановка. В *k*-й итерации мы применяем перестановку p<sup>k</sup>, чтобы получить новую строку. Пусть p<sup>k+1</sup> будет перестановкой, которая бы вернула строку в исходное состояние. Это можно выразить так: если строка на *k*-й итерации была s<sup>k</sup>, то строка s<sup>k+1</sup> получается применением к s<sup>k</sup> перестановки p<sup>k</sup>.  Иными словами, s<sup>k+1</sup> = s<sup>k</sup>[p<sup>k</sup>]. Мы определяем p<sup>k+1</sup> так, что s<sup>k+1</sup>[p<sup>k+1</sup>] = s<sup>0</sup>.
Процесс останавливается, когда s<sup>k</sup> = s<sup>0</sup>.

Например, если s = "abc", то
- s<sup>0</sup> = "abc", p<sup>0</sup> = (1, 2, 3)
- s<sup>1</sup> = "abc", p<sup>1</sup> = (1, 2, 3)
- Процесс останавливается, так как s<sup>1</sup> = s<sup>0</sup>

Если s = "aabb", то
- s<sup>0</sup> = "aabb", p<sup>0</sup> = (1, 2, 3, 4)
- s<sup>1</sup> = "aabb", p<sup>1</sup> = (1, 2, 3, 4)
- Процесс останавливается, так как s<sup>1</sup> = s<sup>0</sup>

Если s = "abab", то
- s<sup>0</sup> = "abab", p<sup>0</sup> = (1, 2, 3, 4)
- s<sup>1</sup> = "baba", p<sup>1</sup> = (2, 1, 4, 3)
- s<sup>2</sup> = "abab", p<sup>2</sup> = (2, 1, 4, 3)
- Процесс останавливается, так как s<sup>2</sup> = s<sup>0</sup>

Если s = "abcc", то
- s<sup>0</sup> = "abcc", p<sup>0</sup> = (1, 2, 3, 4)
- s<sup>1</sup> = "abcc", p<sup>1</sup> = (1, 2, 3, 4)
- Процесс останавливается, так как s<sup>1</sup> = s<sup>0</sup>

Если s = "abcda", то
- s<sup>0</sup> = "abcda", p<sup>0</sup> = (1, 2, 3, 4, 5)
- s<sup>1</sup> = "abcda", p<sup>1</sup> = (1, 2, 3, 4, 5)
- Процесс останавливается, так как s<sup>1</sup> = s<sup>0</sup>

Если s = "abcde", то
- s<sup>0</sup> = "abcde", p<sup>0</sup> = (1, 2, 3, 4, 5)
- s<sup>1</sup> = "abcde", p<sup>1</sup> = (1, 2, 3, 4, 5)
- Процесс останавливается, так как s<sup>1</sup> = s<sup>0</sup>

Если s = "abacde", то
- s<sup>0</sup> = "abacde", p<sup>0</sup> = (1, 2, 3, 4, 5, 6)
- s<sup>1</sup> = "abacde", p<sup>1</sup> = (1, 2, 3, 4, 5, 6)
- Процесс останавливается, так как s<sup>1</sup> = s<sup>0</sup>

Если s = "ababac", то
- s<sup>0</sup> = "ababac", p<sup>0</sup> = (1, 2, 3, 4, 5, 6)
- s<sup>1</sup> = "babaca", p<sup>1</sup> = (2, 1, 4, 3, 6, 5)
- s<sup>2</sup> = "ababac", p<sup>2</sup> = (2, 1, 4, 3, 6, 5)
- Процесс останавливается, так как s<sup>2</sup> = s<sup>0</sup>

Пусть *C*(s) — число итераций, необходимых для остановки процесса динамической перестановки для строки *s*. Например, *C*("abab") = 2 и *C*("abcde") = 1.

Пусть *S(L)* — сумма всех *C*(s) для всех строк *s* длины *L*, состоящих из строчных латинских букв.
Например, *S(3)* = 16380.

Найдите *S(10<sup>7</sup>)*, результат приведите по модулю 1000000007.
