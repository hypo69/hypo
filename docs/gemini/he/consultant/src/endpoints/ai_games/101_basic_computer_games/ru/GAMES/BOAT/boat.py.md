# Анализ кода модуля boat.py

## Качество кода
- **Соблюдение требований к формату кода (1-10):**
    - **Преимущества:**
        - Код модуля написан на языке Python и выполняет заданную логику игры "Морской бой".
        - Используется `random` для случайного размещения корабля.
        - Проверка на попадание и промах реализована корректно.
        - Имеется проверка на повторные попадания.
        - Игровой цикл организован правильно с возможностью завершения игры при потоплении корабля.
        - Есть подробные комментарии в коде, объясняющие каждый шаг.
        - Присутствует документация к модулю в формате, близком к reStructuredText.
        - Логика игры соответствует описанию в документации.
    - **Недостатки:**
        - В коде используется стандартный `print` для вывода сообщений, что может быть не совсем удобно для логирования и дальнейшей расширяемости.
        - Нет обработки ошибок, связанных с неверным вводом координат.
        - Отсутствуют doctring для функций.
        - Не используется `j_loads` или `j_loads_ns` из `src.utils.jjson`, что требовалось.
        - Не используется `logger` для вывода ошибок, что требуется.
        - Нет импорта `from src.logger.logger import logger`

## Рекомендации по улучшению
1. **Использование reStructuredText (RST):**
    - Добавить docstring в формате reStructuredText (RST) для модуля и функций, а также для переменных.
    - Улучшить документацию модуля, сделав её более структурированной.
    - Добавить примеры использования в документацию.
2. **Импорт и использование `logger`:**
    - Импортировать `logger` из `src.logger.logger` для отслеживания ошибок.
    - Заменить `print` на `logger.info` или `logger.debug` для вывода информации в консоль.
    - Добавить обработку исключений с помощью `logger.error` для регистрации ошибок.
3.  **Использование `j_loads` или `j_loads_ns`:**
    - Заменить использование `json.load` на `j_loads` или `j_loads_ns` из `src.utils.jjson`.
4.  **Обработка исключений:**
    - Улучшить обработку исключений, особенно в блоке ввода координат, используя `logger.error` для записи ошибок.
5. **Форматирование кода:**
   - Придерживаться стандарта PEP 8 для улучшения читаемости кода.
   - Использовать более точные имена переменных.
6.  **Улучшение логики игры:**
    - Добавить возможность повторного запуска игры без перезапуска скрипта.
    - Реализовать возможность выбора размера игрового поля.
    - Добавить более информативные сообщения для пользователя.

## Улучшенный код
```python
"""
Модуль для игры в "Морской бой".
=========================================================================================

Этот модуль реализует текстовую версию классической игры "Морской бой",
где игрок пытается потопить корабль компьютера, угадывая координаты его расположения на поле 8x8.

Правила игры:
    1. Игровое поле представляет собой квадратную сетку 8x8.
    2. Компьютер размещает свой корабль на поле случайным образом, занимая 3 последовательные клетки по горизонтали или вертикали.
    3. Игрок вводит координаты выстрела в формате "ряд, столбец" (например, "1,2").
    4. Если выстрел попадает в корабль, компьютер сообщает "Попал".
    5. Если выстрел промахивается, компьютер сообщает "Мимо".
    6. Игра продолжается до тех пор, пока игрок не потопит корабль.

Пример использования:
--------------------
Запустите скрипт и следуйте инструкциям в консоли.

.. code-block:: python

    python boat.py
"""
import random # Импорт модуля random для генерации случайных чисел
from src.logger.logger import logger # Импорт logger для логирования ошибок #
# from src.utils.jjson import j_loads, j_loads_ns # TODO:  Импортировать j_loads и j_loads_ns

# Инициализация игрового поля 8x8
board = [[0 for _ in range(8)] for _ in range(8)] # Создание двумерного списка (матрицы) размером 8x8 и заполнение нулями #

def place_ship():
    """
    Размещает корабль на игровом поле случайным образом.

    :return: None
    """
    direction = random.randint(0, 1) # Случайный выбор направления: 0 - горизонтальное, 1 - вертикальное #
    if direction == 0:  # Горизонтальное направление #
        row = random.randint(0, 7) # Выбор случайного ряда для начала корабля #
        col = random.randint(0, 4) # Выбор случайного столбца для начала корабля (чтобы не выходил за границы) #
        for i in range(3):
            board[row][col + i] = 1  # Размещение корабля, присваивая 1 трем клеткам в выбранном ряду #
    else: # Вертикальное направление #
        row = random.randint(0, 4)  # Выбор случайного ряда для начала корабля (чтобы не выходил за границы) #
        col = random.randint(0, 7)  # Выбор случайного столбца для начала корабля #
        for i in range(3):
            board[row + i][col] = 1  # Размещение корабля, присваивая 1 трем клеткам в выбранном столбце #

# Размещаем корабль на поле #
place_ship()

# Основной игровой цикл
while True:
    # Вывод текущего состояния игрового поля
    for row in board: # Вывод игрового поля в консоль для пользователя #
        print(" ".join(map(str, row))) #

    # Запрашиваем ввод координат у пользователя #
    try:
        coordinates = input("Введите координаты выстрела (ряд, столбец): ") # Запрос ввода координат #
        row, col = map(int, coordinates.split(',')) # Разделение строки на ряд и столбец #
        if not (0 <= row <= 7 and 0 <= col <= 7): # Проверка допустимости координат #
            print("Неверные координаты. Введите числа от 0 до 7") # Вывод сообщения об ошибке #
            continue # Переход к следующей итерации цикла #
    except ValueError as e: # Обработка ошибки ввода #
        logger.error("Неверный формат ввода. Введите ряд и столбец через запятую, например: 1,2", exc_info=True) #  Логирование ошибки в случае неверного ввода #
        continue # Переход к следующей итерации цикла #

    # Проверяем, был ли выстрел попаданием #
    if board[row][col] == 1: # Проверка на попадание #
        print("Попал!") # Вывод сообщения о попадании #
        board[row][col] = 2 # Изменение значения клетки, чтобы не учитывать повторные попадания #
        ship_sunk = True # Флаг потопления корабля #
        for row_b in board: # Проверка, остались ли еще части корабля #
            if 1 in row_b: # Если на поле есть еще клетки корабля (значение 1) #
                ship_sunk = False # Флаг потопления корабля изменяется #
                break # Выход из цикла #
        if ship_sunk: # Если корабль потоплен #
            print("Корабль потоплен! Вы выиграли!") # Вывод сообщения о победе #
            break # Завершение игрового цикла #

    elif board[row][col] == 0: # Если выстрел мимо #
        print("Мимо!") # Вывод сообщения о промахе #

    elif board[row][col] == 2: # Если игрок стрелял в эту клетку ранее #
         print("Вы уже стреляли в эту клетку. Попробуйте другую.") # Вывод сообщения #