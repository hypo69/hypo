# Документация Telegram бота

## Обзор

Данный модуль реализует Telegram бота, который умеет обрабатывать команды, голосовые сообщения и файлы документов, взаимодействуя с пользователями в Telegram. Бот использует библиотеку `python-telegram-bot` для работы с Telegram API.

## Оглавление

- [Описание Telegram бота](#описание-телеграм-бота)
- [Основные функции и команды](#основные-функции-и-команды)
- [Обработка команд](#обработка-команд)
- [Обработка сообщений](#обработка-сообщений)
- [Обработка голосовых сообщений](#обработка-голосовых-сообщений)
- [Обработка документов](#обработка-документов)
- [Обработка текстовых сообщений](#обработка-текстовых-сообщений)
- [Основные модули и библиотеки](#основные-модули-и-библиотеки)
- [Класс TelegramBot](#класс-telegram-bot)
- [Методы класса TelegramBot](#методы-класса-telegram-bot)
- [Основная функция (main)](#основная-функция-main)


## Описание Telegram бота

Бот выполняет несколько функций, связанных с обработкой команд, голосовых сообщений и взаимодействием с пользователями в Telegram.  Он поддерживает команды `/start`, `/help`, `/sendpdf`, и обрабатывает различные типы сообщений.

## Основные функции и команды

Бот предоставляет следующие основные функции и команды:

- **Инициализация бота:** Бот инициализируется с токеном, используемым для аутентификации в Telegram API.
- **Команды:**
    - `/start`: Отправляет приветственное сообщение пользователю.
    - `/help`: Предоставляет список доступных команд.
    - `/sendpdf`: Отправляет PDF-файл пользователю.
- **Обработка сообщений:** Бот обрабатывает текстовые, голосовые сообщения и файлы документов. Для голосовых сообщений используется заглушка для транскрибирования. Для файлов документов осуществляется чтение содержимого текстового документа.


## Обработка команд

Бот обрабатывает следующие команды:

### `start`
Обрабатывает команду `/start`.


### `help`
Обрабатывает команду `/help`.


### `sendpdf`
Обрабатывает команду `/sendpdf` для отправки PDF-файла пользователю.


## Обработка сообщений

Бот обрабатывает различные типы сообщений:


## Обработка голосовых сообщений

Бот загружает файл голосового сообщения, сохраняет его локально и пытается транскрибировать с помощью сервиса распознавания речи (заглушка).

### `transcribe_voice`

**Описание**: Транскрибирует голосовое сообщение (заглушка).

**Параметры**:
- `file_path (Path)`: Путь к файлу голосового сообщения.

**Возвращает**:
- `str`: Транскрибированный текст (заглушка).

**Вызывает исключения**:
- `Exception`: Общие ошибки при обработке голосового сообщения.



## Обработка документов

Бот загружает файл документа, сохраняет его локально и читает содержимое текстового документа.

### `handle_document`

**Описание**: Обрабатывает файлы документов и читает их содержимое.

**Параметры**:
- `update (Update)`: Объект, содержащий данные о входящем обновлении.
- `context (CallbackContext)`: Объект, содержащий контекст выполнения.

**Возвращает**:
- `str`: Содержимое документа.

**Вызывает исключения**:
- `Exception`: Общие ошибки при обработке файла.


## Обработка текстовых сообщений

Бот просто возвращает текст, полученный от пользователя.

### `handle_message`

**Описание**: Обрабатывает текстовые сообщения.

**Параметры**:
- `update (Update)`: Объект, содержащий данные о входящем обновлении.
- `context (CallbackContext)`: Объект, содержащий контекст выполнения.

**Возвращает**:
- `str`: Текст сообщения.

**Вызывает исключения**:
- `Exception`: Общие ошибки при обработке текстового сообщения.



## Основные модули и библиотеки

Бот использует следующие модули и библиотеки:

- `python-telegram-bot`: Для работы с Telegram API.
- `pathlib`: Для работы с путями файлов.
- `tempfile`: Для создания временных файлов.
- `asyncio`: Для асинхронного выполнения задач.
- `requests`: Для загрузки файлов.
- `src.utils.convertors.tts`: Для распознавания речи (заглушка).
- `src.utils.file`: Для чтения текстовых файлов.



## Класс TelegramBot

### `TelegramBot`

**Описание**: Класс, представляющий Telegram бота.

### Методы класса TelegramBot

#### `__init__(self, token: str)`

**Описание**: Инициализирует бота с токеном и регистрирует обработчики.

**Параметры**:
- `token (str)`: Токен бота.

#### `register_handlers(self)`

**Описание**: Регистрирует обработчики команд и сообщений.

#### `start(self, update: Update, context: CallbackContext)`

**Описание**: Обрабатывает команду `/start`.

#### `help_command(self, update: Update, context: CallbackContext)`

**Описание**: Обрабатывает команду `/help`.

#### `send_pdf(self, pdf_file: str | Path)`

**Описание**: Обрабатывает команду `/sendpdf` для отправки PDF-файла.

#### `handle_voice(self, update: Update, context: CallbackContext)`

**Описание**: Обрабатывает голосовые сообщения и транскрибирует аудио.

#### `handle_document(self, update: Update, context: CallbackContext)`

**Описание**: Обрабатывает файлы документов.

#### `handle_message(self, update: Update, context: CallbackContext)`

**Описание**: Обрабатывает текстовые сообщения.



## Основная функция (main)

### `main()`

**Описание**: Инициализирует бота, регистрирует обработчики команд и сообщений, и запускает бота.