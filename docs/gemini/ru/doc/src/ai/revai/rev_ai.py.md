# Модуль для работы с API сервиса rev.ai для обработки аудио файлов.

## Обзор

Модуль предоставляет инструменты для работы с API rev.ai, чтобы осуществлять транскрипцию, анализ и обработку аудио-данных.

## Подробнее

Этот модуль предназначен для упрощения взаимодействия с API rev.ai, сервисом для автоматической транскрипции аудио и видео файлов. Он предоставляет класс `RevAI`, который позволяет отправлять аудиофайлы на обработку и получать результаты.  Модуль упрощает процесс интеграции с API rev.ai, предоставляя методы для отправки файлов, обработки ответов и управления ошибками.

## Классы

### `RevAI`

**Описание**: Класс для работы с API rev.ai.

**Принцип работы**:
Класс `RevAI` инициализируется с API ключом, который используется для аутентификации при взаимодействии с сервисом rev.ai. Он предоставляет метод `process_audio_file` для отправки аудиофайла на обработку и получения результата.

**Атрибуты**:
- `api_key` (str): API ключ для доступа к сервису rev.ai.
- `base_url` (str): Базовый URL для API rev.ai (TODO: необходимо заменить на актуальный URL).

**Методы**:
- `__init__(api_key: str)`: Инициализирует объект `RevAI` с указанным API ключом.
- `process_audio_file(audio_file_path: str) -> dict`: Обрабатывает аудио файл, используя API rev.ai.

### `__init__`

```python
def __init__(self, api_key: str):
    """
    Инициализирует объект RevAI с указанным API ключом.

    :param api_key: API ключ для доступа к сервису rev.ai.
    """
    ...
```

**Назначение**: Инициализация экземпляра класса `RevAI`.

**Параметры**:
- `api_key` (str): API ключ для доступа к сервису rev.ai.

**Как работает функция**:

1.  Функция `__init__` инициализирует объект `RevAI`, сохраняя переданный API ключ в атрибуте `api_key`.
2.  Устанавливает базовый URL для API rev.ai в атрибуте `base_url`. **TODO**:  Укажите правильный базовый URL.
3. **TODO**: Инициализирует заголовки, необходимые для аутентификации запросов к API, используя API ключ.

```
Инициализация
↓
Сохранение api_key
↓
Установка base_url
↓
Установка headers (TODO)
```

**Примеры**:

```python
revai_instance = RevAI(api_key='YOUR_API_KEY')
```

### `process_audio_file`

```python
def process_audio_file(self, audio_file_path: str) -> dict:
    """
    Обрабатывает аудио файл, используя API rev.ai.

    :param audio_file_path: Путь к аудио файлу.
    :return: Результат обработки аудио файла в формате словаря.
    """
    ...
```

**Назначение**: Обработка аудио файла с использованием API rev.ai.

**Параметры**:
- `audio_file_path` (str): Путь к аудио файлу.

**Возвращает**:
- `dict`: Результат обработки аудио файла в формате словаря.

**Вызывает исключения**:
- `requests.exceptions.RequestException`: Если возникает ошибка при отправке запроса к API.
- `Exception`: Если возникает общая ошибка при обработке файла.

**Внутренние функции**:
- Отсутствуют

**Как работает функция**:

1.  Проверяет, существует ли файл по указанному пути. Если файл не найден, функция логирует ошибку и возвращает `None`.
2.  Пытается отправить запрос к API rev.ai для обработки аудио файла. **TODO**: Добавить обработку ошибок при отправке запроса (например, проблемы с сетью, неверные параметры).
3.  Формирует запрос к API, включая аудиофайл и необходимые заголовки.
4.  Обрабатывает ответ от API, проверяя код ответа и преобразуя ответ в словарь с использованием `j_dumps`.
5.  В случае возникновения ошибок при отправке запроса или обработке ответа, функция логирует ошибку и возвращает `None`.
6. Если происходит ошибка в процессе запроса к API (например, `requests.exceptions.RequestException`), фиксируется ошибка с помощью логгера `logger.error` с указанием типа исключения и возвращается `None`.
7. Если происходит любая другая ошибка (`Exception`), фиксируется ошибка с помощью логгера `logger.error` и возвращается `None`.

```
Проверка существования файла
↓
Отправка запроса к API (TODO: доработать)
↓
Обработка ответа
↓
Преобразование ответа в словарь
↓
Обработка ошибок
```

**Примеры**:

```python
from src.ai.revai import RevAI

revai_instance = RevAI(api_key='YOUR_API_KEY')
result = revai_instance.process_audio_file('path/to/audio.wav')
if result:
    print(f'Результат обработки: {result}')
else:
    print('Ошибка при обработке файла')