# Модуль для отправки сообщений WhatsApp
## Обзор

Модуль `whatsapp_sender.py` предназначен для автоматической отправки сообщений в WhatsApp с использованием библиотеки `pywhatkit` и `pyautogui`. Он позволяет отправлять заданное количество сообщений на указанный номер телефона в случайное время в заданном интервале.

## Подробнее

Модуль предоставляет функцию `send_whatsapp_message` для отправки одиночного сообщения и использует цикл `while` для отправки нескольких сообщений. Он также включает банк сообщений с эмодзи для выбора случайного сообщения.

## Функции

### `send_whatsapp_message`

```python
def send_whatsapp_message(phone_number, message, hour, minutes):
    """Отправляет сообщение WhatsApp с использованием pywhatkit и pyautogui.
    
    Args:
        phone_number (str): Номер телефона получателя с кодом страны.
        message (str): Текст сообщения для отправки.
        hour (int): Час отправки сообщения (0-23).
        minutes (int): Минуты отправки сообщения (0-59).

    Raises:
        Exception: Если возникает ошибка при отправке сообщения.

    Example:
        >>> send_whatsapp_message('+79991234567', 'Привет!', 10, 30)
    """
```

**Как работает функция**:
1. Функция `send_whatsapp_message` принимает номер телефона, сообщение, час и минуты в качестве входных параметров.
2. Она использует библиотеку `pywhatkit` для отправки сообщения в указанное время. `pywhatkit.sendwhatmsg` открывает веб-версию WhatsApp, вводит номер телефона, сообщение и отправляет его.
3. После отправки сообщения функция ждет 20 секунд, чтобы дать время для загрузки WhatsApp Web.
4. Затем функция использует библиотеку `pyautogui` и `pynput.keyboard` для эмуляции нажатия клавиши Enter, чтобы отправить сообщение.
5. Если возникает ошибка при отправке сообщения, она перехватывается и выводится в консоль.

**Параметры**:
- `phone_number` (str): Номер телефона получателя с кодом страны.
- `message` (str): Текст сообщения для отправки.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минуты отправки сообщения (0-59).

**Вызывает исключения**:
- `Exception`: Если возникает ошибка при отправке сообщения.

## Переменные

- `messages` (list): Список сообщений с эмодзи. Используется для выбора случайного сообщения для отправки.

## Основной код

После определения функции `send_whatsapp_message` и списка сообщений, код выполняет следующие действия:

1. **Получение пользовательских входных данных**:
   - Запрашивает номер телефона с кодом страны.
   - Запрашивает количество сообщений для отправки.
   - Запрашивает начальный и конечный часы для отправки сообщений.

2. **Цикл отправки сообщений**:
   - Инициализирует счетчик сообщений `message_count` равным 0.
   - Запускает цикл `while`, который выполняется до тех пор, пока `message_count` меньше `num_messages`.
   - Внутри цикла:
     - Генерирует случайный час `random_hour` в диапазоне от `start_hour` до `end_hour`.
     - Генерирует случайные минуты `random_minutes` в диапазоне от 0 до 59.
     - Выбирает случайное сообщение `random_message` из списка `messages`.
     - Вызывает функцию `send_whatsapp_message` с полученными случайными значениями.
     - Увеличивает счетчик сообщений `message_count` на 1.