# Модуль hypotez/src/suppliers/aliexpress/campaign/gsheet.py

## Обзор

Этот модуль предоставляет класс `AliCampaignGoogleSheet` для работы с Google Таблицами в контексте рекламных кампаний AliExpress.  Он наследует класс `SpreadSheet` и добавляет методы для управления листами, записи данных о категориях и продуктах, а также форматирования листов.

## Классы

### `AliCampaignGoogleSheet`

**Описание**:  Класс для работы с Google Таблицами в рамках кампаний AliExpress.  Наследует `SpreadSheet` и предоставляет расширенные методы для управления листами, записи и форматирования данных о категориях и продуктах кампании.

**Атрибуты**:

- `spreadsheet_id`: Строка, представляющая ID Google Таблицы.
- `spreadsheet`: Объект `SpreadSheet`, представляющий подключение к Google Таблице.
- `worksheet`: Объект `Worksheet`, представляющий текущий лист Google Таблицы.


**Методы**:

#### `__init__`

**Описание**: Инициализирует экземпляр класса `AliCampaignGoogleSheet`.

**Параметры**:

- `campaign_name` (str): Название кампании.
- `language` (str | dict, optional): Язык кампании. По умолчанию `None`.
- `currency` (str, optional): Валюта кампании. По умолчанию `None`.

**Возвращает**:
-  (None): Не возвращает значение.

#### `clear`

**Описание**: Очищает содержимое листов, удаляя листы продуктов и очищая данные на листах категорий и других указанных листах.

**Возвращает**:
- (None): Не возвращает значение.

#### `delete_products_worksheets`

**Описание**: Удаляет все листы из Google Таблицы, кроме листов 'categories' и 'product_template'.

**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка во время удаления листов.


#### `set_campaign_worksheet`

**Описание**: Записывает данные о кампании в лист Google Таблицы с именем 'campaign'.

**Параметры**:

- `campaign` (SimpleNamespace): Объект SimpleNamespace содержащий данные о кампании.
- `language` (str, optional): Язык кампании.
- `currency` (str, optional): Валюта кампании.


**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка во время записи данных о кампании.


#### `set_products_worksheet`

**Описание**: Записывает данные продуктов в Google Таблицу.

**Параметры**:

- `category_name` (str): Название категории продуктов.


**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка при записи данных о продуктах.


#### `set_categories_worksheet`

**Описание**: Записывает данные категорий в лист Google Таблицы с именем 'categories'.

**Параметры**:

- `categories` (SimpleNamespace): Объект, содержащий данные о категориях.


**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка во время записи данных о категориях.


#### `get_categories`

**Описание**: Получает данные категорий из Google Таблицы.

**Возвращает**:
- list: Список словарей с данными категорий.
**Возможные исключения**:
- `Exception`: Ошибка при чтении данных о категориях.


#### `set_category_products`

**Описание**: Записывает данные продуктов для определенной категории в Google Таблицу.

**Параметры**:

- `category_name` (str): Название категории.
- `products` (dict): Данные о продуктах.


**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка при записи данных о продуктах.


#### `_format_categories_worksheet`

**Описание**: Форматирует лист 'categories'.


**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка при форматировании листа.


#### `_format_category_products_worksheet`

**Описание**: Форматирует лист с продуктами категории.


**Возвращает**:
- (None): Не возвращает значение.
**Возможные исключения**:
- `Exception`: Ошибка при форматировании листа.


## Функции

(Нет функций в этом модуле, только классы)


## Модули

- `gspread`
- `src.goog.spreadsheet.spreadsheet`
- `src.utils`
- `src.logger`
- `src.ai.openai`