# TinyTroupe: LLM-powered multiagent persona simulation

## Обзор

Этот документ описывает библиотеку *TinyTroupe*, предназначенную для моделирования поведения людей с различными личностями, интересами и целями с использованием больших языковых моделей (LLM). *TinyTroupe* позволяет создавать симуляции для анализа потребительского поведения, тестирования программного обеспечения, генерации синтетических данных и многого другого.

## Подробней

*TinyTroupe* предоставляет инструменты для создания `TinyPerson` (агентов) и `TinyWorld` (сред окружения). Она предназначена для улучшения понимания человеческого поведения в различных сценариях, а не для прямой поддержки этого поведения (например, как это делают AI-ассистенты). Библиотека находится на ранней стадии разработки и предназначена для получения обратной связи и предложений по улучшению.

## Содержание

- [Последние новости](#latest-news)
- [Примеры](#examples)
- [Необходимые условия](#pre-requisites)
- [Установка](#installation)
- [Принципы](#principles)
- [Структура проекта](#project-structure)
- [Использование библиотеки](#using-the-library)
- [Вклад](#contributing)
- [Благодарности](#acknowledgements)
- [Как цитировать TinyTroupe](#how-to-cite-tinytroupe)
- [Юридическое предупреждение](#legal-disclaimer)
- [Торговые марки](#trademarks)

## Последние новости

**[2025-01-29] Выпуск 0.4.0 с различными улучшениями:**

  - Расширены спецификации персонажей, включая черты характера, предпочтения и убеждения.
  - `TinyPerson` теперь можно определять как JSON-файлы и загружать через `TinyPerson.load_specification()`.
  - Введено понятие *фрагментов* для повторного использования элементов персонажей в разных агентах.
  - Введены логические `Proposition` на основе LLM для облегчения мониторинга поведения агентов.
  - Введены `Intervention` для определения модификаций симуляции на основе событий.

## Примеры

- **Пример 1**: Моделирование интервью с клиентом, где бизнес-консультант взаимодействует с банкиром.
- **Пример 2**: Оценка вариантов онлайн-рекламы для выбора лучшего.
- **Пример 3**: Моделирование фокус-группы для обсуждения новых AI-функций для Microsoft Word.

## Необходимые условия

- Python 3.10 или выше.
- Доступ к Azure OpenAI Service или OpenAI GPT-4 APIs.
- Настройка переменных окружения `AZURE_OPENAI_KEY`, `AZURE_OPENAI_ENDPOINT` или `OPENAI_API_KEY`.
- Настройка `config.ini` файла с параметрами API и модели.

## Установка

1. Создайте новое окружение Python:
   ```bash
   conda create -n tinytroupe python=3.10
   ```
2. Активируйте окружение:
   ```bash
   conda activate tinytroupe
   ```
3. Установите библиотеку непосредственно из репозитория:
   ```bash
   pip install git+https://github.com/microsoft/TinyTroupe.git@main
   ```

## Принципы

*TinyTroupe* придерживается следующих принципов:

1. **Программный**: Агенты и окружения определяются программно (на Python и JSON).
2. **Аналитический**: Предназначен для улучшения понимания людей, пользователей и общества.
3. **Персона-ориентированный**: Агенты являются архетипическими представлениями людей.
4. **Мультиагентный**: Позволяет взаимодействовать нескольким агентам в определенных условиях.
5. **Утилитарный**: Предоставляет механизмы для спецификаций, симуляций, извлечений, отчетов, проверок.
6. **Эксперимент-ориентированный**: Симуляции определяются, запускаются, анализируются и улучшаются итеративно.

## Структура проекта

Проект имеет следующую структуру:

  - `/tinytroupe`: Содержит Python-библиотеку.
    * Каждый подмодуль может содержать папку `prompts/` с промптами для LLM.
  - `/tests`: Содержит модульные тесты для библиотеки.
  - `/examples`: Содержит примеры использования библиотеки.
  - `/data`: Данные, используемые примерами или библиотекой.
  - `/docs`: Документация проекта.

## Использование библиотеки

Ключевые абстракции:

  - `TinyPerson`: Агенты, обладающие личностью, получающие стимулы и действующие на них.
  - `TinyWorld`: Среда, в которой существуют и взаимодействуют агенты.

### TinyPerson

`TinyPerson` — это имитированный человек с определенными чертами характера, интересами и целями. В процессе своей жизни этот агент получает стимулы из окружающей среды и реагирует на них. Стимулы принимаются через методы `listen`, `see` и другие, а действия выполняются через метод `act`. Также предоставляются удобные методы, такие как `listen_and_act`.

#### Фрагменты

`TinyPerson` можно обогатить с помощью **фрагментов** — под-спецификаций, которые можно добавлять к основной спецификации. Это полезно для повторного использования общих частей в разных агентах.

#### TinyPersonFactory

`TinyTroupe` также предоставляет способ создания новых агентов с использованием LLM для генерации их спецификаций через класс `TinyPersonFactory`.

### TinyWorld

`TinyWorld` — базовый класс для окружений. Подклассы предоставляют более структурированные среды.

### Утилиты

TinyTroupe предоставляет утилиты:

  - `TinyPersonFactory`: Помогает генерировать новых `TinyPerson` с использованием LLM.
  - `TinyTool`: Имитированные инструменты, используемые `TinyPerson`.
  - `TinyStory`: Помогает создавать и управлять историей, рассказанной через симуляции.
  - `TinyPersonValidator`: Помогает проверить поведение `TinyPerson`.
  - `ResultsExtractor` и `ResultsReducer`: Извлекают и сокращают результаты взаимодействий между агентами.

### Кэширование

TinyTroupe предоставляет механизмы кэширования:

#### Кэширование состояния симуляции

Модуль `tinytroupe.control` предоставляет методы управления симуляцией:

  - `control.begin("<CACHE_FILE_NAME>.cache.json")`: Начинает запись изменений состояния симуляции.
  - `control.checkpoint()`: Сохраняет состояние симуляции в данный момент.
  - `control.end()`: Завершает область записи симуляции, начатую `control.begin()`.

#### Кэширование вызовов LLM API

Включается в файле `config.ini` или через `openai_utils.force_api_cache()`.

### Config.ini

Файл `config.ini` содержит параметры для настройки библиотеки, такие как параметры модели и уровень логирования.

## Вклад

Приветствуются вклады в проект.

## Благодарности

TinyTroupe началась как внутренний хакатон-проект Microsoft.

## Как цитировать TinyTroupe

До выхода официальной статьи, цитируйте репозиторий, включая основных членов команды в качестве авторов.

## Юридическое предупреждение

TinyTroupe предназначена только для исследований и симуляций. Пользователь несет ответственность за любой свой вклад в проект.
Выходные данные не должны быть использованы для обмана, введения в заблуждение или причинения вреда людям.

## Торговые марки

Проект может содержать торговые марки или логотипы для проектов, продуктов или услуг. Использование торговых марок Microsoft регулируется правилами Microsoft.