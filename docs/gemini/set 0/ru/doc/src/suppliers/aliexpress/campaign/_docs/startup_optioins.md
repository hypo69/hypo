# Модуль `prepare_campaigns` для подготовки рекламных кампаний AliExpress

## Обзор

Данный модуль предназначен для подготовки рекламных кампаний на AliExpress. Он выполняет ряд задач, начиная с инициализации параметров кампании (название, язык, валюта) и заканчивая публикацией готовой кампании.  Модуль обрабатывает данные категорий, собирает и сохраняет информацию о продуктах, создает рекламные материалы и проверяет готовность кампании к публикации.

## Оглавление

* [Подготовка рекламных кампаний](#подготовка-рекламных-кампаний)
    * [Функция `update_category`](#функция-update-category)
    * [Функция `process_campaign_category`](#функция-process-campaign-category)
    * [Функция `process_campaign`](#функция-process-campaign)
    * [Функция `main`](#функция-main)


## Подготовка рекламных кампаний

### Функция `update_category`

**Описание**: Обновляет категорию в JSON файле.

**Параметры**:
- `json_path` (Path): Путь к JSON файлу.
- `category` (SimpleNamespace): Объект `SimpleNamespace` содержащий данные категории.

**Возвращает**:
- `bool`: `True` если обновление прошло успешно, `False` в противном случае.

**Вызывает исключения**:
- Любые исключения, возникающие при работе с JSON (например, `JSONDecodeError`, `FileNotFoundError`).


### Функция `process_campaign_category`

**Описание**: Обрабатывает конкретную категорию кампании для всех языков и валют.

**Параметры**:
- `campaign_name` (str): Название рекламной кампании.
- `category_name` (str): Название категории.
- `language` (str): Язык кампании.
- `currency` (str): Валюта кампании.
- `force` (bool, optional): Принудительно обновить категорию. По умолчанию `False`.

**Возвращает**:
- `Optional[bool]`: `True` если обработка категории прошла успешно, `False` в противном случае.  Возвращает `None`, если объект `AliPromoCampaign` не содержит атрибут `category`.

**Вызывает исключения**:
- Любые исключения, возникающие при работе с файлами или `AliPromoCampaign`.


### Функция `process_campaign`

**Описание**: Обрабатывает всю кампанию для всех категорий.

**Параметры**:
- `campaign_name` (str): Название рекламной кампании.
- `categories` (List[str] | None, optional): Список категорий для кампании. Если `None`, то обрабатываются все категории в директории.
- `language` (str, optional): Язык кампании (по умолчанию 'EN').
- `currency` (str, optional): Валюта кампании (по умолчанию 'USD').
- `force` (bool, optional): Принудительно обновить категории. По умолчанию `False`.

**Возвращает**:
- `None`: Функция ничего не возвращает, но записывает результаты обработки в лог. Возвращает список кортежей вида `(категория, результат обработки)`.


**Вызывает исключения**:
- Любые исключения, возникающие при работе с файлами или `get_directory_names`.


### Функция `main`

**Описание**: Асинхронная функция для обработки кампании.

**Параметры**:
- `campaign_name` (str): Название рекламной кампании.
- `categories` (List[str]): Список категорий для кампании.
- `language` (str): Язык кампании.
- `currency` (str): Валюта кампании.
- `force` (bool, optional): Принудительно обновить категории. По умолчанию `False`.

**Возвращает**:
- `None`: Функция ничего не возвращает, но выполняет асинхронную обработку категорий.

**Вызывает исключения**:
- Любые исключения, возникающие внутри асинхронных вызовов `process_campaign_category`.



## Пример использования

```bash
python src/suppliers/aliexpress/campaigns/prepare_campaigns.py summer_sale -c electronics -l EN -cu USD -f
```

Эта команда выполнит подготовку кампании `summer_sale` для категории `electronics` с языком `EN` и валютой `USD`, принудительно обновив данные.


```bash
python src/suppliers/aliexpress/campaigns/prepare_campaigns.py summer_sale -c electronics fashion -l EN -cu USD -f
```

Эта команда обработает кампанию `summer_sale` для категорий `electronics` и `fashion`.
```