Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `AliPromoCampaign`, предназначенный для управления рекламными кампаниями на AliExpress.  Он позволяет загружать и обрабатывать данные о кампаниях, категориях и товарах, а также использовать искусственный интеллект (ИИ) для генерации данных кампаний.  Код содержит методы для инициализации кампании, обработки данных о категориях и товарах, генерации описаний категорий с помощью ИИ и сохранения результатов в файлы.

Шаги выполнения
-------------------------
1. **Импортирование необходимых библиотек:** Код импортирует различные библиотеки, включая `asyncio`, `time`, `copy`, `html`, `pathlib`, `typing`, `header`, `gs`, `AliAffiliatedProducts`, `locales`, `GoogleGenerativeAI`, `OpenAIModel` и другие для работы с файлами, AI-моделями и другими функциональными возможностями.

2. **Определение класса `AliPromoCampaign`:** Определяется класс `AliPromoCampaign` с атрибутами для хранения данных о кампании (имя, язык, валюта, путь к файлам и т.д.), а также AI-моделями.

3. **Метод `__init__`:** Этот метод инициализирует объект `AliPromoCampaign` и загружает данные о кампании из файла JSON, если он существует.  Если файла нет, запускается процесс создания новой кампании `process_new_campaign`.

4. **Метод `_models_payload`:** Метод инициализирует AI-модели (в данном случае `GoogleGenerativeAI`) с использованием инструкций из файла.

5. **Метод `process_campaign`:** Итерируется по именам категорий в кампании. Для каждой категории вызываются методы `process_category_products` и `process_ai_category` для обработки данных о товарах и генерации данных с помощью ИИ соответственно.

6. **Метод `process_new_campaign`:** Создаёт новую рекламную кампанию.  Выполняет операции для создания необходимых директорий и файлов, если их нет, включая генерацию данных о категориях и товарах.

7. **Метод `process_ai_category`:**  Обрабатывает категории с использованием AI, генерируя описания и другую информацию. Загружает данные о товарах из соответствующих каталогов и создаёт prompt для AI. Обрабатывает ответ AI и обновляет информацию о категории в `campaign`.

8. **Метод `process_category_products`:** Обрабатывает данные о товарах в конкретной категории.  Ищет файлы с информацией о продуктах (HTML, sources.txt). Если данные о продуктах не найдены, выводит ошибку и возвращает `None`.  В противном случае, инициирует процесс получения данных о партнерских продуктах.

9. **Метод `dump_category_products_files`:** Сохраняет данные о товарах в отдельные JSON-файлы, по одному на продукт.

10. **Метод `set_categories_from_directories`:** Устанавливает категории рекламной кампании из названий директорий в каталоге `category`.  Преобразует имена директорий в объекты `SimpleNamespace`.

11. **Метод `generate_output`:** Сохраняет данные о товарах в различные форматы (JSON, HTML). Форматирует данные перед сохранением в JSON и в дальнейшем создает и сохраняет HTML файлы с информацией о товарах.

12. **Метод `generate_html`:** Создаёт HTML-страницы для категорий и общей страницы рекламной кампании.


Пример использования
-------------------------
.. code-block:: python

    from hypotez.src.suppliers.aliexpress.campaign import ali_promo_campaign
    import asyncio

    # Инициализация кампании
    campaign = ali_promo_campaign.AliPromoCampaign("SummerSale", language="EN", currency="USD")

    # Обработка кампании
    try:
        asyncio.run(campaign.process_campaign())
    except Exception as e:
        print(f"Ошибка при обработке кампании: {e}")
    # ... другие вызовы методов для обработки категорий и товаров