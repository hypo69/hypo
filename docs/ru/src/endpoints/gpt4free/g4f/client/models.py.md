# Модуль `models.py`

## Обзор

Модуль `models.py` предназначен для управления и предоставления информации о моделях, доступных через различных провайдеров в контексте клиента `gpt4free`. Он содержит класс `ClientModels`, который позволяет получать, фильтровать и организовывать модели в зависимости от их типа (текстовые, vision, image, video) и провайдера. Этот модуль обеспечивает централизованный доступ к моделям и их метаданным, упрощая выбор и использование подходящей модели для конкретной задачи.

## Подробнее

Модуль `models.py` является важной частью системы, поскольку он абстрагирует взаимодействие с различными провайдерами моделей (например, OpenAI, Google Gemini). Он позволяет клиенту динамически получать список доступных моделей, а также фильтровать их по типу (например, модели для работы с изображениями или видео). Это обеспечивает гибкость и расширяемость системы, так как новые провайдеры и типы моделей могут быть легко добавлены без изменения основного кода клиента.

## Классы

### `ClientModels`

**Описание**: Класс `ClientModels` управляет доступными моделями, предоставляя методы для их получения и фильтрации. Он инициализируется с клиентом и, опционально, с основными и медиа-провайдерами.

**Принцип работы**:
Класс `ClientModels` предоставляет методы для получения списка всех моделей, а также для фильтрации моделей по типу (vision, image, video). Он использует провайдеры (основной и медиа) для получения списка моделей. Если провайдер не указан, используются модели, определенные в `ModelUtils.convert`.

**Методы**:

- `__init__`: Инициализирует экземпляр класса `ClientModels`.
- `get`: Возвращает тип провайдера для указанного имени модели.
- `get_all`: Возвращает список всех доступных моделей для основного провайдера.
- `get_vision`: Возвращает список vision-моделей.
- `get_media`: Возвращает список медиа-моделей для медиа-провайдера.
- `get_image`: Возвращает список image-моделей.
- `get_video`: Возвращает список video-моделей.

#### `__init__`

```python
def __init__(self, client, provider: ProviderType = None, media_provider: ProviderType = None):
    """
    Инициализирует экземпляр класса `ClientModels`.

    Args:
        client: Клиент, используемый для взаимодействия с провайдерами.
        provider (ProviderType, optional): Основной провайдер моделей. По умолчанию `None`.
        media_provider (ProviderType, optional): Провайдер медиа-моделей. По умолчанию `None`.
    """
```

**Параметры**:

- `client`: Клиент, используемый для взаимодействия с провайдерами.
- `provider` (ProviderType, optional): Основной провайдер моделей. По умолчанию `None`.
- `media_provider` (ProviderType, optional): Провайдер медиа-моделей. По умолчанию `None`.

**Как работает функция**:

1.  Функция инициализирует класс `ClientModels`, принимая в качестве аргументов клиентский объект, основного провайдера моделей и провайдера медиа-моделей.
2.  Внутри функции происходит присвоение переданных аргументов соответствующим атрибутам экземпляра класса: `self.client`, `self.provider` и `self.media_provider`.

#### `get`

```python
def get(self, name, default=None) -> ProviderType:
    """
    Возвращает тип провайдера для указанного имени модели.

    Args:
        name: Имя модели.
        default: Значение по умолчанию, если модель не найдена.

    Returns:
        ProviderType: Тип провайдера для указанной модели или значение по умолчанию.
    """
```

**Параметры**:

- `name`: Имя модели, для которой требуется получить провайдера.
- `default`: Значение по умолчанию, которое будет возвращено, если модель не найдена. По умолчанию `None`.

**Возвращает**:

- `ProviderType`: Тип провайдера для указанной модели или значение по умолчанию.

**Как работает функция**:

1.  Функция `get` принимает имя модели и опциональное значение по умолчанию.
2.  Проверяет, есть ли имя модели в словаре `ModelUtils.convert` или `ProviderUtils.convert`.
3.  Если имя модели найдено в `ModelUtils.convert`, функция возвращает `best_provider` соответствующей модели.
4.  Если имя модели найдено в `ProviderUtils.convert`, функция возвращает соответствующего провайдера.
5.  Если имя модели не найдено ни в одном из словарей, функция возвращает значение по умолчанию.

**Примеры**:

```python
client_models = ClientModels(client=None)
provider = client_models.get('gpt-3.5-turbo')
print(provider) # выводит <значение провайдера> если gpt-3.5-turbo есть в ModelUtils.convert

provider = client_models.get('some_unknown_model', default='default_provider')
print(provider) # выводит default_provider
```

#### `get_all`

```python
def get_all(self, api_key: str = None, **kwargs) -> list[str]:
    """
    Возвращает список всех доступных моделей для основного провайдера.

    Args:
        api_key (str, optional): API-ключ для провайдера. По умолчанию `None`.
        **kwargs: Дополнительные аргументы, передаваемые в `get_models` провайдера.

    Returns:
        list[str]: Список идентификаторов доступных моделей.
    """
```

**Параметры**:

- `api_key` (str, optional): API-ключ для провайдера. Если `None`, используется `self.client.api_key`. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы, передаваемые в `get_models` провайдера.

**Возвращает**:

- `list[str]`: Список идентификаторов доступных моделей.

**Как работает функция**:

1.  Функция `get_all` принимает опциональный API-ключ и произвольные ключевые аргументы.
2.  Если `self.provider` равен `None`, функция возвращает пустой список.
3.  Если API-ключ не предоставлен, используется `self.client.api_key`.
4.  Функция вызывает метод `get_models` провайдера, передавая API-ключ (если он есть) и дополнительные ключевые аргументы.
5.  Возвращает список идентификаторов моделей, полученных от провайдера.

**Примеры**:

```python
client_models = ClientModels(client=None, provider=some_provider)
models = client_models.get_all(api_key='some_api_key', param1='value1')
print(models) # выводит список моделей, полученных от some_provider
```

#### `get_vision`

```python
def get_vision(self, **kwargs) -> list[str]:
    """
    Возвращает список vision-моделей.

    Args:
        **kwargs: Дополнительные аргументы, передаваемые в `get_all`.

    Returns:
        list[str]: Список идентификаторов vision-моделей.
    """
```

**Параметры**:

- `**kwargs`: Дополнительные аргументы, передаваемые в `get_all`.

**Возвращает**:

- `list[str]`: Список идентификаторов vision-моделей.

**Как работает функция**:

1.  Функция `get_vision` принимает произвольные ключевые аргументы.
2.  Если `self.provider` равен `None`, функция возвращает список идентификаторов моделей из `ModelUtils.convert`, которые являются экземплярами класса `VisionModel`.
3.  В противном случае вызывается метод `get_all` с переданными аргументами.
4.  Если у провайдера есть атрибут `vision_models`, функция возвращает значение этого атрибута.
5.  В противном случае возвращается пустой список.

**Примеры**:

```python
client_models = ClientModels(client=None, provider=some_provider)
vision_models = client_models.get_vision(param1='value1')
print(vision_models) # выводит список vision-моделей, полученных от some_provider
```

#### `get_media`

```python
def get_media(self, api_key: str = None, **kwargs) -> list[str]:
    """
    Возвращает список медиа-моделей для медиа-провайдера.

    Args:
        api_key (str, optional): API-ключ для медиа-провайдера. По умолчанию `None`.
        **kwargs: Дополнительные аргументы, передаваемые в `get_models` медиа-провайдера.

    Returns:
        list[str]: Список идентификаторов медиа-моделей.
    """
```

**Параметры**:

- `api_key` (str, optional): API-ключ для медиа-провайдера. Если `None`, используется `self.client.api_key`. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы, передаваемые в `get_models` медиа-провайдера.

**Возвращает**:

- `list[str]`: Список идентификаторов медиа-моделей.

**Как работает функция**:

1.  Функция `get_media` принимает опциональный API-ключ и произвольные ключевые аргументы.
2.  Если `self.media_provider` равен `None`, функция возвращает пустой список.
3.  Если API-ключ не предоставлен, используется `self.client.api_key`.
4.  Функция вызывает метод `get_models` медиа-провайдера, передавая API-ключ (если он есть) и дополнительные ключевые аргументы.
5.  Возвращает список идентификаторов моделей, полученных от медиа-провайдера.

**Примеры**:

```python
client_models = ClientModels(client=None, media_provider=some_media_provider)
media_models = client_models.get_media(api_key='some_api_key', param1='value1')
print(media_models) # выводит список медиа-моделей, полученных от some_media_provider
```

#### `get_image`

```python
def get_image(self, **kwargs) -> list[str]:
    """
    Возвращает список image-моделей.

    Args:
        **kwargs: Дополнительные аргументы, передаваемые в `get_media`.

    Returns:
        list[str]: Список идентификаторов image-моделей.
    """
```

**Параметры**:

- `**kwargs`: Дополнительные аргументы, передаваемые в `get_media`.

**Возвращает**:

- `list[str]`: Список идентификаторов image-моделей.

**Как работает функция**:

1.  Функция `get_image` принимает произвольные ключевые аргументы.
2.  Если `self.media_provider` равен `None`, функция возвращает список идентификаторов моделей из `ModelUtils.convert`, которые являются экземплярами класса `ImageModel`.
3.  В противном случае вызывается метод `get_media` с переданными аргументами.
4.  Если у медиа-провайдера есть атрибут `image_models`, функция возвращает значение этого атрибута.
5.  В противном случае возвращается пустой список.

**Примеры**:

```python
client_models = ClientModels(client=None, media_provider=some_media_provider)
image_models = client_models.get_image(param1='value1')
print(image_models) # выводит список image-моделей, полученных от some_media_provider
```

#### `get_video`

```python
def get_video(self, **kwargs) -> list[str]:
    """
    Возвращает список video-моделей.

    Args:
        **kwargs: Дополнительные аргументы, передаваемые в `get_media`.

    Returns:
        list[str]: Список идентификаторов video-моделей.
    """
```

**Параметры**:

- `**kwargs`: Дополнительные аргументы, передаваемые в `get_media`.

**Возвращает**:

- `list[str]`: Список идентификаторов video-моделей.

**Как работает функция**:

1.  Функция `get_video` принимает произвольные ключевые аргументы.
2.  Если `self.media_provider` равен `None`, функция возвращает пустой список.
3.  В противном случае вызывается метод `get_media` с переданными аргументами.
4.  Если у медиа-провайдера есть атрибут `video_models`, функция возвращает значение этого атрибута.
5.  В противном случае возвращается пустой список.

**Примеры**:

```python
client_models = ClientModels(client=None, media_provider=some_media_provider)
video_models = client_models.get_video(param1='value1')
print(video_models) # выводит список video-моделей, полученных от some_media_provider