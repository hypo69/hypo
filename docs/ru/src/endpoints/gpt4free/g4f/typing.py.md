# Модуль typing

## Обзор

Модуль `typing` содержит определения типов, используемые в проекте `hypotez` для обеспечения статической типизации и повышения читаемости кода. Он включает в себя импорты стандартных типов, а также определения новых типов, специфичных для проекта.

## Подробнее

Модуль определяет типы данных, используемые в различных частях проекта `hypotez`. Это позволяет улучшить проверку типов и облегчает понимание структуры данных, передаваемых между функциями и классами. В частности, он определяет типы для работы с изображениями, хэшами, сообщениями и результатами асинхронных операций.

## Типы

### `SHA256`

```python
SHA256 = NewType('sha_256_hash', str)
```

**Описание**: Тип, представляющий SHA256 хэш в виде строки.

### `CreateResult`

```python
CreateResult = Iterator[Union[str, ResponseType]]
```

**Описание**: Тип, представляющий итератор, возвращающий либо строку, либо объект типа `ResponseType`.

### `AsyncResult`

```python
AsyncResult = AsyncIterator[Union[str, ResponseType]]
```

**Описание**: Тип, представляющий асинхронный итератор, возвращающий либо строку, либо объект типа `ResponseType`.

### `Messages`

```python
Messages = List[Dict[str, Union[str, List[Dict[str, Union[str, Dict[str, str]]]]]]]
```

**Описание**: Тип, представляющий список словарей, используемых для передачи сообщений.

### `Cookies`

```python
Cookies = Dict[str, str]
```

**Описание**: Тип, представляющий словарь, содержащий HTTP cookie.

### `ImageType`

```python
ImageType = Union[str, bytes, IO, Image, os.PathLike]
```

**Описание**: Тип, представляющий изображение в различных форматах (строка, байты, файловый объект, объект `PIL.Image` или путь к файлу).

### `MediaListType`

```python
MediaListType = List[Tuple[ImageType, Optional[str]]]
```

**Описание**: Тип, представляющий список кортежей, содержащих изображение и опциональное имя файла.

## Зависимости

- `sys`: Используется для получения информации о версии Python.
- `os`: Используется для работы с путями к файлам.
- `typing`: Используется для определения сложных типов данных.
- `PIL.Image`: Используется для работы с изображениями (если PIL установлен).
- `typing_extensions`: Используется для поддержки `TypedDict` в версиях Python ниже 3.8.
- `.providers.response.ResponseType`: Тип, определенный в модуле `response` пакета `providers`.

## Классы

### `Image`

```python
class Image:
    pass
```

**Описание**: Пустой класс-заглушка, используется если библиотека `PIL` не установлена.

## Переменные

- `__all__`: Список строк, содержащий имена всех экспортируемых объектов модуля.

## Как работает модуль

1. **Импорт необходимых модулей**:
   - Модуль импортирует стандартные модули `sys`, `os` и `typing` для определения типов данных.
   - Пытается импортировать `PIL.Image`, и, если это не удается, определяет пустой класс `Image`.
   - Импортирует `TypedDict` из `typing` или `typing_extensions` в зависимости от версии Python.
   - Импортирует `ResponseType` из модуля `providers.response`.

2. **Определение новых типов**:
   - Определяет несколько новых типов с использованием `NewType`, `Union`, `List`, `Dict`, `Tuple` и `Optional` из модуля `typing`.
   - `SHA256` представляет собой хэш SHA256.
   - `CreateResult` и `AsyncResult` представляют собой итераторы и асинхронные итераторы, возвращающие строки или объекты `ResponseType`.
   - `Messages` представляет собой сложную структуру данных для сообщений.
   - `Cookies` представляет собой словарь для хранения HTTP cookie.
   - `ImageType` представляет различные типы изображений.
   - `MediaListType` представляет список кортежей, содержащих изображения и их имена.

3. **Экспорт объектов**:
   - Определяет список `__all__`, содержащий имена всех объектов, которые должны быть экспортированы из модуля.

## Flowchart

```
[Начало] --> [Импорт модулей]
[Импорт модулей] --> [Определение Image (если PIL отсутствует)]
[Определение Image (если PIL отсутствует)] --> [Определение TypedDict]
[Определение TypedDict] --> [Определение SHA256]
[Определение SHA256] --> [Определение CreateResult]
[Определение CreateResult] --> [Определение AsyncResult]
[Определение AsyncResult] --> [Определение Messages]
[Определение Messages] --> [Определение Cookies]
[Определение Cookies] --> [Определение ImageType]
[Определение ImageType] --> [Определение MediaListType]
[Определение MediaListType] --> [Определение __all__]
[Определение __all__] --> [Конец]
```
## Примеры

Пример использования определенных типов:

```python
from typing import Optional

def process_image(image: ImageType, description: Optional[str] = None) -> None:
    """
    Функция для обработки изображений.

    Args:
        image: Изображение в формате ImageType.
        description: Описание изображения (опционально).

    Returns:
        None
    """
    print(f"Обработка изображения: {image}, описание: {description}")

# Пример вызова
process_image("path/to/image.jpg", "Пример изображения")
```
```python
from typing import List, Dict, Union

def process_messages(messages: Messages) -> None:
    """
    Функция для обработки сообщений.

    Args:
        messages: Список сообщений в формате Messages.

    Returns:
        None
    """
    for message in messages:
        print(f"Обработка сообщения: {message}")

# Пример вызова
example_messages: Messages = [{"role": "user", "content": "Hello!"}]
process_messages(example_messages)