Как использовать функцию get_short_affiliate_link
========================================================================================

Описание
-------------------------
Функция `get_short_affiliate_link` предназначена для получения короткой ссылки из длинной ссылки, используя веб-браузер. Она взаимодействует с веб-сайтом, где происходит укорачивание ссылок, заполняет поле URL, нажимает кнопку генерации и возвращает полученную короткую ссылку. Функция также обрабатывает возможные ошибки, такие как отсутствие короткой ссылки или некорректный URL, и логирует их.

Шаги выполнения
-------------------------
1. **Загрузка локаторов:** Функция загружает данные локаторов из файла `affiliate_links_shortener.json` с помощью `j_loads_ns`. Локаторы определяют элементы на веб-странице, например, поле для ввода ссылки, кнопку генерации, поле с короткой ссылкой.

2. **Ввод URL:** Передает длинную ссылку (`url`) в поле ввода (`textarea_target_url`) на веб-странице.

3. **Нажатие кнопки:** Нажимает кнопку для получения короткой ссылки (`button_get_tracking_link`).

4. **Ожидание обновления:** Функция ожидает 1 секунду, чтобы страница успела обновиться и сгенерировать короткую ссылку.

5. **Получение короткой ссылки:** Извлекает короткую ссылку из соответствующего элемента на странице (`textarea_short_link`).

6. **Сохранение идентификатора основной вкладки:** Сохраняет текущий идентификатор основной вкладки, чтобы после открытия новой вкладки с короткой ссылкой вернуться к основной.

7. **Проверка короткой ссылки:** Проверяет, не пустая ли полученная короткая ссылка. Если она пустая, логирует ошибку и не возвращает значение.

8. **Открытие новой вкладки:** Открывает новую вкладку браузера с короткой ссылкой.

9. **Переключение на новую вкладку:** Переключается на новую вкладку браузера.

10. **Проверка корректности короткой ссылки:** Проверяет, что короткая ссылка начинается с ожидаемой части ('https://error.taobao.com'). Если ссылка некорректна, то логирует ошибку, закрывает вкладку с некорректной ссылкой и возвращается к основной вкладке.

11. **Закрытие новой вкладки и возврат к основной:** Закрывает новую вкладку и возвращается к основной вкладке.

12. **Возврат короткой ссылки:** Возвращает полученную короткую ссылку.


Пример использования
-------------------------
.. code-block:: python

    from src.webdriver import Driver
    from pathlib import Path
    # ... (импорты из файла) ...
    
    driver = Driver() # Создайте экземпляр класса Driver
    short_link = get_short_affiliate_link(driver, 'https://example.com/longurl')
    print(f"Короткий URL: {short_link}")

    # Не забудьте закрыть драйвер после использования:
    driver.quit()