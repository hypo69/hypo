# Анализ кода модуля `bull.py`

**Качество кода**
9
-  Плюсы
    - Код хорошо структурирован и логически понятен.
    - Используются функции для разделения логики (генерация числа, подсчет быков и коров).
    - Присутствует проверка корректности ввода пользователя.
    - Код игры соответствует описанию в начале модуля.
    - Есть подробное описание модуля, правил игры, алгоритма, блок-схемы и объяснения кода в комментариях.
-  Минусы
    - Отсутствует обработка возможных ошибок, кроме проверки ввода на корректность.
    - Не используются константы для магических чисел (например, 4 для длины числа).
    - Не используется логирование ошибок.
    - Комментарии не соответствуют стандарту reStructuredText (RST).
    - Не хватает описания типов для параметров функций.
    - Нет описания возвращаемого значения для функции `generate_target_number()` в docstring.
    - Нет подробных комментариев о блоках кода

**Рекомендации по улучшению**

1.  **Импорты:** Добавить импорт `logger` из `src.logger.logger`.
2.  **Константы:** Определить константу для длины числа (например, `NUMBER_LENGTH = 4`).
3.  **Обработка ошибок:** Использовать `try-except` блоки с `logger.error` для обработки ошибок в функциях.
4.  **Форматирование docstring:** Переписать все комментарии в формате reStructuredText (RST), включая описания функций, параметров и возвращаемых значений.
5.  **Комментарии:** Добавить более подробные комментарии для каждого блока кода.
6.  **Типизация:** Добавить аннотации типов к параметрам и возвращаемым значениям функций.
7.  **Логирование:** Добавить логирование ошибок и отладочную информацию.

**Оптимизированный код**

```python
"""
Модуль для игры "Быки и коровы"
=========================================================================================

Этот модуль реализует игру "Быки и коровы", в которой компьютер генерирует
случайное четырехзначное число с разными цифрами, а игрок пытается его угадать.

Правила игры:
1. Компьютер генерирует случайное четырехзначное число, все цифры которого различны.
2. Игрок делает попытки угадать число, вводя свои четырехзначные числа.
3. После каждой попытки компьютер выводит количество "быков" и "коров".
    - "Бык" - это цифра, которая угадана и находится на правильной позиции.
    - "Корова" - это цифра, которая угадана, но находится на неправильной позиции.
4. Игра продолжается до тех пор, пока игрок не угадает число (т.е. получит 4 "быка").

Пример использования
--------------------

Пример запуска игры:

.. code-block:: python

    python bull.py
"""
import random
# Импортируем logger для логирования ошибок
from src.logger.logger import logger


# Задаем константу для длины числа
NUMBER_LENGTH = 4

def generate_target_number() -> str:
    """
    Генерирует случайное четырехзначное число с уникальными цифрами.

    :return: Строка, представляющая четырехзначное число с уникальными цифрами.
    :rtype: str
    """
    try:
        # Код создает список цифр от 0 до 9
        digits = list(range(10))
        # Код перемешивает список цифр в случайном порядке
        random.shuffle(digits)
        # Код проверяет, является ли первая цифра 0
        while digits[0] == 0:
            # Если первая цифра 0, код перемешивает цифры еще раз
            random.shuffle(digits)
        # Код возвращает первые 4 цифры в виде строки
        return "".join(map(str, digits[:NUMBER_LENGTH]))
    except Exception as ex:
        # Логируем ошибку и возвращаем пустую строку
        logger.error(f'Ошибка при генерации числа: {ex}')
        return ""

def get_bulls_and_cows(user_guess: str, target_number: str) -> tuple[int, int]:
    """
    Считает количество "быков" и "коров" в введенном числе.

    :param user_guess: Число, введенное пользователем.
    :type user_guess: str
    :param target_number: Загаданное число.
    :type target_number: str
    :return: Кортеж, содержащий количество "быков" и "коров".
    :rtype: tuple[int, int]
    """
    try:
        # Код инициализирует счетчики быков и коров нулями
        bulls = 0
        cows = 0
        # Код перебирает цифры в введенном числе с их индексами
        for i, digit in enumerate(user_guess):
            # Код проверяет, совпадает ли цифра на той же позиции в загаданном числе
            if digit == target_number[i]:
                # Если цифры совпадают, увеличиваем счетчик быков
                bulls += 1
            # Код проверяет, присутствует ли цифра в загаданном числе на другой позиции
            elif digit in target_number:
                # Если цифра присутствует, увеличиваем счетчик коров
                cows += 1
        # Код возвращает количество быков и коров
        return bulls, cows
    except Exception as ex:
        # Логируем ошибку и возвращаем кортеж с нулями
        logger.error(f'Ошибка при подсчете быков и коров: {ex}')
        return 0, 0


# Код генерирует загаданное число
target_number = generate_target_number()

# Код запускает основной игровой цикл
while True:
    # Код запрашивает у пользователя ввод числа
    user_guess = input("Введите четырехзначное число: ")

    # Код проверяет, является ли ввод корректным (состоит из 4 цифр)
    if not user_guess.isdigit() or len(user_guess) != NUMBER_LENGTH:
        # Если ввод некорректный, код выводит сообщение об ошибке и начинает новый виток цикла
        print("Пожалуйста, введите корректное четырехзначное число.")
        continue

    # Код подсчитывает количество быков и коров
    bulls, cows = get_bulls_and_cows(user_guess, target_number)
    # Код выводит количество быков и коров
    print(f"{bulls} быков, {cows} коров")

    # Код проверяет, равно ли количество быков 4
    if bulls == NUMBER_LENGTH:
        # Если да, код выводит сообщение о победе и завершает цикл
        print("Поздравляю, вы угадали число!")
        break
```