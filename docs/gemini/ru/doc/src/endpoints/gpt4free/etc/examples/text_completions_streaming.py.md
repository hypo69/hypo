# Модуль для демонстрации потоковой передачи текста с использованием g4f

## Обзор

Модуль `text_completions_streaming.py` демонстрирует, как использовать потоковую передачу текста (streaming) с помощью библиотеки `g4f` для синхронного и асинхронного взаимодействия с моделью `gpt-4`. Он показывает, как отправлять запросы к модели и получать ответы в режиме реального времени, что позволяет более эффективно обрабатывать большие объемы текста.

## Подробней

Этот модуль предоставляет два основных способа использования потоковой передачи текста: синхронный и асинхронный. Синхронный метод (`sync_stream`) подходит для простых задач, где не требуется параллельное выполнение. Асинхронный метод (`async_stream`) позволяет более эффективно использовать ресурсы, особенно в приложениях, требующих высокой производительности и параллельной обработки данных.

## Функции

### `sync_stream`

```python
def sync_stream():
    """
    Функция для демонстрации синхронной потоковой передачи текста с использованием g4f.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Если возникает ошибка при взаимодействии с моделью.
    """
```

**Как работает функция**:

1.  **Инициализация клиента**: Создается экземпляр класса `Client` из библиотеки `g4f`.
2.  **Создание потока**: Вызывается метод `chat.completions.create` для создания потока данных с моделью `"gpt-4"`. В запросе передается вопрос `question` для получения ответа.
3.  **Обработка чанков**: В цикле перебираются чанки данных, полученные из потока. Каждый чанк содержит часть ответа модели.
4.  **Вывод чанков**: Из каждого чанка извлекается содержимое (`chunk.choices[0].delta.content`) и выводится на экран.

```
    Инициализация клиента
    │
    Создание потока → Отправка запроса к модели
    │
    Обработка чанков
    │
    Вывод чанков
```

### `async_stream`

```python
async def async_stream():
    """
    Асинхронная функция для демонстрации потоковой передачи текста с использованием g4f.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Если возникает ошибка при взаимодействии с моделью.
    """
```

**Как работает функция**:

1.  **Инициализация асинхронного клиента**: Создается экземпляр класса `AsyncClient` из библиотеки `g4f`.
2.  **Создание асинхронного потока**: Вызывается метод `chat.completions.create` для создания асинхронного потока данных с моделью `"gpt-4"`. В запросе передается вопрос `question` для получения ответа.
3.  **Асинхронная обработка чанков**: Асинхронно перебираются чанки данных, полученные из потока.
4.  **Вывод чанков**: Из каждого чанка извлекается содержимое (`chunk.choices[0].delta.content`) и выводится на экран.

```
    Инициализация асинхронного клиента
    │
    Создание асинхронного потока → Отправка запроса к модели
    │
    Асинхронная обработка чанков
    │
    Вывод чанков
```

### `main`

```python
def main():
    """
    Главная функция для запуска синхронного и асинхронного потоков.

    Args:
        None

    Returns:
        None
    """
```

**Как работает функция**:

1.  **Вывод заголовка**: Выводится заголовок `"Synchronous Stream:"` для обозначения начала синхронного потока.
2.  **Запуск синхронного потока**: Вызывается функция `sync_stream()` для запуска синхронной потоковой передачи текста.
3.  **Вывод разделителя**: Выводится разделитель `"\\n\\nAsynchronous Stream:"` для отделения синхронного и асинхронного потоков.
4.  **Запуск асинхронного потока**: Используется `asyncio.run()` для запуска асинхронной функции `async_stream()`.

```
    Вывод заголовка (Synchronous Stream:)
    │
    Запуск синхронного потока
    │
    Вывод разделителя
    │
    Запуск асинхронного потока
```

**Примеры**:

```python
main()
```

### `__main__`

```python
if __name__ == "__main__":
    try:
        main()
    except Exception as e:
        print(f"An error occurred: {str(e)}")
```

**Как работает**:

1.  **Проверка условия**: Проверяется, является ли текущий модуль главным (`__name__ == "__main__"`).
2.  **Запуск главной функции**: Если условие выполняется, вызывается функция `main()`.
3.  **Обработка исключений**: Если во время выполнения `main()` возникает исключение, оно перехватывается, и выводится сообщение об ошибке.

```
    Проверка условия (if __name__ == "__main__":)
    │
    Запуск главной функции (main())
    │
    Обработка исключений
```