# ניתוח קוד מודול `basebl.py`

**איכות הקוד**

*   **ציון: 7/10**
*   **יתרונות:**
    *   הקוד פשוט וקל להבנה.
    *   המשחק פועל בצורה תקינה בהתאם לכללי המשחק.
    *   קיימת הפרדה בין פונקציות לוגיות (יצירת מספר, קבלת ניחוש, חישוב פידבק, ניהול המשחק).
    *   הקוד מגיב לקלט לא תקין מהמשתמש.
*   **חסרונות:**
    *   חסרה תיעוד מפורט בקוד עצמו (docstrings).
    *   אין שימוש בלוגר לרישום שגיאות או מידע נוסף.
    *   הקוד לא משתמש בפורמט RST לתיעוד.

**המלצות לשיפור**

1.  **הוספת Docstrings**: יש להוסיף docstrings לכל הפונקציות והמודולים בפורמט reStructuredText (RST).
2.  **שימוש בלוגר**: יש להשתמש בלוגר במקום `print` לרישום שגיאות ומידע נוסף.
3.  **טיפול בשגיאות**: יש להוסיף טיפול בשגיאות ואימות קלט נוסף במידת הצורך.
4.  **שיפור קריאות**: יש לשקול שימוש בשמות משתנים משמעותיים יותר (אך שמות המשתנים הנוכחיים מספקים).

**קוד משופר**
```python
"""
מודול למשחק בייסבול
=======================

המשחק "בייסבול" הוא משחק ניחושים בו המחשב בוחר רצף של ארבע ספרות ייחודיות,
והשחקן מנסה לנחש אותן. לאחר כל ניחוש, המחשב מגיב בכמה "בייס"
(ספרה נכונה במיקום נכון) וכמה "בול" (ספרה נכונה במיקום שגוי).
השחקן מנצח כאשר הוא מנחש את הרצף הנכון.

דוגמה לשימוש:
--------------
הפעל את המודול ופעל לפי ההוראות במסך כדי לשחק.
"""
import random
from src.logger.logger import logger
from src.utils.jjson import j_loads, j_loads_ns


def generate_target_number() -> list:
    """
    יוצר מספר בן 4 ספרות שונות באופן אקראי.

    :return: רשימה של 4 ספרות אקראיות וייחודיות.
    :rtype: list
    """
    # הקוד יוצר רשימה של ספרות מ-0 עד 9
    digits = list(range(10))
    # הקוד מערבב את רשימת הספרות
    random.shuffle(digits)
    # הקוד מחזיר את 4 הספרות הראשונות מהרשימה המעורבבת
    return digits[:4]


def get_user_guess() -> str:
    """
    קולט ניחוש מהמשתמש ומבטיח שהוא תקין (4 ספרות).

    :return: מחרוזת המייצגת את ניחוש המשתמש.
    :rtype: str
    """
    while True:
        # הקוד מבקש מהמשתמש להזין ניחוש
        guess = input("נסה לנחש מספר בן 4 ספרות שונות: ")
        # בדיקה שאורך הקלט 4 והוא מכיל ספרות בלבד
        if len(guess) == 4 and guess.isdigit():
           return guess
        else:
            # הקוד מציג הודעת שגיאה על קלט לא חוקי
            print("קלט לא חוקי, הזן מספר עם 4 ספרות.")
            logger.error(f"קלט משתמש לא חוקי: {guess}")



def calculate_feedback(target: list, guess: str) -> tuple:
    """
    מחזיר את מספר הבייס והבול בהשוואה בין הניחוש למספר המטרה.

    :param target: רשימה של 4 ספרות המייצגות את המספר המטרה.
    :type target: list
    :param guess: מחרוזת המייצגת את ניחוש המשתמש.
    :type guess: str
    :return: טאפל המכיל את מספר הבייס והבול.
    :rtype: tuple
    """
    # מספר הספרות הנכונות במיקום הנכון
    bases = 0
    # מספר הספרות הנכונות במיקום שגוי
    balls = 0
    # הקוד עובר על כל ספרה בניחוש המשתמש
    for i in range(4):
        # אם הספרה מהניחוש זהה לספרה במספר המטרה באותו מיקום, הגדל את מונה הבייס
        if guess[i] == str(target[i]):
           bases +=1
           # אם הספרה מהניחוש נמצאת במספר המטרה (אבל לא באותו מיקום), הגדל את מונה הבול
        elif int(guess[i]) in target:
           balls += 1
    # החזרת מספר הבייס והבול
    return bases, balls


def play_baseball():
    """
    פונקציית המשחק הראשית.
    """
    # אתחול מספר הניסיונות
    numberOfGuesses = 0
    # קבלת מספר רנדומלי
    targetNumber = generate_target_number()
    print("בוא נשחק בייסבול!")
    # הקוד מתחיל לולאה ראשית של המשחק
    while True:
        # הקוד מגדיל את מספר הניסיונות ב-1
        numberOfGuesses += 1
        # הקוד קורא את הניחוש של המשתמש
        userGuess = get_user_guess()
        # הקוד מחשב את כמות הבייס והבול
        bases, balls = calculate_feedback(targetNumber, userGuess)
        # הקוד מציג את תוצאת הפידבק למשתמש
        print(f"{bases} בייס, {balls} בול")
        # אם כמות הבייס שווה ל-4, השחקן ניצח
        if bases == 4:
            # הקוד מציג הודעת ניצחון
            print(f"מזל טוב! ניצחת ב-{numberOfGuesses} ניסיונות")
            # הקוד יוצא מהלולאה
            break

if __name__ == "__main__":
    play_baseball()
```