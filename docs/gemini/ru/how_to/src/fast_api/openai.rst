Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код представляет собой FastAPI приложение для взаимодействия с моделью OpenAI. Модуль содержит API-эндпоинты для запроса к модели и ее обучения на основе предоставленных данных.  Он также отвечает за отображение HTML-страницы (`index.html`) по корневому пути.  Он обрабатывает запросы к `/ask`, получая сообщение и (необязательные) системные инструкции, чтобы получить ответ от модели OpenAI.  Код включает в себя обработку ошибок и логгирование.


Шаги выполнения
-------------------------
1. **Импорт необходимых библиотек:** Код импортирует `FastAPI`, `HTTPException`, `BaseModel`, `StaticFiles`, `CORSMiddleware`, `HTMLResponse`, `Path` и другие библиотеки, необходимые для работы приложения.  Также импортируется класс `OpenAIModel` для взаимодействия с моделью OpenAI и класс логгирования `logger`.

2. **Настройка FastAPI приложения:**  Создается экземпляр `FastAPI` приложения.  Настраивается обработка статических файлов (HTML) из указанной директории.  Настраивается CORS (Cross-Origin Resource Sharing) для разрешения запросов с любых источников.

3. **Инициализация модели:** Создается экземпляр класса `OpenAIModel`, который, вероятно, содержит логику взаимодействия с API OpenAI.

4. **Определение модели запроса:** Определяется `AskRequest` - модель данных для запросов к эндпоинту `/ask`. Она содержит `message` (текст запроса) и `system_instruction` (необязательные инструкции).

5. **Определение эндпоинта `/`:** Эндпоинт `/` отвечает за отображение `index.html`. Код читает содержимое файла и возвращает его в виде HTML ответа. Включает обработку ошибок (используя `try...except`) и логгирование ошибок.

6. **Определение эндпоинта `/ask`:** Эндпоинт `/ask` обрабатывает POST-запросы, содержащие данные от пользователя (через `AskRequest`). Код получает данные, отправляет запрос к модели (`model.ask`) и возвращает результат. Также реализована обработка ошибок.

7. **Запуск приложения:** Код запускает приложение с помощью `uvicorn`.


Пример использования
-------------------------
.. code-block:: python

    # Пример запроса к эндпоинту /ask
    import requests
    import json

    url = "http://127.0.0.1:8000/ask"
    payload = {
        "message": "Привет, расскажи что-нибудь о Москве.",
        "system_instruction": "Будь краток."  # Необязательно
    }
    headers = {
        "Content-Type": "application/json"
    }

    response = requests.post(url, headers=headers, json=payload)

    if response.status_code == 200:
        data = response.json()
        print(data['response'])  # Выводит ответ модели
    else:
        print(f"Ошибка: {response.status_code} - {response.text}")