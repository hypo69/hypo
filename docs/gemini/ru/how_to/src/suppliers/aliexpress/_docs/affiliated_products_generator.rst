Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код предоставляет класс `AliAffiliatedProducts`, который собирает полные данные о продуктах с сайта AliExpress через API для аффилированного маркетинга. Он получает ссылки, сохраняет изображения и видео, и сохраняет JSON данные о продукте. Класс использует API `AliApi`, и предоставляет методы для обработки списка URL или ID продуктов.

Шаги выполнения
-------------------------
1. **Импортирование библиотек:** Код импортирует необходимые библиотеки, включая `asyncio`, `pathlib`, `urllib.parse`, `requests`, и пользовательские модули для работы с файлами, логированием и API AliExpress.

2. **Определение класса `AliAffiliatedProducts`:** Класс наследуется от `AliApi`, расширяя его функциональность для работы с аффилированными продуктами.

3. **Инициализация класса:**  При создании экземпляра класса, необходимо передать имя кампании, категорию (необязательно), язык и валюту.  Это используется для определения папок, куда будут сохраняться изображения, видео и JSON данные.

4. **Обработка списка продуктов (`process_affiliate_products`):** Метод `process_affiliate_products` принимает список URL или ID продуктов.
    -  Для каждого продукта:
        - Получает аффилированную ссылку с помощью `get_affiliate_links`.
        - Проверяет, существует ли аффилированная ссылка. Если нет, выводит предупреждение и пропускает продукт.
        - Извлекает необходимые данные о продукте (используя `retrieve_product_details`).
        - Сохраняет изображение и видео продукта в соответствующие директории, используя `save_png_from_url` и `save_video_from_url`.
        - Сохраняет JSON данные продукта в файл, используя `j_dumps`.
        - Добавляет путь к сохранённому изображению и видео в атрибуты объекта.
        - Логирует процесс и успехи.


5. **Обработка ошибок:**  Код содержит обработку ошибок (например, `exc_info=False`) при сохранении файлов, а также логирование предупреждений и ошибок для отслеживания проблем.

6. **Удаление продуктов без аффилированных ссылок (delete_product):** Метод `delete_product` удаляет продукты, для которых не были найдены аффилированные ссылки.  Он работает с текстовыми файлами, хранящими список продуктов и удаляет из него соответствующую запись.

Пример использования
-------------------------
.. code-block:: python

    from src.suppliers.aliexpress import AliAffiliatedProducts
    from pathlib import Path

    # Список URL или ID продуктов
    prod_urls = [
        "https://www.aliexpress.com/item/1234567890.html",
        "https://www.aliexpress.com/item/9876543210.html"
    ]

    # Инициализация класса
    parser = AliAffiliatedProducts(
        campaign_name="MyCampaign",
        campaign_category="Electronics",
        language="EN",
        currency="USD"
    )

    # Обработка продуктов
    products = parser.process_affiliate_products(prod_urls)

    # Обработка полученных результатов (products)
    for product in products:
        print(f"Product ID: {product.product_id}, Affiliate Link: {product.promotion_link}")