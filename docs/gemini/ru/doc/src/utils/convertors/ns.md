# Модуль hypotez/src/utils/convertors/ns.py

## Обзор

Модуль `ns.py` предоставляет функции для преобразования объектов `SimpleNamespace` в различные форматы: `dict`, `JSON`, `CSV`, `XML` и `XLS`.  Он обрабатывает вложенные структуры данных, обеспечивая конвертацию данных в различных представлениях.

## Функции

### `ns2dict`

**Описание**: Функция `ns2dict` рекурсивно преобразует объект `SimpleNamespace` в словарь Python.  Функция обрабатывает вложенные структуры, такие как списки и словари, внутри объекта.

**Параметры**:

- `ns_obj` (SimpleNamespace): Объект `SimpleNamespace`, который необходимо преобразовать.

**Возвращает**:

- `Dict[str, Any]`: Преобразованный словарь, содержащий значения из объекта `SimpleNamespace`.

### `ns2json`

**Описание**: Функция `ns2json` преобразует объект `SimpleNamespace` в формат JSON.

**Параметры**:

- `ns_obj` (SimpleNamespace): Объект `SimpleNamespace`, который необходимо преобразовать.

**Возвращает**:

- `str`: Строковое представление объекта в формате JSON.


### `ns2csv`

**Описание**: Функция `ns2csv` преобразует объект `SimpleNamespace` в формат CSV и сохраняет данные в указанный файл.

**Параметры**:

- `ns_obj` (SimpleNamespace): Объект `SimpleNamespace`, который необходимо преобразовать.
- `csv_file_path` (str | Path): Путь к файлу, куда необходимо сохранить данные в формате CSV.


**Возвращает**:

- `bool`: `True`, если преобразование и сохранение успешны, `False` в противном случае.

**Возможные исключения**:

- Любые исключения, возникающие при работе с файловой системой или сохранении данных в CSV.


### `ns2xml`

**Описание**: Функция `ns2xml` преобразует объект `SimpleNamespace` в формат XML.

**Параметры**:

- `ns_obj` (SimpleNamespace): Объект `SimpleNamespace`, который необходимо преобразовать.
- `root_tag` (str, optional): Тег корневого элемента XML. По умолчанию "root".


**Возвращает**:

- `str`: Строковое представление объекта в формате XML.


**Возможные исключения**:

- Любые исключения, возникающие при работе с функцией `xml2dict` или преобразовании данных.


### `ns2xls`

**Описание**: Функция `ns2xls` преобразует объект `SimpleNamespace` в формат XLS и сохраняет данные в указанный файл.


**Параметры**:

- `data` (SimpleNamespace): Объект `SimpleNamespace` с данными.
- `xls_file_path` (str | Path): Путь к файлу, куда необходимо сохранить данные в формате XLS.


**Возвращает**:

- `bool`: `True`, если преобразование и сохранение успешны, `False` в противном случае.

**Возможные исключения**:

- Любые исключения, возникающие при работе с файловой системой или сохранении данных в XLS.


##  Вспомогательные функции (внутренние)

### `convert`

**Описание**: Вспомогательная рекурсивная функция для обработки вложенных структур данных при преобразовании `SimpleNamespace` в `dict`.

**Параметры**:

- `value` (Any): Значение для обработки.


**Возвращает**:

- `Any`: Преобразованное значение.


**Примечание**: Данная функция используется внутри функции `ns2dict`.