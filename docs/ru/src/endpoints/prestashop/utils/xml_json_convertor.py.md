# Модуль для конвертации XML и JSON

## Обзор

Модуль `xml_json_convertor.py` предоставляет утилиты для конвертации данных между форматами XML и JSON. Он включает функции для парсинга XML-строк и преобразования деревьев элементов XML в словарные представления, а также функции для обратного преобразования JSON в XML.

## Подробней

Этот модуль облегчает взаимодействие с данными в формате XML, позволяя преобразовывать их в удобные для обработки структуры данных Python (словари) и обратно. Модуль содержит функции для преобразования как простых, так и сложных XML-структур, включая атрибуты и вложенные элементы. В проекте `hypotez` этот модуль может использоваться для обработки данных, получаемых от внешних источников в формате XML, например, от API PrestaShop.

## Функции

### `dict2xml`

```python
def dict2xml(json_obj: dict, root_name: str = "product") -> str:
    """
    Args:
        json_obj (dict): JSON словарь для конвертации.
        root_name (str, optional): Имя корневого элемента. По умолчанию "product".

    Returns:
        str: XML строка, представляющая JSON.

    """
```

**Описание**: Преобразует JSON-словарь в XML-строку.

**Как работает функция**: Функция `dict2xml` принимает JSON-словарь и преобразует его в XML-строку. Она рекурсивно строит XML-элементы на основе структуры JSON, обрабатывая атрибуты и текстовые значения.

**Параметры**:
- `json_obj` (dict): JSON-словарь, который необходимо преобразовать в XML.
- `root_name` (str, optional): Имя корневого элемента XML. По умолчанию используется "product".

**Возвращает**:
- `str`: XML-строка, представляющая переданный JSON-словарь.

**Примеры**:

```python
json_data = {"product": {"name": "Test Product", "price": "10.00"}}
xml_output = dict2xml(json_data)
print(xml_output)
```

### `_parse_node`

```python
def _parse_node(node: ET.Element) -> dict | str:
    """
    Args:
        node (ET.Element): XML элемент для парсинга.

    Returns:
        dict | str: Словарь, представляющий XML узел, или строка, если узел не имеет атрибутов или дочерних элементов.

    """
```

**Описание**: Преобразует XML-узел в словарь.

**Как работает функция**: Функция `_parse_node` рекурсивно преобразует XML-узел в словарь. Она обрабатывает атрибуты узла, текстовые значения и дочерние элементы, создавая словарь, представляющий структуру XML. Если узел не имеет атрибутов и дочерних элементов, возвращается только текстовое значение узла.

**Параметры**:
- `node` (ET.Element): XML-элемент, который необходимо преобразовать в словарь.

**Возвращает**:
- `dict | str`: Словарь, представляющий XML-узел, или строка, если узел не имеет атрибутов или дочерних элементов.

### `_make_dict`

```python
def _make_dict(tag: str, value: any) -> dict:
    """
    Args:
        tag (str): Имя тега XML элемента.
        value (any): Значение, связанное с тегом.

    Returns:
        dict: Словарь с именем тега в качестве ключа и значением в качестве значения словаря.

    """
```

**Описание**: Создает новый словарь с тегом и значением.

**Как работает функция**: Функция `_make_dict` создает словарь, где ключом является имя тега XML-элемента, а значением - значение, связанное с этим тегом.

**Параметры**:
- `tag` (str): Имя тега XML-элемента.
- `value` (any): Значение, связанное с тегом.

**Возвращает**:
- `dict`: Словарь с именем тега в качестве ключа и значением в качестве значения словаря.

### `xml2dict`

```python
def xml2dict(xml: str) -> dict:
    """
    Args:
        xml (str): XML строка для парсинга.

    Returns:
        dict: Словарь, представляющий XML.

    """
```

**Описание**: Преобразует XML-строку в словарь.

**Как работает функция**: Функция `xml2dict` принимает XML-строку, преобразует ее в дерево элементов с помощью `ET.fromstring()`, а затем вызывает функцию `ET2dict()` для преобразования дерева элементов в словарь.

**Параметры**:
- `xml` (str): XML-строка, которую необходимо преобразовать в словарь.

**Возвращает**:
- `dict`: Словарь, представляющий переданную XML-строку.

### `ET2dict`

```python
def ET2dict(element_tree: ET.Element) -> dict:
    """
    Args:
        element_tree (ET.Element): Дерево XML элементов.

    Returns:
        dict: Словарь, представляющий дерево XML элементов.

    """
```

**Описание**: Преобразует дерево элементов XML в словарь.

**Как работает функция**: Функция `ET2dict` принимает дерево элементов XML и преобразует его в словарь, используя функцию `_make_dict()` для создания структуры словаря.

**Параметры**:
- `element_tree` (ET.Element): Дерево XML-элементов, которое необходимо преобразовать в словарь.

**Возвращает**:
- `dict`: Словарь, представляющий переданное дерево XML-элементов.

### `presta_fields_to_xml`

```python
def presta_fields_to_xml(presta_fields_dict: dict) -> str:
    """
    Args:
        presta_fields_dict (dict): JSON словарь, содержащий данные (без ключа 'prestashop').

    Returns:
        str: XML строка, представляющая JSON.

    """
```

**Описание**: Преобразует JSON-словарь в XML-строку с фиксированным корневым элементом 'prestashop'.

**Как работает функция**: Функция `presta_fields_to_xml` принимает JSON-словарь, оборачивает его в корневой элемент "prestashop" и преобразует в XML-строку. Она используется для подготовки данных в формате, требуемом API PrestaShop. Функция обрабатывает атрибуты и текстовые значения, а также поддерживает вложенные структуры данных.

**Параметры**:
- `presta_fields_dict` (dict): JSON-словарь, содержащий данные для преобразования в XML (без корневого элемента "prestashop").

**Возвращает**:
- `str`: XML-строка, представляющая переданный JSON-словарь с корневым элементом "prestashop".