## <алгоритм>

**1. `plot_age_distribution(agents, title, show)`:**

   - **Вход:** Список агентов (`agents` типа `List[TinyPerson]`), заголовок графика (`title` типа `str`, по умолчанию "Age Distribution"), флаг показа графика (`show` типа `bool`, по умолчанию `True`).
   - **Извлечение возраста:** Проходится по списку агентов и извлекает их возраст (`agent.get("age")`) создавая список `ages`.
   - **Создание DataFrame:** Из списка возрастов `ages` создается Pandas DataFrame `df` с колонкой "Age".
   - **Построение гистограммы:** Вызывает `df["Age"].plot.hist(bins=20, title=title)` для построения гистограммы распределения возрастов. Гистограмма разбивает данные на 20 интервалов.
   - **Отображение графика:** Если `show` равно `True`, отображает график с помощью `plt.show()`.
   - **Возврат DataFrame:** Возвращает DataFrame `df` с данными, использованными для графика.

   **Пример:**
   ```python
   agents = [TinyPerson({"age": 20}), TinyPerson({"age": 30}), TinyPerson({"age": 20}), TinyPerson({"age": 40})]
   df = plot_age_distribution(agents, title="Age Distribution of Sample Agents")
   ```
   В этом примере будет создан гистограмма распределения возрастов, и возвращен DataFrame с колонкой "Age" и значениями [20, 30, 20, 40].

**2. `plot_interest_distribution(agents, title, show)`:**

   - **Вход:** Список агентов (`agents` типа `List[TinyPerson]`), заголовок графика (`title` типа `str`, по умолчанию "Interest Distribution"), флаг показа графика (`show` типа `bool`, по умолчанию `True`).
   - **Извлечение интересов:** Проходится по списку агентов и извлекает их интересы (`agent.get("interests")`) создавая список `interests`.
   - **Создание DataFrame:** Из списка интересов `interests` создается Pandas DataFrame `df` с колонкой "Interests".
   - **Построение круговой диаграммы:** Вызывает `df["Interests"].value_counts().plot.pie(title=title)` для построения круговой диаграммы распределения интересов. Функция `value_counts()` подсчитывает количество каждого уникального значения интересов.
   - **Отображение графика:** Если `show` равно `True`, отображает график с помощью `plt.show()`.
   - **Возврат DataFrame:** Возвращает DataFrame `df` с данными, использованными для графика.

    **Пример:**
    ```python
    agents = [TinyPerson({"interests": "music"}), TinyPerson({"interests": "sport"}), TinyPerson({"interests": "music"})]
    df = plot_interest_distribution(agents, title="Interest Distribution of Sample Agents")
    ```
    В этом примере будет построена круговая диаграмма распределения интересов, и возвращен DataFrame с колонкой "Interests" и значениями ["music", "sport", "music"].

## <mermaid>

```mermaid
graph LR
    A[Начало] --> B(plot_age_distribution);
    B --> C{Извлечь возрасты из агентов};
    C --> D[Создать DataFrame с возрастом];
    D --> E{Построить гистограмму};
    E --> F{Показать график (если show=True)};
    F --> G[Вернуть DataFrame];
    G --> H[Конец];

    I[Начало] --> J(plot_interest_distribution);
    J --> K{Извлечь интересы из агентов};
    K --> L[Создать DataFrame с интересами];
    L --> M{Подсчитать и построить круговую диаграмму};
    M --> N{Показать график (если show=True)};
    N --> O[Вернуть DataFrame];
    O --> P[Конец];
    
    classDef process fill:#f9f,stroke:#333,stroke-width:2px
    classDef io fill:#ccf,stroke:#333,stroke-width:2px
    
    class B,J process;
    class C,K process;
    class D,L io;
    class E,M process;
    class F,N process;
    class G,O io;
    class A,H,I,P io;
    
```

**Описание диаграммы:**

- Диаграмма описывает два процесса: `plot_age_distribution` и `plot_interest_distribution`, представляющие собой функции для визуализации данных об агентах.
- Каждая функция начинается с узла **Начало** и заканчивается узлом **Конец**.
- **`plot_age_distribution`**:
  - Извлекает возрасты из списка агентов.
  - Создает Pandas DataFrame с колонкой "Age".
  - Строит гистограмму распределения возрастов.
  - При условии `show` равным True показывает гистограмму.
  - Возвращает DataFrame.
- **`plot_interest_distribution`**:
  - Извлекает интересы из списка агентов.
  - Создает Pandas DataFrame с колонкой "Interests".
  - Подсчитывает уникальные значения интересов и строит круговую диаграмму.
  - При условии `show` равным True показывает круговую диаграмму.
  - Возвращает DataFrame.
- Диаграмма визуализирует поток данных и последовательность операций в каждом методе.
- **Стили:**
   - `process`: выделены узлы, представляющие собой процессы или вычисления.
   - `io`: выделены узлы, представляющие начало/конец и операции ввода/вывода (DataFrame).

## <объяснение>

**Импорты:**

- `pandas as pd`:  Библиотека `pandas` используется для работы с данными, в частности, для создания и управления DataFrame. DataFrame — это структура данных, представляющая собой таблицу.
- `matplotlib.pyplot as plt`: Библиотека `matplotlib.pyplot` используется для создания графиков и визуализаций. В данном случае, для отображения гистограммы и круговой диаграммы.
- `typing.List`: Используется для аннотации типов, конкретно для указания, что `agents` - это список (`List`) объектов типа `TinyPerson`.
- `tinytroupe.agent.TinyPerson`: Импортирует класс `TinyPerson`, который, вероятно, представляет агента в системе. Он используется для извлечения информации (возраст и интересы) об агентах.

**Классы:**

- **`TinyPerson`**: Класс не определен в коде, но импортируется из `tinytroupe.agent`. Вероятно, этот класс имеет метод `get(key)`, который позволяет получить атрибут агента по ключу. В данном случае ключи это "age" и "interests".

**Функции:**

1. **`plot_age_distribution(agents: List[TinyPerson], title: str = "Age Distribution", show: bool = True)`**:
   - **Аргументы:**
      - `agents`: Список агентов типа `TinyPerson`.
      - `title`: Заголовок графика (по умолчанию "Age Distribution").
      - `show`: Флаг, определяющий, показывать ли график (по умолчанию `True`).
   - **Возвращаемое значение:** DataFrame с данными для графика.
   - **Назначение:** Строит гистограмму распределения возрастов агентов. Извлекает возрасты из каждого агента, создаёт DataFrame, строит гистограмму и возвращает DataFrame.
   - **Пример:** `plot_age_distribution([TinyPerson({"age": 25}), TinyPerson({"age": 30})])` - построит гистограмму распределения возрастов двух агентов и вернёт DataFrame с их возрастами.

2. **`plot_interest_distribution(agents: List[TinyPerson], title: str = "Interest Distribution", show: bool = True)`**:
   - **Аргументы:**
      - `agents`: Список агентов типа `TinyPerson`.
      - `title`: Заголовок графика (по умолчанию "Interest Distribution").
      - `show`: Флаг, определяющий, показывать ли график (по умолчанию `True`).
   - **Возвращаемое значение:** DataFrame с данными для графика.
   - **Назначение:** Строит круговую диаграмму распределения интересов агентов. Извлекает интересы каждого агента, создаёт DataFrame, строит круговую диаграмму и возвращает DataFrame.
   - **Пример:** `plot_interest_distribution([TinyPerson({"interests": "music"}), TinyPerson({"interests": "sport"})])` - построит круговую диаграмму распределения интересов двух агентов и вернёт DataFrame с их интересами.

**Переменные:**

- `agents`: Список объектов типа `TinyPerson`, переданный в функции.
- `ages`: Список возрастов агентов, полученных с помощью list comprehension.
- `interests`: Список интересов агентов, полученных с помощью list comprehension.
- `title`: Строка, содержащая заголовок графика.
- `show`: Булевая переменная, определяющая, следует ли отображать график.
- `df`: Pandas DataFrame, созданный из данных об агентах (возраста или интересов).

**Потенциальные ошибки и улучшения:**

- **Обработка отсутствующих данных:** В коде не предусмотрена обработка ситуации, когда у агента отсутствует информация о возрасте или интересах. Это может вызвать ошибку, если `agent.get("age")` или `agent.get("interests")` вернут `None`. Следует добавить проверку на `None` и обработать такие случаи.
- **Обработка пустых данных:** В случае пустого списка агентов, программа может завершится с ошибкой.
- **Более гибкое управление графиками:** Можно добавить возможность настройки параметров графиков, например, цветов, шрифтов, размера диаграммы и т. д.
- **Типы интересов:** Предполагается, что интересы представлены в виде строк. Хорошей практикой является приведение данных к более структурированному виду, например, используя перечисления, что упростит работу с данными.
- **Зависимости:** Код зависит от `pandas`, `matplotlib` и `tinytroupe.agent`. Эти зависимости должны быть установлены перед запуском кода.

**Взаимосвязь с другими частями проекта:**

- Код взаимодействует с модулем `tinytroupe.agent` для получения данных об агентах.
- Код может быть использован в других модулях для анализа характеристик популяции агентов. Например, в модуле моделирования или визуализации.
- Результаты работы функций могут быть использованы для анализа и принятия решений о популяции агентов.