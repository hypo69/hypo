```markdown
# unist-util-visit-parents

[![Build][build-badge]][build]
[![Coverage][coverage-badge]][coverage]
[![Downloads][downloads-badge]][downloads]
[![Size][size-badge]][size]
[![Sponsors][sponsors-badge]][collective]
[![Backers][backers-badge]][collective]
[![Chat][chat-badge]][chat]

A utility for traversing a [unist][unist-link] tree, visiting each node and its ancestors.

## Usage

This package provides the `visitParents` function for traversing a unist tree.  It's designed for situations where you need access to the entire path of parent nodes for each node you visit.

```javascript
import { visitParents } from 'unist-util-visit-parents';
import { fromMarkdown } from 'mdast-util-from-markdown';

const markdown = 'Some *emphasis*, **strong**, and `code`.';
const tree = fromMarkdown(markdown);

visitParents(tree, 'emphasis', (node, ancestors) => {
  console.log(node.type, ancestors.map(ancestor => ancestor.type));
});

// Output:
// emphasis [ 'root', 'paragraph' ]
```

This example demonstrates visiting emphasis nodes, printing their type and the types of their ancestors.  The `ancestors` array contains the nodes from the root to the current node.

## API

### `visitParents(tree[, test], visitor[, reverse])`

Visits nodes in the tree, optionally filtering by a test, and providing the stack of parent nodes.

*   **`tree`**: The unist tree to traverse.
*   **`test` (optional)**: A function or object that matches nodes to visit.  Uses the [unist-util-is][unist-util-is] API, so you can use either a function to check against or a simple string matching the node type, e.g. `"paragraph"` or `'strong'`.
*   **`visitor`**: A function that is called for each node matching the test.  This function receives the current node and an array of its ancestor nodes.
*   **`reverse` (optional, default: `false`)**: If `true`, traverses the tree in reverse preorder (NRL).

**Return Value**: `undefined`

**Important Considerations:**

* **Modifying the Tree:**  Modifying the tree during traversal (e.g., adding or removing nodes) may lead to unexpected results or errors. Exercise caution when doing such modifications. If necessary, you should ideally clone the tree and make the changes on the cloned copy.
* **Performance:** Tree traversal can be computationally intensive.  Use the `test` parameter carefully to avoid unnecessary visits.  Avoid multiple traversals of the same tree if possible.
* **Error Handling:** Consider error handling in your visitor function.


### Actions (`CONTINUE`, `EXIT`, `SKIP`)

The `visitor` function can return a special value to control the traversal:

*   **`CONTINUE` (default)**: Continue traversing the tree normally.
*   **`EXIT`**: Stop the traversal immediately.
*   **`SKIP`**: Skip visiting the children of the current node.

These special values are predefined constants in the module.


## Install

```bash
npm install unist-util-visit-parents
```

## Further Information

* [unist-util-visit]: https://github.com/syntax-tree/unist-util-visit for visiting nodes without ancestor information.
* [unist-util-is]: https://github.com/syntax-tree/unist-util-is for node type checks and matching.

[unist-link]: https://github.com/syntax-tree/unist
[unist-util-visit]: [link to unist-util-visit]
[unist-util-is]: [link to unist-util-is]
```