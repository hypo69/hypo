# Задача No 334
## Складывание монет

## Условия
Представим, что у нас есть стопка из $n$ монет, пронумерованных от $1$ до $n$, уложенных в некотором порядке.

Назовем операцию *сгибанием* следующую последовательность действий: мы берем верхнюю монету и переносим ее на нижнюю часть стопки. Затем мы берем вторую сверху монету и помещаем ее на дно стопки. Продолжаем до тех пор, пока не перенесем половину монет (округляя вниз, если количество монет нечетно) на нижнюю часть стопки. Так, если стопка состоит из 10 монет, мы переносим 5 верхних монет на дно, а если из 11 монет, то мы переносим 5 верхних монет на дно.

Теперь рассмотрим следующее.

Даны два массива монет $A$ и $B$, каждый из $n$ монет.

Мы можем выполнить *сгибание* на любой из стопок, $A$ или $B$.

Обозначим за $m(A,B)$ минимальное количество *сгибаний*, необходимое для того, чтобы массивы $A$ и $B$ стали идентичными. Например, если $A=\{1,2,3,4,5\}$ и $B=\{4,5,3,2,1\}$, то мы можем получить $A$ из $B$ всего за 2 *сгибания*:
 - первое сгибание для $B$ дает $B=\{3,2,1,4,5\}$;
 - второе сгибание для $B$ дает $B=\{1,4,5,3,2\}$;
 - после этого еще одно сгибание для $B$ дает $B=\{4,5,3,2,1\}$, поэтому чтобы получить $A$ из $B$, нужно еще одно сгибание.

Значит $m(A,B)=2$.

Пусть $P(n)$ – это количество всех возможных пар из $n$ массивов $A$ и $B$, таких что $m(A,B) = n$.

Например, $P(3) = 12$, и $P(5)=2520$.

Найдите $P(10^6)$ по модулю $10^8$.

