# Модуль для шифрования и дешифрования данных с использованием AES

## Обзор

Модуль предоставляет функции для шифрования и дешифрования данных с использованием алгоритма AES. Он включает в себя функции для добавления отступов к данным, шифрования данных с использованием ключа и соли, а также дешифрования данных с использованием ключа и соли.

## Подробней

Этот модуль используется для защиты конфиденциальной информации путем ее шифрования перед сохранением или передачей. Он использует библиотеку `Crypto.Cipher` для выполнения шифрования AES и `hashlib` для генерации ключей на основе предоставленного ключа и соли.

## Функции

### `pad`

```python
def pad(data: str) -> bytes:
    """
    Добавляет отступы к входным данным, чтобы длина данных была кратна 16 байтам.

    Args:
        data (str): Строка для добавления отступов.

    Returns:
        bytes: Байт-строка с добавленными отступами.

    Как работает функция:
    1. Преобразует входную строку `data` в байты.
    2. Вычисляет количество байтов, необходимых для дополнения, чтобы длина данных была кратна 16.
    3. Добавляет байты дополнения к данным, где значение каждого байта равно количеству байтов дополнения.
    
    ASCII flowchart:
    Входная строка -> Преобразование в байты -> Расчет отступов -> Добавление отступов -> Выходные байты
    
    Примеры:
    >>> pad("example")
    b'example\\t\\t\\t\\t\\t\\t\\t\\t\\t'
    """
    ...
```

### `encrypt`

```python
def encrypt(data, key):
    """
    Шифрует данные с использованием алгоритма AES.

    Args:
        data (str): Данные для шифрования.
        key (str): Ключ шифрования.

    Returns:
        str: JSON-строка, содержащая зашифрованные данные, вектор инициализации (IV) и соль.

    Как работает функция:
    1. Генерирует случайную соль длиной 8 символов.
    2. Вычисляет производный ключ и IV путем повторного хеширования ключа и соли с использованием MD5.
    3. Добавляет отступы к данным с использованием функции `pad`.
    4. Шифрует данные с использованием AES в режиме CBC с производным ключом и IV.
    5. Кодирует зашифрованные данные, IV и соль в base64 и hex соответственно.
    6. Возвращает JSON-строку, содержащую закодированные зашифрованные данные, IV и соль.
    
    ASCII flowchart:
    Входные данные и ключ -> Генерация соли -> Вычисление производного ключа и IV -> Добавление отступов -> Шифрование AES -> Кодирование в base64 и hex -> JSON-строка
    
    Примеры:
    >>> encrypt("example", "secret_key")
    '{"ct": "...", "iv": "...", "s": "..."}'
    """
    ...
```

### `unpad`

```python
def unpad(data: bytes) -> bytes:
    """
    Удаляет отступы из зашифрованных данных.

    Args:
        data (bytes): Байт-строка, из которой нужно удалить отступы.

    Returns:
        bytes: Байт-строка без отступов.

    Как работает функция:
    1. Извлекает значение отступа из последнего байта данных.
    2. Удаляет байты отступа из данных.

    ASCII flowchart:
    Входные байты -> Извлечение значения отступа -> Удаление отступов -> Выходные байты

    Примеры:
    >>> unpad(b'example\\t\\t\\t\\t\\t\\t\\t\\t\\t')
    b'example'
    """
    ...
```

### `decrypt`

```python
def decrypt(data: str, key: str):
    """
    Расшифровывает данные, зашифрованные с использованием алгоритма AES.

    Args:
        data (str): JSON-строка, содержащая зашифрованные данные, вектор инициализации (IV) и соль.
        key (str): Ключ шифрования.

    Returns:
        str: Расшифрованные данные.

    Как работает функция:
    1. Декодирует JSON-строку для получения зашифрованных данных, IV и соли.
    2. Вычисляет производный ключ на основе ключа и соли с использованием MD5.
    3. Дешифрует данные с использованием AES в режиме CBC с производным ключом и IV.
    4. Удаляет отступы из расшифрованных данных с использованием функции `unpad`.
    5. Декодирует расшифрованные данные из байтов в строку.

    ASCII flowchart:
    JSON-строка и ключ -> Декодирование base64 и hex -> Вычисление производного ключа -> Дешифрование AES -> Удаление отступов -> Декодирование в строку -> Выходные данные

    Примеры:
    >>> decrypt('{"ct": "...", "iv": "...", "s": "..."}', "secret_key")
    'example'
    """
    ...