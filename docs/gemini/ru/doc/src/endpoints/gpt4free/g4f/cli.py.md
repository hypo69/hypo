# Модуль для запуска gpt4free через CLI
## Обзор

Данный модуль предоставляет интерфейс командной строки (CLI) для запуска gpt4free в различных режимах, таких как API и GUI. Он использует библиотеку `argparse` для обработки аргументов командной строки и запуска соответствующих функций.

## Подробней

Этот модуль является отправной точкой для запуска приложения gpt4free. Он определяет аргументы командной строки для настройки API и GUI, а затем запускает приложение с указанными параметрами. Модуль использует другие модули из библиотеки `g4f` для фактической работы API и GUI.

## Функции

### `get_api_parser`

```python
def get_api_parser() -> ArgumentParser:
    """
    Создает парсер аргументов для API gpt4free.

    Args:
        None

    Returns:
        ArgumentParser: Парсер аргументов командной строки.

    Raises:
        None

    """
```

**Назначение**:
Функция `get_api_parser` создает и настраивает парсер аргументов командной строки для API gpt4free. Этот парсер определяет, какие аргументы командной строки можно использовать для настройки API, такие как адрес привязки, порт, режим отладки, модель, провайдер и другие параметры.

**Как работает функция**:

1.  Создается экземпляр `ArgumentParser` с описанием "Run the API and GUI".
2.  Добавляются аргументы, такие как `--bind`, `--port`, `--debug`, `--gui`, `--model`, `--provider`, `--image-provider`, `--proxy`, `--workers`, `--disable-colors`, `--ignore-cookie-files`, `--g4f-api-key`, `--ignored-providers`, `--cookie-browsers`, `--reload`, `--demo`, `--ssl-keyfile`, `--ssl-certfile`, `--log-config` с использованием метода `add_argument`. Для каждого аргумента указывается имя, значение по умолчанию, помощь и тип (если необходимо).
3.  Для аргументов `--provider` и `--image-provider` используется `choices` для ограничения допустимых значений именами провайдеров из `g4f.Provider.__providers__`.
4.  Для аргументов `--ignored-providers` и `--cookie-browsers` используется `nargs="+"` для разрешения указания нескольких значений.

**ASCII flowchart**:

```
Создание ArgumentParser
│
Добавление аргументов (bind, port, debug, ...)
│
Возврат ArgumentParser
```

**Примеры**:

*   Получение парсера аргументов API:

```python
parser = get_api_parser()
```

### `main`

```python
def main() -> None:
    """
    Точка входа для запуска gpt4free.

    Args:
        None

    Returns:
        None

    Raises:
        SystemExit: Если режим не распознан и не указан.

    """
```

**Назначение**:
Функция `main` является основной точкой входа для запуска gpt4free через командную строку. Она создает главный парсер аргументов, добавляет подпарсеры для режимов API и GUI, обрабатывает аргументы командной строки и запускает соответствующий режим.

**Как работает функция**:

1.  Создается главный парсер аргументов `argparse.ArgumentParser` с описанием "Run gpt4free".
2.  Создается подпарсер `subparsers` с помощью `parser.add_subparsers`, который определяет доступные режимы запуска (API и GUI).
3.  Добавляются подпарсеры "api" и "gui" с использованием `subparsers.add_parser`. Для каждого подпарсера указываются родители (парсеры аргументов для API и GUI) и `add_help=False` для предотвращения дублирования справки.
4.  Вызывается `parser.parse_args()` для обработки аргументов командной строки.
5.  В зависимости от значения `args.mode` вызывается соответствующая функция (`run_api_args` для API, `run_gui_args` для GUI) или выводится справка и завершается программа с кодом ошибки 1, если режим не распознан.

**ASCII flowchart**:

```
Создание главного парсера
│
Добавление подпарсеров (API, GUI)
│
Обработка аргументов командной строки
│
Вызов соответствующей функции (run_api_args, run_gui_args) или вывод справки
```

**Примеры**:

*   Запуск gpt4free с аргументами командной строки:

```python
main()
```

### `run_api_args`

```python
def run_api_args(args: argparse.Namespace) -> None:
    """
    Запускает API gpt4free с указанными аргументами.

    Args:
        args (argparse.Namespace): Аргументы командной строки.

    Returns:
        None

    Raises:
        None

    """
```

**Назначение**:
Функция `run_api_args` запускает API gpt4free с параметрами, переданными через аргументы командной строки. Она настраивает конфигурацию приложения и запускает API с указанными параметрами, такими как адрес привязки, порт, режим отладки, количество рабочих процессов и другие параметры.

**Как работает функция**:

1.  Импортируются классы `AppConfig` и функция `run_api` из модуля `g4f.api`.
2.  Вызывается `AppConfig.set_config` для настройки конфигурации приложения с использованием аргументов командной строки.
3.  Если указаны браузеры для получения cookie (`args.cookie_browsers`), то `g4f.cookies.browsers` обновляется списком соответствующих классов браузеров из `g4f.cookies`.
4.  Вызывается `run_api` с аргументами командной строки для запуска API.

**ASCII flowchart**:

```
Импорт AppConfig и run_api
│
Настройка AppConfig
│
Обновление g4f.cookies.browsers (если необходимо)
│
Запуск run_api
```

**Примеры**:

*   Запуск API gpt4free с аргументами командной строки:

```python
run_api_args(args)
```