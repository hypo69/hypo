# Модуль `try_xpath_functions.js`

## Обзор

Этот модуль предоставляет функции для выполнения XPath-запросов и работы с узлами DOM. Он позволяет оценивать XPath-выражения, выбирать элементы с помощью `querySelector` и `querySelectorAll`, а также обрабатывать различные типы результатов. Модуль также содержит функции для работы со свойствами элементов (получение текста, добавление/удаление классов, сохранение/восстановление атрибутов) и для работы со фреймами.


## Функции

### `execExpr`

**Описание**: Выполняет XPath-запрос или запрос `querySelector` или `querySelectorAll` на заданном контексте.

**Параметры**:

- `expr` (str): XPath-выражение или CSS-селектор.
- `method` (str): Метод для выполнения запроса ("evaluate", "querySelector", "querySelectorAll").
- `opts` (dict, optional): Опции для выполнения запроса:
    - `context` (Node, optional): Контекст для выполнения запроса (по умолчанию `document`).
    - `resolver` (function | str | dict, optional): Функция или строка JSON, которая используется для разрешения локальных переменных в XPath. При использовании строки JSON, она должна представлять собой словарь.
    - `resultType` (int, optional): Тип результата для запроса `evaluate`.  Если не указан, используется `xpathResult.ANY_TYPE`.
    - `document` (Document, optional): Документ, на котором нужно выполнить запрос.

**Возвращает**:

- `dict`: Словарь с результатами:
    - `items` (list): Список узлов, соответствующих запросу. Для числовых, строковых и логических результатов возвращается массив с одним элементом.
    - `method` (str): Метод, использованный для выполнения запроса.
    - `resultType` (int): Тип результата запроса (для `evaluate`).

**Вызывает исключения**:

- `Error`: Возникает при ошибках в контексте или неподходящих типах входных данных.  Подробное сообщение об ошибке включено.


### `resToArr`

**Описание**: Преобразует результат `evaluate` в массив.

**Параметры**:

- `res` (XPathResult): Результат XPath-выражения.
- `type` (int, optional): Тип результата. Если не указан, используется тип из `res`.

**Возвращает**:

- `list`: Массив узлов или значений результата.

**Вызывает исключения**:

- `Error`: Возникает, если тип результата `res` не поддерживается.


### `makeResolver`

**Описание**: Создает функцию-разрешитель для XPath.

**Параметры**:

- `obj` (function | str | dict, optional): Функция или строка JSON, которая используется для разрешения локальных переменных в XPath, или словарь.

**Возвращает**:

- `function`: Функция-разрешитель. Возвращает пустую строку, если переменная не найдена.

**Вызывает исключения**:

- `Error`: Возникает, если переданный `obj` имеет неверный тип или формат JSON.


### `isValidDict`

**Описание**: Проверяет, является ли переданный объект корректным словарем, содержащим только строковые значения.

**Параметры**:

- `obj`: Объект для проверки.

**Возвращает**:

- `bool`: `True`, если объект является корректным словарем, содержащим только строковые значения; `False` в противном случае.


### `objToMap`

**Описание**: Преобразует объект в `Map`.

**Параметры**:

- `obj`: Объект для преобразования.

**Возвращает**:

- `Map`: Объект `Map`.


### `isDocOrElem`

**Описание**: Проверяет, является ли объект элементом или документом.

**Параметры**:

- `obj`: Объект для проверки.

**Возвращает**:

- `bool`: `True`, если объект является элементом или документом; `False` в противном случае.


### `listToArr`

**Описание**: Преобразует список в массив.

**Параметры**:

- `list`: Список для преобразования.

**Возвращает**:

- `list`: Массив элементов.


### `getItemDetail`

**Описание**: Возвращает подробную информацию об элементе.

**Параметры**:

- `item`: Элемент для получения информации.

**Возвращает**:

- `dict`: Словарь с информацией об элементе.

**Вызывает исключения**:
- Не обрабатывает исключения, предполагает правильность входных данных.


### `getItemDetails`

**Описание**: Возвращает подробную информацию о списке элементов.

**Параметры**:

- `items`: Список элементов для получения информации.

**Возвращает**:

- `list`: Список словарей с информацией об элементах.


### `getNodeTypeStr`

**Описание**: Возвращает строковое представление типа узла.

**Параметры**:

- `nodeType`: Код типа узла.

**Возвращает**:

- `str`: Строковое представление типа узла.


### `getxpathResultStr`

**Описание**: Возвращает строковое представление кода типа результата XPath.

**Параметры**:

- `resultType`: Код типа результата XPath.

**Возвращает**:

- `str`: Строковое представление кода типа результата XPath.


### `getxpathResultNum`

**Описание**: Возвращает числовое представление кода типа результата XPath.

**Параметры**:

- `resultTypeStr`: Строковое представление кода типа результата XPath.

**Возвращает**:

- `number`: Числовое представление кода типа результата XPath.


### `isAttrItem`

**Описание**: Проверяет, является ли элемент атрибутом.

**Параметры**:

- `item`: Элемент для проверки.

**Возвращает**:

- `bool`: `True`, если элемент является атрибутом; `False` в противном случае.


### `isNodeItem`

**Описание**: Проверяет, является ли элемент узлом DOM.

**Параметры**:

- `item`: Элемент для проверки.

**Возвращает**:

- `bool`: `True`, если элемент является узлом DOM; `False` в противном случае.



... (и так далее для остальных функций)