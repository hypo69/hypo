# Документация модуля `whatsapp_sender.py`

## Обзор

Модуль `whatsapp_sender.py` предназначен для автоматической отправки сообщений в WhatsApp с использованием библиотеки `pywhatkit` и эмуляции нажатий клавиш с помощью `pyautogui` и `pynput`. Он включает функцию для отправки одиночного сообщения и основной цикл, который позволяет отправлять несколько сообщений в заданном временном диапазоне.

## Подробней

Модуль предоставляет возможность автоматизировать отправку сообщений в WhatsApp, выбирая случайное время отправки и случайное сообщение из заданного списка. Это может быть полезно для автоматических уведомлений или рассылок.

## Функции

### `send_whatsapp_message`

```python
def send_whatsapp_message(phone_number, message, hour, minutes):
    """Sends a WhatsApp message using pywhatkit and pyautogui."""
```

**Назначение**: Отправляет сообщение в WhatsApp с использованием библиотеки `pywhatkit` и эмуляции нажатия клавиши Enter через `pyautogui` и `pynput`.

**Параметры**:
- `phone_number` (str): Номер телефона получателя в международном формате.
- `message` (str): Текст сообщения для отправки.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минута отправки сообщения (0-59).

**Возвращает**:
- `None`

**Вызывает исключения**:
- `Exception`: Если происходит ошибка при отправке сообщения.

**Как работает функция**:
1. **Инициализация**: Функция принимает номер телефона, сообщение, час и минуты для отправки.
2. **Отправка сообщения**: Использует `pywhatkit.sendwhatmsg` для отправки сообщения в указанное время. Устанавливает время ожидания загрузки страницы WhatsApp Web в 25 секунд и закрывает вкладку после отправки.
3. **Ожидание и эмуляция нажатия Enter**: Ждет 20 секунд, чтобы страница WhatsApp Web успела загрузиться, затем эмулирует нажатие клавиши Enter для отправки сообщения.
4. **Обработка ошибок**: Если возникает исключение во время отправки, выводит сообщение об ошибке.

**ASCII flowchart**:

```
Начало
  ↓
Инициализация параметров (phone_number, message, hour, minutes)
  ↓
Отправка сообщения через pywhatkit.sendwhatmsg
  ↓
Ожидание загрузки WhatsApp Web (20 секунд)
  ↓
Эмуляция нажатия Enter
  ↓
Сообщение успешно отправлено
  ↓
Конец
```

**Примеры**:

```python
send_whatsapp_message("+1234567890", "Hello, how are you?", 10, 30)
send_whatsapp_message("+9876543210", "Meeting reminder", 14, 00)
```

## Переменные

- `messages` (List[str]): Список сообщений, из которых случайным образом выбирается сообщение для отправки. Сообщения содержат эмодзи.
- `phone_number` (str): Номер телефона получателя, вводится пользователем.
- `num_messages` (int): Количество сообщений для отправки, вводится пользователем.
- `start_hour` (int): Начальный час временного диапазона для отправки сообщений, вводится пользователем.
- `end_hour` (int): Конечный час временного диапазона для отправки сообщений, вводится пользователем.
- `message_count` (int): Счетчик отправленных сообщений.
- `random_hour` (int): Случайный час для отправки сообщения, генерируется в заданном диапазоне.
- `random_minutes` (int): Случайная минута для отправки сообщения, генерируется в диапазоне от 0 до 59.
- `random_message` (str): Случайное сообщение, выбирается из списка `messages`.

## Основной цикл отправки сообщений

Основной цикл отвечает за отправку заданного количества сообщений в случайное время в указанном диапазоне часов.

1. **Получение входных данных**: Запрашивает у пользователя номер телефона, количество сообщений, начальный и конечный час для отправки.
2. **Инициализация счетчика**: Устанавливает счетчик отправленных сообщений в 0.
3. **Цикл отправки сообщений**:
   - Генерирует случайный час и случайную минуту в заданном диапазоне.
   - Выбирает случайное сообщение из списка `messages`.
   - Вызывает функцию `send_whatsapp_message` для отправки сообщения.
   - Увеличивает счетчик отправленных сообщений.
4. **Завершение**: Повторяет цикл до тех пор, пока не будет отправлено заданное количество сообщений.