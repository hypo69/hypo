# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` предназначен для настройки маршрутов и обработки запросов, связанных с веб-сайтом. Он использует Flask для определения конечных точек (endpoints) и обработки запросов.

## Подробнее

Этот модуль настраивает маршруты для главной страницы, чата и статических ресурсов (assets), таких как файлы JavaScript и CSS. Основная цель модуля - организация структуры веб-приложения и обеспечение правильной обработки запросов пользователей. Модуль использует шаблонизатор Jinja2 (через `render_template`) для динамической генерации HTML-страниц.

## Классы

### `Website`

**Описание**: Класс `Website` управляет маршрутами и отображением веб-страниц.

**Принцип работы**:
Класс инициализируется с экземпляром приложения Flask и определяет маршруты для различных URL-адресов, связывая их с соответствующими функциями обработки запросов. Маршруты определены в словаре `self.routes`, где ключи - это URL-адреса, а значения - словари с функцией обработчиком и списком HTTP-методов.

**Атрибуты**:
- `app`: Экземпляр приложения Flask.
- `routes` (dict): Словарь, содержащий маршруты и соответствующие им функции и HTTP-методы.

**Методы**:
- `__init__(self, app)`: Инициализирует класс `Website` с переданным приложением Flask.
- `_chat(self, conversation_id)`: Обрабатывает запрос для отображения страницы чата с указанным ID разговора.
- `_index(self)`: Обрабатывает запрос для отображения главной страницы чата.
- `_assets(self, folder: str, file: str)`: Обрабатывает запрос для получения статических ресурсов (assets), таких как файлы JavaScript и CSS.

## Функции

### `__init__`

```python
def __init__(self, app) -> None:
    """Инициализирует класс Website, настраивая маршруты приложения Flask.

    Args:
        app: Экземпляр приложения Flask.

    Returns:
        None

    Raises:
        None
    """
```

**Назначение**: Инициализирует экземпляр класса `Website` и связывает переданное приложение Flask с определенными маршрутами.

**Параметры**:
- `app`: Экземпляр приложения Flask.

**Как работает функция**:
1. Присваивает переданный экземпляр приложения Flask атрибуту `self.app`.
2. Определяет словарь `self.routes`, который содержит маршруты веб-приложения. Каждый маршрут связан с функцией обработчиком и списком поддерживаемых HTTP-методов.

**Примеры**:

```python
from flask import Flask
app = Flask(__name__)
website = Website(app)
```

### `_chat`

```python
def _chat(self, conversation_id):
    """Отображает страницу чата с указанным ID разговора.

    Args:
        conversation_id: ID разговора.

    Returns:
        Response: HTML-страница чата или перенаправление на главную страницу чата.

    Raises:
        None
    """
```

**Назначение**: Функция отображает страницу чата, используя `conversation_id`, полученный из URL. Если `conversation_id` не содержит дефис (`-`), происходит перенаправление на главную страницу чата.

**Параметры**:
- `conversation_id`: ID разговора, полученный из URL.

**Возвращает**:
- `render_template`: HTML-страница чата (index.html) с указанным `chat_id`.
- `redirect`: Перенаправление на главную страницу чата, если `conversation_id` не соответствует ожидаемому формату.

**Как работает функция**:
1. Проверяет, содержит ли `conversation_id` символ "-".
2. Если символ "-" отсутствует, выполняет перенаправление на главную страницу чата (`/chat`).
3. Если символ "-" присутствует, отображает шаблон `index.html`, передавая `conversation_id` в качестве параметра `chat_id`.

**Примеры**:
```python
# Пример вызова функции _chat с допустимым conversation_id
_chat("1234-abcd-5678-efgh-901234567890")

# Пример вызова функции _chat с недопустимым conversation_id
_chat("1234abcd5678efgh901234567890") # приведет к редиректу на '/chat'
```

### `_index`

```python
def _index(self):
    """Отображает главную страницу чата, генерируя уникальный ID разговора.

    Args:
        None

    Returns:
        Response: HTML-страница чата с автоматически сгенерированным `chat_id`.

    Raises:
        None
    """
```

**Назначение**: Функция отображает главную страницу чата, генерируя уникальный идентификатор чата (`chat_id`).

**Параметры**:
- Отсутствуют.

**Возвращает**:
- `render_template`: HTML-страница чата (index.html) с автоматически сгенерированным `chat_id`.

**Как работает функция**:
1. Генерирует случайный `chat_id` путем объединения нескольких случайных шестнадцатеричных чисел и текущего времени в миллисекундах.
2. Отображает шаблон `index.html`, передавая сгенерированный `chat_id` в качестве параметра.

**Примеры**:

```python
# Пример вызова функции _index
_index()
```

### `_assets`

```python
def _assets(self, folder: str, file: str):
    """Предоставляет статические ресурсы (assets) из указанной папки.

    Args:
        folder (str): Название папки, содержащей файл.
        file (str): Имя запрашиваемого файла.

    Returns:
        Response: Файл ресурса или сообщение об ошибке "File not found" с кодом 404.

    Raises:
        None
    """
```

**Назначение**: Функция предоставляет статические ресурсы, такие как файлы JavaScript и CSS, из указанной папки.

**Параметры**:
- `folder` (str): Название папки, содержащей файл.
- `file` (str): Имя запрашиваемого файла.

**Возвращает**:
- `send_file`: Файл ресурса, если он найден.
- Сообщение об ошибке "File not found" с кодом 404, если файл не найден.

**Как работает функция**:
1. Пытается отправить запрошенный файл из папки `client`.
2. Если файл найден, он отправляется клиенту с помощью `send_file`.
3. Если файл не найден, возвращается сообщение об ошибке "File not found" с кодом 404.

**Примеры**:

```python
# Пример вызова функции _assets для получения файла style.css из папки css
_assets("css", "style.css")

# Пример вызова функции _assets для получения файла script.js из папки js
_assets("js", "script.js")
```