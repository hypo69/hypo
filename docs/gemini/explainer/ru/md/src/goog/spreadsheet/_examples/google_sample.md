# Объяснение кода

Этот Python-скрипт использует Google Sheets API для чтения данных из конкретного листа Google Таблицы. Он извлекает данные из столбцов A и E, выводит их в формате "Имя, Специальность".

**Основные компоненты:**

* **`SCOPES`:** Список разрешений, необходимых для доступа к Google Таблицам. В данном случае, только для чтения.
* **`SAMPLE_SPREADSHEET_ID`:** Идентификатор Google Таблицы, из которой будут считываться данные.
* **`SAMPLE_RANGE_NAME`:** Диапазон в таблице, из которого будут извлекаться данные (в данном случае, диапазон A2:E).
* **`ROOT_DIRECTORY`:** Путь к текущей директории.
* **`path`:** Путь к файлу `client_secret.json`, содержащему секретные ключи для приложения. **Важно**: этот путь динамически сконструирован, и крайне важно, чтобы файл `client_secret.json` находился в указанном расположении.
* **`main()`:** Функция, содержащая основной логику работы скрипта:
    * **Авторизация:** Программа проверяет наличие файла `token.json` с токенами доступа. Если файл существует, то используются сохраненные данные. Если нет, то программа запускает диалог авторизации с пользователем, чтобы получить токен доступа.  После успешной авторизации, токен сохраняется в `token.json` для последующего использования.
    * **Обработка API:** Используется Google Sheets API для выполнения запроса данных из таблицы.  `service.spreadsheets().values().get(...)` выполняет запрос на получение данных.
    * **Обработка ошибок:**  Блок `try...except` обрабатывает возможные ошибки при взаимодействии с API (например, `HttpError`).
    * **Вывод данных:** Программа выводит данные в формате "Имя, Специальность" из столбцов A и E. Если данных нет, выводится сообщение об этом.
* **`if __name__ == '__main__':`:**  Стандартный блок, гарантирующий, что функция `main()` будет вызвана только при непосредственном запуске скрипта.

**Как запустить скрипт:**

1. **Установите необходимые библиотеки:**
   ```bash
   pip install google-api-python-client google-auth-httplib2 google-auth-oauthlib
   ```

2. **Получите `client_secret.json`:**
   - Создайте приложение в Google Cloud Console.
   - Настройте необходимые разрешения (доступ к Google Таблицам).
   - Скачайте файл `client_secret.json` и поместите его в папку, указанную в переменной `path`.

3. **Запустите скрипт:**
   ```bash
   python google_sample.py
   ```

**Важные замечания:**

* **Файл `token.json`:** Этот файл крайне важен. Он хранит токен доступа к API.  Если вы измените `SCOPES`, то файл `token.json` нужно удалить, чтобы приложение заново запросило авторизацию.
* **Путь к `client_secret.json`:**  Будьте внимательны к пути к файлу `client_secret.json`.  Он должен быть правильным, чтобы приложение могло получить доступ к секретным ключам.
* **Разрешения:** Убедитесь, что приложение имеет необходимые разрешения в Google Cloud Console.
* **`credentials.json`:** В коде используется файл `credentials.json`, но он нигде не используется.  Возможно, это нужно было добавить в скрипт для работы.  В реальных приложениях обычно в настройках авторизации не указывается `credentials.json`.
* **`ROOT_DIRECTORY`:** При необходимости можно изменить переменную `ROOT_DIRECTORY`, если структура каталогов отличается от ожидаемой.


Этот код предоставляет базовый пример доступа к Google Таблицам. Для более сложных задач, вам могут потребоваться дополнительные настройки и методы.