# Анализ кода модуля `chomp.py`

**Качество кода**
  
1.  **Соответствие требованиям к формату кода (1-10)**:
    -   **Преимущества**:
        *   Код хорошо структурирован и разбит на функции, что облегчает понимание и поддержку.
        *   Используются описательные имена функций и переменных, что повышает читаемость кода.
        *   Присутствуют базовые проверки ввода.
        *   Логика игры реализована понятно и эффективно.
    -   **Недостатки**:
        *   Отсутствует reStructuredText (RST) для документирования функций, классов, и модулей.
        *   Не используется `src.utils.jjson` для чтения файлов (хотя в данном коде нет файлов для чтения).
        *   Не используется `from src.logger.logger import logger` для логирования ошибок.
        *   Присутствует избыточное использование try-except блоков, что может быть заменено на более специфичные проверки.
        *   Комментарии в конце файла не структурированы в формате RST.
        
**Рекомендации по улучшению**

1.  **Документация в формате reStructuredText (RST)**:
    *   Добавить описание модуля в начале файла.
    *   Задокументировать каждую функцию, метод и переменную в формате RST, включая параметры и возвращаемые значения.
2.  **Импорт `logger`**:
    *   Импортировать `logger` из `src.logger.logger` и использовать его для логирования ошибок и отладки.
3.  **Обработка исключений**:
    *   Заменить избыточное использование `try-except` на более конкретные проверки, где это возможно. Использовать `logger.error` для логирования исключений.
4.  **Использование `j_loads` или `j_loads_ns`**:
    *   В данном коде отсутствует работа с файлами, поэтому нет необходимости использовать `j_loads` или `j_loads_ns`, но нужно помнить об этом требовании для будущих изменений.
5.  **Форматирование комментариев**:
    *   Переписать комментарии в конце файла в формате RST.
    *   Добавить более подробные комментарии для объяснения логики каждого блока кода.
6.  **Примеры кода в документации**:
    *   Добавить примеры использования функций в формате RST.

**Улучшенный код**

```python
"""
Модуль для реализации игры "CHOMP".
=========================================================================================

Модуль содержит функции для инициализации игрового поля, отображения доски,
выполнения ходов игроков и проверки окончания игры. Игра "CHOMP" - это игра для двух игроков,
в которой используется прямоугольная доска, представляющая собой шоколадную плитку.

:Example:

    .. code-block:: python
        
        play_chomp()
        
"""
from src.logger.logger import logger # Импортируем logger для обработки ошибок # Изменено: импортируем logger

def initialize_board(rows: int, cols: int) -> list[list[str]]:
    """
    Инициализирует игровое поле (шоколадную плитку).

    :param rows: Количество строк на доске.
    :type rows: int
    :param cols: Количество столбцов на доске.
    :type cols: int
    :return: Список списков, представляющий игровую доску, где 'X' - шоколад, ' ' - пустое место.
    :rtype: list[list[str]]
    """
    board = [['X' for _ in range(cols)] for _ in range(rows)] # Создаем доску, заполненную 'X'
    return board

def display_board(board: list[list[str]]) -> None:
    """
    Выводит текущее состояние доски на экран.

    :param board: Игровая доска.
    :type board: list[list[str]]
    """
    for row in board: # Итерируем по строкам доски
        print(' '.join(row)) # Выводим каждую строку

def make_move(board: list[list[str]], row_move: int, col_move: int) -> list[list[str]]:
    """
    Обновляет состояние доски после хода игрока.
    Все клетки справа и выше выбранной позиции удаляются.

    :param board: Игровая доска.
    :type board: list[list[str]]
    :param row_move: Строка, на которую игрок сделал ход.
    :type row_move: int
    :param col_move: Столбец, на который игрок сделал ход.
    :type col_move: int
    :return: Обновленная игровая доска.
    :rtype: list[list[str]]
    """
    rows = len(board) # Получаем количество строк
    cols = len(board[0]) # Получаем количество столбцов
    for row in range(row_move, rows): # Итерируем по строкам начиная с хода
        for col in range(col_move, cols): # Итерируем по столбцам начиная с хода
            board[row][col] = ' ' # Удаляем клетки, заменяя их на ' '
    return board

def is_game_over(board: list[list[str]]) -> bool:
  """
  Проверяет, закончилась ли игра.
  Игра заканчивается, если ядовитая долька (верхний левый угол) съедена.

  :param board: Игровая доска.
  :type board: list[list[str]]
  :return: True, если игра окончена, иначе False.
  :rtype: bool
  """
  return board[0][0] == ' ' # Проверяем, съедена ли ядовитая долька

def play_chomp() -> None:
    """
    Основная функция игры "CHOMP".
    Реализует игровой процесс, включая ввод размеров доски, отображение доски,
    и обработку ходов игроков.
    """
    while True:
        try:
            rows = int(input("Введите количество строк на доске: ")) # Запрашиваем количество строк
            cols = int(input("Введите количество столбцов на доске: ")) # Запрашиваем количество столбцов
            if rows <= 0 or cols <= 0: # Проверяем, что размеры доски положительные
                 print("Размер доски должен быть положительным числом.")
                 continue
            break
        except ValueError as e: # Ловим ошибку ввода не числа
            logger.error(f'Ошибка ввода размера доски: {e}') # Логируем ошибку
            print("Пожалуйста, введите целое число.")

    board = initialize_board(rows, cols) # Инициализируем доску
    current_player = 1  # Начинает первый игрок

    while True:
        print(f"\nХод игрока {current_player}:") # Выводим ход текущего игрока
        display_board(board) # Отображаем доску
        
        while True:
            try:
                row_move = int(input("Введите строку для откусывания (начиная с 0): ")) # Запрашиваем строку для хода
                col_move = int(input("Введите столбец для откусывания (начиная с 0): ")) # Запрашиваем столбец для хода
                if row_move < 0 or col_move < 0 or row_move >= rows or col_move >= cols: # Проверяем корректность координат
                    print("Неверный ход. Укажите строку и столбец в пределах доски")
                    continue
                if board[row_move][col_move] == ' ': # Проверяем, что не откусываем пустое место
                     print("Вы не можете откусить пустое место. Попробуйте еще раз")
                     continue
                break
            except ValueError as e: # Ловим ошибку ввода не числа
                logger.error(f'Ошибка ввода координат хода: {e}') # Логируем ошибку
                print("Пожалуйста, введите целые числа.")
            except IndexError as e: # Ловим ошибку выхода за пределы доски
                logger.error(f'Ошибка выхода за пределы доски: {e}') # Логируем ошибку
                print("Неверный ход. Укажите строку и столбец в пределах доски")
            

        board = make_move(board, row_move, col_move) # Выполняем ход

        if is_game_over(board): # Проверяем, закончилась ли игра
          print(f"Победил игрок {3-current_player}!") # Выводим победителя
          display_board(board) # Отображаем доску
          break
        
        current_player = 3 - current_player # Переключаем игрока

if __name__ == "__main__":
    play_chomp()

"""
Объяснение кода:
===================

:Модуль:
    Модуль `chomp.py` реализует логику игры "CHOMP".
    Игра представляет собой пошаговую стратегию на прямоугольной доске,
    представляющей шоколадную плитку. Игроки по очереди отламывают куски плитки,
    стремясь заставить противника съесть "отравленную дольку" в левом верхнем углу.

:Инициализация доски:
    Функция :func:`initialize_board` создает игровую доску заданного размера,
    заполненную символами 'X', обозначающими шоколад.

:Отображение доски:
    Функция :func:`display_board` выводит текущее состояние доски в консоль.

:Ход игрока:
    Функция :func:`make_move` обновляет состояние доски после хода игрока.
    Все клетки справа и ниже выбранной позиции заменяются на пробелы.

:Проверка окончания игры:
    Функция :func:`is_game_over` проверяет, съедена ли ядовитая долька.
    Игра заканчивается, если клетка в левом верхнем углу пуста.

:Основная логика игры:
    Функция :func:`play_chomp` управляет основным игровым процессом. Она запрашивает размеры доски,
    инициализирует доску, организует цикл ходов игроков, выводит текущее состояние доски,
    запрашивает ввод хода от игрока, обновляет доску, проверяет окончание игры и переключает игроков.

:Обработка исключений:
   Код использует блоки `try-except` для обработки ошибок ввода, например, нечисловых значений
   или некорректных координат.

:Запуск игры:
   Блок `if __name__ == "__main__":` гарантирует, что функция :func:`play_chomp` будет запущена только при непосредственном запуске скрипта.

"""
```