# Анализ кода модуля `readme.ru.md`

## Качество кода:

- **Соответствие стандартам**: 8
- **Плюсы**:
    - Документ содержит подробное описание модуля `Crawlee Python`.
    - Описаны основные особенности, требования и конфигурация.
    - Приведены примеры использования и конфигурационного файла.
    - Есть разделы о логировании и отладке.
- **Минусы**:
    -  Не все элементы документации соответствуют стандарту RST.
    -  Встречаются двойные кавычки в примерах кода, что противоречит требованиям.
    -  Не хватает примеров использования с разными конфигурациями.
    -  Слишком много повторений в описаниях конфигурации, можно сократить.

## Рекомендации по улучшению:

- Необходимо привести все примеры кода к единому стилю, используя одинарные кавычки (`'`) для строк в Python коде.
- Необходимо переработать раздел конфигурации, сделав описания более лаконичными и структурированными.
- Добавить примеры конфигурации с различными типами браузеров и прокси.
- Добавить больше примеров использования `CrawleePython` с разными параметрами, чтобы было понятно, как можно кастомизировать работу.
-  Привести описание конфигурации к стандарту RST.
- Уточнить раздел логирования и отладки, добавив больше примеров сообщений.
-  Использовать code-block:: python для всего кода.
-  Исправить "логирование" в "журналирование".

## Оптимизированный код:

```rst
.. module:: src.webdriver.crawlee_python

# Модуль Crawlee Python для автоматизации и сбора данных
========================================================

Модуль предоставляет кастомную реализацию `PlaywrightCrawler` с использованием библиотеки Crawlee. Он позволяет настраивать параметры запуска браузера, обрабатывать веб-страницы и извлекать данные из них. Конфигурация управляется через файл `crawlee_python.json`.

## Ключевые особенности
---------------------

- **Централизованная конфигурация**: Конфигурация управляется через файл `crawlee_python.json`.
- **Поддержка пользовательских опций**: Возможность передавать пользовательские опции при инициализации.
- **Улучшенное журналирование и обработка ошибок**: Предоставляет подробные логи для инициализации, проблем с конфигурацией и ошибок WebDriver.
- **Поддержка прокси**: Настройка прокси-сервера для обхода ограничений.
- **Гибкие настройки браузера**: Возможность настройки размера окна, user-agent и других параметров.

## Требования
------------

Перед использованием этого модуля убедитесь, что установлены следующие зависимости:

- Python 3.x
- Playwright
- Crawlee

Установите необходимые зависимости Python:

.. code-block:: bash

    pip install playwright crawlee

Кроме того, убедитесь, что Playwright установлен и настроен для работы с браузером. Установите браузеры, используя команду:

.. code-block:: bash

    playwright install

## Конфигурация
--------------

Конфигурация для Crawlee Python хранится в файле `crawlee_python.json`. Ниже приведён пример структуры конфигурационного файла и его описание:

### Пример конфигурации (`crawlee_python.json`)
-----------------------------------------------

.. code-block:: json

    {
      "max_requests": 10,
      "headless": true,
      "browser_type": "chromium",
      "options": [
        "--disable-dev-shm-usage",
        "--no-sandbox",
        "--disable-gpu"
      ],
      "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36",
      "proxy": {
        "enabled": false,
        "server": "http://proxy.example.com:8080",
        "username": "user",
        "password": "password"
      },
      "viewport": {
        "width": 1280,
        "height": 720
      },
      "timeout": 30000,
      "ignore_https_errors": false
    }

### Описание полей конфигурации
-------------------------------

#### `max_requests`
    Максимальное количество запросов, которые будут выполнены во время обхода. По умолчанию `10`.

#### `headless`
    Булевое значение, указывающее, должен ли браузер запускаться в безголовом режиме. По умолчанию `true`.

#### `browser_type`
    Тип браузера, который будет использоваться. Возможные значения:
    - `chromium` (по умолчанию)
    - `firefox`
    - `webkit`

#### `options`
    Список аргументов командной строки, передаваемых в браузер. Примеры:
    - `--disable-dev-shm-usage`: Отключает использование `/dev/shm` в Docker-контейнерах.
    - `--no-sandbox`: Отключает режим песочницы.
    - `--disable-gpu`: Отключает аппаратное ускорение GPU.

#### `user_agent`
    Строка user-agent, которая будет использоваться для запросов браузера.

#### `proxy`
    Настройки прокси-сервера:
    - **enabled**: Булевое значение, указывающее, следует ли использовать прокси.
    - **server**: Адрес прокси-сервера.
    - **username**: Имя пользователя для аутентификации на прокси-сервере.
    - **password**: Пароль для аутентификации на прокси-сервере.

#### `viewport`
    Размеры окна браузера:
    - **width**: Ширина окна.
    - **height**: Высота окна.

#### `timeout`
    Максимальное время ожидания для выполнения операций (в миллисекундах). По умолчанию `30000` (30 секунд).

#### `ignore_https_errors`
    Булевое значение, указывающее, следует ли игнорировать ошибки HTTPS. По умолчанию `false`.

## Использование
-------------

Чтобы использовать `CrawleePython` в своём проекте, просто импортируйте его и инициализируйте:

.. code-block:: python

    from src.webdriver.crawlee_python import CrawleePython
    import asyncio

    # Инициализация CrawleePython с пользовательскими опциями
    async def main():
        crawler = CrawleePython(
            max_requests=10,
            headless=True,
            browser_type='chromium',
            options=['--headless']
        )
        await crawler.run(['https://www.example.com'])

    asyncio.run(main())

Класс `CrawleePython` автоматически загружает настройки из файла `crawlee_python.json` и использует их для конфигурации WebDriver. Также можно указать пользовательский user-agent и передать дополнительные опции при инициализации WebDriver.

## Журналирование и отладка
-------------------------

Класс WebDriver использует `logger` из `src.logger` для журналирования ошибок, предупреждений и общей информации. Все проблемы, возникающие при инициализации, конфигурации или выполнении, будут записываться в логи для удобства отладки.

### Примеры логов
----------------

- **Ошибка при инициализации WebDriver**: `Ошибка при инициализации Crawlee Python: <детали ошибки>`
- **Проблемы с конфигурацией**: `Ошибка в файле crawlee_python.json: <детали проблемы>`

## Лицензия
---------

Этот проект лицензирован на условиях MIT License. Подробности см. в файле [LICENSE](../../LICENSE).