```MD
# Анализ правил форматирования кода

## <input code>

```markdown
### Правила форматирования кода:

1. **Общие принципы**
   - Используйте согласованный стиль кодирования для повышения читаемости и согласованности.
   - Все изменения и рекомендации должны соответствовать этому формату.

---

2. **Комментарии**
   - **Комментарии после символа `#`:**
     - **Не изменяйте**: Комментарии после символа `#` должны оставаться неизменными и быть понятными. Не переписывайте и не удаляйте их, даже если они начинаются с кода.
     - **Информативные**: Внутренние комментарии должны быть информативными и объяснять следующий блок кода.
     - **Формат**: Используйте формат reStructuredText (RST) для всех комментариев и документации.
     - **Терминология**: Избегайте использования терминов вроде 'получить', 'сделать' в комментариях. Вместо этого используйте фразы вроде 'проверить', 'отправить', 'код выполняет...'.
     - **Пассивный залог**: Предпочитается пассивный залог: 'копирование', 'форматирование', 'создание' и т.д.
     - **Пустые строки**: Если есть пустые строки или `...`, не документируйте их.

   - **Комментарии после символа `"""`:**
     - **Оптимизировать**: Комментарии после символа `"""` можно и нужно оптимизировать, основываясь на фактическом поведении кода.

---

3. **Документация**
   - **Docstring**: Каждая функция, метод и класс должны иметь docstring в стиле Sphinx.
     - Пример для функции:
       ```python
       def function(param: str, param1: Optional[str | dict] = None) -> dict | None:
           """
           Описание функции.

           :param param: Описание параметра `param`.
           :param param1: (Необязательно) Описание параметра `param1`.
           :return: Описание возвращаемого значения.
           :raises SomeError: Условия для исключения.
           """
       ```
   - **Описание модуля**: Добавьте описание модуля в начале каждого файла:
     ```python
     """
     Модуль для работы с помощником программиста
     =========================================================================================

     Описание функциональности модуля.

     Пример использования
     ---------------------

     .. code-block:: python

         example_usage()
     """
     ```

---

4. **Форматирование кода**
   - **Кавычки**: Используйте одинарные кавычки вместо двойных.
   - **Пробелы**: Используйте пробелы вокруг оператора присваивания `=`. Пример:
     ```python
     a = 1
     ```
   - **Согласованность**: Применяйте пробелы последовательно во всех выражениях и присваиваниях:
     ```python
     result = 10 if x > 5 else 20
     ```
   - **Заголовок импорта**: Всегда включайте строку `import header` в начале файла.
   - **Отладка**: Добавляйте `...` между `logger` и `return` для отладки, пример:
     ```python
     logger.error('Ошибка при выполнении задачи', ex)
     ...
     return
     ```

---

5. **Параметры функций**
   - **Типизация**: Параметры должны быть явно типизированы. Если значение по умолчанию `None`, используйте `Optional`. Пример:
     ```python
     def critical(self, message: str, ex: Optional = None, exc_info: Optional[bool] = True):
     ```
   - **Избегайте Union**: Избегайте использования `Union`.

---

6. **Pydantic**
   - **Валидация**: Используйте Pydantic для валидации данных, если это возможно и уместно.
   - **Модели**: Предпочитайте модели Pydantic для классов, обрабатывающих структурированные данные.

---

7. **Логирование**
   - **Логгер**: Используйте `from src.logger import logger` для логирования вместо стандартного `logging`.
   - **Пример логирования ошибок**:
     ```python
     logger.error('Ошибка при запуске бота: ', ex)
     ...
     return
     ```

---

8. **Константы**
   - **MODE**: Всегда включайте глобальную константу `MODE` в код, даже если она не используется.

---

### Формат ответа:

Все ответы должны следовать формату Markdown.

Структура ответа должна включать:

- **Улучшенный код**: Блок с улучшенным кодом, отформатированным и с добавленными комментариями.
- **Изменения**: Подробный список модификаций и объяснений.

Код должен быть заключён в соответствующих тегах синтаксической подсветки (например, `python`, `markdown`, `json`).

---

### Примеры:

#### Пример 1 (Python-код):
Вход:
```python
def add_numbers(a,b):
    return a+b
```

Ожидаемый ответ:

```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```

```

```
```

```

```
```

```
```
```

```

```
```
```

```
```
```
```
```
```
```
```
```
```
```
```
```
```
```

```
```
```
```
```

```
```

```
```

```
```
```
```
```
```
```
```
```
```
```
```
```
```
```
```

```
```
```

```
```

```

```
```

```

```
```

```
```


```
```

```
```

```
```

```
```
```


```
```
```
```


```
```
```
```

```
```

```

```
```

```
```


```
```
```

```

```
```

```
```

```

```


```
```
```
```

```
```

```


```
```
```
```

```
```

```
```
```
```


```
```
```

```

```
```
```



```

```
```


```
```

```


```
```

```

```
```

```
```

```

```


```
```


```

```
```


```


```
```

```

```
```


```

```

```

```
```

```


```

```
```

```


```
```

```

```

```
```
```

```


```
```

```

```

```
```

```

```

```
```

```


```


```
```

```

```
```

```
```

```
```

```
```


```


```
```

```
```


```

```


```
```

```
```

```

```

```
```


```

```

```


```

```


```


```
```

```


```
```

```


```

```

```


```

```
```


```
```
```

```
```


```
```
```

```
```

```

```
```

```

```

```

```

```
```

```
```


```

```
```

```

```

```


```
```

```

```

```

```


```

```

```

```

```

```


```
```


```

```

```

```

```

```
```
```
```

```


```

```
```
```
```



```

```
```


```

```
```


```

```
```

```
```

```

```


```
```
```
```

```
```



```

```

```
```

```


```
```


```


```

```

```

```


```
```

```

```
```

```

```

```

```

```



```

```

```


```
```


```
```
```

```
```
```

```

```


```

```
```

```


```
```


```

```

```



```

```

```

```

```

```

```

```
```
```

```



```
```
```



```

```
```
```

```

```


```

```
```

```

```



```


```
```

```


```

```
```
```


```

```

```


```
```

```
```
```
```

```
```

```

```
```

```

```


```


```
```

```
```


```

```

```
```

```


```

```

```

```



```
```
```

```
```

```



```
```

```

```

```
```




```
```


```

```


```
```

```

```
```

```

```



```
```

```


```

```

```

```


```

```

```

```



```

```


```

```

```

```

```

```


```

```

```

```

```


```
```

```

```

```

```

```

```


```


```

```

```

```

```


```

```

```

```
```

```



```

```

```


```

```


```
```


```
```


```
```

```


```

```

```

```

```
```

```
```

```



```

```

```

```

```


```
```
```

```

```

```
```
```


```

```
```

```

```
```
```

```

```



```
```

```
```

```

```


```

```

```


```

```

```

```

```


```


```
```

```
```

```

```

```


```

```

```
```

```



```

```


```

```


```


```


```

```

```

```

```

```

```

```

```

```
```

```

```

```

```

```

```

```

```

```
```


```
```

```


```
```

```
```


```

```


```

```

```

```

```

```

```
```

```
```

```

```



```


```

```


```

```

```
```


```

```

```

```

```

```

```
```

```



```

```


```

```
```

```



```

```


```

```

```

```


```


```


```

```
```

```


```
```


```

```


```
```

```


```

```
```


```

```

```
```


```
```



```


```

```

```

```


```
```

```

```

```

```

```

```


```
```
```
```


```
```


```
```


```

```

```


```
```

```

```


```

```

```


```

```
```



```

```

```

```

```

```


```

```

```

```

```

```

```

```


```

```


```

```

```



```

```
```
```

```


```
```

```

```

```


```
```

```


```


```

```

```

```

```


```

```

```

```


```
```

```



```
```


```

```

```


```

```
```

```


```


```


```


```


```

```


```

```

```


```
```

```



```
```

```

```

```


```


```

```

```

```

```

```

```

```
```
```


```

```
```


```

```


```


```

```
```



```

```

```

```


```
```

```



```

```
```

```


```

```


```


```

```
```

```

```


```
```

```
```


```

```
```

```

```

```

```

```


```

```

```


```

```



```

```


```

```

```

```


```

```
```

```

```

```

```



```

```


```

```

```



```
```

```
```

```

```

```


```
```

```


```

```

```

```

```

```

```

```

```

```

```

```


```

```

```


```
```


```

```

```

```

```

```


```


```


```

```

```

```
```
```
```


```

```


```
```

```


```


```



```
```


```
```



```

```

```
```

```


```


```

```

```

```

```

```

```

```

```

```



```

```

```

```

```
```


```
```



```

```

```


```

```

```

```

```

```

```
```

```

```

```

```

```

```

```

```

```

```

```


```

```

```



```

```

```

```


```

```

```

```


```


```


```

```


```

```



```

```

```

```


```
```

```


```


```

```


```

```
```


```
```


```

```

```


```


```

```

```

```



```


```

```
```
```

```
```

```
```

```
```


```

```


```

```
```


```

```

```


```


```
```
```
```

```
```

```

```

```

```

```
```


```

```



```

```

```

```


```

```



```


```

```

```

```

```


```


```

```

```

```
```
```


```


```

```

```



```
```
```

```

```

```

```

```
```


```

```
```

```

```

```

```

```

```

```

```

```
```

```

```

```

```

```


```


```

```


```

```

```

```

```

```

```


```

```

```

```


```

```

```

```

```

```

```

```

```

```

```

```


```
```

```

```

```


```

```

```

```


```
```


```
```


```
```


```
```


```

```


```

```
```

```

```


```

```

```

```

```

```


```

```


```

```
```

```


```
```

```
```


```

```

```

```

```

```

```

```

```

```

```

```

```

```


```

```

```

```



```
```
```


```
```



```

```

```
```

```


```
```
```

```


```

```
```


```
```
```


```


```


```

```


```

```

```

```

```


```

```

```

```

```

```

```

```

```

```

```

```
```

```

```

```

```


```
```

```

```

```

```

```

```


```
```
```

```

```


```


```

```


```
```

```


```

```

```

```


```


```

```


```

```


```


```

```


```
```

```
```


```
```


```


```

```

```


```
```

```



```

```


```

```

```


```
```

```

```
```

```



```
```


```
```

```

```


```

```


```


```
```
```

```

```
```



```
```


```

```

```


```

```


```

```

```



```


```
```
```

```

```


```

```


```

```
```

```

```

```

```


```

```

```

```

```

```

```
```

```

```


```


```

```
```
```

```

```
```

```

```

```
```


```

```
```

```

```

```

```
```

```

```


```


```

```

```

```
```

```

```

```

```

```
```

```


```

```


```


```

```


```


```


```


```

```

```

```

```

```


```

```

```

```


```

```



```

```

```

```


```

```



```
```

```


```

```


```
```

```

```



```

```
```


```
```

```

```

```

```
```

```



```
```


```

```

```

```

```

```



```

```


```

```

```
```

```

```



```
```


```

```



```
```


```

```



```
```

```
```

```

```
```

```


```

```

```


```

```

```

```

```

```



```
```

```

```

```


```


```


```
```

```

```

```

```

```


```
```

```

```

```

```


```

```

```

```


```
```


```
```


```

```

```
```

```


```


```

```



```


```


```
```


```


```

```
```

```


```


```
```



```

```

```

```

```


```


```

```


```
```


```

```

```


```

```
```

```


```

```


```

```

```

```

```

```
```
```


```
```


```

```


```
```



```
```

```


```

```


```

```


```
```

```

```

```

```

```



```

```


```

```
```

```

```

```
```


```

```

```


```

```

```


```
```

```

```


```
```


```

```

```

```

```

```


```

```


```

```

```

```

```

```


```

```


```

```

```

```

```

```
```

```

```

```

```

```


```

```

```

```

```
```

```

```

```

```

```

```

```

```
```

```

```

```

```

```

```


```
```

```

```

```

```
```


```

```



```

```
```


```

```

```


```

```

```


```
```

```



```

```

```

```

```

```

```

```

```

```

```


```
```

```



```

```
```


```

```

```

```


```


```

```

```
```



```

```


```

```
```

```

```

```

```

```

```
```
```

```


```

```

```

```

```

```
```

```


```
```

```

```

```

```

```


```

```

```

```


```

```
```

```


```
```

```

```

```

```

```


```

```


```

```

```

```


```
```


```


```


```


```

```
```

```

```
```

```

```

```


```
```

```

```
```

```

```


```


```
```


```

```


```
```

```

```

```

```


```


```
```

```


```

```
```
```


```

```



```

```

```

```


```

```
```

```

```

```
```

```


```

```

```


```

```

```

```

```

```

```
```


```
```
```

```

```
```


```

```

```
```


```

```
```
```

```


```

```


```
```

```

```
```



```
```



```

```
```


```
```

```

```


```

```


```


```
```


```


```

```


```

```


```

```


```

```

```

```

```

```

```

```

```

```
```

```

```


```

```

```


```

```

```

```

```

```

```

```
```


```

```

```
```
```


```


```

```

```



```


```
```

```

```


```

```
```


```


```

```

```


```

```

```


```
```

```

```

```

```

```


```

```

```
```


```


```

```



```
```

```
```


```


```

```
```

```


```


```


```
```


```

```

```

```



```

```
```

```

```


```


```

```

```

```

```

```

```


```

```
```

```

```

```


```
```
```

```

```

```

```

```
```


```

```

```
```

```


```

```

```


```
```


```


```

```

```
```



```

```

```


```

```
```


```
```

```
```


```


```

```

```

```



```

```

```

```

```
```



```

```


```


```
```


```
```

```


```


```

```

```

```

```
```

```

```


```

```

```


```

```

```

```

```

```


```

```

```

```

```

```


```


```

```


```

```

```

```


```

```


```

```

```

```


```
```

```


```


```


```
```


```

```


```

```


```
```

```

```

```


```

```


```

```



```

```

```


```
```

```
```
```

```



```

```


```

```


```
```

```


```

```


```
```

```

```

```


```

```
```



```

```

```


```


```
```
```

```

```

```


```


```

```

```

```

```

```


```

```


```
```

```


```

```

```

```


```

```

```

```

```

```

```


```

```

```

```



```
```

```


```

```

```


```

```

```

```
```

```


```

```


```

```

```



```


```

```

```
```


```

```

```
```


```

```


```
```

```


```
```

```
```


```

```


```

```

```

```

```

```

```


```
```



```

```
```
```

```

```

```

```

```

```


```
```

```

```


```


```


```

```

```


```
```

```

```

```

```

```

```

```

```

```

```

```

```

```
```

```

```
```

```
```

```

```

```

```

```

```

```

```

```

```

```

```

```
```

```

```

```

```


```

```

```

```

```
```

```

```

```

```


```
```

```

```

```

```

```

```

```

```

```


```

```

```


```

```


```

```


```

```

```

```

```
```

```


```

```


```

```
```


```

```

```

```

```

```

```

```

```


```


```
```


```

```

```

```

```

```

```

```

```

```

```

```

```

```

```


```

```

```

```
```


```

```



```
```

```

```

```


```

```

```


```


```


```


```


```

```



```

```

```
```

```
```
```


```

```

```


```

```

```

```
```

```

```

```


```

```
```

```
```
```

```

```


```
```


```

```

```


```

```

```
```


```

```


```

```

```

```
```

```


```

```

```

```
```

```

```


```
```

```



```

```

```

```

```

```
```


```

```
```



```
```
```
```
```
```

```

```

```


```
```

```

```

```

```

```

```

```

```
```



```
```


```
```


```

```
```


```

```

```

```


```

```

```


```

```


```
```

```
```



```
```

```

```

```

```

```


```

```


```
```

```


```

```
```


```

```

```

```

```

```

```

```
```

```

```

```


```
```

```

```

```

```
```
```

```
```

```
```

```
```
```
```

```
```

```
```


```

```
```

```
```

```


```

```

```


```

```

```

```

```

```
```


```

```
```

```

```

```
```
```

```

```

```

```
```

```

```

```

```

```
```

```

```

```

```


```


```

```
```

```

```
```

```

```


```
```

```

```
```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```


```
```


```


```


```

```
```
```

```

```

```


```

```


```
```
```


```

```
```

```
```

```


```

```
```

```

```


```

```

```

```
```
```

```


```

```


```
```

```

```

```



```

```

```

```

```


```

```

```
```

```

```

```

```

```
```


```


```

```
```


```
```

```

```

```
```

```


```

```

```

```

```

```


```


```
```

```

```


```
```

```

```

```

```


```

```



```

```

```

```

```

```
```


```

```

```

```

```
```

```


```

```

```

```


```


```

```
```
```

```


```

```


```

```

```


```

```

```


```


```
```
```
```

```
```

```


```

```

```

```
```


```

```


```


```

```


```


```


```
```

```
```

```
```


```
```

```
```

```
```


```


```

```

```

```


```


```

```

```

```
```


```

```

```


```

```


```
```

```

```

```

```

```

```
```


```

```


```
```


```

```

```

```

```

```

```

```
```
```

```

```

```


```
```


```

```


```

```

```

```

```
```


```


```
```

```


```


```
```
```
```


```


```

```


```
```
```


```

```


```


```

```

```


```
```


```

```


```
```
```

```

```

```

```

```
```
```

```

```

```


```

```

```

```
```
```

```

```

```

```


```
```


```
```

```


```

```

```


```

```

```
```

```

```

```
```

```

```

```

```
```

```

```

```

```

```

```
```

```

```


```

```


```


```

```

```


```

```


```
```

```

```
```

```


```
```

```

```


```
```

```

```


```


```

```


```
```


```
```



```
```

```

```
```

```

```


```
```

```

```

```

```

```

```

```

```


```

```
```
```


```

```

```

```

```


```

```
```
```
```

```

```

```

```


```

```

```

```


```

```
```
```


```
```

```

```

```

```


```
```


```

```


```
```

```

```


```

```


```

```


```

```

```

```

```

```

```
```

```


```
```

```


```

```

```


```

```
```

```


```

```

```


```


```


```


```

```

```

```



```

```
```

```

```

```

```


```

```

```

```


```

```

```



```
```
```


```

```

```

```


```

```

```


```

```

```


```


```

```

```


```

```

```

```


```
```


```

```

```

```

```

```
```

```
```


```

```



```

```
```

```


```

```
```

```

```

```

```

```


```

```

```

```

```

```


```

```
```
```

```

```

```

```



```

```
```
```

```
```

```

```


```


```

```

```

```

```

```

```


```

```

```

```


```

```

```

```

```


```

```

```

```

```

```

```

```


```

```


```
```



```

```

```
```

```

```
```


```

```

```

```

```


```

```

```


```

```


```


```

```


```


```

```
```

```

```

```

```

```


```

```

```

```

```
```


```

```

```

```

```

```

```

```

```

```

```

```


```

```

```

```


```

```



```

```

```

```

```



```

```



```
```
```

```
```

```

```
```

```

```

```

```

```

```

```

```


```
```
```

```
```


```
```


```


```


```

```

```

```

```


```

```


```


```

```

```

```

```


```

```

```


```


```

```

```


```
```

```


```

```

```


```

```

```

```

```
```



```
```
```

```

```

```


```

```

```


```

```

```


```
```
```
```


```

```
```


```

```
```

```


```

```


```
```

```
```


```

```

```

```

```


```
```


```
```

```

```

```


```

```

```

```


```

```

```

```

```

```


```


```


```


```


```

```
```
```

```


```


```


```
```
```

```


```

```


```

```



```
```

```

```


```

```
```

```

```

```

```

```


```


```

```


```
```
```

```


```

```



```
```

```

```

```

```


```
```



```
```
```

```
```


```

```

```

```


```

```


```

```


```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```

```
```

```
```

```


```

```
```
```

```

```


```

```

```

```

```


```

```

```

```


```

```

```

```


```

```

```

```

```

```

```


```

```

```

```


```


```


```

```


```
```


```
```


```


```
```



```
```

```

```

```
```

```

```

```

```

```

```

```

```


```

```

```


```

```

```

```


```

```

```

```
```


```

```

```
```


```


```

```


```

```

```

```

```



```

```
```

```

```

```


```

```

```

```

```

```

```

```

```

```

```

```


```

```


```

```

```


```

```
```

```

```

```

```

```


```

```

```

```

```

```

```

```


```

```


```
```


```

```

```


```

```

```

```

```

```

```


```

```


```

```

```

```

```


```

```


```

```


```
```
```

```

```
```

```

```

```

```

```

```

```

```

```

```

```

```


```

```

```

```

```
```

```


```

```

```

```

```

```

```

```


```

```

```

```

```

```


```

```


```

```

```

```

```

```

```

```

```

```


```

```

```

```

```

```

```


```

```


```

```
```

```

```

```

```

```

```

```

```


```
```

```

```

```

```

```

```

```

```

```


```

```


```

```

```

```


```

```

```

```

```

```

```

```

```
```

```