# Документация модуля Facebook Promoter

## Обзор

Модуль **Facebook Promoter** предназначен для автоматизации процесса продвижения товаров и мероприятий AliExpress в группах Facebook. Он позволяет управлять публикациями рекламных материалов, избегая дублирования, и использует WebDriver для автоматизации браузера.

## Особенности модуля

- Продвижение категорий и мероприятий в группах Facebook.
- Избежание дублирования публикаций через отслеживание уже опубликованных элементов.
- Поддержка конфигурации данных групп через файлы.
- Возможность отключения загрузки видео в публикациях.

## Оглавление

- [Класс `FacebookPromoter`](#класс-facebookpromoter)
    - [Метод `__init__`](#метод-__init__)
    - [Метод `promote`](#метод-promote)
    - [Метод `log_promotion_error`](#метод-log_promotion_error)
    - [Метод `update_group_promotion_data`](#метод-update_group_promotion_data)
    - [Метод `process_groups`](#метод-process_groups)
    - [Метод `get_category_item`](#метод-get_category_item)
    - [Метод `check_interval`](#метод-check_interval)
    - [Метод `validate_group`](#метод-validate_group)

## Подробнее

Модуль `Facebook Promoter` автоматизирует процесс продвижения товаров и мероприятий AliExpress в группах Facebook. Он предназначен для управления рекламными публикациями и предотвращения дублирования контента. Модуль использует WebDriver для автоматизации действий в браузере, что позволяет эффективно управлять процессом продвижения.
Он интегрируется с WebDriver для автоматизации задач в браузере и использует файлы конфигурации для управления данными групп. Это облегчает автоматизированное продвижение товаров и мероприятий в Facebook.

## Классы

### Класс `FacebookPromoter`

**Описание**:
Этот класс управляет процессом продвижения товаров и мероприятий AliExpress в группах Facebook.

**Как работает класс**:
Класс `FacebookPromoter` инициализируется с WebDriver, именем промоутера и путями к файлам конфигурации групп. Он предоставляет методы для продвижения категорий и мероприятий в группах Facebook, обновления данных о продвижении и проверки интервалов между продвижениями. Основной метод `process_groups` управляет циклом обработки групп, выбирает элементы для продвижения и вызывает метод `promote` для публикации контента. Класс также включает методы для валидации данных группы и обработки ошибок продвижения.

**Методы**:
- [`__init__`](#метод-__init__)
- [`promote`](#метод-promote)
- [`log_promotion_error`](#метод-log_promotion_error)
- [`update_group_promotion_data`](#метод-update_group_promotion_data)
- [`process_groups`](#метод-process_groups)
- [`get_category_item`](#метод-get_category_item)
- [`check_interval`](#метод-check_interval)
- [`validate_group`](#метод-validate_group)

#### Метод `__init__`

```python
def __init__(self, d: Driver, promoter: str, group_file_paths: Optional[list[str | Path] | str | Path] = None, no_video: bool = False) -> None:
    """
    Инициализирует промоутер для Facebook с необходимыми конфигурациями.

    Args:
        d (Driver): Экземпляр WebDriver для автоматизации.
        promoter (str): Имя промоутера (например, "aliexpress").
        group_file_paths (Optional[list[str | Path] | str | Path], optional): Пути к файлам с данными групп.
        no_video (bool, optional): Флаг для отключения видео в публикациях. По умолчанию False.

    """
```

**Описание**:
Инициализирует экземпляр класса `FacebookPromoter`.

**Как работает функция**:
Метод `__init__` принимает экземпляр WebDriver, имя промоутера и пути к файлам с данными групп. Он устанавливает основные параметры для работы промоутера, включая WebDriver, имя промоутера и пути к файлам конфигурации групп. Если указан параметр `no_video`, он отключает загрузку видео в публикациях.

**Параметры**:
- `d` (Driver): Экземпляр WebDriver для автоматизации браузера.
- `promoter` (str): Имя промоутера (например, "aliexpress").
- `group_file_paths` (Optional[list[str | Path] | str | Path], optional): Пути к файлам с данными групп. Может быть списком путей или одиночным путем. По умолчанию `None`.
- `no_video` (bool, optional): Флаг, указывающий, следует ли отключать загрузку видео в публикациях. По умолчанию `False`.

#### Метод `promote`

```python
def promote(self, group: SimpleNamespace, item: SimpleNamespace, is_event: bool = False, language: str = None, currency: str = None) -> bool:
    """
    Продвигает категорию или мероприятие в указанной группе Facebook.

    Args:
        group (SimpleNamespace): Данные группы.
        item (SimpleNamespace): Категория или мероприятие для продвижения.
        is_event (bool, optional): Является ли элемент мероприятием. По умолчанию False.
        language (str, optional): Язык публикации. По умолчанию None.
        currency (str, optional): Валюта для продвижения. По умолчанию None.

    Returns:
        bool: Успешно ли прошло продвижение.
    """
```

**Описание**:
Продвигает категорию или мероприятие в указанной группе Facebook.

**Как работает функция**:
Метод `promote` принимает данные группы и элемент для продвижения (категорию или мероприятие). Он выполняет действия по публикации контента в группе Facebook, используя WebDriver. В процессе публикации учитываются язык и валюта, указанные в параметрах. Метод возвращает `True`, если продвижение прошло успешно, и `False` в противном случае.

**Параметры**:
- `group` (SimpleNamespace): Данные группы Facebook, в которой будет выполняться продвижение.
- `item` (SimpleNamespace): Элемент для продвижения, который может быть категорией или мероприятием.
- `is_event` (bool, optional): Флаг, указывающий, является ли продвигаемый элемент мероприятием. По умолчанию `False`.
- `language` (str, optional): Язык, на котором будет выполнена публикация. По умолчанию `None`.
- `currency` (str, optional): Валюта, используемая для продвижения. По умолчанию `None`.

**Возвращает**:
- `bool`: `True`, если продвижение прошло успешно, `False` в противном случае.

#### Метод `log_promotion_error`

```python
def log_promotion_error(self, is_event: bool, item_name: str) -> None:
    """
    Записывает ошибку, если продвижение не удалось.

    Args:
        is_event (bool): Является ли элемент мероприятием.
        item_name (str): Название элемента.
    """
```

**Описание**:
Записывает ошибку в лог, если продвижение не удалось.

**Как работает функция**:
Метод `log_promotion_error` принимает информацию о том, является ли элемент мероприятием, и название элемента. Он записывает сообщение об ошибке в лог, указывая, что продвижение не удалось. Это позволяет отслеживать проблемы в процессе продвижения и анализировать причины сбоев.

**Параметры**:
- `is_event` (bool): Указывает, является ли продвигаемый элемент мероприятием.
- `item_name` (str): Название элемента, который не удалось продвинуть.

#### Метод `update_group_promotion_data`

```python
def update_group_promotion_data(self, group: SimpleNamespace, item_name: str, is_event: bool = False) -> None:
    """
    Обновляет данные группы после продвижения, добавляя продвигаемый элемент в список продвигаемых категорий или мероприятий.

    Args:
        group (SimpleNamespace): Данные группы.
        item_name (str): Название продвигаемого элемента.
        is_event (bool, optional): Является ли элемент мероприятием. По умолчанию False.
    """
```

**Описание**:
Обновляет данные группы после успешного продвижения, добавляя информацию о продвигаемом элементе.

**Как работает функция**:
Метод `update_group_promotion_data` принимает данные группы, название продвигаемого элемента и флаг, указывающий, является ли элемент мероприятием. Он добавляет название элемента в список продвинутых категорий или мероприятий в данных группы. Это позволяет избежать повторного продвижения одного и того же элемента в одной и той же группе.

**Параметры**:
- `group` (SimpleNamespace): Данные группы Facebook, которые необходимо обновить.
- `item_name` (str): Название продвинутого элемента (категории или мероприятия).
- `is_event` (bool, optional): Флаг, указывающий, является ли продвигаемый элемент мероприятием. По умолчанию `False`.

#### Метод `process_groups`

```python
def process_groups(self, campaign_name: str = None, events: list[SimpleNamespace] = None, is_event: bool = False, group_file_paths: list[str] = None, group_categories_to_adv: list[str] = ['sales'], language: str = None, currency: str = None) -> None:
    """
    Обрабатывает группы для текущей кампании или продвижения мероприятия.

    Args:
        campaign_name (str, optional): Название кампании. По умолчанию None.
        events (list[SimpleNamespace], optional): Список мероприятий для продвижения. По умолчанию None.
        is_event (bool, optional): Является ли продвижение мероприятий или категорий. По умолчанию False.
        group_file_paths (list[str], optional): Пути к файлам с данными групп. По умолчанию None.
        group_categories_to_adv (list[str], optional): Категории для продвижения. По умолчанию ['sales'].
        language (str, optional): Язык публикации. По умолчанию None.
        currency (str, optional): Валюта для продвижения. По умолчанию None.
    """
```

**Описание**:
Обрабатывает группы для текущей кампании или продвижения мероприятия.

**Как работает функция**:
Метод `process_groups` является основным методом, управляющим процессом продвижения. Он принимает название кампании, список мероприятий, флаг, указывающий, является ли продвижение мероприятий или категорий, пути к файлам с данными групп, категории для продвижения, язык и валюту. Метод загружает данные групп, проверяет их валидность, выбирает элементы для продвижения и вызывает метод `promote` для публикации контента.

**Параметры**:
- `campaign_name` (str, optional): Название кампании. Используется для выбора элементов для продвижения. По умолчанию `None`.
- `events` (list[SimpleNamespace], optional): Список мероприятий для продвижения. По умолчанию `None`.
- `is_event` (bool, optional): Флаг, указывающий, выполняется ли продвижение мероприятий (если `True`) или категорий (если `False`). По умолчанию `False`.
- `group_file_paths` (list[str], optional): Список путей к файлам, содержащим данные о группах Facebook. По умолчанию `None`.
- `group_categories_to_adv` (list[str], optional): Список категорий для продвижения. По умолчанию `['sales']`.
- `language` (str, optional): Язык, на котором будет выполняться продвижение. По умолчанию `None`.
- `currency` (str, optional): Валюта, используемая для продвижения. По умолчанию `None`.

#### Метод `get_category_item`

```python
def get_category_item(self, campaign_name: str, group: SimpleNamespace, language: str, currency: str) -> SimpleNamespace:
    """
    Получает элемент категории для продвижения в зависимости от кампании и промоутера.

    Args:
        campaign_name (str): Название кампании.
        group (SimpleNamespace): Данные группы.
        language (str): Язык для публикации.
        currency (str): Валюта для публикации.

    Returns:
        SimpleNamespace: Элемент категории для продвижения.
    """
```

**Описание**:
Получает элемент категории для продвижения в зависимости от кампании и промоутера.

**Как работает функция**:
Метод `get_category_item` принимает название кампании, данные группы, язык и валюту. Он выбирает элемент категории для продвижения в зависимости от указанных параметров. Метод использует имя кампании и данные группы для определения наиболее подходящего элемента для продвижения.

**Параметры**:
- `campaign_name` (str): Название кампании, используемое для выбора элемента категории.
- `group` (SimpleNamespace): Данные группы Facebook, для которой выбирается элемент.
- `language` (str): Язык, на котором будет выполнена публикация.
- `currency` (str): Валюта, используемая для продвижения.

**Возвращает**:
- `SimpleNamespace`: Элемент категории для продвижения.

#### Метод `check_interval`

```python
def check_interval(self, group: SimpleNamespace) -> bool:
    """
    Проверяет, прошло ли достаточно времени, чтобы снова продвигать эту группу.

    Args:
        group (SimpleNamespace): Данные группы.

    Returns:
        bool: Можно ли снова продвигать группу.
    """
```

**Описание**:
Проверяет, прошло ли достаточно времени с момента последнего продвижения в группе.

**Как работает функция**:
Метод `check_interval` принимает данные группы и проверяет, прошло ли достаточно времени с момента последнего продвижения. Если интервал времени между текущим моментом и временем последнего продвижения превышает установленный лимит, метод возвращает `True`, указывая, что группу можно снова продвигать. В противном случае метод возвращает `False`.

**Параметры**:
- `group` (SimpleNamespace): Данные группы Facebook, для которой выполняется проверка интервала.

**Возвращает**:
- `bool`: `True`, если прошло достаточно времени для повторного продвижения, `False` в противном случае.

#### Метод `validate_group`

```python
def validate_group(self, group: SimpleNamespace) -> bool:
    """
    Проверяет данные группы, чтобы убедиться в их корректности.

    Args:
        group (SimpleNamespace): Данные группы.

    Returns:
        bool: Корректны ли данные группы.
    """
```

**Описание**:
Проверяет данные группы на корректность.

**Как работает функция**:
Метод `validate_group` принимает данные группы и проверяет, содержат ли они необходимую информацию для продвижения. Если данные группы содержат все необходимые поля и соответствуют ожидаемым форматам, метод возвращает `True`, указывая, что данные группы корректны. В противном случае метод возвращает `False`.

**Параметры**:
- `group` (SimpleNamespace): Данные группы Facebook, которые необходимо проверить.

**Возвращает**:
- `bool`: `True`, если данные группы корректны, `False` в противном случае.

## Лицензия

Модуль является частью пакета **Facebook Promoter** и лицензируется по лицензии MIT.