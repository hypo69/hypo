# Модуль миграции Alembic: добавление столбца payment_id

## Обзор

Этот модуль содержит скрипт миграции Alembic, который добавляет столбец `payment_id` в таблицу `purchases`. Миграция также создает уникальный индекс для этого столбца. Если столбец уже существует, миграция пропускает добавление.

## Подробней

Данный код является частью системы миграций базы данных, используемой в проекте `hypotez`. Миграции позволяют изменять структуру базы данных контролируемым и воспроизводимым образом. В данном случае, миграция добавляет столбец `payment_id` в таблицу `purchases`, что позволяет хранить идентификаторы платежей, связанные с покупками. Уникальный индекс, созданный для этого столбца, обеспечивает уникальность каждого идентификатора платежа в таблице.

## Функции

### `upgrade`

```python
def upgrade() -> None:
    """Добавляет столбец 'payment_id' в таблицу 'purchases', если он еще не существует."""
```

**Описание**: Функция `upgrade` выполняет миграцию базы данных, добавляя столбец `payment_id` в таблицу `purchases`. Она проверяет, существует ли уже столбец `payment_id`, и если нет, добавляет его и создает уникальный индекс `uq_purchases_payment_id`.

**Параметры**:

-   Нет

**Возвращает**:

-   `None`

**Примеры**:

```python
upgrade()
```

### `downgrade`

```python
def downgrade() -> None:
    """Удаляет столбец 'payment_id' из таблицы 'purchases', если он существует."""
```

**Описание**: Функция `downgrade` выполняет откат миграции базы данных, удаляя столбец `payment_id` из таблицы `purchases`. Она проверяет, существует ли столбец `payment_id`, и если да, удаляет его и связанный с ним уникальный индекс `uq_purchases_payment_id`.

**Параметры**:

-   Нет

**Возвращает**:

-   `None`

**Примеры**:

```python
downgrade()
```