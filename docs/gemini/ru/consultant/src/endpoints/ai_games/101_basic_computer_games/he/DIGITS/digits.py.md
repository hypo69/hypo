# Анализ кода модуля `digits.py`

**Качество кода**
8
-  Плюсы
    - Код хорошо структурирован и читаем.
    - Функции имеют четкое назначение.
    - Присутствует обработка ошибок ввода.
    - Есть описание алгоритма и блок-схема.
-  Минусы
    - Отсутствуют docstring в формате reStructuredText (RST).
    - Нет логирования ошибок.
    - Некоторые комментарии после `#` не соответствуют правилам RST.
    - Нет проверки на правильность формата входных данных.

**Рекомендации по улучшению**

1.  **Документация:**
    - Добавить docstring в формате RST для всех функций и модуля.
    - Переписать комментарии после `#` в соответствии с RST.
    - Описать параметры и возвращаемые значения в docstring.

2.  **Логирование:**
    - Использовать `src.logger.logger` для логирования ошибок и отладочной информации.
    - Заменить блоки `try-except` на логирование ошибок через `logger.error`.

3.  **Обработка ввода:**
    - Можно добавить более строгую проверку входных данных, например, через регулярные выражения.

4. **Рефакторинг:**
    - Улучшить читаемость кода с помощью более описательных переменных.

**Оптимизиробанный код**

```python
"""
Модуль для игры "Дигитс"
=========================================================================================

Игра "Дигитс" - это игра в угадывание, где компьютер выбирает случайное число от 100 до 999,
а игрок пытается угадать это число, получая подсказки о положении правильных цифр.

Правила игры:
1. Компьютер выбирает случайное трехзначное число (от 100 до 999).
2. Игрок пытается угадать это число, вводя трехзначное число.
3. Компьютер отвечает, предоставляя подсказки: количество правильно угаданных цифр и их положение.
4. Игра продолжается до тех пор, пока игрок не угадает загаданное число правильно.

Алгоритм:
1. Создать случайное трехзначное число (от 100 до 999).
2. Начать цикл:
   2.1. Получить ввод от пользователя (трехзначное число).
   2.2. Проверить, соответствует ли ввод загаданному числу. Если да, показать сообщение о победе и завершить игру.
   2.3. Если ввод не соответствует, посчитать количество правильных цифр в правильном и неправильном месте.
   2.4. Показать подсказку игроку.
3. Продолжить цикл до правильного угадывания.

Пример использования
--------------------

Пример запуска игры:

.. code-block:: python

    if __name__ == "__main__":
        play_digits()
"""
import random
from src.logger.logger import logger # импорт логгера

def generate_target_number() -> int:
    """
    Генерирует случайное трехзначное число между 100 и 999.

    :return: Случайное трехзначное число.
    :rtype: int
    """
    return random.randint(100, 999)


def compare_digits(target: int, guess: int) -> str:
    """
    Сравнивает цифры в загаданном числе и в предположении пользователя, возвращая подсказки.

    :param target: Загаданное число (трехзначное число).
    :type target: int
    :param guess: Предположение пользователя (трехзначное число).
    :type guess: int
    :return: Строка с подсказками о количестве правильных цифр в правильном и неправильном месте.
    :rtype: str
    """
    target_str = str(target)
    guess_str = str(guess)
    correct_place = 0 # количество цифр на правильном месте
    correct_digit = 0 # количество правильных цифр на неправильном месте

    # подсчет цифр на правильном месте
    for i in range(3):
        if target_str[i] == guess_str[i]:
            correct_place += 1

    # подсчет правильных цифр на неправильном месте
    for i in range(3):
        for j in range(3):
            if i != j and target_str[i] == guess_str[j]:
                correct_digit += 1

    return f"{correct_place} на месте, {correct_digit} правильных не на месте."


def play_digits():
    """
    Управляет процессом игры в "Дигитс".
    """
    target_number = generate_target_number() # генерируется случайное число
    print("Я загадал трехзначное число. Попробуй его угадать!")

    while True:
        try:
            user_guess = int(input("Введите предположение (трехзначное число): ")) # ввод пользователя
        except ValueError as e: #  если ввод не является целым числом
            logger.error(f"Ошибка ввода: {e}") # Логируем ошибку
            print("Пожалуйста, введите корректное трехзначное число.")
            continue

        if not 100 <= user_guess <= 999: # проверяем, что число в диапазоне 100-999
             print("Пожалуйста, введите корректное трехзначное число.")
             continue

        if user_guess == target_number: # если пользователь угадал число
            print("Поздравляю! Вы угадали число!")
            break
        else: # если пользователь не угадал число
            hint = compare_digits(target_number, user_guess) # формируем подсказку
            print(hint) #  выводим подсказку

# запуск игры
if __name__ == "__main__":
    play_digits()
"""
Описание кода:
1.  **Импорт модуля `random` и `logger`**::
    -   `import random`: импортирует модуль `random`, позволяющий генерировать случайные числа.
    -   `from src.logger.logger import logger`: импортирует логгер для записи ошибок и отладочной информации.

2.  **Функция `generate_target_number()`**::
    -   `def generate_target_number() -> int:`: определяет функцию для генерации случайного трехзначного числа.
    -   `return random.randint(100, 999)`: возвращает случайное целое число в диапазоне от 100 до 999.

3.  **Функция `compare_digits(target, guess)`**::
    -   `def compare_digits(target: int, guess: int) -> str:`: определяет функцию для сравнения загаданного числа с предположением пользователя.
    -   `target_str = str(target)` и `guess_str = str(guess)`: преобразует числа в строки для удобного доступа к цифрам.
    -   `correct_place = 0` и `correct_digit = 0`: инициализирует переменные для подсчета правильных цифр на правильном и неправильном местах.
    -   Цикл `for i in range(3):`: перебирает цифры в числе.
    -   `if target_str[i] == guess_str[i]`: проверяет, совпадают ли цифры в одном и том же месте.
    -   `correct_place += 1`: увеличивает счетчик, если цифра на правильном месте.
    -   Вложенный цикл: считает правильные цифры, которые не на своих местах.
    -   `return f"{correct_place} на месте, {correct_digit} правильных не на месте."`: возвращает строку с подсказкой.

4.  **Функция `play_digits()`**::
    -   `def play_digits():`: определяет главную функцию игры.
    -   `target_number = generate_target_number()`: генерирует случайное число, используя функцию `generate_target_number`.
    -   `print("Я загадал трехзначное число. Попробуй его угадать!")`: выводит приветственное сообщение.
    -   `while True:`: запускает бесконечный цикл игры.
    -   Блок `try...except ValueError`: обрабатывает ошибку ввода. Если пользователь вводит не целое число, то ошибка будет перехвачена.
        -   `logger.error(f"Ошибка ввода: {e}")`: логирует ошибку ввода в логгер.
    -   `user_guess = int(input("Введите предположение (трехзначное число): "))`: получает ввод пользователя и преобразует его в целое число.
    -   `if not 100 <= user_guess <= 999:`: проверяет, что введенное число является трехзначным.
    -   `if user_guess == target_number`: проверяет, угадал ли пользователь число.
    -   `print("Поздравляю! Вы угадали число!")`: выводит сообщение о победе.
    -   `break`: завершает цикл.
    -   `else:`: выполняется, если пользователь не угадал число.
    -   `hint = compare_digits(target_number, user_guess)`: формирует строку с подсказкой.
    -   `print(hint)`: выводит подсказку пользователю.

5.  **Запуск игры**::
    -   `if __name__ == "__main__":`: проверяет, запущен ли скрипт напрямую.
    -   `play_digits()`: запускает игру, вызывая функцию `play_digits`.
"""
```