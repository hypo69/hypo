# Модуль graber.py

## Обзор

Модуль `graber.py` предназначен для сбора информации о товарах с сайта `cdata.co.il`. Он расширяет функциональность базового класса `Graber`, предоставляя специфичные методы для обработки данных именно с этого сайта. Включает механизм для предварительной обработки действий перед запросами к веб-драйверу с использованием декораторов.

## Подробней

Этот модуль является частью системы, отвечающей за извлечение данных о товарах из различных онлайн-источников. Он специализируется на парсинге сайта `cdata.co.il`.

Основные особенности:

-   **Наследование от `Graber`**: Модуль наследует базовый класс `Graber`, который предоставляет общую функциональность для парсинга веб-страниц.
-   **Переопределение методов**: В классе `Graber` переопределяются методы для обработки полей, специфичных для сайта `cdata.co.il`.
-   **Декораторы**: Предусмотрена возможность использования декораторов для выполнения предварительных действий перед запросами к веб-драйверу, например, для закрытия всплывающих окон.
-   **Логирование**: Для отладки и контроля работы используются логи.

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для сбора данных о товарах с сайта `cdata.co.il`.

**Наследует**:

-   `Graber` (из `src.suppliers.graber`): Предоставляет базовую функциональность для парсинга веб-страниц.

**Атрибуты**:

-   `supplier_prefix` (str): Префикс поставщика, используемый для идентификации.

**Методы**:

-   `__init__`: Инициализирует экземпляр класса `Graber`, устанавливает префикс поставщика и вызывает конструктор родительского класса.

#### `__init__`

```python
def __init__(self, driver: Driver, lang_index:int):
    """Инициализация класса сбора полей товара."""
    ...
```

**Назначение**: Инициализация экземпляра класса `Graber`.

**Параметры**:

-   `driver` (`Driver`): Экземпляр веб-драйвера, используемый для взаимодействия с веб-страницей.
-   `lang_index` (`int`): Индекс языка, используемый для локализации контента.

**Возвращает**: Ничего.

**Вызывает исключения**: Отсутствуют.

**Как работает функция**:

1.  Устанавливает атрибут `supplier_prefix` равным `'cdata'`.
2.  Вызывает конструктор родительского класса `Graber` с указанием префикса поставщика, драйвера и индекса языка.
3.  Устанавливает значение `Context.locator_for_decorator` в `None`, отключая выполнение декоратора `@close_pop_up`.

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
driver = Driver(Chrome)
graber = Graber(driver, 0)
```
```
Инициализация драйвера -> Установка префикса поставщика -> Вызов конструктора родительского класса -> Отключение декоратора
```

## Функции

### `close_pop_up` (Декоратор)

```python
def close_pop_up(value: Any = None) -> Callable:
    """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

    Args:
        value (Any): Дополнительное значение для декоратора.

    Returns:
        Callable: Декоратор, оборачивающий функцию.
    """
    ...
```

**Назначение**: Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

**Параметры**:

-   `value` (`Any`, optional): Дополнительное значение для декоратора. По умолчанию `None`.

**Возвращает**:

-   `Callable`: Декоратор, оборачивающий функцию.

**Вызывает исключения**: Отсутствуют.

**Как работает функция**:

1.  Определяет внутреннюю функцию `decorator`, которая принимает функцию `func` в качестве аргумента.
2.  Внутри `decorator` определяется асинхронная функция `wrapper`, которая выполняет следующие действия:

    *   Пытается выполнить локатор для закрытия всплывающего окна.
    *   Ловит исключение `ExecuteLocatorException`, если локатор не найден или не может быть выполнен.
    *   Вызывает основную функцию `func` и возвращает ее результат.
3.  Возвращает функцию `decorator`.

**Примеры**:

```python
@close_pop_up()
async def my_function():
    ...
```
```
Определение декоратора -> Определение внутренней функции `decorator` -> Определение асинхронной функции `wrapper` -> Попытка закрытия всплывающего окна -> Вызов основной функции