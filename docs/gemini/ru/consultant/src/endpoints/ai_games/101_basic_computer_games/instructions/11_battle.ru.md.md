# Анализ кода модуля BATTLE

**Качество кода**
7
- Плюсы
    - Документ содержит подробное описание игры и ее механики.
    -  Присутствуют пошаговые инструкции для реализации игры.
    -  Описаны основные игровые ситуации и реакции программы.
- Минусы
    -  Документ не содержит примеров кода, только текстовое описание.
    -  Отсутствует описание структур данных (например, матрица), которые будут использоваться в коде.
    -  Не описана логика проверки ошибок (например, некорректный ввод координат).

**Рекомендации по улучшению**
1. Добавить примеры кода на Python, чтобы наглядно продемонстрировать, как реализовать основные функции игры.
2. Уточнить описание структур данных, которые будут использоваться для представления игрового поля и кораблей.
3. Описать логику проверки ввода координат и обработки ошибок, чтобы сделать игру более надежной.
4. Разбить описание на более логичные блоки, чтобы сделать его более читабельным.
5. Добавить блок с возможными расширениями игры (например, добавление разных типов кораблей).

**Оптимизированный код**
```markdown
### Название игры: **BATTLE** (Симуляция морского сражения)
    
#### Описание
    
:Игра основана на классической игре *Баттлшип*, в которой игрок должен по координатам стрелять по вражеским кораблям, пытаясь потопить их. Игра включает в себя разгадывание зашифрованной матрицы расположения кораблей противника на игровом поле, а также позволяет строить собственную матрицу для отображения попаданий и промахов.
    
---
    
### Пошаговая инструкция для реализации
    
#### 1. **Инициализация игры**
    
   - Игровое поле представляет собой матрицу 6x6, на которой располагаются шесть кораблей:
     - 2 эсминца (два блока)
     - 2 крейсера (три блока)
     - 2 авианосца (четыре блока)
   - Корабли случайным образом размещаются на поле в вертикальном или горизонтальном положении.
   - Задача игрока — разгадать расположение этих кораблей, используя подсказки (попадания, промахи и т.д.).
    
#### 2. **Как использовать матрицу**
    
   - Игровая матрица состоит из числовых координат, где первое число обозначает колонку, а второе — строку.
   - Пример: "3,4" означает 3-ю колонку и 4-ю строку.
    
#### 3. **Основной цикл игры**
    
   - Игрок по очереди вводит координаты, куда он хочет "выстрелить". Каждое введённое значение сравнивается с расположением кораблей противника.
   - Ответ компьютера будет один из следующих:
     - **Splash** — мимо, в этой ячейке нет корабля.
     - **Hit** — попадание по кораблю, но корабль ещё не потоплен.
     - **Sunk** — корабль уничтожен.
    
#### 4. **Подсчёт попаданий**
    
   - Игрок записывает все попадания в свою матрицу, чтобы проследить, какие части кораблей были поражены.
   - После каждого попадания программа обновляет статус потопленных кораблей и выводит текущий счёт (включая количество "splash" и "hit" для расчёта соотношения).
    
#### 5. **Завершение игры**
    
   - Игра завершается, когда все корабли противника будут потоплены. Победителем становится тот, кто первым уничтожит все корабли противника.
    
#### 6. **Подсчёт соотношения Splash/Hit**
    
   - Соотношение *Splash/Hit* показывается как дробь (например, 9 попаданий на 15 промахов = 9/15 или 3/5). Это соотношение может помочь игроку определить, насколько успешны были его действия в игре.
    
---
    
### Пример работы программы
    
1. **Начало игры**:
   ```
   Введите координаты для уничтожения вражеского корабля:
   > 3,4
   Компьютер: Splash! Нет корабля.
   ```
    
2. **Попадание по кораблю**:
   ```
   Введите координаты для уничтожения вражеского корабля:
   > 2,5
   Компьютер: Hit! Корабль повреждён.
   ```
    
3. **Потопление корабля**:
   ```
   Введите координаты для уничтожения вражеского корабля:
   > 5,6
   Компьютер: Sunk! Корабль потоплен!
   ```
    
4. **Вывод результатов**:
   ```
   Игра завершена!
   Вы потопили все корабли противника!
   Итоговый счёт:
   Hits: 15
   Splash: 9
   Соотношение Splash/Hit: 9/15 (0.6)
   ```
    
---
    
### Возможные ограничения
    
- Игрок может вводить некорректные координаты, например, выходящие за пределы поля. Программа должна проверять такие ошибки и предложить повторный ввод.
- Логика игры может быть улучшена для более точных вычислений попаданий и отслеживания состояния кораблей.

---
    
### Примеры кода на Python
    
#### Инициализация игрового поля
    
```python
import random
    
def create_board(size: int) -> list[list[str]]:
    """Создает игровое поле заданного размера.
    
        :param size: Размер игрового поля (например, 6 для матрицы 6x6).
        :return:  Двумерный список, представляющий игровое поле.
    """
    return [[' ' for _ in range(size)] for _ in range(size)]
```
    
#### Размещение кораблей
    
```python
def place_ship(board: list[list[str]], ship_size: int) -> None:
    """ Размещает корабль на игровом поле случайным образом.
        
        :param board: Двумерный список, представляющий игровое поле.
        :param ship_size: Размер корабля (количество блоков).
    """
    size = len(board)
    while True:
        # Код выбирает случайное направление (вертикальное или горизонтальное)
        orientation = random.choice(['horizontal', 'vertical'])
        # Код выбирает случайные координаты для начала размещения корабля
        if orientation == 'horizontal':
            row = random.randint(0, size - 1)
            col = random.randint(0, size - ship_size)
        else:
            row = random.randint(0, size - ship_size)
            col = random.randint(0, size - 1)
    
        # Код проверяет, можно ли разместить корабль в выбранных координатах
        if is_valid_placement(board, row, col, ship_size, orientation):
            # Код размещает корабль на поле
            if orientation == 'horizontal':
                for i in range(ship_size):
                    board[row][col + i] = 'S'  
            else:
                for i in range(ship_size):
                    board[row + i][col] = 'S'
            break

def is_valid_placement(board: list[list[str]], row: int, col: int, ship_size: int, orientation: str) -> bool:
    """ Проверяет, можно ли разместить корабль в указанных координатах.
        
        :param board: Двумерный список, представляющий игровое поле.
        :param row: Координата строки для начала размещения корабля.
        :param col: Координата колонки для начала размещения корабля.
        :param ship_size: Размер корабля (количество блоков).
        :param orientation: Ориентация корабля ('horizontal' или 'vertical').
        :return:  Возвращает True, если размещение допустимо, иначе False.
    """
    size = len(board)
    if orientation == 'horizontal':
        for i in range(ship_size):
            if col + i >= size or board[row][col + i] == 'S':
                return False
    else:
        for i in range(ship_size):
             if row + i >= size or board[row + i][col] == 'S':
                return False
    return True
```
    
#### Обработка выстрела
```python
def process_shot(board: list[list[str]], row: int, col: int) -> str:
    """Обрабатывает выстрел игрока и возвращает результат.
        
        :param board: Двумерный список, представляющий игровое поле.
        :param row: Координата строки выстрела.
        :param col: Координата колонки выстрела.
        :return:  Результат выстрела ('Splash', 'Hit', 'Sunk').
    """
    if board[row][col] == 'S':
        board[row][col] = 'X'  # Помечаем попадание
        if is_ship_sunk(board, row, col):
             return 'Sunk'
        return 'Hit'
    else:
        return 'Splash'

def is_ship_sunk(board: list[list[str]], row: int, col: int) -> bool:
    """ Проверяет, потоплен ли корабль, после попадания.
        
        :param board: Двумерный список, представляющий игровое поле.
        :param row: Координата строки попадания.
        :param col: Координата колонки попадания.
        :return: Возвращает True, если корабль потоплен, иначе False.
    """
    size = len(board)
    
    # Код проверяет горизонтальные направления
    for i in range(max(0, col - 4), min(size, col + 4)):
      if board[row][i] == 'S':
            return False
    # Код проверяет вертикальные направления
    for i in range(max(0, row - 4), min(size, row + 4)):
      if board[i][col] == 'S':
          return False
    return True
```
    
####  Пример основного цикла игры
```python
def play_game():
    """Запускает основную игру"""
    size = 6
    board = create_board(size)
    
    # Размещаем корабли на поле
    ships = [2, 2, 3, 3, 4, 4]
    for ship_size in ships:
        place_ship(board, ship_size)
    
    hits = 0
    misses = 0
    ships_sunk = 0
    while ships_sunk < len(ships):
        try:
            coords = input('Введите координаты для выстрела (например, 3,4): ')
            col, row = map(int, coords.split(','))
            if not (0 <= row < size and 0 <= col < size):
                  print('Некорректные координаты! Пожалуйста, введите координаты в пределах игрового поля.')
                  continue
        except (ValueError, TypeError):
            print('Некорректный ввод! Пожалуйста, введите координаты в формате "x,y"')
            continue
        
        result = process_shot(board, row, col)
        print(f'Компьютер: {result}!')
        if result == 'Hit':
              hits += 1
        elif result == 'Splash':
              misses += 1
        elif result == 'Sunk':
              hits += 1
              ships_sunk += 1
        # Код проверяет окончание игры
    print('Игра завершена!')
    print('Вы потопили все корабли противника!')
    print(f'Итоговый счёт:\n  Hits: {hits}\n  Splash: {misses}')
    print(f'Соотношение Splash/Hit: {misses}/{hits} ({(misses / hits) if hits else "undefined"})')
```
```python
if __name__ == '__main__':
    play_game()
```
    
---

### Возможные расширения
1. **Разные типы кораблей:** Добавить корабли разного размера и типа (например, подлодки, линкоры).
2. **Усложнение правил:** Добавить ограничения по количеству выстрелов или ввести бонусы за точные попадания.
3. **Режим для двух игроков:** Реализовать возможность игры двух игроков на одном компьютере.
4. **Интерфейс пользователя:** Создать графический интерфейс для более удобного взаимодействия с игрой.
```