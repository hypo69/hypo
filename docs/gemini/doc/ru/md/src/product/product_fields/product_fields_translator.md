# Модуль `product_fields_translator`

## Обзор

Модуль `product_fields_translator` отвечает за перевод полей товара на языки клиентской базы данных. Он обрабатывает данные из словаря `presta_fields_dict`, содержащего поля товара с мультиязычной поддержкой, и адаптирует их к схеме языков клиента (`client_langs_schema`).

## Функции

### `rearrange_language_keys`

**Описание**: Функция обновляет идентификатор языка в словаре `presta_fields_dict` на соответствующий идентификатор из схемы языков клиента, если язык страницы совпадает.

**Параметры**:

- `presta_fields_dict` (dict): Словарь полей товара.
- `client_langs_schema` (list | dict): Схема языков клиента.
- `page_lang` (str): Язык страницы.

**Возвращает**:

- dict: Обновленный словарь `presta_fields_dict`.

### `translate_presta_fields_dict`

**Описание**: Переводит мультиязычные поля в соответствии со схемой значений `id` языка в базе данных клиента.  Функция получает словарь `presta_fields_dict` с данными полей товара, полученными от поставщика.  Мультиязычные поля содержат данные в формате словаря с ключом `language`, внутри которого находятся записи с атрибутами `attrs` (включая `id` языка) и значением `value`.

**Параметры**:

- `presta_fields_dict` (dict): Словарь полей товара от поставщика.
- `client_langs_schema` (list | dict): Схема языков клиента.
- `page_lang` (str, optional): Язык страницы. По умолчанию `None`.  Если не задан, функция пытается определить язык по тексту.

**Возвращает**:

- dict: Переведенный словарь полей товара `presta_fields_dict`.

**Обрабатываемые исключения**:

- `ProductFieldException`: Возникает в случае ошибок при работе с полями товара.

**Примечания**:

* Функция `translate_presta_fields_dict` использует `rearrange_language_keys` для предварительной обработки данных.
* Она использует данные из таблицы переводов (`get_translations_from_presta_translations_table`) для заполнения значений перевода.
* Если перевод не найден, функция создаёт запись в таблице и возвращает обновлённый словарь.
* Обработка исключений (`try...except`) важна для логгирования ошибок и предотвращения сбоя приложения при проблемах с переводом.


```