# Модуль show_all_results.js

## Обзор

Этот модуль отвечает за отображение результатов поиска, полученных из расширения `tryxpath`. Он обрабатывает данные, полученные от контекста и основного поиска, заполняя соответствующие элементы на странице.  Модуль также предоставляет возможности экспорта данных в текстовые файлы.

## Функции

### `showAllResults`

**Описание**: Функция отображает результаты поиска, заполняя элементы страницы данными из объекта `results`.

**Параметры**:
- `results` (объект): Объект, содержащий результаты поиска.  Ожидается, что он содержит информацию о запросе, контексте поиска, основных результатах и других необходимых деталях.

**Вызывает исключения**:
- `fu.onError`: Обрабатывает исключения, возникшие при обновлении таблиц с помощью функции `fu.updateDetailsTable`.


### `makeTextDownloadUrl`

**Описание**: Функция создаёт URL для загрузки текстового файла.

**Параметры**:
- `text` (строка): Текст, который нужно сохранить в файл.

**Возвращает**:
- `URL`: URL для скачивания текстового файла.

### `makeInfoText`

**Описание**: Функция формирует текстовое представление результатов поиска для экспорта.

**Параметры**:
- `results` (объект): Объект, содержащий результаты поиска.

**Возвращает**:
- `строка`: Текстовое представление результатов в формате, подходящем для экспорта в текстовый файл.

### `makeConvertedInfoText`

**Описание**:  Аналогична функции `makeInfoText`, но дополнительно преобразует значения `value` и `textContent` в JSON строку.

**Параметры**:
- `results` (объект): Объект, содержащий результаты поиска.


**Возвращает**:
- `строка`: Текстовое представление результатов в формате, подходящем для экспорта в текстовый файл с JSON представлением.


## Вспомогательные функции (из tryxpath.functions)

Эти функции не описаны в текущем коде, но предполагается, что они используются в `showAllResults`.  Их описание не может быть предоставлено без исходного кода модуля `tryxpath.functions`.

### `fu.updateDetailsTable`

**Описание**: Обновляет таблицу с деталями результата.

**Параметры**:
- `mainTbody` (элемент `tbody`): Элемент таблицы для обновления.
- `main.itemDetails` (массив): Массив с деталями.
- `options` (объект): Параметры, такие как `headerValues` и `detailKeys`.


**Вызывает исключения**:
- `catch(fu.onError)`: Обрабатывает исключения, возникшие при работе с таблицей.

### `fu.onError`

**Описание**: Обработчик ошибок, который скорее всего используется в других функциях.

**Параметры**:
- `error`:  объект ошибки.

**Вызывает исключения**:
- Не указано.

### `fu.makeDetailText`

**Описание**:  Функция создания строки с деталями.

**Параметры**:
- `detail`: элемент детали.
- `keys`: массив ключей для доступа к деталям.
- `separator`: Разделитель для элементов в строке.
- `options`:  Дополнительные опции для форматирования (например, преобразования в JSON).


**Возвращает**:
- `строка`: Строка с деталями в определённом формате.



## Обработчик событий

Модуль содержит обработчик события `load`, который инициирует запрос к браузерному расширению за результатами поиска.  Обработчики событий для таблиц `context-detail` и `main-details` предназначены для обработки кликов по кнопкам в таблицах и отправки соответствующих сообщений браузерному расширению для выделения найденных элементов в окне браузера.


## Замечания

-  Модуль использует  `tryxpath` и `tryxpath.functions`, предполагая, что они доступны в текущем контексте.
-  В коде имеются ссылки на элементы страницы (`document.getElementById(...)`), что предполагает, что эти элементы существуют на странице, где будет использоваться модуль.
-  Для корректной работы требуется функция `fu.makeDetailText` из `tryxpath.functions`.
-  Функции `makeInfoText` и `makeConvertedInfoText` создают  JSON-представление для экспорта, что может быть полезным для дальнейшей обработки данных.