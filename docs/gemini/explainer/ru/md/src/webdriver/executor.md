# executor.py

```markdown
## hypotez/src/webdriver/executor.py

**Описание:**

Этот модуль предоставляет инструменты для взаимодействия с веб-элементами с помощью Selenium.  Он обрабатывает различные запросы к веб-элементам, включая нажатия, отправку сообщений, выполнение событий и получение атрибутов.  Важной особенностью является поддержка обработки ошибок для обеспечения устойчивости при работе с динамическими веб-страницами. Модуль поддерживает как одиночные, так и множественные локейторы, позволяя взаимодействовать с одним или несколькими элементами одновременно.


**Ключевые классы и функции:**


* **`ExecuteLocator`:**  Главный класс для управления взаимодействием с веб-элементами.
    * `execute_locator()`: Центральная функция для выполнения действий с заданным локейтором. Она определяет и обрабатывает различные типы действий, например, отправку сообщений (send_message), взятие скриншотов, клики и прочие. Присутствует гибкая настройка таймаутов и обработки ошибок.
    * `evaluate_locator()`: Обрабатывает атрибуты локейтора, выполняя, например, замены символов в соответствии с шаблонами.
    * `get_attribute_by_locator()`:  Получает атрибуты у найденного элемента (или списка элементов) по заданному локейтору. Включает в себя обработку сложных запросов, включая получение атрибутов по ключу-значению (из строки).
    * `get_webelement_by_locator()`:  Находит веб-элемент(ы) по локейтору с поддержкой таймаутов и разных режимов ожидания. Важно, что эта функция используется и для получения единственного элемента, и для получения списка элементов.
    * `get_webelement_as_screenshot()`:  Создаёт скриншот указанного элемента.
    * `execute_event()`: Выполняет события, заданные в локейторе (например, клик, ввод текста).  Обрабатывает различные типы событий и предоставляет возможность задания скорости ввода текста.
    * `send_message()`: Функция для отправки сообщений в веб-элемент, поддерживает замену символов,  быстрый ввод, и работу со списком сообщений.


**Архитектура и дизайн:**

Модуль использует `SimpleNamespace` для гибкого представления данных локейтора, что упрощает передачу информации.  Акцент на асинхронном программировании (`asyncio`) через `asyncio.to_thread()` позволяет избегать блокировок и улучшает отзывчивость программы.  Использование `selenium.webdriver` гарантирует корректное взаимодействие с веб-драйвером.


**Примечания:**

* **Обработка ошибок:**  Модуль активно использует обработку исключений (`try...except`) для устойчивой работы и логирования ошибок.
* **Логирование:** Модуль использует `logger` для записи сообщений об ошибках и отладки.
* **Таймауты:** Введены таймауты для ожидания загрузки элементов, что делает код более надежным.
* **Переменная `MODE`:**  Позволяет контролировать уровень детализации логов ('dev', 'debug').
* **`_parse_elements_list`:**  Функция для обработки списка найденных элементов (например, выбор первого, последнего, или чётных/нечётных).


**Рекомендации по использованию:**

Чтобы использовать функции модуля, создайте экземпляр класса `ExecuteLocator`, передав в него драйвер Selenium.  Затем вызовите соответствующие методы для выполнения действий с веб-элементами.  Обратите внимание на структуру локейтора (`locator`), она должна быть в формате словаря или `SimpleNamespace` для корректного взаимодействия.
```
```