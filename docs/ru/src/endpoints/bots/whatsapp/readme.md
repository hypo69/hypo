# Документация для автоматизированной отправки сообщений WhatsApp

## Обзор

Этот документ предоставляет руководство по созданию скрипта Python для автоматической отправки сообщений WhatsApp. Пользователь может настроить количество отправляемых сообщений и временной диапазон. Для стабильной работы необходимо следить за обновлениями библиотек и веб-версии WhatsApp.

## Подробнее

Данный код используется для автоматизации отправки сообщений в WhatsApp через Python. Скрипт позволяет задать количество сообщений для отправки и временной интервал, в котором эти сообщения будут отправлены. Он предназначен для разработчиков с базовыми знаниями Python и опытом работы с командной строкой. Важно следить за обновлениями библиотек и изменениями в веб-версии WhatsApp, чтобы обеспечить стабильную работу скрипта.

## Оглавление

- [Необходимые компоненты](#необходимые-компоненты)
- [Процесс разработки](#процесс-разработки)
  - [Функция отправки сообщений (`send_whatsapp_message`)](#функция-отправки-сообщений-send_whatsapp_message)
  - [Банк сообщений](#банк-сообщений)
  - [Пользовательский ввод](#пользовательский-ввод)
  - [Основной цикл отправки](#основной-цикл-отправки)
- [Возможные проблемы и решения](#возможные-проблемы-и-решения)

## Необходимые компоненты

### 2.1. Библиотеки Python:

-   `pywhatkit`: Для взаимодействия с веб-версией WhatsApp и отправки сообщений.
-   `pyautogui`: Для автоматизации действий мыши и клавиатуры.
-   `pynput`: Для контроля клавиатурного ввода.
-   `emoji`: Для добавления эмодзи в сообщения.
-   `random`: Для генерации случайных сообщений и времени.
-   `time`: Для управления задержками и временем выполнения.

### 2.2. Зависимости:

Установка указанных библиотек выполняется посредством pip:

```bash
pip install pywhatkit pyautogui pynput emoji
```

### 2.3. Требования к системе:

Операционная система с установленным веб-браузером (например, Chrome или Firefox) и возможностью подключения к WhatsApp Web.

## Процесс разработки

### Функция отправки сообщений (`send_whatsapp_message`)

**Описание**: Отправляет сообщение WhatsApp заданному номеру телефона в указанное время.

**Как работает функция**:
1.  Использует `pywhatkit.sendwhatmsg` для инициализации отправки сообщения.
2.  Применяет `time.sleep` для задержки загрузки веб-версии WhatsApp.
3.  Применяет `pyautogui` и `pynput` для имитации нажатия клавиши "Enter" для отправки сообщения.
4.  Обрабатывает исключения с помощью блока `try...except` для вывода ошибок.

**Параметры**:

-   `phone_number` (str): Номер телефона получателя (с кодом страны).
-   `message` (str): Текст сообщения.
-   `hour` (int): Час отправки сообщения (0-23).
-   `minutes` (int): Минуты отправки сообщения (0-59).

```python
def send_whatsapp_message(phone_number: str, message: str, hour: int, minutes: int) -> None:
    """
    Отправляет сообщение WhatsApp заданному номеру телефона в указанное время.

    Args:
        phone_number (str): Номер телефона получателя (с кодом страны).
        message (str): Текст сообщения.
        hour (int): Час отправки сообщения (0-23).
        minutes (int): Минуты отправки сообщения (0-59).

    Returns:
        None

    Raises:
        Exception: Если возникает ошибка при отправке сообщения.

    Example:
        >>> send_whatsapp_message('+1234567890', 'Hello, world!', 10, 30)
    """
    ...
```

### Банк сообщений

**Описание**: Создает и управляет списком сообщений для отправки.

**Как работает функция**:
1.  Создает список строк (`messages`) для хранения сообщений.
2.  Использует `emoji.emojize` для добавления эмодзи.
3.  Применяет `random.choice` для случайного выбора сообщения.

```python
def create_message_bank() -> list[str]:
    """
    Создает список сообщений для отправки.

    Returns:
        list[str]: Список сообщений.

    Example:
        >>> create_message_bank()
        ['Привет! :wave:', 'Как дела? :question:', ...]
    """
    ...
```

### Пользовательский ввод

**Описание**: Получает от пользователя количество сообщений, начальный и конечный часы для отправки.

**Как работает функция**:
1.  Получает количество сообщений (`num_messages`) с помощью функции `input`.
2.  Получает начальный час (`start_hour`) и конечный час (`end_hour`) диапазона отправки с помощью `input`.

```python
def get_user_input() -> tuple[int, int, int]:
    """
    Получает от пользователя количество сообщений, начальный и конечный часы для отправки.

    Returns:
        tuple[int, int, int]: Кортеж, содержащий количество сообщений, начальный час и конечный час.

    Example:
        >>> get_user_input()
        (10, 9, 17)
    """
    ...
```

### Основной цикл отправки

**Описание**: Организует цикл отправки сообщений в заданном количестве и временном диапазоне.

**Как работает функция**:
1.  Цикл `while` выполняется, пока счетчик сообщений (`message_count`) не достигнет заданного количества (`num_messages`).
2.  Генерирует случайный час и минуты с помощью `random.randint`.
3.  Вызывает функцию `send_whatsapp_message` с полученными данными.
4.  Увеличивает счетчик сообщений.

```python
def main_loop(num_messages: int, start_hour: int, end_hour: int) -> None:
    """
    Организует цикл отправки сообщений в заданном количестве и временном диапазоне.

    Args:
        num_messages (int): Количество сообщений для отправки.
        start_hour (int): Начальный час диапазона отправки.
        end_hour (int): Конечный час диапазона отправки.

    Returns:
        None

    Example:
        >>> main_loop(5, 9, 17)
    """
    ...
```

## Возможные проблемы и решения

*   **4.1. Проблемы с `pywhatkit`:** В случае неудачной автоматической отправки сообщения, использовать `pyautogui` и `pynput` для эмуляции нажатия клавиш и отправки сообщения.
*   **4.2. Подключение к WhatsApp Web:** При первом использовании необходимо подключение к веб-версии WhatsApp через веб-браузер.
*   **4.3. Динамическая задержка:** Скорость загрузки веб-версии WhatsApp может меняться, поэтому для стабильности увеличьте время задержки.
*   **4.4. Зависимость от браузера и версии WhatsApp:** Изменения в браузере или веб-версии WhatsApp могут потребовать корректировки скрипта.