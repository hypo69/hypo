# Модуль Ails

## Обзор

Модуль предоставляет класс `Utils` и функцию `_create_completion` для взаимодействия с API ai.ls.
Он включает в себя функции для создания хешей, форматирования временных меток и выполнения запросов к API для получения ответов от модели GPT-3.5 Turbo.

## Подробнее

Этот модуль используется для связи с сервисом ai.ls и получения ответов от языковой модели GPT-3.5 Turbo.
Он создает необходимые заголовки и параметры запроса, форматирует данные и обрабатывает ответы, возвращая токены сгенерированного текста.

## Классы

### `Utils`

**Описание**: Класс содержит статические методы для выполнения различных вспомогательных задач, таких как хеширование данных и форматирование временных меток.

#### `hash`

```python
def hash(json_data: Dict[str, str]) -> sha256:
    """
    Вычисляет SHA256 хеш на основе предоставленных JSON-данных.

    Args:
        json_data (Dict[str, str]): Словарь с данными, используемыми для генерации хеша.

    Returns:
        sha256: SHA256 хеш, представленный в виде шестнадцатеричной строки.

    Как работает функция:
    1. Определяет секретный ключ в виде массива байтов.
    2. Формирует строку base_string, используя значения из json_data и фиксированную строку.
    3. Вычисляет SHA256 хеш от base_string.

    ASCII flowchart:
    JSON данные --> Формирование base_string --> Вычисление SHA256 хеша --> Возврат хеша

    """
```

#### `format_timestamp`

```python
def format_timestamp(timestamp: int) -> str:
    """
    Форматирует timestamp, чтобы он соответствовал определенному формату.

    Args:
        timestamp (int): Timestamp для форматирования.

    Returns:
        str: Отформатированный timestamp в виде строки.

    Как работает функция:
    1. Вычисляет остаток от деления timestamp на 10.
    2. Если остаток четный, добавляет 1 к нему; иначе оставляет без изменений.
    3. Вычитает исходный остаток из timestamp и добавляет новый остаток.
    4. Возвращает результат в виде строки.

    ASCII flowchart:
    Timestamp --> Вычисление остатка --> Корректировка остатка (если нужно) --> Форматирование и возврат

    """
```

## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, temperature: float = 0.6, stream: bool = False, **kwargs):
    """
    Создает запрос к API для получения ответа от языковой модели.

    Args:
        model (str): Название модели для использования.
        messages (list): Список сообщений для отправки в модель.
        temperature (float): Температура для контроля случайности ответов модели. По умолчанию 0.6.
        stream (bool): Определяет, будет ли ответ возвращаться в виде потока. По умолчанию False.
        **kwargs: Дополнительные параметры.

    Returns:
        Generator[str, None, None]: Генератор токенов, полученных от модели.

    Как работает функция:
    1. Определяет заголовки, необходимые для запроса к API.
    2. Формирует параметры запроса.
    3. Генерирует timestamp и подпись (sig) для запроса.
    4. Создает JSON-данные для отправки в запросе, включая модель, температуру, сообщения и подпись.
    5. Отправляет POST-запрос к API и обрабатывает ответ в виде потока, извлекая и возвращая токены.

    ASCII flowchart:
    Входные параметры --> Формирование заголовков и параметров запроса --> Создание JSON-данных -->
    POST-запрос к API --> Обработка ответа в виде потока --> Извлечение и возврат токенов

    """