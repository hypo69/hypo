# Модуль для взаимодействия с You.com

## Обзор

Модуль предоставляет функциональность для взаимодействия с моделью `gpt-3.5-turbo` через API You.com. Он использует подпроцесс для выполнения скрипта `you.py`, который, в свою очередь, взаимодействует с API You.com. Модуль поддерживает потоковую передачу данных и не требует аутентификации.

## Подробней

Модуль предназначен для отправки запросов к You.com и получения ответов в потоковом режиме. Он использует подпроцесс для запуска скрипта `you.py`, который выполняет фактическое взаимодействие с API You.com. Это позволяет избежать блокировки основного процесса и обеспечивает более гибкое управление запросами.

## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, stream: bool, **kwargs):
    """Создает запрос на завершение текста с использованием API You.com.

    Args:
        model (str): Название модели для использования.
        messages (list): Список сообщений для отправки в API.
        stream (bool): Флаг, указывающий, нужно ли использовать потоковую передачу данных.
        **kwargs: Дополнительные аргументы.

    Returns:
        Generator[str, None, None]: Генератор строк, содержащий ответы от API You.com.

    Raises:
        Exception: Если возникает ошибка при взаимодействии с API You.com.
    """
```

**Как работает функция**:

1. **Подготовка данных**:
   - Функция принимает модель, список сообщений и флаг потоковой передачи.
   - Преобразует список сообщений в JSON-строку.

2. **Запуск подпроцесса**:
   - Определяет путь к скрипту `you.py`.
   - Формирует команду для запуска скрипта `you.py` с использованием `python3` и передает JSON-строку в качестве аргумента.
   - Запускает подпроцесс с перенаправлением стандартного вывода и ошибок в канал.

3. **Обработка потока данных**:
   - Читает вывод подпроцесса построчно.
   - Декодирует каждую строку из байтов в UTF-8.
   - Возвращает строку через `yield`, что позволяет использовать функцию как генератор.

4. **Завершение**:
   - Функция продолжает читать и возвращать строки до тех пор, пока подпроцесс не завершится и не закроет канал.

**Примеры**:

```python
# Пример использования функции _create_completion
messages = [{"role": "user", "content": "Hello, how are you?"}]
for chunk in _create_completion(model="gpt-3.5-turbo", messages=messages, stream=True):
    print(chunk, end="")