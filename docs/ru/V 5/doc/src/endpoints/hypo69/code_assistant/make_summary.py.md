# Модуль `make_summary`

## Обзор

Модуль `make_summary` предназначен для автоматического создания файла `SUMMARY.md`, который используется для формирования структуры книги в формате `mdbook`. Он рекурсивно обходит указанную директорию с исходными файлами в формате Markdown (`.md`) и генерирует содержание книги, фильтруя файлы по языку (русский или английский). Подробнее о `mdbook` можно узнать по ссылке: https://chatgpt.com/share/6742f054-aaa0-800d-9f84-0ab035a2a2c2.

## Подробнее

Этот модуль является частью проекта `hypotez` и используется для автоматизации процесса создания документации. Он сканирует директорию `src` в поисках `.md` файлов, формирует структуру `SUMMARY.md` и сохраняет его в директории `docs`. Фильтрация по языкам позволяет создавать отдельные версии документации для каждого языка.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `make_summary`

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md, рекурсивно обходя папку.

    Args:
        docs_dir (Path): Путь к исходной директории 'src'.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
```

**Как работает функция**:
Функция `make_summary` принимает путь к директории с документацией (`docs_dir`) и язык (`lang`) в качестве аргументов. Она вызывает функцию `prepare_summary_path` для определения пути к файлу `SUMMARY.md`, создает необходимые директории и вызывает функцию `_make_summary` для фактического создания содержимого файла.

**Параметры**:
- `docs_dir` (Path): Путь к исходной директории `src`.
- `lang` (str, optional): Язык фильтрации файлов. Возможные значения: `ru` или `en`. По умолчанию `en`.

**Возвращает**:
- `None`: Функция ничего не возвращает.

**Вызывает исключения**:
- Не вызывает исключений напрямую, но может возникнуть исключение при создании директории или записи в файл.

**Примеры**:

```python
from pathlib import Path

# Предположим, что PROJECT_ROOT определен где-то в вашем коде
PROJECT_ROOT = Path('/путь/к/вашему/проекту')
docs_dir = PROJECT_ROOT / 'src'
make_summary(docs_dir, 'ru')
```

### `_make_summary`

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
```

**Как работает функция**:
Функция `_make_summary` рекурсивно обходит указанную директорию (`src_dir`) в поисках файлов `.md`. Она открывает файл `SUMMARY.md` для записи и добавляет в него ссылки на найденные файлы. Файлы фильтруются по языку в соответствии с параметром `lang`. Если `lang` равен `ru`, то добавляются только файлы с суффиксом `.ru.md`. Если `lang` равен `en`, то файлы с суффиксом `.ru.md` пропускаются.

**Параметры**:
- `src_dir` (Path): Путь к папке с исходниками `.md`.
- `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`.
- `lang` (str, optional): Язык фильтрации файлов. Возможные значения: `ru` или `en`. По умолчанию `en`.

**Возвращает**:
- `bool`: Возвращает `True` в случае успешного создания файла `SUMMARY.md`, `False` в случае ошибки.

**Вызывает исключения**:
- Может возникнуть исключение при открытии или записи файла.

**Примеры**:

```python
from pathlib import Path

# Предположим, что PROJECT_ROOT определен где-то в вашем коде
PROJECT_ROOT = Path('/путь/к/вашему/проекту')
src_dir = PROJECT_ROOT / 'src'
summary_file = PROJECT_ROOT / 'docs' / 'SUMMARY.md'
_make_summary(src_dir, summary_file, 'ru')
```

### `prepare_summary_path`

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути 'src' на 'docs' и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с 'src'.
        file_name (str): Имя файла, который нужно создать. По умолчанию 'SUMMARY.md'.

    Returns:
        Path: Новый путь к файлу.
    """
```

**Как работает функция**:
Функция `prepare_summary_path` формирует путь к файлу `SUMMARY.md` на основе исходного пути `src_dir`. Она заменяет часть пути `src` на `docs` и добавляет имя файла `file_name`. Функция использует глобальную переменную `PROJECT_ROOT` для определения корневого пути проекта.

**Параметры**:
- `src_dir` (Path): Исходный путь с `src`.
- `file_name` (str, optional): Имя файла, который нужно создать. По умолчанию `SUMMARY.md`.

**Возвращает**:
- `Path`: Новый путь к файлу.

**Вызывает исключения**:
- Не вызывает исключений.

**Примеры**:

```python
from pathlib import Path

# Предположим, что PROJECT_ROOT определен где-то в вашем коде
PROJECT_ROOT = Path('/путь/к/вашему/проекту')
src_dir = PROJECT_ROOT / 'src'
summary_file = prepare_summary_path(src_dir)
print(summary_file)  # Вывод: /путь/к/вашему/проекту/docs/SUMMARY.md
```