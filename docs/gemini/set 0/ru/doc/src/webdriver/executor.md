# Модуль hypotez/src/webdriver/executor.py

## Обзор

Модуль `executor` предназначен для выполнения действий над веб-элементами на основе предоставленных конфигураций, известных как "локато́ры". Эти конфигурации (локато́ры) представляют собой словари, содержащие информацию о том, как найти и взаимодействовать с элементами на веб-странице. Модуль предоставляет следующие функциональности:

1. **Парсинг и обработка локато́ров**: Преобразование словарей с конфигурациями в объекты `SimpleNamespace`, что позволяет гибко управлять данными локато́ра.
2. **Взаимодействие с веб-элементами**: В зависимости от предоставленных данных, модуль может выполнять различные действия, такие как клики, отправка сообщений, выполнение событий и получение атрибутов веб-элементов.
3. **Обработка ошибок**: Модуль поддерживает продолжение выполнения в случае ошибки, что позволяет обрабатывать веб-страницы с нестабильными элементами или требующими специального подхода.
4. **Поддержка нескольких типов локато́ров**: Обрабатывает как одиночные, так и множественные локато́ры, позволяя идентифицировать и взаимодействовать с одним или несколькими веб-элементами одновременно.

Этот модуль обеспечивает гибкость и универсальность при работе с веб-элементами, что позволяет автоматизировать сложные сценарии взаимодействия с веб-страницами.


## Классы

### `ExecuteLocator`

**Описание**: Обработчик локато́ров для веб-элементов, использующий Selenium.

**Атрибуты**:
- `driver`: Опциональный драйвер Selenium.
- `actions`: Объект `ActionChains` для взаимодействия с элементами. Инициализируется в `__post_init__`.
- `by_mapping`: Словарь для отображения типов локато́ров (XPATH, ID, TAG_NAME и т.д.) на соответствующие значения `By`.
- `mode`: Режим работы (по умолчанию `'debug'`).

**Методы**:

#### `execute_locator`

**Описание**: Выполняет действия над веб-элементом на основе предоставленного локато́ра.

**Параметры**:
- `locator`: Данные локато́ра (словарь или `SimpleNamespace`).
- `timeout`: Таймаут для поиска элемента.
- `timeout_for_event`: Условие ожидания (`'presence_of_element_located'`, `'element_to_be_clickable'`).
- `message`: Опциональное сообщение для отправки.
- `typing_speed`: Скорость ввода для событий `send_keys`.
- `continue_on_error`: Флаг, указывающий на необходимость продолжения при ошибке.

**Возвращает**:
- `str | list | dict | WebElement | bool`: Результат в зависимости от инструкций локато́ра.

**Вызывает исключения**:
- `ElementClickInterceptedException`: Если клик перехвачен.
- `JavascriptException`: Если произошла ошибка JavaScript.
- `NoSuchElementException`: Если элемент не найден.
- `StaleElementReferenceException`: Если ссылка на элемент устарела.
- `TimeoutException`: Если таймаут истек.
- `WebDriverException`: Базовое исключение Selenium.
- Исключения, возникающие внутри других методов.

#### `evaluate_locator`

**Описание**: Оценивает и обрабатывает атрибуты локато́ра.

**Параметры**:
- `attribute`: Атрибуты для оценки.

**Возвращает**:
- `str | list | dict`: Оцененные атрибуты.


#### `get_attribute_by_locator`

**Описание**: Извлекает атрибуты элемента или списка элементов, найденных по заданному локато́ру.

**Параметры**:
- `locator`: Локатор (словарь или `SimpleNamespace`).
- `timeout`: Максимальное время ожидания.
- `timeout_for_event`: Тип условия ожидания.

**Возвращает**:
- `WebElement | list[WebElement] | None`: Значение атрибута(ов) или словарь с атрибутами.

#### `get_webelement_by_locator`

**Описание**: Извлекает веб-элементы по локато́ру.

**Параметры**:
- `locator`: Данные локато́ра.
- `timeout`: Максимальное время ожидания.
- `timeout_for_event`: Тип условия ожидания.

**Возвращает**:
- `WebElement | List[WebElement] | None`: Найденный веб-элемент или список элементов.


#### `get_webelement_as_screenshot`

**Описание**: Делает скриншот найденного веб-элемента.

**Параметры**:
- `locator`: Данные локато́ра.
- `timeout`: Максимальное время ожидания.
- `timeout_for_event`: Тип условия ожидания.
- `webelement`: Предварительно найденный веб-элемент (опционально).

**Возвращает**:
- `BinaryIO | None`: Бинарный поток скриншота или `None` при неудаче.

#### `execute_event`

**Описание**: Выполняет события, связанные с локато́ром.

**Параметры**:
- `locator`: Локатор, содержащий события.
- `timeout`: Таймаут для поиска элемента.
- `timeout_for_event`: Таймаут ожидания события.
- `message`: Сообщение для отправки.
- `typing_speed`: Скорость печати.

**Возвращает**:
- `bool`: `True`, если выполнение прошло успешно, `False` иначе.

#### `send_message`

**Описание**: Отправляет сообщение веб-элементу.

**Параметры**:
- `locator`: Данные локато́ра.
- `timeout`: Таймаут для поиска элемента.
- `timeout_for_event`: Таймаут ожидания события.
- `message`: Сообщение для отправки.
- `typing_speed`: Скорость печати.

**Возвращает**:
- `bool`: `True` - если сообщение успешно отправлено, `False` - иначе.


## Функции

(Подробные описания функций тут)