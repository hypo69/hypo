```markdown
# whatwg-url

This library provides a full implementation of the WHATWG URL Standard.  It can be used independently or to integrate a robust URL parser into projects like jsdom.

## Status

The current version of `whatwg-url` is up to date with the URL spec up to commit `a62223`.

## API Overview

The library exposes two main interfaces: a high-level `URL` constructor, and a set of low-level functions for advanced use cases (e.g., jsdom).

### High-Level API: `URL` Constructor

The primary entry point for most users is the `URL` constructor, which directly mirrors the behavior of the WHATWG URL specification, including handling of `USVString` conversions.

### Low-Level API: URL Standard Functions

These functions offer granular control over URL parsing and serialization.  They are primarily intended for use by projects requiring finer-grained control, like jsdom.

* **`parseURL(input, { baseURL, encodingOverride })`:** Parses a URL string.
* **`basicURLParse(input, { baseURL, encodingOverride, url, stateOverride })`:** A low-level parser, with more direct control over parsing state. Critically important for internal usage in projects like jsdom. `stateOverride` allows you to control the parsing state, enabling state management as needed.
* **`serializeURL(urlRecord, excludeFragment)`:** Serializes a URL record to a string.
* **`serializeHost(hostFromURLRecord)`:** Serializes a host component from a URL record.
* **`serializeInteger(number)`:** Serializes an integer according to the spec.
* **`serializeURLOrigin(urlRecord)`:** Serializes the origin of a URL.
* **`setTheUsername(urlRecord, usernameString)`:** Sets the username component.
* **`setThePassword(urlRecord, passwordString)`:** Sets the password component.
* **`cannotHaveAUsernamePasswordPort(urlRecord)`:** Checks whether a URL record can have username, password, and port.

**Important Considerations for Low-Level API:**

* **`urlRecord` (Internal URL):** This "internal URL" structure is a critical component of the low-level API.  Its properties (e.g., `scheme`, `username`, `path`) should be treated with caution, as direct manipulation can lead to an inconsistent state.  The spec defines explicit step-by-step processes to ensure consistency.
* **`stateOverride`:**  Precise control of the parsing process.  This parameter allows you to pass a state string to drive the parser exactly as defined in the WHATWG URL standard.
* **Error Handling:**  The functions may return `"failure"` to indicate parsing errors, allowing for robust error handling in your code.


**Example (Illustrative, not complete):**

```javascript
const parsedURL = whatwgURL.parseURL("https://example.com/path?query#fragment");

if (parsedURL !== "failure") {
  console.log(parsedURL.scheme); // "https"
  // ... access other parsed URL components
} else {
  console.error("Failed to parse URL.");
}
```

**Note:** This README provides a summary. Refer to the WHATWG URL specification for detailed explanations of each API function and its behavior.  This library is intended for projects needing precise adherence to the specification and not for general user-level URL manipulation.


```