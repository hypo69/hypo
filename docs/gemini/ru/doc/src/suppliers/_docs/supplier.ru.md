# Класс Supplier

## Обзор

Класс `Supplier` является базовым классом для работы с поставщиками данных в приложении `hypotez`. Он предоставляет общие методы и атрибуты для взаимодействия с различными источниками данных, такими как Amazon, AliExpress, Walmart и т.д.

## Подробней

Класс служит основой для реализации конкретных поставщиков данных. Он определяет общую логику, такую как загрузка настроек, инициализация веб-драйвера, выполнение входа на сайт и запуск сценариев сбора данных.

## Классы

### `Supplier`

**Описание**: Базовый класс для работы с поставщиками данных.

**Принцип работы**:
1.  **Инициализация**: При создании объекта `Supplier`, конструктор `__init__` загружает настройки поставщика и инициализирует необходимые компоненты.
2.  **Загрузка конфигурации**: Метод `_payload` загружает конфигурации для данного поставщика, включая локаторы для страниц и сценарии выполнения.
3.  **Вход на сайт**: Метод `login` используется для выполнения процесса входа на сайт поставщика, если это требуется.
4.  **Выполнение сценариев**: Методы `run_scenario_files` и `run_scenarios` запускают сценарии, которые определяют, какие действия нужно выполнить (например, сбор данных).

**Аттрибуты**:

*   `supplier_id` (int): Уникальный идентификатор поставщика.
*   `supplier_prefix` (str): Префикс для поставщика, например, `aliexpress` или `amazon`.
*   `supplier_settings` (dict): Настройки для поставщика, загруженные из файла конфигурации.
*   `locale` (str): Код локализации (например, `en` для английского, `ru` для русского).
*   `price_rule` (str): Правило для расчета цены (например, добавление НДС или скидки).
*   `related_modules` (list): Модуль, содержащий специфические для поставщика функции.
*   `scenario_files` (list): Список файлов сценариев, которые должны быть выполнены.
*   `current_scenario` (str): Текущий сценарий выполнения.
*   `login_data` (dict): Данные для входа на сайт поставщика (если требуется).
*   `locators` (dict): Локаторы для веб-элементов на страницах сайта поставщика.
*   `driver` (Driver): Веб-драйвер для взаимодействия с сайтом поставщика.
*   `parsing_method` (str): Метод парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).

**Методы**:

*   `__init__(supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs)`: Конструктор класса, инициализирующий атрибуты на основе префикса поставщика, локали и веб-драйвера.
*   `_payload(webdriver: str | Driver | bool, *attrs, **kwargs) -> bool`: Загружает конфигурационные файлы и инициализирует веб-драйвер.
*   `login() -> bool`: Выполняет вход на сайт поставщика (если требуется).
*   `run_scenario_files(scenario_files: str | List[str] = None) -> bool`: Выполняет сценарии из файлов.
*   `run_scenarios(scenarios: dict | list[dict]) -> bool`: Выполняет заданные сценарии.

## Функции

### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs)
```

**Назначение**: Инициализирует экземпляр класса `Supplier`.

**Параметры**:

*   `supplier_prefix` (str): Префикс поставщика (например, 'aliexpress').
*   `locale` (str): Локаль (язык) поставщика, по умолчанию 'en'.
*   `webdriver` (str | Driver | bool): Используемый веб-драйвер, может быть строкой ('chrome', 'firefox'), экземпляром `Driver` или булевым значением, по умолчанию 'default'.
*   `*attrs`: Дополнительные атрибуты.
*   `**kwargs`: Дополнительные именованные аргументы.

**Как работает функция**:

1.  Инициализирует атрибуты `supplier_prefix`, `locale` и `webdriver` из переданных аргументов.
2.  Загружает настройки поставщика с помощью метода `_payload`.

```
Инициализация атрибутов (supplier_prefix, locale, webdriver)
↓
Загрузка настроек поставщика через _payload()
↓
Конец
```

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='ru', webdriver='chrome')
```

### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool
```

**Назначение**: Загружает конфигурационные файлы и инициализирует веб-драйвер.

**Параметры**:

*   `webdriver` (str | Driver | bool): Используемый веб-драйвер, может быть строкой ('chrome', 'firefox'), экземпляром `Driver` или булевым значением.
*   `*attrs`: Дополнительные атрибуты.
*   `**kwargs`: Дополнительные именованные аргументы.

**Возвращает**:

*   `bool`: Возвращает `True` после успешной загрузки конфигурации и инициализации веб-драйвера.

**Как работает функция**:

1.  Осуществляет загрузку и обработку конфигурационных файлов, специфичных для поставщика.
2.  Инициализирует веб-драйвер, если он не был передан в конструктор.

```
Загрузка конфигурационных файлов
↓
Инициализация веб-драйвера
↓
Конец
```

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier._payload(webdriver='firefox')
```

### `login`

```python
def login(self) -> bool
```

**Назначение**: Выполняет вход на сайт поставщика (если требуется).

**Возвращает**:

*   `bool`: Возвращает `True`, если вход выполнен успешно, иначе `False`.

**Как работает функция**:

1.  Проверяет, требуются ли данные для входа.
2.  Выполняет вход на сайт, используя веб-драйвер и данные для входа.

```
Проверка необходимости входа
↓
Выполнение входа на сайт
↓
Конец
```

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier.login()
```

### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool
```

**Назначение**: Запускает выполнение сценариев, определенных в файлах.

**Параметры**:

*   `scenario_files` (str | List[str]): Путь к файлу сценария или список путей к файлам сценариев. Если `None`, используются сценарии по умолчанию.

**Возвращает**:

*   `bool`: Возвращает `True`, если все сценарии выполнены успешно, иначе `False`.

**Как работает функция**:

1.  Определяет список файлов сценариев для выполнения.
2.  Запускает выполнение каждого сценария.

```
Определение списка файлов сценариев
↓
Запуск выполнения каждого сценария
↓
Конец
```

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier.run_scenario_files(['scenario1.json', 'scenario2.json'])
```

### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool
```

**Назначение**: Запускает выполнение заданных сценариев.

**Параметры**:

*   `scenarios` (dict | list[dict]): Словарь или список словарей, представляющих сценарии для выполнения.

**Возвращает**:

*   `bool`: Возвращает `True`, если все сценарии выполнены успешно, иначе `False`.

**Как работает функция**:

1.  Выполняет каждый сценарий из переданного списка.

```
Выполнение каждого сценария из списка
↓
Конец
```

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```