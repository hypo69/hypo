# ИНСТРУКЦИЯ ПО ДОКУМЕНТИРОВАНИЮ

## Введение

Этот документ предоставляет инструкцию по документированию Python-файлов в формате reStructuredText (RST) для последующего использования.  Он описывает формат комментариев, структуру документации, правила обработки исключений и многое другое.

## Требования

1. **Формат документации**:
    - Используйте reStructuredText (RST) для всех комментариев и docstrings.
    - Всегда используйте одинарные кавычки (`'`) в Python-коде.

2. **Сохранение комментариев**:
    - Все существующие комментарии после символа `#` должны быть сохранены без изменений.
    - Блоки кода, требующие изменений, должны быть комментированы построчно с помощью символа `#`.

3. **Обработка данных**:
    - Используйте `j_loads` или `j_loads_ns` из `src.utils.jjson` вместо стандартной функции `json.load` для чтения файлов.
    - Оставьте любые `...` в коде без изменений как точки остановки.

4. **Анализ структуры**:
    - Проверьте и добавьте недостающие импорты в код.
    - Убедитесь, что имена функций, переменных и импортов соответствуют ранее обработанным файлам.

5. **Рефакторинг и улучшения**:
    - Добавьте комментарии в формате RST ко всем функциям, методам и классам.
    - Используйте `from src.logger import logger` для ведения журналов ошибок.
    - Избегайте чрезмерного использования стандартных блоков `try-except`; предпочтительнее обрабатывать ошибки с помощью `logger.error`.
    - В комментариях избегайте нечетких слов, таких как 'get' или 'do'. Вместо этого используйте конкретные термины, такие как 'валидация', 'выполнение' или 'отправка'.

6. **Шаблон ответа**:
    - Ответ должен содержать три раздела:
        - **Полученный код** — исходный код без изменений.
        - **Улучшенный код** — код с добавленными комментариями и исправлениями.
        - **Внесенные изменения** — подробный список внесенных изменений.
        - **ПОЛНЫЙ код** — весь код с внесенными улучшениями.
    - Ответ не должен начинаться с ` ``` `. Используйте эти теги только для блоков кода.

7. **Окончательный код**:
    - Последний раздел ответа должен представлять весь код (исходный код с улучшениями) в одном блоке, готовом к копированию и вставке в качестве замены исходного кода.
    - Все измененные части кода должны быть комментированы построчно с помощью символа `#` в этом блоке.

8. **Примеры кода**:
    - Приведите примеры документации RST и возможных улучшений в формате `TODO`.

9. **Дополнительная инструкция**:
    - Перепишите все комментарии для модулей, функций, методов и переменных в формате RST.  Это включает:
        - Описание модуля в начале файла.
        - Документацию для каждой функции, метода и переменной.
        - Соблюдение стандартов Python docstring (например, в стиле Sphinx).
        - Строки, комментированные с помощью `#`, должны предоставлять подробное объяснение блока кода, которому они предшествуют.


## Примеры


```python
# Пример документации модуля
"""
Модуль для функций программиста-помощника
=========================================================================================

Этот модуль содержит класс :class:`CodeAssistant`, который работает с различными моделями ИИ,
такими как Google Gemini и OpenAI, для обработки задач обработки кода.

Пример использования
--------------------

Пример использования класса `CodeAssistant`:

.. code-block:: python

    assistant = CodeAssistant(role='code_checker', lang='en', model=['gemini'])
    assistant.process_files()
"""
```

```python
# Пример документации функции
def example_function(param1: str, param2: int) -> str:
    """
    Выполняет примерную задачу.

    :param param1: Описание параметра 1.
    :param param2: Описание параметра 2.
    :return: Описание возвращаемого значения.
    """
    ...
```

```python
# Пример комментария в коде
@close_pop_up()
async def specification(self, value: Any = None):
    """Получение и установка спецификации.

    Args:
        value (Any): Это значение может быть передано в словаре kwargs под ключом `{specification = value}`
        при определении класса. Если `value` предоставлено, его значение устанавливается в поле `ProductFields.specification`.
    """
    try:
        # Код выполняет извлечение значения с помощью execute_locator
        value = value or await self.d.execute_locator(self.l.specification) or ''
    except Exception as ex:
        logger.error('Ошибка при получении значения для поля `specification`', ex)
        ...
        return

    # Валидация полученного результата
    if not value:
        logger.debug(f'Неверное значение {value=}\nЛокатор {self.l.specification}')
        ...
        return

    # Если значение является списком, код преобразует его в строку, разделенную `\n`
    if isinstance(value, list):
        value = '\n'.join(map(str, value))

    # Код записывает результат в поле `specification` объекта `ProductFields`
    self.fields.specification = value
    return True
```
```
```
```
```
```


```