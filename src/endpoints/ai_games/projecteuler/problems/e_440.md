# Задача No 440
## Гиперболическая игра в шарики

## Условия
Предположим, у нас есть сетка гиперболической плоскости, где каждая точка имеет координаты (x,y). Если мы начнём с шарика в точке (a,b), а затем подтолкнём его в направлении (c,d), то он будет лететь по прямой до тех пор, пока не столкнётся со стенкой. Стенки находятся на линиях x=0, y=0 и x=y. После столкновения шарик меняет направление.

Стенки x=0 и y=0 действуют как зеркала, отражая направление. Другими словами, если шарик столкнётся со стенкой x=0, то направление (c,d) изменится на (-c,d). Аналогично, если шарик столкнётся со стенкой y=0, то направление (c,d) изменится на (c,-d).

В случае, когда шарик сталкивается со стенкой x=y, его направление (c,d) меняется на (d,c).

Например, шарик, начинающий свой путь в точке (1,3) и летящий в направлении (2,-1), последовательно меняет своё положение и направление следующим образом:

(1,3) -> (7,0) направление (2,-1)
(7,0) -> (7,0) направление (2,1)
(7,0) -> (1,7) направление (1,2)
(1,7) -> (6,2) направление (1,2)
(6,2) -> (2,6) направление (2,1)
(2,6) -> (6,2) направление (1,2)

Заметим, что шарик может продолжать перемещаться бесконечно.

Определим функцию F(a,b,c,d), которая возвращает количество столкновений шарика со стенками, пока он не достигнет положения, которое уже было достигнуто ранее. В примере выше F(1,3,2,-1) = 5.

Также определим функцию S(n), которая является суммой значений F(a,b,c,d) для всех 0 < a, b, c, d ≤ n.

Например: S(5) = 41755.

Найдите S(10<sup>6</sup>) mod 10<sup>9</sup> + 7.
