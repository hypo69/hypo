# Модуль для взаимодействия с Goabror API
## Обзор

Модуль `Goabror` предоставляет асинхронный интерфейс для взаимодействия с API `goabror.uz`. Он позволяет генерировать текст на основе предоставленных сообщений, используя модель `gpt-4` по умолчанию. Модуль поддерживает использование прокси и обрабатывает ответы в формате JSON или текста.

## Подробней

Модуль предназначен для интеграции с другими частями проекта, требующими доступа к API `goabror.uz` для генерации текста. Он использует асинхронные запросы для неблокирующей работы и предоставляет гибкую обработку ответов, поддерживая как JSON, так и обычный текст.

## Классы

### `Goabror`

**Описание**: Класс `Goabror` является асинхронным провайдером, реализующим взаимодействие с API `goabror.uz`.

**Принцип работы**:
1.  **Инициализация**: Устанавливает URL, endpoint API и флаг `working`.
2.  **Создание асинхронного генератора**: Метод `create_async_generator` создает асинхронный генератор, который отправляет запросы к API и возвращает результаты.
3.  **Обработка запросов**: Использует `aiohttp.ClientSession` для выполнения асинхронных HTTP-запросов с заданными заголовками и параметрами.
4.  **Обработка ответов**: Получает ответы от API, проверяет статус и преобразует текст ответа в JSON или возвращает как текст.

**Атрибуты класса**:
- `url` (str): URL веб-сайта `goabror.uz`.
- `api_endpoint` (str): URL API для взаимодействия.
- `working` (bool): Флаг, указывающий на работоспособность провайдера.
- `default_model` (str): Модель, используемая по умолчанию (`gpt-4`).
- `models` (List[str]): Список поддерживаемых моделей.

## Функции

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """Создает асинхронный генератор для взаимодействия с API goabror.uz.

    Args:
        cls (Goabror): Ссылка на класс.
        model (str): Модель для использования (например, 'gpt-4').
        messages (Messages): Список сообщений для отправки в API.
        proxy (str, optional): URL прокси-сервера для использования. По умолчанию `None`.
        **kwargs: Дополнительные параметры.

    Returns:
        AsyncResult: Асинхронный генератор, возвращающий ответы от API.

    Raises:
        Exception: В случае ошибок при выполнении запроса или обработке ответа.

    Как работает функция:
    1. Формируются заголовки HTTP-запроса, включая User-Agent.
    2. Создается асинхронная сессия `aiohttp.ClientSession` с заданными заголовками.
    3. Формируются параметры запроса, включающие пользовательский и системный промты.
    4. Выполняется GET-запрос к API с использованием `session.get`.
    5. Обрабатывается ответ от API:
        - Проверяется статус ответа с помощью `raise_for_status`.
        - Текст ответа преобразуется в JSON, если это возможно.
        - Извлекаются данные из JSON-ответа или возвращается текст ответа.

    Внутри функции происходят следующие действия и преобразования:
    A - Формирование заголовков запроса
    |
    -- B - Создание асинхронной сессии
    |
    C - Формирование параметров запроса
    |
    D - Отправка GET-запроса к API
    |
    E - Обработка ответа от API
    |
    F - Извлечение и возврат данных

    """
    ...
```

**Параметры**:

-   `cls` (Goabror): Ссылка на класс.
-   `model` (str): Модель для использования (например, `'gpt-4'`).
-   `messages` (Messages): Список сообщений для отправки в API.
-   `proxy` (str, optional): URL прокси-сервера для использования. По умолчанию `None`.
-   `**kwargs`: Дополнительные параметры.

**Возвращает**:

-   `AsyncResult`: Асинхронный генератор, возвращающий ответы от API.

**Вызывает исключения**:

-   `Exception`: В случае ошибок при выполнении запроса или обработке ответа.

**Примеры**:

```python
# Пример вызова create_async_generator
messages = [{"role": "user", "content": "Hello, world!"}]
async for response in Goabror.create_async_generator(model='gpt-4', messages=messages):
    print(response)