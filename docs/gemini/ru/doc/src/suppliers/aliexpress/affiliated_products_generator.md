# Модуль `hypotez/src/suppliers/aliexpress/affiliated_products_generator.py`

## Обзор

Этот модуль содержит класс `AliAffiliatedProducts`, предназначенный для сбора данных о продуктах с AliExpress, включая аффилированные ссылки, изображения и видео.  Класс наследуется от `AliApi` и предоставляет асинхронную функцию `process_affiliate_products` для обработки списка идентификаторов продуктов и создания аффилированных ссылок, сохранения изображений и видео.

## Классы

### `AliAffiliatedProducts`

**Описание**: Класс, расширяющий `AliApi`, для получения полной информации о продуктах с AliExpress, включая аффилированные ссылки. Поддерживает настройку языка и валюты для получения релевантных ссылок.

**Атрибуты**:

- `language`: Язык рекламной кампании (по умолчанию 'EN').
- `currency`: Валюта рекламной кампании (по умолчанию 'USD').

**Методы**:

#### `__init__`

**Описание**: Инициализирует класс `AliAffiliatedProducts`.

**Параметры**:

- `language` (str | dict, optional): Язык кампании (по умолчанию 'EN').
- `currency` (str, optional): Валюта кампании (по умолчанию 'USD').

**Возвращает**:
-  `None`


#### `process_affiliate_products`

**Описание**: Обрабатывает список идентификаторов продуктов и возвращает список обработанных продуктов с аффилированными ссылками и сохраненными изображениями.

**Параметры**:

- `prod_ids` (list[str]): Список URL или ID продуктов.
- `category_root` (Path | str): Корневой путь к директории для сохранения данных.

**Возвращает**:
- `list[SimpleNamespace]`: Список обработанных продуктов с аффилированными ссылками и сохраненными изображениями.

**Возможные исключения**:

- `Exception`: Если не найден нужный категорийный путь в кампании.

**Примечания**:
- Загружает содержимое страниц по URL.
- Обрабатывает аффилированные ссылки и сохранение изображений/видео.
- Генерирует и сохраняет данные кампании и выходные файлы.
- Функция имеет сложную логику, изображенную в блок-схеме.

## Функции


### `get_affiliate_links`

**Описание**: Получает аффилированные ссылки для заданного продукта.

**Параметры**:
- `prod_url` (str): URL продукта.


**Возвращает**:
- list: Список аффилированных ссылок. Возвращает пустой список, если ссылки не найдены.

**Возможные исключения**:
- `Exception`: Возможны исключения, связанные с парсингом или обработкой данных, полученных от внешнего сервиса.

### `retrieve_product_details`

**Описание**: Получает детали продукта по предоставленным URL.


**Параметры**:
- `prod_urls` (list[str]): Список URL продуктов.

**Возвращает**:
- list[SimpleNamespace]: Список объектов `SimpleNamespace` с деталями продуктов.  Возвращает пустой список, если данные не получены.


**Возможные исключения**:
- `Exception`: Возможны исключения, связанные с парсингом или обработкой данных.



## Дополнительные функции

Документация для функций `save_png_from_url`, `save_video_from_url`, `j_dumps`, `save_text_file` находится в других модулях и должна быть документирована отдельно.