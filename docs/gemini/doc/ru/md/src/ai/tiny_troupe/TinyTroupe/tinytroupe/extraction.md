# Модуль extraction

## Обзор

Этот модуль предоставляет инструменты для извлечения структурированных данных из элементов TinyTroupe, таких как агенты и миры. Он включает механизмы для сокращения извлеченных данных до более компактного формата и экспорта артефактов из элементов TinyTroupe. Модуль демонстрирует разницу между агентами-симуляциями и AI-помощниками, поскольку помощники не предназначены для такого рода интроспекции.

## Классы

### `ResultsExtractor`

**Описание**: Класс для извлечения результатов из агентов и миров.

**Методы**:

#### `extract_results_from_agent`

**Описание**: Извлекает результаты из экземпляра `TinyPerson`.

**Параметры**:
- `tinyperson` (TinyPerson): Экземпляр `TinyPerson` для извлечения результатов.
- `extraction_objective` (str): Цель извлечения.
- `situation` (str): Ситуация для рассмотрения.
- `fields` (list, optional): Поля для извлечения. Если `None`, извлекатель определит названия полей. По умолчанию `None`.
- `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.

**Возвращает**:
- `dict | None`: Словарь с результатами извлечения или `None`, если извлечение не удалось.

#### `extract_results_from_world`

**Описание**: Извлекает результаты из экземпляра `TinyWorld`.

**Параметры**:
- `tinyworld` (TinyWorld): Экземпляр `TinyWorld` для извлечения результатов.
- `extraction_objective` (str): Цель извлечения.
- `situation` (str): Ситуация для рассмотрения.
- `fields` (list, optional): Поля для извлечения. Если `None`, извлекатель определит названия полей. По умолчанию `None`.
- `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.

**Возвращает**:
- `dict | None`: Словарь с результатами извлечения или `None`, если извлечение не удалось.

#### `save_as_json`

**Описание**: Сохраняет результаты последнего извлечения в формате JSON.

**Параметры**:
- `filename` (str): Имя файла для сохранения.
- `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.


### `ResultsReducer`

**Описание**: Класс для сокращения результатов извлечения.

**Методы**:

#### `add_reduction_rule`

**Описание**: Добавляет правило сокращения.

**Параметры**:
- `trigger` (str): Триггер для правила.
- `func` (callable): Функция, выполняющая правило.

**Возбуждает исключения**:
- `Exception`: Если правило для `trigger` уже существует.


#### `reduce_agent`

**Описание**: Сокращает результаты для агента.

**Параметры**:
- `agent` (TinyPerson): Агент для сокращения.

**Возвращает**:
- `list`: Список сокращенных результатов.


#### `reduce_agent_to_dataframe`

**Описание**: Преобразует результаты сокращения в DataFrame.

**Параметры**:
- `agent` (TinyPerson): Агент для сокращения.
- `column_names` (list, optional): Имена столбцов DataFrame. По умолчанию `None`.

**Возвращает**:
- `pd.DataFrame`: DataFrame с сокращенными результатами.


### `ArtifactExporter`

**Описание**: Класс для экспорта артефактов.

**Методы**:

#### `export`

**Описание**: Экспортирует данные артефакта в файл.

**Параметры**:
- `artifact_name` (str): Имя артефакта.
- `artifact_data` (Union[dict, str]): Данные для экспорта.
- `content_type` (str): Тип содержимого артефакта.
- `content_format` (str, optional): Формат содержимого артефакта (например, md, csv). По умолчанию `None`.
- `target_format` (str): Формат экспорта артефакта (например, json, txt, docx).
- `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.

**Возбуждает исключения**:
- `ValueError`: Если неподдерживаемый формат `target_format` или `content_type`.


#### `_export_as_txt`
#### `_export_as_json`
#### `_export_as_docx`

**Описание**: Вспомогательные методы для экспорта в разные форматы.


#### `_compose_filepath`

**Описание**: Формирует путь к файлу для экспорта.

**Параметры**:
- `artifact_data` (Union[dict, str]): Данные для экспорта.
- `artifact_name` (str): Имя артефакта.
- `content_type` (str): Тип содержимого артефакта.
- `target_format` (str): Формат экспорта артефакта.
- `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.

**Возвращает**:
- `str`: Путь к файлу для экспорта.


### `Normalizer`

**Описание**: Механизм для нормализации текстовых элементов.

**Методы**:

#### `__init__`

**Описание**: Инициализирует нормализатор.

**Параметры**:
- `elements` (List[str]): Элементы для нормализации.
- `n` (int): Количество нормализованных элементов для вывода.
- `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.


#### `normalize`

**Описание**: Нормализует указанные элементы.

**Параметры**:
- `element_or_elements` (Union[str, List[str]]): Элемент или список элементов для нормализации.


**Возвращает**:
- `str | list`: Нормализованный элемент или список нормализованных элементов.

## Функции

(Список функций в модуле отсутствует в запрошенном формате)