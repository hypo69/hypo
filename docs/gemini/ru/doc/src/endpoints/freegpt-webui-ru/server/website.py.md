# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` предназначен для настройки маршрутов и обработки запросов, связанных с веб-интерфейсом. Он использует Flask для маршрутизации и рендеринга шаблонов.
Модуль отвечает за отображение страниц чата и статических ресурсов, таких как файлы стилей и скрипты.

## Подробнее

Данный код является частью веб-интерфейса и отвечает за обработку различных URL-адресов, связанных с чатом и статическими ресурсами. Он использует Flask для определения маршрутов и обработки HTTP-запросов. Класс `Website` настраивает маршруты для главной страницы, страниц чата и статических ресурсов.

## Классы

### `Website`

**Описание**: Класс `Website` управляет маршрутами и обработкой запросов для веб-сайта.

**Принцип работы**:
1.  При инициализации класса `Website` передается объект Flask-приложения (`app`).
2.  Определяется словарь `routes`, содержащий маршруты и связанные с ними функции и HTTP-методы.
3.  Метод `__init__` сохраняет Flask-приложение и словарь маршрутов в атрибутах экземпляра класса.
4.  Методы `_index`, `_chat` и `_assets` обрабатывают запросы к соответствующим маршрутам, рендерят шаблоны или возвращают статические файлы.
5.  При запросе к определенному маршруту вызывается соответствующая функция, которая выполняет необходимую логику и возвращает ответ клиенту.

**Атрибуты**:

*   `app`: Объект Flask-приложения.
*   `routes` (dict): Словарь, содержащий маршруты веб-сайта и связанные с ними функции и методы.

**Методы**:

*   `__init__(self, app)`: Конструктор класса, инициализирует объект `Website`.
*   `_index(self)`: Обрабатывает запрос к главной странице (`/chat/`) и возвращает шаблон `index.html` с уникальным идентификатором чата.
*   `_chat(self, conversation_id)`: Обрабатывает запрос к странице чата (`/chat/<conversation_id>`) и возвращает шаблон `index.html` с идентификатором чата.
*   `_assets(self, folder: str, file: str)`: Обрабатывает запрос к статическим ресурсам (`/assets/<folder>/<file>`) и возвращает запрошенный файл.

## Функции

### `_chat`

```python
def _chat(self, conversation_id):
    """
    Обрабатывает запрос к странице чата с определенным conversation_id.

    Args:
        conversation_id: Идентификатор чата.

    Returns:
        response: Объект ответа Flask, содержащий отрендеренный шаблон index.html или редирект на /chat.
    """
```

**Назначение**: Обрабатывает запрос к странице чата (`/chat/<conversation_id>`).

**Параметры**:

*   `conversation_id`: Идентификатор чата, полученный из URL.

**Возвращает**:

*   `response`: Объект ответа Flask, содержащий отрендеренный шаблон `index.html` с идентификатором чата, если `conversation_id` содержит символ `-`. В противном случае выполняет перенаправление на главную страницу чата (`/chat`).

**Как работает функция**:

1.  Функция проверяет, содержит ли `conversation_id` символ `-`.
2.  Если символ присутствует, функция рендерит шаблон `index.html` и передает в него `conversation_id` в качестве аргумента `chat_id`.
3.  Если символ отсутствует, функция выполняет перенаправление на главную страницу чата (`/chat`).

```
Проверка conversation_id
│
├─── Содержит '-'?
│    │
│    ├─── Да: Рендеринг шаблона index.html с chat_id=conversation_id
│    │
│    └─── Нет: Редирект на /chat
│
Конец
```

**Примеры**:

```python
# Пример вызова функции с корректным conversation_id
_chat(self, "1234-abcd-5678-efgh-0123456789ab")
# Пример вызова функции с некорректным conversation_id
_chat(self, "1234abcd5678efgh0123456789ab")
```

### `_index`

```python
def _index(self):
    """
    Обрабатывает запрос к главной странице чата.

    Returns:
        response: Объект ответа Flask, содержащий отрендеренный шаблон index.html с уникальным chat_id.
    """
```

**Назначение**: Обрабатывает запрос к главной странице чата (`/chat/`).

**Возвращает**:

*   `response`: Объект ответа Flask, содержащий отрендеренный шаблон `index.html` с уникальным `chat_id`.

**Как работает функция**:

1.  Функция генерирует уникальный `chat_id`, объединяя случайные шестнадцатеричные значения и текущее время в миллисекундах.
2.  Функция рендерит шаблон `index.html` и передает в него сгенерированный `chat_id` в качестве аргумента.

```
Генерация chat_id
│
├─── Случайные шестнадцатеричные значения
│    │
│    └─── Текущее время в миллисекундах
│
│
└─── Рендеринг шаблона index.html с chat_id
│
Конец
```

**Примеры**:

```python
# Пример вызова функции
_index(self)
```

### `_assets`

```python
def _assets(self, folder: str, file: str):
    """
    Обрабатывает запрос к статическим ресурсам.

    Args:
        folder (str): Имя папки, содержащей файл.
        file (str): Имя файла.

    Returns:
        response: Объект ответа Flask, содержащий запрошенный файл или сообщение об ошибке.
    """
```

**Назначение**: Обрабатывает запрос к статическим ресурсам (`/assets/<folder>/<file>`).

**Параметры**:

*   `folder` (str): Имя папки, содержащей запрошенный файл.
*   `file` (str): Имя запрошенного файла.

**Возвращает**:

*   `response`: Объект ответа Flask, содержащий запрошенный файл, если он найден. Если файл не найден, возвращает сообщение об ошибке "File not found" и код состояния 404.

**Как работает функция**:

1.  Функция пытается отправить запрошенный файл из папки `client`.
2.  Если файл найден, он отправляется клиенту.
3.  Если файл не найден, перехватывается исключение и возвращается сообщение об ошибке "File not found" с кодом состояния 404.

```
Попытка отправки файла
│
├─── Файл найден?
│    │
│    ├─── Да: Отправка файла
│    │
│    └─── Нет: Возврат ошибки "File not found"
│
Конец
```

**Примеры**:

```python
# Пример вызова функции для получения файла style.css из папки css
_assets(self, "css", "style.css")
# Пример вызова функции для получения файла script.js из папки js
_assets(self, "js", "script.js")