# Модуль `hypotez/src/utils/jjson.py`

## Обзор

Модуль `jjson` предназначен для работы с JSON и CSV файлами. Он предоставляет функции для загрузки, выгрузки, слияния данных в JSON и CSV форматах, а также конвертации в `SimpleNamespace` объекты для удобной работы.

## Функции

### `j_dumps`

**Описание**: Функция для выгрузки JSON данных в файл или возврата их как словарь. Поддерживает различные режимы работы с файлами (запись, добавление в конец или начало файла).  Обрабатывает данные в формате SimpleNamespace, списке словарей и т.д.

**Параметры**:

- `data` (Dict | SimpleNamespace | List[Dict] | List[SimpleNamespace]): Данные для выгрузки в формате JSON или SimpleNamespace.
- `file_path` (Optional[Path], optional): Путь к файлу для выгрузки. Если `None`, возвращает JSON данные в виде словаря. По умолчанию `None`.
- `ensure_ascii` (bool, optional):  Если `True`, не ASCII символы в выводе будут экранированы. По умолчанию `True`.
- `mode` (str, optional): Режим открытия файла ('w', 'a+', '+a'). По умолчанию 'w'.
- `exc_info` (bool, optional): Если `True`, выводит информацию об исключениях в лог. По умолчанию `True`.

**Возвращает**:

- `Optional[Dict]`: JSON данные в виде словаря при успешной выгрузке, или `None` в случае ошибки.

**Вызывает исключения**:

- `ValueError`: Если режим открытия файла не поддерживается.
- `Exception`: В случае других ошибок при работе с файлами или JSON.



### `j_loads`

**Описание**: Функция для загрузки JSON или CSV данных из файла, директории, строки, объекта JSON или SimpleNamespace.  Перекодирует строки ключей и значений в Unicode.

**Параметры**:

- `jjson` (dict | SimpleNamespace | str | Path | list): Путь к файлу, директории, строка JSON данных, объект JSON или SimpleNamespace.
- `ordered` (bool, optional): Возвращает OrderedDict для сохранения порядка элементов. По умолчанию `True`.

**Возвращает**:

- `dict | list`: Обработанные данные (словарь или список словарей).

**Вызывает исключения**:

- `FileNotFoundError`: Если указанный файл не найден.
- `json.JSONDecodeError`: Если данные JSON не удалось разобрать.
- `Exception`: В случае других ошибок при работе с файлами или JSON.



### `j_loads_ns`

**Описание**: Функция для загрузки JSON или CSV данных из файла, директории, строки и конвертации их в `SimpleNamespace` объекты.

**Параметры**:

- `jjson` (Path | SimpleNamespace | Dict | str): Путь к файлу, директории, строка JSON данных или объект JSON.
- `ordered` (bool, optional):  Возвращает `OrderedDict` вместо обычного `dict` для сохранения порядка элементов. По умолчанию `False`.

**Возвращает**:

- `Optional[SimpleNamespace | List[SimpleNamespace]]`:  Возвращает `SimpleNamespace` или список `SimpleNamespace` объектов, если операция успешна. Возвращает `None` если файл не найден или не может быть прочитан.

**Примеры**:

```python
# Пример использования:
j_loads_ns('data.json')  # Возвращает SimpleNamespace с данными из файла
j_loads_ns(Path('/path/to/directory')) # Возвращает список SimpleNamespace с данными из директории
j_loads_ns('{"key": "value"}') # Возвращает SimpleNamespace с данными из строки JSON
```

**Вызывает исключения**:

- `FileNotFoundError`: Если указанный файл не найден.
- `json.JSONDecodeError`: Если данные JSON не удалось разобрать.
- `Exception`: В случае других ошибок при работе с файлами или JSON.


### `extract_json_from_string`

**Описание**: Извлекает JSON-контент из Markdown строки, заключенный в тэги ```json```.

**Параметры**:

- `md_string` (str): Markdown строка, содержащая JSON.

**Возвращает**:

- `str`: Извлеченный JSON-строка или пустая строка, если JSON не найден.

**Вызывает исключения**:

- `Exception`: В случае ошибок при парсинге строки.


```