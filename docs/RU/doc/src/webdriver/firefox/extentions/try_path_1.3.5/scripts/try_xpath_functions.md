# Модуль try_xpath_functions.js

## Обзор

Этот модуль содержит JavaScript функции для работы с XPath и DOM-элементами.  Он предоставляет методы для оценки XPath выражений, выбора элементов с помощью `querySelector` и `querySelectorAll`, а также для обработки результатов этих операций.  Модуль включает функции для преобразования результатов XPath в массивы узлов, обработки различных типов результатов XPath, получения информации об элементах (тип, имя, значение).  Также реализованы функции для управления классами и атрибутами элементов, нахождения родительских элементов, предков и работы с фреймами.

## Функции

### `execExpr`

**Описание**: Выполняет XPath выражение или операцию `querySelector` / `querySelectorAll` на заданном контексте.

**Параметры**:
- `expr` (str): XPath выражение или CSS селектор.
- `method` (str): Метод выполнения ('evaluate', 'querySelector', 'querySelectorAll').
- `opts` (dict, optional): Опциональный объект с параметрами:
    - `context` (Node | Document, optional): Контекст для выполнения выражения. По умолчанию `document`.
    - `resolver` (function | str | dict, optional):  Функция, которая разрешает имена в XPath выражении. Если строка или словарь, то парсится как JSON.  По умолчанию `null`.
    - `resultType` (int, optional): Тип результата, возвращаемого функцией `evaluate`. По умолчанию `xpathResult.ANY_TYPE`.
    - `document` (Document, optional):  Объект Document, используемый для выполнения XPath. По умолчанию используется document, полученный из контекста.

**Возвращает**:
- `dict`: Словарь, содержащий:
    - `items` (array): Массив результатов выполнения выражения.
    - `method` (str): Метод, используемый для выполнения.
    - `resultType` (int): Тип результата выполнения XPath (или null если используется `querySelector` или `querySelectorAll`).


**Вызывает исключения**:
- `Error`: Возникает при несоответствии контекста заданному методу (`context` не является Node или Attr для `evaluate`, или Document или Element для `querySelector/querySelectorAll`).


### `resToArr`

**Описание**: Преобразует результат выполнения XPath выражения (объект `XPathResult`) в массив.

**Параметры**:
- `res` (XPathResult): Объект `XPathResult`.
- `type` (int, optional): Тип результата. Если не указан, используется тип результата из `res`.

**Возвращает**:
- `array`: Массив узлов или значений.

**Вызывает исключения**:
- `Error`: Возникает при недопустимом `resultType` в результате XPath.


### `makeResolver`

**Описание**: Создает функцию-резолвер для обработки имен в XPath выражениях.

**Параметры**:
- `obj` (function | str | dict, optional):  Функция, строка или словарь. Если строка или словарь, то парсится как JSON.  По умолчанию `null`.

**Возвращает**:
- `function`: Резолвер, который принимает строковое имя и возвращает значение.

**Вызывает исключения**:
- `Error`: Возникает при некорректном формате `resolver`.

### `isValidDict`

**Описание**: Проверяет, является ли переданный объект валидным словарем, где все значения – строки.

**Параметры**:
- `obj`: Проверяемый объект.

**Возвращает**:
- `bool`: True, если объект является валидным словарем, иначе False.


### `objToMap`

**Описание**: Преобразует объект в Map.

**Параметры**:
- `obj`: Объект, который нужно преобразовать.

**Возвращает**:
- `Map`: Map, содержащий ключи и значения из объекта.


### `isDocOrElem`

**Описание**: Проверяет, является ли объект документом или элементом.

**Параметры**:
- `obj`: Объект для проверки.

**Возвращает**:
- `bool`: True, если объект документ или элемент, иначе False.


### `listToArr`

**Описание**: Преобразует список в массив.

**Параметры**:
- `list`: Список, который нужно преобразовать.

**Возвращает**:
- `array`: Массив, содержащий элементы из списка.


### `getItemDetail`

**Описание**: Возвращает подробную информацию об элементе.

**Параметры**:
- `item`: Элемент (узел, строка, число, булево значение).

**Возвращает**:
- `dict`: Словарь с информацией о типе, имени, значении и текстовом содержимом элемента.


### `getItemDetails`

**Описание**: Возвращает массив подробной информации о нескольких элементах.

**Параметры**:
- `items`: Массив элементов.

**Возвращает**:
- `array`: Массив словарей с информацией о каждом элементе.


### `getNodeTypeStr`

**Описание**: Возвращает строковое представление типа узла.

**Параметры**:
- `nodeType`: Числовое представление типа узла.

**Возвращает**:
- `string`: Строковое представление типа узла.


### `getxpathResultStr`

**Описание**: Преобразует числовой тип результата XPath в строку.

**Параметры**:
- `resultType`: Числовой тип результата XPath.

**Возвращает**:
- `string`: Строковое представление типа результата.


### `getxpathResultNum`

**Описание**: Преобразует строковый тип результата XPath в число.

**Параметры**:
- `resultTypeStr`: Строковое представление типа результата XPath.

**Возвращает**:
- `int`: Числовое представление типа результата.


### `isAttrItem`

**Описание**: Проверяет, является ли переданный элемент атрибутом.

**Параметры**:
- `item`: Элемент для проверки.

**Возвращает**:
- `bool`: `True`, если элемент атрибут, `False` в противном случае.


### `isNodeItem`

**Описание**: Проверяет, является ли переданный элемент узлом DOM.

**Параметры**:
- `item`: Элемент для проверки.

**Возвращает**:
- `bool`: `True`, если элемент узел DOM, `False` в противном случае.


### `isElementItem`

**Описание**: Проверяет, является ли переданный элемент элементом HTML.

**Параметры**:
- `item`: Элемент для проверки.

**Возвращает**:
- `bool`: `True`, если элемент элемент HTML, `False` в противном случае.


... (остальные функции)