# Модуль try_xpath_background.js

## Обзор

Этот модуль JavaScript отвечает за обработку сообщений, полученных от других вкладок или элементов расширения, связанных с инструментом поиска по XPath. Он реализует различные слушатели событий, которые обрабатывают запросы на установку стилей, восстановление состояния всплывающего окна, отображение результатов поиска и обновление CSS. Модуль также предоставляет функции для взаимодействия с хранилищем браузера и загрузки CSS-файлов.

## Переменные

### `tx`

**Описание**: псевдоним для `tryxpath`.

### `fu`

**Описание**: псевдоним для `tryxpath.functions`.

### `popupState`

**Описание**: Хранит текущее состояние всплывающего окна.

### `popupCss`

**Описание**: Строка CSS-стилей для всплывающего окна.

### `results`

**Описание**: Объект, содержащий результаты поиска по XPath.

### `css`

**Описание**: Строка CSS-стилей для вкладок.

### `attributes`

**Описание**: Объект, содержащий атрибуты, используемые для поиска по XPath.

## Функции

### `loadDefaultCss()`

**Описание**: Загружает значения по умолчанию из файла CSS.

**Возвращает**:
- `Promise<string>`: Обещание, которое разрешается строкой CSS-кода.

**Обрабатывает исключения**:
- `Error`: Обработка ошибок при выполнении запроса.

### `genericListener(message, sender, sendResponse)`

**Описание**: Общий слушатель сообщений.

**Параметры**:
- `message (Object)`: Объект с данными сообщения.
- `sender (Object)`: Объект, передающий данные.
- `sendResponse (Function)`: Функция для отправки ответа.

**Возвращает**:
- `undefined | boolean`: `undefined` или `true`, если обработка выполнена.


### `genericListener.listeners.storePopupState(message)`

**Описание**: Сохраняет состояние всплывающего окна.

**Параметры**:
- `message(Object)`: Сообщение с информацией о состоянии.


### `genericListener.listeners.requestRestorePopupState(message)`

**Описание**: Запрашивает восстановление состояния всплывающего окна.

**Параметры**:
- `message(Object)`: Сообщение с информацией о состоянии.


### `genericListener.listeners.requestInsertStyleToPopup()`

**Описание**: Запрашивает вставку CSS-стилей в всплывающее окно.


### `genericListener.listeners.showAllResults(message, sender)`

**Описание**: Отображает все результаты поиска в новой вкладке.

**Параметры**:
- `message(Object)`: Сообщение с результатами.
- `sender(Object)`: Данные о отправителе.


### `genericListener.listeners.loadResults(message, sender, sendResponse)`

**Описание**: Отправляет результаты поиска в ответ.

**Параметры**:
- `message(Object)`: Сообщение с запросом.
- `sender(Object)`: Данные о отправителе.
- `sendResponse(Function)`: Функция для отправки ответа.

**Возвращает**:
- `true`: Указывает, что обработка завершена успешно.

### `genericListener.listeners.updateCss(message, sender)`

**Описание**: Обновляет CSS-стили в текущей вкладке.

**Параметры**:
- `message(Object)`: Сообщение с обновляемыми стилями.
- `sender(Object)`: Данные о отправителе.

**Обрабатывает исключения**:
- `Error`: Обработка ошибок при обновлении CSS.

### `genericListener.listeners.loadOptions(message, sender, sendResponse)`

**Описание**: Загружает параметры расширения.

**Параметры**:
- `message (Object)`: Объект с данными сообщения.
- `sender (Object)`: Объект, передающий данные.
- `sendResponse (Function)`: Функция для отправки ответа.

**Возвращает**:
- `true`: Указывает, что обработка завершена успешно.

### `genericListener.listeners.requestSetContentInfo(message, sender)`

**Описание**: Запрашивает установку информации о содержимом в текущей вкладке.

**Параметры**:
- `message (Object)`: Объект с данными сообщения.
- `sender (Object)`: Объект, передающий данные.


## Обработчики изменений хранилища

### Обработчик `browser.storage.onChanged`

**Описание**: Обрабатывает изменения в хранилище браузера.

**Параметры**:
- `changes (Object)`: Объект с информацией о внесенных изменениях.

**Описание изменений:**
- Обновляет значения `attributes`, `css`, `popupCss` при изменении соответствующих значений в хранилище.


## Загрузка начальных значений

### `browser.storage.sync.get(...)`

**Описание**: Загружает начальные значения параметров из синхронизированного хранилища.

**Возвращает**:
- `Promise<Object>`: Обещание, которое разрешается объектом с загруженными параметрами.

**Обрабатывает исключения**:
- `Error`: Обработка ошибок при загрузке данных из хранилища.

## Ссылки

- [tryxpath](https://github.com/example-repo)  (замените на реальную ссылку, если она есть)