# Правила кодирования для разработчиков

## Обзор

Данный документ содержит руководство по стилю кодирования для проекта.  Он описывает правила, которым следует придерживаться при разработке и поддержании кода, чтобы обеспечить его читаемость, надежность и соответствие стандартам.

## Правила

### Общие принципы

- Следует использовать согласованный стиль кодирования для повышения читаемости и единообразия.
- Все изменения и рекомендации должны соответствовать данному руководству.

### Комментарии

- **Комментарии после символа `#`:**
    - **Не изменять:** Комментарии после `#` должны оставаться неизменными и ясными. Не переписывайте и не удаляйте их, даже если они начинаются с кода.
    - **Информативные:** Внутренние комментарии должны быть информативными и пояснять последующий блок кода.
    - **Формат:** Используйте формат reStructuredText (RST) для всех комментариев и документации.
    - **Терминология:** Избегайте использования терминов типа 'получить', 'сделать' в комментариях. Используйте фразы типа 'проверить', 'отправить', 'код выполняет...'.
    - **Пассивный залог:** Предпочтительнее использовать пассивный залог: 'копирование', 'форматирование', 'создание' и т.д.
    - **Пустые строки:** Пустые строки или `...` не документировать.

- **Комментарии после символа `"""`:**
    - **Оптимизировать:** Комментарии после `"""` можно и нужно оптимизировать на основе фактического поведения кода.

### Документация

- **Docstring:** Каждая функция, метод и класс должны иметь docstring в стиле Sphinx.
    - Пример функции:
        ```python
        def function(param: str, param1: Optional[str | dict] = None) -> dict | None:
            """
            Описание функции.

            :param param: Описание параметра `param`.
            :param param1: (Необязательно) Описание параметра `param1`.
            :return: Описание возвращаемого значения.
            :raises SomeError: Условия возникновения исключения.
            """
            # ... код функции ...
        ```
- **Описание модуля:** В начале каждого файла необходимо добавлять описание модуля в формате:
    ```python
    """
    Модуль для работы с помощником программиста
    =========================================================================================

    Описание функциональности модуля.

    Пример использования
    ---------------------

    .. code-block:: python

        example_usage()
    """
    ```

### Форматирование кода

- **Кавычки:** Используйте одинарные кавычки вместо двойных.
- **Пробелы:** Используйте пробелы вокруг оператора присваивания `=`. Пример:
    ```python
    a = 1
    ```
- **Согласованность:** Применяйте пробелы последовательно во всех выражениях и присваиваниях:
    ```python
    result = 10 if x > 5 else 20
    ```
- **Заголовок импорта:** Всегда включайте строку `import header` в начале файла.
- **Отладка:** Добавляйте `...` между `logger` и `return` для отладки, например:
    ```python
    logger.error('Ошибка при выполнении задачи', ex)
    ...
    return
    ```

### Параметры функций

- **Типизация:** Параметры должны быть явно типизированы. Если значение по умолчанию `None`, используйте `Optional`. Пример:
    ```python
    def critical(self, message: str, ex: Optional = None, exc_info: Optional[bool] = True):
        # ...
    ```
- **Избегайте Union:** Избегайте использования `Union`.

### Pydantic

- **Валидация:** Используйте Pydantic для валидации данных, если это возможно и уместно.
- **Модели:** Предпочитайте Pydantic модели для классов, обрабатывающих структурированные данные.

### Логирование

- **Логгер:** Используйте `from src.logger.logger import logger` для логирования вместо стандартного `logging`.
- **Пример логирования ошибок:**
    ```python
    logger.error('Ошибка при запуске бота: ', ex)
    ...
    return
    ```

### Константы

- **MODE:** Всегда включайте глобальную константу `MODE` в код, даже если она не используется.

### Формат ответа

Все ответы должны соответствовать формату Markdown.  Структура ответа должна включать:
- **Улучшенный код:** Блок с улучшенным кодом, отформатированным и с добавленными комментариями.
- **Изменения:** Подробный список модификаций и объяснений.

Код должен быть заключен в теги соответствующего синтаксического выделения (например, `python`, `markdown`, `json`).