# Анализ кода модуля `send_data.js`

**Качество кода**

8
- Плюсы
    - Код выполняет свою задачу по сбору данных со страницы и отправке на сервер.
    - Используется `fetch` для отправки данных, что является современным подходом.
    - Присутствует обработка ошибок при сетевых запросах.
    - Логика отправки данных вынесена в отдельную функцию `onPageLoad`, что способствует модульности.
- Минусы
    - Отсутствуют комментарии, объясняющие назначение переменных.
    - Нет обработки ошибок на уровне JSON парсинга.
    - `console.log` и `console.error` используются для вывода информации, что не подходит для продакшн среды.
    - Не используется асинхронность для обработки запроса.

**Рекомендации по улучшению**

1.  Добавить описание модуля в начале файла.
2.  Добавить комментарии к переменным, объясняющие их назначение.
3.  Заменить `console.log` и `console.error` на `logger` для ведения журнала ошибок.
4.  Использовать `async` и `await` для более читаемого асинхронного кода.
5.  Добавить обработку ошибок JSON парсинга, если это требуется.
6.  Добавить документацию в формате RST для функции.

**Оптимизированный код**

```javascript
/**
 * Модуль для сбора и отправки данных страницы на сервер.
 * =====================================================
 *
 * Этот модуль содержит функцию `onPageLoad`, которая собирает данные со страницы,
 * такие как заголовок, URL и HTML-содержимое, и отправляет их на удаленный сервер.
 *
 * Пример использования
 * --------------------
 *
 * После загрузки страницы данные автоматически отправляются на сервер.
 */

//  Импортируем logger
import { logger } from '../../../src/logger/logger';


/**
 *  Асинхронно собирает данные страницы и отправляет их на сервер.
 *
 *  Собирает заголовок страницы, URL и HTML-содержимое,
 *  затем отправляет их в виде JSON-объекта на указанный адрес.
 *  В случае успеха, в консоль выводится сообщение об успехе, в случае ошибки сообщение об ошибке.
 */
async function onPageLoad() {
    try {
        //  Получаем заголовок страницы
        const title = document.title;
        //  Получаем URL текущей страницы
        const url = window.location.href;
        //  Получаем HTML-содержимое тела страницы
        const body = document.body.innerHTML;

        //  Формируем объект с данными для отправки
        const data = {
            title: title,
            url: url,
            body: body,
        };

        //  Отправляем данные на указанный адрес
        const response = await fetch('http://127.0.0.1/hypotez.online/api/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        });

        //  Проверяем, что ответ сервера успешный
        if (!response.ok) {
            //  Генерируем ошибку, если ответ не успешен
            throw new Error(`Network response was not ok: ${response.status}`);
        }

        //  Парсим JSON из ответа сервера
        const json = await response.json();

        //  Логируем успешный ответ
        logger.info('Response:', json);


    } catch (error) {
        //  Логируем ошибку
        logger.error(`Error: ${error.message}`, error);
    }
}


//  Добавляем обработчик события загрузки страницы
window.addEventListener('load', onPageLoad);
```