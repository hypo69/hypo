# Модуль для обработки диалогов

## Обзор

Модуль предоставляет класс `ConversationHandler`, который упрощает взаимодействие с моделями GPT-4 через клиент `g4f.client.Client`. Он позволяет поддерживать историю диалога, добавлять сообщения пользователя и получать ответы от ассистента.

## Подробнее

Этот модуль предназначен для управления диалогами с использованием модели GPT-4. Он инициализирует клиент, сохраняет историю сообщений и предоставляет методы для добавления сообщений пользователя и получения ответов от модели. Он позволяет поддерживать контекст диалога.

## Классы

### `ConversationHandler`

**Описание**: Класс для управления диалогом с использованием GPT-4.

**Принцип работы**:
Класс `ConversationHandler` инициализируется с указанием модели, используемой для диалога (по умолчанию "gpt-4"). Он поддерживает историю диалога в виде списка сообщений. Методы `add_user_message` добавляют сообщения пользователя в историю, а `get_response` отправляет историю сообщений в модель и возвращает ответ ассистента.

**Атрибуты**:
- `client` (g4f.client.Client): Клиент для взаимодействия с API g4f.
- `model` (str): Модель, используемая для генерации ответов (по умолчанию "gpt-4").
- `conversation_history` (list): Список словарей, представляющих историю диалога.

**Методы**:
- `__init__(model)`: Инициализирует экземпляр класса `ConversationHandler`.
- `add_user_message(content)`: Добавляет сообщение пользователя в историю диалога.
- `get_response()`: Получает ответ от модели на основе истории диалога.

## Функции

### `__init__`

```python
def __init__(self, model="gpt-4"):
    """
    Инициализирует экземпляр класса `ConversationHandler`.

    Args:
        model (str): Модель, используемая для генерации ответов (по умолчанию "gpt-4").

    """
```

**Назначение**: Инициализация объекта `ConversationHandler`.

**Параметры**:
- `model` (str): Модель, используемая для генерации ответов. По умолчанию `"gpt-4"`.

**Как работает функция**:

1. Инициализирует клиент `g4f.client.Client`.
2. Устанавливает модель для диалога.
3. Инициализирует пустой список `conversation_history` для хранения истории диалога.

**Примеры**:

```python
conversation = ConversationHandler(model="gpt-4")
```

### `add_user_message`

```python
def add_user_message(self, content):
    """
    Добавляет сообщение пользователя в историю диалога.

    Args:
        content (str): Сообщение пользователя.

    """
```

**Назначение**: Добавление сообщения пользователя в историю диалога.

**Параметры**:
- `content` (str): Сообщение пользователя.

**Как работает функция**:

1. Создает словарь, представляющий сообщение пользователя, с ключами `"role"` (установлено в `"user"`) и `"content"` (содержимое сообщения).
2. Добавляет этот словарь в список `conversation_history`.

**Примеры**:

```python
conversation = ConversationHandler()
conversation.add_user_message("Hello!")
```

### `get_response`

```python
def get_response(self):
    """
    Получает ответ от модели на основе истории диалога.

    Returns:
        str: Ответ ассистента.

    """
```

**Назначение**: Получение ответа от модели на основе истории диалога.

**Возвращает**:
- `str`: Ответ ассистента.

**Как работает функция**:

1. Вызывает метод `create` у `self.client.chat.completions` с указанием модели и истории диалога.
2. Извлекает роль и содержимое ответа из объекта `response`.
3. Создает словарь, представляющий сообщение ассистента, с ключами `"role"` и `"content"`.
4. Добавляет это сообщение в список `conversation_history`.
5. Возвращает содержимое сообщения ассистента.

**Примеры**:

```python
conversation = ConversationHandler()
conversation.add_user_message("Hello!")
print("Assistant:", conversation.get_response())