# Анализ кода модуля `tic_tac.py`

**Качество кода**

-  **Соответствие требованиям к формату кода (1-10):** 7
    -   **Преимущества:**
        -   Код достаточно прост и понятен.
        -   Используются функции для разделения логики.
        -   Присутствуют комментарии, описывающие функционал.
        -   Логика игры "Крестики-нолики" реализована правильно.
        -   Есть базовая проверка ввода пользователя.
    -   **Недостатки:**
        -   Нет обработки исключений для всех случаев (например, при вводе нечислового значения).
        -   Нет логгирования ошибок, что затрудняет отладку.
        -   Используются глобальные переменные для доски, что не очень хорошо для масштабируемости.
        -   Комментарии не соответствуют формату reStructuredText (RST).
        -   Не используются `j_loads` или `j_loads_ns`.
        -   Не используются импорты из `src`.

**Рекомендации по улучшению**

1.  **Формат документации:**
    -   Переписать все комментарии в формате reStructuredText (RST).
    -   Добавить docstring к модулю, функциям и переменным.
2.  **Обработка данных:**
    -   Заменить все комментарии на формат RST.
    -   Добавить логгирование ошибок с помощью `src.logger.logger`.
    -   Устранить избыточное использование `try-except` и использовать `logger.error`.
3.  **Структура кода:**
    -   Добавить необходимые импорты.
    -   Переименовать функции и переменные в соответствии с ранее обработанными файлами.
4.  **Улучшения:**
    -   Добавить более детальные проверки ввода.
    -   Улучшить сообщения об ошибках.
    -   Использовать `j_loads` или `j_loads_ns`, если требуется работа с файлами.

**Улучшенный код**
```python
"""
Модуль для реализации игры "Крестики-нолики".
=========================================================================================

Этот модуль содержит функции для игры в "Крестики-нолики" между компьютером и игроком.

Пример использования
--------------------

Пример запуска игры "Крестики-нолики":

.. code-block:: python

   if __name__ == "__main__":
       play_tic_tac_toe()
"""


from src.logger.logger import logger  # Импорт логгера


# Функция для вывода игрового поля
def print_board(board: list) -> None:
    """
    Выводит текущее состояние игрового поля в консоль.

    :param board: Список, представляющий игровое поле.
    :type board: list
    """
    print("\n   " + board[1] + " | " + board[2] + " | " + board[3])
    print("  ---+---+---")
    print("   " + board[4] + " | " + board[5] + " | " + board[6])
    print("  ---+---+---")
    print("   " + board[7] + " | " + board[8] + " | " + board[9] + "\n")


# Функция для проверки победы
def check_win(board: list, player: str) -> bool:
    """
    Проверяет, есть ли выигрышная комбинация для данного игрока.

    :param board: Список, представляющий игровое поле.
    :type board: list
    :param player: Символ игрока ('X' или 'O').
    :type player: str
    :return: True, если игрок выиграл, иначе False.
    :rtype: bool
    """
    # Все возможные выигрышные комбинации
    winning_combinations = [
        [1, 2, 3], [4, 5, 6], [7, 8, 9],  # Горизонтальные
        [1, 4, 7], [2, 5, 8], [3, 6, 9],  # Вертикальные
        [1, 5, 9], [3, 5, 7]  # Диагональные
    ]
    # Проверка каждой комбинации на соответствие символам игрока
    for combination in winning_combinations:
        if (board[combination[0]] == board[combination[1]] ==
                board[combination[2]] == player):
            return True
    return False


# Функция для проверки ничьей
def check_draw(board: list) -> bool:
    """
    Проверяет, является ли текущая игра ничьей.

    :param board: Список, представляющий игровое поле.
    :type board: list
    :return: True, если ничья, иначе False.
    :rtype: bool
    """
    # Возвращает True, если нет свободных клеток
    return ' ' not in board[1:]


def play_tic_tac_toe() -> None:
    """
    Основная функция для запуска игры "Крестики-нолики".
    """
    # Инициализация игрового поля
    board = [' '] * 10  # 0 индекс не используется
    # Основной игровой цикл
    while True:
        # Вывод игрового поля
        print_board(board)

        # Ход игрока (человека)
        while True:
            try:
                cellNumber = int(input("Введите номер клетки (1-9) для 'O': "))
                # Проверка ввода на корректность
                if 1 <= cellNumber <= 9 and board[cellNumber] == ' ':
                    board[cellNumber] = 'O'
                    break
                else:
                    print("Неверный ввод. Пожалуйста, введите номер свободной клетки от 1 до 9.")
            except ValueError as e:
                logger.error(f"Неверный ввод от игрока: {e}", exc_info=True) # Логгирование ошибки ввода
                print("Неверный ввод. Пожалуйста, введите целое число от 1 до 9.")
        # Проверка победы игрока
        if check_win(board, 'O'):
            print_board(board)
            print("Вы выиграли! Поздравляю!")
            break

        # Проверка на ничью
        if check_draw(board):
            print_board(board)
            print("Ничья!")
            break

        # Ход компьютера
        # Поиск первой свободной клетки
        for i in range(1, 10):
            if board[i] == ' ':
                board[i] = 'X'
                break

        # Проверка победы компьютера
        if check_win(board, 'X'):
            print_board(board)
            print("Компьютер выиграл!")
            break
        # Проверка на ничью
        if check_draw(board):
            print_board(board)
            print("Ничья!")
            break


# Запуск игры
if __name__ == "__main__":
    play_tic_tac_toe()
    # Функция play_tic_tac_toe() запускается только при прямом запуске скрипта
"""
Объяснение кода:
1.  **Функция `print_board(board)`**:
    -   Принимает список `board`, представляющий игровое поле.
    -   Выводит текущее состояние поля в консоль, разделяя клетки линиями.
2.  **Функция `check_win(board, player)`**:
    -   Принимает `board` и символ `player` ('X' или 'O').
    -   Содержит список `winning_combinations`, описывающий все выигрышные комбинации.
    -   Проверяет каждую комбинацию на наличие трех символов игрока.
    -   Возвращает `True`, если есть выигрышная комбинация для данного игрока, иначе `False`.
3.  **Функция `check_draw(board)`**:
    -   Принимает список `board`.
    -   Проверяет, есть ли свободные клетки на игровом поле.
    -   Возвращает `True`, если все клетки заполнены (ничья), иначе `False`.
4.  **Функция `play_tic_tac_toe()`**:
    -   Инициализирует `board` как список из 10 элементов, где первые 9 представляют клетки, а 0 не используется.
    -   Основной цикл `while True:` продолжается до тех пор, пока не будет объявлен победитель или не будет ничья.
    -   Выводит текущее состояние доски с помощью `print_board(board)`.
    -   **Ход игрока**:
        -   Внутренний цикл `while True:` обеспечивает повторный ввод, пока не будет введен корректный ход.
        -   Запрашивает ввод номера клетки у игрока и проверяет его корректность (число от 1 до 9 и клетка свободна).
        -   Устанавливает символ 'O' в выбранную клетку.
        -   Выходит из внутреннего цикла, если ввод корректен.
    -   **Проверка победы игрока**:
        -   Вызывает функцию `check_win` для проверки победы игрока.
        -   Выводит сообщение о победе и заканчивает игру, если игрок выиграл.
    -   **Проверка ничьей**:
        -   Вызывает `check_draw`, чтобы проверить, не ничья ли игра.
        -   Выводит сообщение о ничьей и заканчивает игру, если ничья.
    -   **Ход компьютера**:
        -   Ищет первую свободную клетку в списке `board`.
        -   Устанавливает символ 'X' в найденную свободную клетку.
    -   **Проверка победы компьютера**:
        -   Вызывает `check_win`, чтобы проверить победу компьютера.
        -   Выводит сообщение о победе и заканчивает игру, если компьютер выиграл.
    -   **Проверка ничьей после хода компьютера**:
        -   Вызывает `check_draw` для проверки ничьи после хода компьютера.
        -   Выводит сообщение о ничьей, если игра завершилась вничью.
5.  **Запуск игры**:
    -   `if __name__ == "__main__":`: Этот блок гарантирует, что функция `play_tic_tac_toe()` будет запущена, только если файл исполняется напрямую, а не импортируется как модуль.
    -  `play_tic_tac_toe()`: Вызывает функцию для начала игры.
"""
```