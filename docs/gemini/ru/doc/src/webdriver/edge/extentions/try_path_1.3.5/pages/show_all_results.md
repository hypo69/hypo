# Модуль show_all_results.js

## Обзор

Этот модуль JavaScript отвечает за отображение результатов поиска, полученных от расширения. Он обрабатывает полученные данные, форматирует их и выводит в DOM-элементы страницы.  Также он позволяет загрузить результаты в текстовый файл.

## Функции

### `showAllResults`

**Описание**: Функция отображает результаты поиска в заданных элементах страницы. Она обрабатывает данные `results`, обновляет соответствующие поля и таблицы с деталями.

**Параметры**:

- `results` (объект): Объект, содержащий результаты поиска.  Необходимо, чтобы он содержал следующие свойства: `message`, `title`, `href`, `frameId`, `context` (опционально) и `main`.

**Обрабатываемые исключения**:

- `fu.onError`: Функция `fu.onError` обрабатывает возникшие ошибки.


### `makeTextDownloadUrl`

**Описание**: Функция создает URL для скачивания текстового файла.

**Параметры**:

- `text` (строка): Текст, который необходимо сохранить в файл.

**Возвращает**:

- `URL`: URL для загрузки файла.


### `makeInfoText`

**Описание**: Функция создаёт строку текста содержащую информацию о результатах поиска. Используется для экспорта данных.

**Параметры**:

- `results` (объект): Объект результатов поиска.


**Возвращает**:

- `строка`:  Форматированная строка с информацией о результатах.

### `makeConvertedInfoText`

**Описание**: Функция создаёт строку текста содержащую информацию о результатах поиска в формате JSON. Используется для экспорта данных.

**Параметры**:

- `results` (объект): Объект результатов поиска.


**Возвращает**:

- `строка`:  Форматированная строка с информацией о результатах в формате JSON.


## Дополнительная информация

Функции `fu.updateDetailsTable` и `fu.onError` предполагаются как часть внешнего модуля `tryxpath.functions` и не описываются в данном файле.
Функция `fu.makeDetailText` также предполагается внешней, и ее описание отсутствует.

## Обработчики событий

### `window.addEventListener('load')`

**Описание**: Обработчик события загрузки страницы.  Получает результаты от расширения, обрабатывает их, создаёт ссылки для скачивания и вызывает функцию `showAllResults`.

**Обрабатываемые исключения**:

- `fu.onError`: Функция `fu.onError` обрабатывает возникшие ошибки при общении с расширением.


### `contDetail.addEventListener('click')`

**Описание**: Обработчик кликов на кнопках в таблице контекста. Отправляет сообщение расширению для фокусировки элемента контекста.

**Обрабатываемые исключения**:


- Нет явных исключений, но потенциально могут возникнуть ошибки при взаимодействии с расширением.

### `mainDetails.addEventListener('click')`

**Описание**: Обработчик кликов на кнопках в таблице основных результатов. Отправляет сообщение расширению для фокусировки элемента основных результатов.

**Обрабатываемые исключения**:

- Нет явных исключений, но потенциально могут возникнуть ошибки при взаимодействии с расширением.


## Структура данных

Модуль ожидает, что объект `results`, полученный из расширения, будет иметь структуру с полями: `message`, `title`, `href`, `frameId`, `context`, `main`.  Конкретные структуры `context` и `main` должны иметь свойства, используемые для отображения информации.

## Замечания

* Используется анонимная функция с замыканием для доступа к глобальным переменным.
*  Для обработки исключений используется `catch(fu.onError)`.
* Используется `browser.runtime.sendMessage` для взаимодействия с расширением.
* Функции `makeTextDownloadUrl`, `makeInfoText`, `makeConvertedInfoText` генерируют текст для скачивания.