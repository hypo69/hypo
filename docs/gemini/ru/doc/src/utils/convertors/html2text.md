# Модуль `hypotez/src/utils/convertors/html2text.py`

## Обзор

Модуль `html2text` преобразует HTML-код в эквивалентный текст в формате Markdown. Поддерживает различные опции форматирования, такие как обработка ссылок, изображений, списков, заголовков и блоков цитат.

## Параметры

Этот модуль использует несколько констант и опций, определяющих поведение преобразования:

* `MODE`: Строка, определяющая режим работы (например, 'dev').
* `UNICODE_SNOB`: Логическое значение, определяющее использование юникода вместо ASCII-заменителей.
* `LINKS_EACH_PARAGRAPH`: Логическое значение, определяющее расположение ссылок после каждого абзаца.
* `BODY_WIDTH`: Целое число, определяющее ширину обрезки длинных строк.
* `SKIP_INTERNAL_LINKS`: Логическое значение, определяющее игнорирование внутренних ссылок.
* `INLINE_LINKS`: Логическое значение, определяющее использование встроенного, а не ссылочного, форматирования для изображений и ссылок.
* `GOOGLE_LIST_INDENT`: Число пикселей, определяющее отступ вложенных списков в Google Docs.
* `IGNORE_ANCHORS`: Логическое значение, определяющее игнорирование анкоров.
* `IGNORE_IMAGES`: Логическое значение, определяющее игнорирование изображений.

## Функции

### `has_key`

**Описание**: Проверяет наличие ключа в словаре или объекте.

**Параметры**:
- `x`: Словарь или объект, в котором ищется ключ.
- `y`: Ключ, который ищется.

**Возвращает**:
- `True` если ключ существует, иначе `False`.


### `name2cp`

**Описание**: Преобразует имя сущности HTML в её код символа.

**Параметры**:
- `k`: Имя сущности.

**Возвращает**:
- Код символа.


### `charref`

**Описание**: Преобразует числовую ссылку HTML в соответствующий символ.

**Параметры**:
- `name`: Числовая ссылка (например, `&#160;`).

**Возвращает**:
- Символ, соответствующий числовой ссылке.


### `entityref`

**Описание**: Преобразует ссылку на сущность HTML в соответствующий символ.

**Параметры**:
- `c`: Имя сущности.

**Возвращает**:
- Символ, соответствующий ссылке на сущность.


### `replaceEntities`

**Описание**: Заменяет сущности HTML на соответствующие символы.

**Параметры**:
- `s`: Строка с сущностями HTML.

**Возвращает**:
- Строка с заменёнными сущностями.


### `unescape`

**Описание**: Разбирает и заменяет HTML-сущности в строке.

**Параметры**:
- `s`: Входная строка.

**Возвращает**:
- Строка с обработанными HTML-сущностями.


### `onlywhite`

**Описание**: Проверяет, состоит ли строка только из пробелов.

**Параметры**:
- `line`: Строка, которую необходимо проверить.

**Возвращает**:
- `True` если строка состоит только из пробелов, иначе `False`.


### `optwrap`

**Описание**: Обрезает длинные строки.

**Параметры**:
- `text`: Входной текст.

**Возвращает**:
- Обрезанный текст.


### `hn`

**Описание**: Возвращает уровень заголовка.

**Параметры**:
- `tag`: Тэг HTML.

**Возвращает**:
- Уровень заголовка (целое число от 1 до 6) или 0, если не является заголовком.


### `dumb_property_dict`

**Описание**: Возвращает словарь CSS-атрибутов.

**Параметры**:
- `style`: Строка CSS-стилей.

**Возвращает**:
- Словарь CSS-атрибутов.


### `dumb_css_parser`

**Описание**: Разбирает строку CSS.

**Параметры**:
- `data`: Строка CSS.

**Возвращает**:
- Словарь CSS-селекторов.


### `element_style`

**Описание**: Возвращает стиль элемента.

**Параметры**:
- `attrs`: Атрибуты элемента.
- `style_def`: Словарь стилей.
- `parent_style`: Стиль родительского элемента.

**Возвращает**:
- Словарь стилей элемента.


### `google_list_style`

**Описание**: Определяет тип списка (упорядоченный или неупорядоченный) для Google Docs.

**Параметры**:
- `style`: Стиль элемента.

**Возвращает**:
- `'ul'` если неупорядоченный список, `'ol'` если упорядоченный, иначе пустую строку.


### `google_nest_count`

**Описание**:  Возвращает уровень вложенности списка в Google Docs.

**Параметры**:
- `style`: Стиль элемента.

**Возвращает**:
- Уровень вложенности.


### `google_has_height`

**Описание**: Проверяет, определена ли высота элемента в CSS.

**Параметры**:
- `style`: Стиль элемента.

**Возвращает**:
- `True` если высота определена, иначе `False`.


### `google_text_emphasis`

**Описание**: Возвращает список модификаторов форматирования текста.

**Параметры**:
- `style`: Стиль элемента.

**Возвращает**:
- Список модификаторов форматирования текста.


### `google_fixed_width_font`

**Описание**: Проверяет, используется ли в элементе шрифт с фиксированной шириной.

**Параметры**:
- `style`: Стиль элемента.

**Возвращает**:
- `True`, если используется шрифт с фиксированной шириной, `False` иначе.


### `list_numbering_start`

**Описание**: Возвращает начальное значение нумерации для списка.

**Параметры**:
- `attrs`: Атрибуты элемента.

**Возвращает**:
- Начальное значение нумерации.

### `_html2text`

**Описание**: Класс, реализующий парсинг HTML и преобразование в Markdown.

(Подробное описание методов класса опущенно из-за большого размера.  См. исходный код.)

### `wrapwrite`

**Описание**: Функция для записи текста в stdout.

**Параметры**:
- `text`: Текст для записи.

### `html2text_file`

**Описание**: Преобразует HTML в Markdown и записывает в заданный поток.

**Параметры**:
- `html`: HTML-код для преобразования.
- `out`: Функция для записи результата (по умолчанию `wrapwrite`).
- `baseurl`: Базовый URL.

**Возвращает**:
- Преобразованный текст в формате Markdown.


### `html2text`

**Описание**: Преобразует HTML-код в Markdown, обрабатывая возможные ошибки и возвращая результат.

**Параметры**:
- `html`: HTML-код для преобразования.
- `baseurl`: Базовый URL.

**Возвращает**:
- Преобразованный текст в формате Markdown.

## Классы

### `Storage`

**Описание**: Пустой класс, используемый для хранения опций.

## Опции


Модуль принимает различные опции, влияющие на преобразование, через командную строку.
```
```
```markdown
## Команды (CLI)

### Доступные параметры:

- `-g`, `--google-doc`: Преобразовать HTML, экспортированный из Google Docs.
- `-d`, `--dash-unordered-list`: Использовать дефис вместо звёздочки для пунктов неупорядоченных списков.
- `-b`, `--body-width`: Ширина обрезки длинных строк (значение по умолчанию 78).
- `-i`, `--google-list-indent`: Отступ вложенных списков в Google Docs (значение по умолчанию 36).
- `-s`, `--hide-strikethrough`: Скрыть текст с зачёркиванием.

Подробную информацию об использовании вызовите с опцией `-h` или `--help`.
```
```