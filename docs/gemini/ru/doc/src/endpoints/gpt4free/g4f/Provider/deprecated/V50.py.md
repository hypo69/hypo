# Модуль V50

## Обзор

Модуль `V50` предоставляет класс `V50`, который является устаревшим провайдером для взаимодействия с API `p5.v50.ltd`. Этот модуль предназначен для создания завершений на основе предоставленных сообщений, имитируя поведение чат-ассистента. Провайдер поддерживает модель `gpt-3.5-turbo` и не требует аутентификации, однако потоковая передача не поддерживается.

## Подробнее

Модуль `V50` является частью устаревших провайдеров и, вероятно, больше не поддерживается или не рекомендуется к использованию в новых проектах. Он включает в себя функциональность для отправки запросов к API `p5.v50.ltd` и получения ответов, адаптированных под формат чат-ассистента.

## Классы

### `V50(AbstractProvider)`

**Описание**: Класс `V50` является провайдером, реализующим взаимодействие с API `p5.v50.ltd`. Он наследуется от `AbstractProvider` и предоставляет метод для создания завершений на основе предоставленных сообщений.

**Наследует**:
- `AbstractProvider`: Абстрактный класс, определяющий интерфейс для всех провайдеров.

**Атрибуты**:
- `url` (str): URL-адрес API `p5.v50.ltd`.
- `supports_gpt_35_turbo` (bool): Указывает, поддерживает ли провайдер модель `gpt-3.5-turbo`.
- `supports_stream` (bool): Указывает, поддерживает ли провайдер потоковую передачу.
- `needs_auth` (bool): Указывает, требуется ли аутентификация для использования провайдера.
- `working` (bool): Указывает, находится ли провайдер в рабочем состоянии.

**Методы**:
- `create_completion()`: Создает завершение на основе предоставленных сообщений.

## Функции

### `create_completion(model: str, messages: list[dict[str, str]], stream: bool, **kwargs: Any) -> CreateResult`

**Назначение**: Создает запрос к API `p5.v50.ltd` для генерации ответа на основе предоставленных сообщений.

**Параметры**:
- `model` (str): Идентификатор используемой модели.
- `messages` (list[dict[str, str]]): Список сообщений, представляющих контекст диалога. Каждое сообщение содержит роль (`role`) и содержимое (`content`).
- `stream` (bool): Указывает, следует ли использовать потоковую передачу (в данном случае всегда `False`).
- `**kwargs` (Any): Дополнительные параметры запроса, такие как `temperature`, `top_p` и `proxy`.

**Возвращает**:
- `CreateResult`: Генератор, возвращающий текст ответа от API.

**Как работает функция**:

1. **Формирование запроса**:
   - Из списка сообщений формируется строка `conversation`, объединяющая роль и содержимое каждого сообщения.
   - Создается словарь `payload` с данными для отправки в API, включающий `prompt`, `options`, `systemMessage`, `temperature`, `top_p`, `model` и `user`.
   - Формируются заголовки `headers` для HTTP-запроса.

2. **Отправка запроса**:
   - Отправляется POST-запрос к API `https://p5.v50.ltd/api/chat-process` с использованием библиотеки `requests`.
   - В запросе передаются `payload`, `headers` и, при наличии, параметры прокси из `kwargs`.

3. **Обработка ответа**:
   - Проверяется, содержит ли текст ответа строку `https://fk1.v50.ltd`.
   - Если строка отсутствует, текст ответа передается через `yield`, что делает функцию генератором.

```
Формирование запроса
│
├─── Объединение сообщений в conversation
│
├─── Создание payload с параметрами
│
└─── Формирование headers для запроса
│
Отправка POST-запроса
│
└─── Отправка запроса к API p5.v50.ltd
│
Обработка ответа
│
└─── Проверка наличия "https://fk1.v50.ltd" в ответе
│
└─── Если отсутствует, возврат текста ответа через yield
```

**Примеры**:

```python
# Пример вызова функции create_completion
model = "gpt-3.5-turbo"
messages = [
    {"role": "user", "content": "Hello, how are you?"},
    {"role": "assistant", "content": "I am doing well, thank you. How can I help you today?"}
]
stream = False
kwargs = {"temperature": 0.5, "top_p": 0.5}

result = V50.create_completion(model, messages, stream, **kwargs)
for item in result:
    print(item)