# Модуль crypto

## Обзор

Модуль `crypto.py` предоставляет функции для шифрования и дешифрования данных с использованием алгоритма AES в режиме CBC, а также для обработки ключей и атрибутов, специфичных для Mega.

## Оглавление
1. [Функции](#Функции)
    - [`aes_cbc_encrypt`](#aes_cbc_encrypt)
    - [`aes_cbc_decrypt`](#aes_cbc_decrypt)
    - [`aes_cbc_encrypt_a32`](#aes_cbc_encrypt_a32)
    - [`aes_cbc_decrypt_a32`](#aes_cbc_decrypt_a32)
    - [`stringhash`](#stringhash)
    - [`prepare_key`](#prepare_key)
    - [`encrypt_key`](#encrypt_key)
    - [`decrypt_key`](#decrypt_key)
    - [`enc_attr`](#enc_attr)
    - [`dec_attr`](#dec_attr)

## Функции

### `aes_cbc_encrypt`

**Описание**: Шифрует данные с использованием алгоритма AES в режиме CBC.

**Параметры**:
- `data` (bytes): Данные для шифрования.
- `key` (bytes): Ключ шифрования.

**Возвращает**:
- `bytes`: Зашифрованные данные.

### `aes_cbc_decrypt`

**Описание**: Дешифрует данные, зашифрованные алгоритмом AES в режиме CBC.

**Параметры**:
- `data` (bytes): Данные для дешифрования.
- `key` (bytes): Ключ дешифрования.

**Возвращает**:
- `bytes`: Дешифрованные данные.

### `aes_cbc_encrypt_a32`

**Описание**: Шифрует данные в формате a32 с использованием алгоритма AES в режиме CBC.

**Параметры**:
- `data` (list[int]): Данные для шифрования в формате a32.
- `key` (list[int]): Ключ шифрования в формате a32.

**Возвращает**:
- `list[int]`: Зашифрованные данные в формате a32.

### `aes_cbc_decrypt_a32`

**Описание**: Дешифрует данные в формате a32, зашифрованные алгоритмом AES в режиме CBC.

**Параметры**:
- `data` (list[int]): Данные для дешифрования в формате a32.
- `key` (list[int]): Ключ дешифрования в формате a32.

**Возвращает**:
- `list[int]`: Дешифрованные данные в формате a32.

### `stringhash`

**Описание**: Создает хэш строки с использованием алгоритма AES и возвращает его в формате base64.

**Параметры**:
- `s` (str): Строка для хэширования.
- `aeskey` (list[int]): Ключ AES в формате a32.

**Возвращает**:
- `str`: Хэш строки в формате base64.

### `prepare_key`

**Описание**: Подготавливает ключ для шифрования/дешифрования.

**Параметры**:
- `a` (list[int]): Исходный ключ в формате a32.

**Возвращает**:
- `list[int]`: Подготовленный ключ в формате a32.

### `encrypt_key`

**Описание**: Шифрует ключ с использованием алгоритма AES в режиме CBC.

**Параметры**:
- `a` (list[int]): Ключ для шифрования в формате a32.
- `key` (list[int]): Ключ шифрования в формате a32.

**Возвращает**:
- `tuple[int]`: Зашифрованный ключ в формате a32.

### `decrypt_key`

**Описание**: Дешифрует ключ, зашифрованный алгоритмом AES в режиме CBC.

**Параметры**:
- `a` (list[int]): Ключ для дешифрования в формате a32.
- `key` (list[int]): Ключ дешифрования в формате a32.

**Возвращает**:
- `tuple[int]`: Дешифрованный ключ в формате a32.

### `enc_attr`

**Описание**: Шифрует атрибуты с добавлением префикса 'MEGA' и последующим шифрованием AES в режиме CBC.

**Параметры**:
- `attr` (dict): Словарь атрибутов для шифрования.
- `key` (list[int]): Ключ шифрования в формате a32.

**Возвращает**:
- `bytes`: Зашифрованные атрибуты.

### `dec_attr`

**Описание**: Дешифрует атрибуты, зашифрованные функцией `enc_attr`.

**Параметры**:
- `attr` (bytes): Зашифрованные атрибуты.
- `key` (list[int]): Ключ дешифрования в формате a32.

**Возвращает**:
- `dict`: Дешифрованные атрибуты в виде словаря.