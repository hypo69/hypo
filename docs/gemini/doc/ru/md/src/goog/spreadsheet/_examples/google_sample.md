# Модуль `hypotez/src/goog/spreadsheet/_examples/google_sample.py`

## Обзор

Данный модуль предоставляет пример использования Google Sheets API для получения данных из конкретного листа. Модуль реализует функцию `main`, которая авторизуется в Google аккаунте, получает данные из заданного листа и выводит их на консоль.


## Функции

### `main`

**Описание**: Функция `main` реализует основную логику работы с Google Sheets API. Она авторизуется, получает данные из указанного листа и выводит их в формате "Имя, Специальность".

**Параметры**:

Нет параметров.

**Возвращает**:

Нет возвращаемого значения.

**Вызывает исключения**:

- `HttpError`: Возникает при ошибке в запросе к Google Sheets API.  В блоке обработки исключений `ex` происходит вывод подробной информации об ошибке.


## Постоянные значения

### `MODE`

**Описание**:  Переменная `MODE` хранит строковое значение, которое, по всей видимости, определяет режим работы программы.  (значение `'dev'` ).


### `SCOPES`

**Описание**: Список из строк, определяющих разрешения доступа к Google Sheets API. В данном случае, это доступ только для чтения.


### `SAMPLE_SPREADSHEET_ID`

**Описание**: Строка, содержащая идентификатор Google Sheets таблицы.


### `SAMPLE_RANGE_NAME`

**Описание**: Строка, определяющая диапазон ячеек в таблице, из которого необходимо получить данные.


### `ROOT_DIRECTORY`

**Описание**: Путь к корневой директории текущего проекта.


### `path`

**Описание**:  Полный путь к файлу `client_secret.json`.  Важно обратить внимание, что жестко заданный путь к файлу может быть проблемой, если вы переместите проект.  Реализация должна быть более гибкой.

## Подробности реализации

Функция `main` использует библиотеки `google-auth-oauthlib` и `googleapiclient` для взаимодействия с Google Sheets API.
Обратите внимание на:

- **Авторизацию:** Функция пытается загрузить существующий файл `token.json` с токенами доступа. Если токенов нет или они просрочены, запускается локальный сервер для авторизации пользователя. Токен сохраняется для последующего использования.
- **Обработку ошибок:** Блок `try...except` обрабатывает возможные ошибки при запросе к API (например, если пользователь не авторизован или нет доступа к таблице).
- **Вывод данных:** Вывод данных происходит в заданном формате "Имя, Специальность".


## Пример использования

Для использования модуля, необходимо:

1.  Получить файл `client_secret.json` от Google Cloud Console.
2.  Скопировать `client_secret.json` в папку `google_api/secrets`.
3.  Запустить скрипт.

```bash
python google_sample.py
```

Этот скрипт выведет данные из указанного листа в консоль.


## Замечания

-  Путь к файлу `client_secret.json` должен быть правильно настроен.
-  Необходимо убедиться, что у вашего приложения есть необходимые разрешения для доступа к Google Sheets.
-  Идентификатор таблицы и диапазон ячеек должны быть корректными для вашего листа.
-  В коде есть hardcoded путь к файлу `client_secret.json`.  Рекомендуется вынести этот путь в переменную окружения, или использовать более гибкий механизм для определения пути.