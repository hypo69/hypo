# Модуль `hypotez/src/utils/jjson.py`

## Обзор

Модуль `jjson` предоставляет функции для работы с JSON и CSV файлами, включая загрузку, сохранение, слияние и преобразование данных.  Он поддерживает конвертацию данных в SimpleNamespace для удобной работы, а также предоставляет инструменты для обработки JSON данных из Markdown строк.

## Функции

### `j_dumps`

**Описание**: Функция сохраняет данные в формате JSON в файл или возвращает данные в формате JSON как словарь, если путь к файлу не указан. Поддерживает различные режимы записи: "w", "a+", "+a".

**Параметры**:

- `data` (Dict | SimpleNamespace | List[Dict] | List[SimpleNamespace]): Данные, которые нужно сохранить в JSON формате. Может быть словарем, SimpleNamespace объектом, списком словарей или списком SimpleNamespace объектов.
- `file_path` (Optional[Path], optional): Путь к файлу, куда нужно сохранить JSON данные. Если `None`, то функция вернёт JSON данные как словарь. По умолчанию `None`.
- `ensure_ascii` (bool, optional):  Если `True`,  не ASCII символы будут экранированы. По умолчанию `True`.
- `mode` (str, optional): Режим открытия файла. Допустимые значения: "w", "a+", "+a".  По умолчанию "w".
- `exc_info` (bool, optional): Если `True`, то информация об ошибке будет записана в лог вместе с трейсом. По умолчанию `True`.

**Возвращает**:

- Optional[Dict]: Словарь с JSON данными, если сохранение прошло успешно. `None` в случае ошибки.

**Возможные исключения**:

- `ValueError`: Если передан неподдерживаемый режим открытия файла.
- `Exception`: Возможные исключения при работе с файлом (например, проблемы с чтением/записью). Сообщения об ошибках будут логгированы.

### `j_loads`

**Описание**: Функция загружает JSON или CSV данные из файла, директории или строки. Может обрабатывать JSON в Markdown.

**Параметры**:

- `jjson` (Path | dict | str | list[dict] | list[SimpleNamespace]): Путь к файлу, директории, JSON данные в виде строки или JSON объект.
- `ordered` (bool, optional): Если `True`, возвращает `OrderedDict` для сохранения порядка элементов. По умолчанию `False`.
- `exc_info` (bool, optional): Если `True`, то информация об ошибке будет записана в лог вместе с трейсом. По умолчанию `True`.

**Возвращает**:

- Any: Словарь или список словарей, если загрузка успешна. `None` при ошибке.

**Возможные исключения**:

- `FileNotFoundError`: Если указанный файл не найден.
- `json.JSONDecodeError`: Если JSON данные не могут быть прочитаны.
- `Exception`: Возможные исключения при работе с файлом или обработке данных.


### `j_loads_ns`

**Описание**: Загружает JSON или CSV данные из файла, директории или строки и преобразует их в SimpleNamespace объекты.

**Параметры**:

- `jjson` (Path | SimpleNamespace | Dict | str):  Путь к файлу, директории, JSON данные в виде строки или JSON объект.
- `ordered` (bool, optional): Если `True`, возвращает `OrderedDict`. По умолчанию `False`.
- `exc_info` (bool, optional): Если `True`,  то информация об ошибке будет записана в лог вместе с трейсом. По умолчанию `True`.


**Возвращает**:

- Optional[SimpleNamespace | List[SimpleNamespace]]: Возвращает `SimpleNamespace` или список `SimpleNamespace` объектов при успешной загрузке. `None` в случае ошибки.


### `replace_key_in_json`

**Описание**: Рекурсивно заменяет ключ в словаре или списке.

**Параметры**:

- `data` (dict | list): Словарь или список, в котором нужно заменить ключ.
- `old_key` (str): Ключ, который нужно заменить.
- `new_key` (str): Новый ключ.

**Возвращает**:

- dict: Обновлённый словарь с заменёнными ключами.

**Пример использования** (включён в документацию функции).

### `process_json_file`

**Описание**: Обрабатывает JSON файл, заменяя ключ `name` на `category_name`.

**Параметры**:

- `json_file` (Path): Путь к JSON файлу.

**Возможные исключения**:

- `Exception`: Возможные исключения при обработке файла.

### `recursive_process_json_files`

**Описание**: Рекурсивно обходит папки и обрабатывает все JSON файлы в них, заменяя ключ `name` на `category_name`.

**Параметры**:

- `directory` (Path): Путь к директории, которую нужно обработать.


### `extract_json_from_string`

**Описание**: Извлекает JSON контент из Markdown строки, заключённый в ````json````.

**Параметры**:

- `md_string` (str): Markdown строка, содержащая JSON.

**Возвращает**:

- str: Извлечённая JSON строка или пустая строка, если JSON не найден.

**Возможные исключения**:

- `Exception`: Возможные исключения при извлечении JSON из Markdown.


## Классы

(В данном модуле нет классов)

## Поддержка

(Добавьте раздел с информацией о поддержке, если нужно)