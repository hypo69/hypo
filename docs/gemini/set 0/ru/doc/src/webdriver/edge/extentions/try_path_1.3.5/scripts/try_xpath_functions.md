# Модуль `try_xpath_functions`

## Обзор

Этот модуль предоставляет набор функций для работы с XPath-выражениями и DOM-элементами в JavaScript. Он позволяет выполнять XPath-запросы, получать результаты в различных форматах (узлы, числа, строки и т.д.), работать с коллекциями элементов и управлять их свойствами.

## Функции

### `execExpr`

**Описание**: Выполняет заданный XPath-запрос или DOM-запрос (querySelector/querySelectorAll) относительно заданного контекста.

**Параметры**:

- `expr` (string): XPath-выражение или CSS-селектор.
- `method` (string): Метод для выполнения запроса ("evaluate", "querySelector", "querySelectorAll"). По умолчанию "evaluate".
- `opts` (Optional[dict], optional): Опции запроса.
    - `context` (Node | Document | Element, optional): Контекст для выполнения запроса. По умолчанию `document`.
    - `resolver` (Optional[Callable], optional): Функция для разрешения значений в XPath-выражении.
    - `resultType` (Optional[int], optional): Тип результата для `evaluate`. По умолчанию `xpathResult.ANY_TYPE`.
    - `document` (Optional[Document], optional): Объект Document для использования при выполнении запроса (если нужно использовать другой документ, чем текущий).


**Возвращает**:

- `dict`: Словарь с результатами запроса:
    - `items` (list): Список результатов запроса (узлы, числа, строки и т.д.).
    - `method` (string): Использованный метод ("evaluate", "querySelector", "querySelectorAll").
    - `resultType` (int | null): Тип результата.


**Вызывает исключения**:

- `Error`: В случае несоответствия контекста ожидаемому типу (например, `querySelector` применен к не `Document` или `Element`, `evaluate` к не `Node` или `Attr`).  Описание конкретной ошибки будет указано в сообщении исключения.


### `resToArr`

**Описание**: Преобразует результат выполнения XPath запроса в массив.

**Параметры**:

- `res` (object): Результат XPath-выражения.
- `type` (int, optional): Тип результата (например, `xpathResult.NUMBER_TYPE`).

**Возвращает**:

- `array`: Массив значений, полученных из результатов запроса.

**Вызывает исключения**:

- `Error`: Если тип результата `res` не распознан.


### `makeResolver`

**Описание**: Создает функцию-разрешитель для использования в XPath-запросах.

**Параметры**:

- `obj` (Optional[string | dict | Callable], optional):  Может быть строкой, представляющей JSON-объект, объектом JavaScript или функцией.

**Возвращает**:

- `Callable`: Функция, которая принимает строку (ключ) и возвращает соответствующее значение из объекта или пустую строку, если ключ не найден.  Возвращает `null`, если `obj`  равен `null`.


**Вызывает исключения**:

- `Error`: При неверном формате входного `obj` (например, если строка не является валидным JSON, или `obj` не является объектом, или не содержит только строковые значения).


### `isValidDict`

**Описание**: Проверяет, является ли объект корректным словарем, содержащим только строковые значения.

**Параметры**:

- `obj` (object): Объект для проверки.


**Возвращает**:

- `bool`: `True`, если объект является валидным словарем, `False` иначе.


### ... (и так далее для всех остальных функций)