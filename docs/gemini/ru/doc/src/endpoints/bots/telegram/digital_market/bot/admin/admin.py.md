# Модуль `admin`

## Обзор

Модуль `admin` предоставляет функциональность для управления административной частью Telegram-бота, включая добавление и удаление товаров, просмотр статистики и другие административные действия. Он использует `aiogram` для обработки команд и взаимодействует с базой данных через `sqlalchemy`.

## Подробней

Модуль содержит роутер `admin_router`, который обрабатывает различные callback-запросы и сообщения от администраторов. Определены состояния через `FSM` (Finite State Machine) для управления процессом добавления товаров. Функции в модуле позволяют администраторам просматривать статистику, добавлять, удалять и управлять товарами через интерфейс бота.

## Классы

### `AddProduct`

**Описание**:
Класс `AddProduct` представляет собой группу состояний (StatesGroup) для процесса добавления нового товара. Каждое состояние соответствует определенному этапу ввода информации о товаре.

**Атрибуты**:
- `name` (State): Состояние для ввода имени товара.
- `description` (State): Состояние для ввода описания товара.
- `price` (State): Состояние для ввода цены товара.
- `file_id` (State): Состояние для ввода ID файла товара.
- `category_id` (State): Состояние для выбора категории товара.
- `hidden_content` (State): Состояние для ввода скрытого контента товара.
- `confirm_add` (State): Состояние для подтверждения добавления товара.

## Функции

### `start_admin`

```python
async def start_admin(call: CallbackQuery):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.

    Returns:
        None

    Raises:
        Exception: В случае возникновения ошибки при открытии админ-панели.

     Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "admin_panel".)
    """
```

**Описание**:
Обработчик callback-запроса `admin_panel`. Предоставляет администратору доступ к панели управления, отправляя клавиатуру с доступными действиями.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.

**Возвращает**:
- `None`

### `admin_statistic`

```python
async def admin_statistic(call: CallbackQuery, session_without_commit: AsyncSession):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных без коммита.

    Returns:
        None

    Raises:
         Ошибка выполнение

     Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "statistic".)
    """
```

**Описание**:
Обработчик callback-запроса `statistic`. Собирает и отображает статистику по пользователям и заказам.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения запросов к базе данных.

**Возвращает**:
- `None`

### `admin_process_cancel`

```python
async def admin_process_cancel(call: CallbackQuery, state: FSMContext):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "cancel".)
    """
```

**Описание**:
Обработчик callback-запроса `cancel`. Отменяет текущий сценарий добавления товара, очищает состояние пользователя и возвращает в предыдущее меню.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_start_dell`

```python
async def admin_process_start_dell(call: CallbackQuery, session_without_commit: AsyncSession):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных без коммита.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "delete_product".)
    """
```

**Описание**:
Обработчик callback-запроса `delete_product`. Отображает список товаров с возможностью их удаления.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения запросов к базе данных.

**Возвращает**:
- `None`

### `admin_process_start_dell`

```python
async def admin_process_start_dell(call: CallbackQuery, session_with_commit: AsyncSession):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        session_with_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных с коммитом.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку, начинающуюся с "dell_".)
    """
```

**Описание**:
Обработчик callback-запросов, начинающихся с `dell_`. Удаляет выбранный товар из базы данных.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `session_with_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных с коммитом.

**Возвращает**:
- `None`

### `admin_process_products`

```python
async def admin_process_products(call: CallbackQuery, session_without_commit: AsyncSession):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных без коммита.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "process_products".)
    """
```

**Описание**:
Обработчик callback-запроса `process_products`. Предоставляет администратору меню управления товарами (добавление, удаление и т.д.).

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения запросов к базе данных.

**Возвращает**:
- `None`

### `admin_process_add_product`

```python
async def admin_process_add_product(call: CallbackQuery, state: FSMContext):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "add_product".)
    """
```

**Описание**:
Обработчик callback-запроса `add_product`. Запускает сценарий добавления нового товара, начиная с запроса имени товара.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_name`

```python
async def admin_process_name(message: Message, state: FSMContext):
    """
    Args:
        message (Message): Объект Message, представляющий сообщение от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при вводе пользователем имени товара.)
    """
```

**Описание**:
Обработчик сообщения с именем товара. Сохраняет имя товара в состоянии и запрашивает описание товара.

**Параметры**:
- `message` (Message): Объект сообщения, содержащий введенное имя товара.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_description`

```python
async def admin_process_description(message: Message, state: FSMContext, session_without_commit: AsyncSession):
    """
    Args:
        message (Message): Объект Message, представляющий сообщение от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных без коммита.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при вводе пользователем описания товара.)
    """
```

**Описание**:
Обработчик сообщения с описанием товара. Сохраняет описание товара в состоянии и запрашивает категорию товара.

**Параметры**:
- `message` (Message): Объект сообщения, содержащий введенное описание товара.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения запросов к базе данных.

**Возвращает**:
- `None`

### `admin_process_category`

```python
async def admin_process_category(call: CallbackQuery, state: FSMContext):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при выборе пользователем категории товара.)
    """
```

**Описание**:
Обработчик callback-запроса с выбором категории товара. Сохраняет ID категории в состоянии и запрашивает цену товара.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_price`

```python
async def admin_process_price(message: Message, state: FSMContext):
    """
    Args:
        message (Message): Объект Message, представляющий сообщение от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при вводе пользователем цены товара.)
    """
```

**Описание**:
Обработчик сообщения с ценой товара. Сохраняет цену товара в состоянии и запрашивает файл товара (если требуется).

**Параметры**:
- `message` (Message): Объект сообщения, содержащий введенную цену товара.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_without_file`

```python
async def admin_process_without_file(call: CallbackQuery, state: FSMContext):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "without_file".)
    """
```

**Описание**:
Обработчик callback-запроса `without_file`. Указывает, что товар не имеет файла, и запрашивает скрытый контент товара.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_without_file`

```python
async def admin_process_without_file(message: Message, state: FSMContext):
    """
    Args:
        message (Message): Объект Message, представляющий сообщение от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при отправке пользователем файла (документа) для товара.)
    """
```

**Описание**:
Обработчик сообщения с файлом товара. Сохраняет ID файла в состоянии и запрашивает скрытый контент товара.

**Параметры**:
- `message` (Message): Объект сообщения, содержащий отправленный файл товара.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.

**Возвращает**:
- `None`

### `admin_process_hidden_content`

```python
async def admin_process_hidden_content(message: Message, state: FSMContext, session_without_commit: AsyncSession):
    """
    Args:
        message (Message): Объект Message, представляющий сообщение от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных без коммита.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при вводе пользователем скрытого контента для товара.)
    """
```

**Описание**:
Обработчик сообщения со скрытым контентом товара. Сохраняет скрытый контент в состоянии и отображает сводку введенных данных для подтверждения.

**Параметры**:
- `message` (Message): Объект сообщения, содержащий введенный скрытый контент товара.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения запросов к базе данных.

**Возвращает**:
- `None`

### `admin_process_confirm_add`

```python
async def admin_process_confirm_add(call: CallbackQuery, state: FSMContext, session_with_commit: AsyncSession):
    """
    Args:
        call (CallbackQuery): Объект CallbackQuery, представляющий обратный вызов от пользователя.
        state (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.
        session_with_commit (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных с коммитом.

    Returns:
        None

    Raises:
         Ошибка выполнение

    Example:
        Пример вызова:

        (Этот метод вызывается автоматически при нажатии пользователем на кнопку "confirm_add".)
    """
```

**Описание**:
Обработчик callback-запроса `confirm_add`. Подтверждает добавление товара, сохраняет данные в базе данных и завершает сценарий.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова, содержащий информацию о действии пользователя.
- `state` (FSMContext): Контекст машины состояний для хранения и управления состоянием пользователя.
- `session_with_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для выполнения операций с базой данных с коммитом.

**Возвращает**:
- `None`