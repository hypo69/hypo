# Модуль для создания провайдеров g4f

## Обзор

Этот модуль предназначен для автоматического создания файлов провайдеров для библиотеки `g4f` на основе команд cURL. Он принимает имя провайдера и команду cURL в качестве входных данных, затем использует модель GPT-4 для генерации кода провайдера на основе предоставленной команды cURL и сохраняет его в файл.

## Подробнее

Модуль упрощает процесс добавления новых провайдеров в библиотеку `g4f` путем автоматизации генерации большей части необходимого кода. Он считывает команду cURL, предоставляет ее в качестве входных данных в GPT-4, получает сгенерированный код и сохраняет его в соответствующем файле. Расположение файла в проекте: `hypotez/src/endpoints/gpt4free/etc/tool/create_provider.py`

## Функции

### `read_code`

```python
def read_code(text: str) -> str | None:
    """Функция извлекает код Python из текста, заключенного в блоки кода Markdown.

    Args:
        text (str): Текст, содержащий код Python, заключенный в блоки кода Markdown (```python ... ```).

    Returns:
        str | None: Извлеченный код Python или None, если код не найден.

    """
```

**Как работает функция**:

1. **Поиск кода**: Функция использует регулярное выражение для поиска блоков кода, обрамленных тройными обратными кавычками (```) с указанием языка `python` или `py`.
2. **Извлечение кода**: Если блок кода найден, функция извлекает содержимое этого блока, исключая обратные кавычки и указание языка.
3. **Возврат результата**: Функция возвращает извлеченный код. Если блок кода не найден, функция возвращает `None`.

**Примеры**:

```python
text_with_code = "Some text ```python\nprint('Hello')\n```"
code = read_code(text_with_code)
print(code)  # Вывод: print('Hello')

text_without_code = "Some text without code"
code = read_code(text_without_code)
print(code)  # Вывод: None
```

### `input_command`

```python
def input_command() -> str:
    """Функция считывает многострочный ввод от пользователя до тех пор, пока не будет встречен символ конца файла (EOF).

    Args:
        None

    Returns:
        str: Строка, содержащая объединенный ввод пользователя.

    """
```

**Как работает функция**:

1. **Инициализация**: Функция инициализирует пустой список `contents` для хранения строк ввода.
2. **Цикл ввода**: Функция входит в бесконечный цикл, в котором она пытается прочитать строку ввода с помощью функции `input()`.
3. **Обработка EOFError**: Если возникает исключение `EOFError` (что происходит, когда пользователь нажимает Ctrl-D или Ctrl-Z), цикл прерывается.
4. **Объединение ввода**: После завершения цикла функция объединяет все строки ввода, хранящиеся в списке `contents`, в одну строку, разделенную символами новой строки (`\n`).
5. **Возврат результата**: Функция возвращает полученную объединенную строку.

**Примеры**:

```python
# Ввод пользователя:
# line1
# line2
# line3
# (Ctrl-D)
command = input_command()
print(command)  # Вывод: "line1\nline2\nline3"
```

## Переменные

### `name`

Имя провайдера, которое будет использоваться для создания файла. Получается через функцию `input()` от пользователя.

### `provider_path`

Путь к файлу, в котором будет сохранен код провайдера. Формируется как `g4f/Provider/{name}.py`, где `name` - имя провайдера.

### `example`

Строка, содержащая пример кода провайдера, который используется в запросе к GPT-4 для формирования ответа.

### `command`

Содержит команду cURL, введенную пользователем через функцию `input_command()`.

### `prompt`

Строка, содержащая запрос, который отправляется в GPT-4. Запрос включает команду cURL и пример кода провайдера.

### `response`

Список, который накапливает ответ от GPT-4 по частям (chunk).

### `code`

Код провайдера, извлеченный из ответа GPT-4 с помощью функции `read_code()`.