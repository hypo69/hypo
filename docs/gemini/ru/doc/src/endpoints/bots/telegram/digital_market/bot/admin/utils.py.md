# Модуль utils для администрирования Telegram-бота цифрового рынка

## Обзор

Модуль содержит утилиту `process_dell_text_msg`, которая используется для удаления текстовых сообщений в Telegram-боте. Функция предназначена для обработки случаев, когда необходимо удалить последнее сообщение пользователя и сообщение с командой удаления.

## Подробней

Этот модуль предоставляет функцию для удаления сообщений в чате с пользователем. Он использует данные, хранящиеся в FSMContext (Finite State Machine Context) для определения ID последнего сообщения, которое нужно удалить. Если ID найден, функция пытается удалить это сообщение и сообщение пользователя с командой удаления. В случае ошибки логируется предупреждение или ошибка.

## Функции

### `process_dell_text_msg`

```python
async def process_dell_text_msg(message: Message, state: FSMContext):
    """ Функция удаляет последнее сообщение пользователя и сообщение с командой удаления.

    Args:
        message (Message): Объект сообщения, содержащий информацию о сообщении, которое нужно удалить.
        state (FSMContext): Объект состояния FSM, содержащий данные о текущем состоянии разговора с пользователем.

    Returns:
        None

    Raises:
        Exception: Если происходит ошибка при удалении сообщения.

    Example:
        Пример вызова функции:
        >>> await process_dell_text_msg(message, state)
    """
```

**Параметры**:

- `message` (Message): Объект сообщения от пользователя.
- `state` (FSMContext): Объект, содержащий состояние FSM для текущего пользователя.

**Как работает функция**:

1. **Извлечение данных из состояния**: Функция извлекает данные из FSMContext, чтобы получить ID последнего сообщения (`last_msg_id`), которое нужно удалить.
2. **Удаление сообщений**:
   - Если `last_msg_id` найден, функция пытается удалить сообщение с этим ID из чата с пользователем.
   - Независимо от результата предыдущего шага, функция пытается удалить сообщение пользователя с командой удаления.
3. **Обработка ошибок**:
   - Если `last_msg_id` не найден, функция логирует предупреждение.
   - Если при удалении сообщения возникает исключение, функция логирует ошибку.

**ASCII flowchart**:

```
A: Получение данных из FSMContext (last_msg_id)
|
B: Проверка наличия last_msg_id
|
C: Удаление сообщения с last_msg_id
|
D: Удаление сообщения пользователя
|
E: Обработка ошибок
```

Где:

- `A`: Извлечение `last_msg_id` из FSMContext.
- `B`: Проверка, был ли найден `last_msg_id`.
- `C`: Попытка удаления сообщения с ID `last_msg_id`.
- `D`: Попытка удаления сообщения пользователя с командой удаления.
- `E`: Обработка возможных исключений при удалении сообщений и логирование ошибок или предупреждений.

**Примеры**:

Пример 1: Успешное удаление последнего сообщения и сообщения пользователя:

```python
# Предположим, что message - это объект сообщения, который нужно удалить
# Предположим, что state - это объект FSMContext, содержащий 'last_msg_id'
await process_dell_text_msg(message, state)
```

Пример 2: `last_msg_id` не найден:

```python
# Предположим, что message - это объект сообщения, который нужно удалить
# Предположим, что state - это объект FSMContext, НЕ содержащий 'last_msg_id'
await process_dell_text_msg(message, state)
```

Пример 3: Произошла ошибка при удалении сообщения:

```python
# Предположим, что message - это объект сообщения, который нужно удалить
# Предположим, что state - это объект FSMContext, содержащий 'last_msg_id'
# Предположим, что удаление сообщения вызвало исключение
await process_dell_text_msg(message, state)