# Документация модуля hypotez/src/goog/spreadsheet/_docs

## Обзор

Данный модуль предоставляет документацию и примеры использования Google Sheets API v4 для работы с Google Таблицами.  Модуль содержит подробное руководство по созданию сервисного аккаунта, установке необходимых библиотек, и работе с API.  Описываются методы для создания, управления доступом, форматирования и заполнения данных в таблицах.  Особое внимание уделяется гибкому классу-обертке `Spreadsheet`, упрощающему взаимодействие с API.

## Оглавление

* [Постановка задачи](#постановка-задачи)
* [Решение](#решение)
    * [Шаг 1. Создать сервисный аккаунт](#шаг-1-создать-сервисный-аккаунт)
    * [Шаг 2. Установить необходимые библиотеки](#шаг-2-установить-необходимые-библиотеки)
    * [Шаг 3. Кодить](#шаг-3-кодить)
        * [3.1. Service-объект](#31-service-объект)
        * [3.2. Термины и id'шники](#32-термины-и-idшники)
        * [3.3. Новый spreadsheet](#33-новый-spreadsheet)
        * [3.4. Доступ к новому документу](#34-доступ-к-новому-документу)
        * [3.5. Ещё немного теории](#35-ещё-немного-теории)
        * [3.6. Ширина столбцов](#36-ширина-столбцов)
        * [3.7. Логика класса-обёртки](#37-логика-класса-обёртки)
        * [3.8. Заполнение ячеек данными](#38-заполнение-ячеек-данными)
        * [3.9. Объединение ячеек, настройка жирности, формата отображения, цвета фона и прочего](#39-объединение-ячеек-настройка-жирности-формата-отображения-цвета-фона-и-прочего)
    * [Заключение](#заключение)

## Функции

### `Spreadsheet`

**Описание**: Класс-обёртка для работы с Google Sheets API v4. Предоставляет методы для подготовки запросов к API и выполнения операций над таблицей.

**Методы**:

- `prepare_setColumnWidth(col: int, width: int)`:  Подготавливает запрос для задания ширины столбца.
- `prepare_setColumnsWidth(startCol: int, endCol: int, width: int)`: Подготавливает запрос для задания ширины нескольких столбцов.
- `prepare_setDimensionPixelSize(dimension: str, startIndex: int, endIndex: int, pixelSize: int)`: Подготавливает запрос для задания размера измерения (столбца или строки).
- `prepare_setValues(cellsRange: str, values: list, majorDimension: str = "ROWS")`: Подготавливает запрос для заполнения ячеек.
- `prepare_mergeCells(range_: str)`: Подготавливает запрос для объединения ячеек.
- `prepare_setCellsFormat(range_: str, format_: dict, fields: str = "userEnteredFormat")`: Подготавливает запрос для форматирования ячеек.
- `prepare_setCellsFormats(range_: str, formats: list)`: Подготавливает запрос для форматирования множества ячеек.
- `runPrepared(valueInputOption: str = "USER_ENTERED")`: Выполняет подготовленные запросы к API. Возвращает результаты выполнения запросов.

**Параметры**:


- `col` (int): Номер столбца (нумерация с 0).
- `width` (int): Ширина столбца в пикселях.
- `startCol` (int), `endCol` (int): Диапазон столбцов.
- `dimension` (str): Измерение (COLUMNS или ROWS).
- `startIndex` (int), `endIndex` (int): Индексы начала и конца диапазона.
- `pixelSize` (int): Размер измерения в пикселях.
- `cellsRange` (str): Диапазон ячеек в формате A1.
- `values` (list): Данные для заполнения ячеек.
- `majorDimension` (str): Направление заполнения данных (ROWS или COLUMNS).
- `format_` (dict): Словарь, определяющий форматирование.
- `fields` (str): Список полей для обновления в формате GridRange.

**Возвращает**:


- tuple: Tuple содержащий результаты выполнения запросов к `spreadsheets.batchUpdate` и `spreadsheets.values.batchUpdate`.


**Вызывает исключения**:


- `Exception`: Возможные исключения при работе с Google Sheets API.

```