# Модуль AuxiliaryClasses.py

## Обзор

Модуль `AuxiliaryClasses.py` содержит вспомогательные классы для работы с Telegram ботом, включая создание клавиатур и сжатие промптов. Он включает классы `keyboards` для генерации различных типов клавиатур и `PromptsCompressor` для работы с текстовыми промптами.

## Подробней

Этот модуль предоставляет инструменты для упрощения взаимодействия с пользователем через Telegram бот, такие как создание интерактивных клавиатур и форматирование текстовых сообщений. Класс `keyboards` позволяет создавать клавиатуры с динамическим наполнением, а `PromptsCompressor` обеспечивает удобный способ управления и форматирования промптов для различных задач.

## Классы

### `keyboards`

**Описание**: Класс `keyboards` предназначен для создания различных типов клавиатур для Telegram бота. Он предоставляет методы для создания клавиатур с двумя полями и клавиатур с кнопками ответа.

**Как работает класс**:

Класс содержит методы для генерации различных типов клавиатур. Метод `_keyboard_two_blank` создает клавиатуру с двумя полями на основе предоставленных данных и имен. Метод `_reply_keyboard` создает клавиатуру с кнопками ответа на основе предоставленных имен.

**Методы**:

- `_keyboard_two_blank`: Создает клавиатуру с двумя полями.
- `_reply_keyboard`: Создает клавиатуру с кнопками ответа.

#### `_keyboard_two_blank`

```python
def _keyboard_two_blank(self, data: list[str], name: list[str]) -> types.InlineKeyboardMarkup:
    """
    Создает клавиатуру с двумя полями.

    Args:
        data (list[str]): Список данных для кнопок (callback_data).
        name (list[str]): Список имен для отображения на кнопках.

    Returns:
        types.InlineKeyboardMarkup: Объект клавиатуры Telegram.
    """
    ...
```

**Параметры**:

- `data` (list[str]): Список данных, которые будут передаваться при нажатии на кнопку.
- `name` (list[str]): Список имен, которые будут отображаться на кнопках.

**Возвращает**:

- `types.InlineKeyboardMarkup`: Объект клавиатуры Telegram.

**Как работает функция**:

1.  Функция создает объект `types.InlineKeyboardMarkup` для представления клавиатуры.
2.  Создается список кнопок `types.InlineKeyboardButton` на основе предоставленных данных и имен.
3.  Если количество кнопок четное, они добавляются на клавиатуру попарно.
4.  Если количество кнопок нечетное, все кнопки, кроме последней, добавляются попарно, а последняя кнопка добавляется отдельно.
5.  Функция возвращает созданную клавиатуру.

#### `_reply_keyboard`

```python
def _reply_keyboard(self, name: list[str]):
    """
    Создает клавиатуру с кнопками ответа.

    Args:
        name (list[str]): Список имен для отображения на кнопках.

    Returns:
        types.ReplyKeyboardMarkup: Объект клавиатуры Telegram.
    """
    ...
```

**Параметры**:

- `name` (list[str]): Список имен, которые будут отображаться на кнопках.

**Возвращает**:

- `types.ReplyKeyboardMarkup`: Объект клавиатуры Telegram.

**Как работает функция**:

1.  Функция создает объект `types.ReplyKeyboardMarkup` для представления клавиатуры.
2.  Создается список кнопок `types.KeyboardButton` на основе предоставленных имен.
3.  Каждая кнопка добавляется на клавиатуру.
4.  Функция возвращает созданную клавиатуру.

### `PromptsCompressor`

**Описание**: Класс `PromptsCompressor` предназначен для сжатия и форматирования текстовых промптов. Он позволяет получать промпты из JSON-файла и вставлять в них значения из списка.

**Как работает класс**:

Класс инициализируется с определением структуры команд (`commands_size`). Метод `get_prompt` извлекает промпт из JSON-файла и заменяет в нем placeholders на значения из предоставленного списка. Метод `html_tags_insert` вставляет HTML-теги в текст ответа для форматирования.

**Методы**:

- `__init__`: Инициализирует класс.
- `get_prompt`: Извлекает и форматирует промпт.
- `html_tags_insert`: Вставляет HTML-теги в текст ответа.

#### `__init__`

```python
def __init__(self):
    """
    Инициализирует класс PromptsCompressor.
    """
    ...
```

**Как работает функция**:

1.  Функция инициализирует атрибут `commands_size`, который представляет собой список списков с параметрами для различных команд.

#### `get_prompt`

```python
def get_prompt(self, info: list[str], ind: int) -> str:
    """
    Извлекает и форматирует промпт.

    Args:
        info (list[str]): Список значений для вставки в промпт.
        ind (int): Индекс команды в списке команд.

    Returns:
        str: Сформированный промпт.
    """
    ...
```

**Параметры**:

- `info` (list[str]): Список значений, которые будут вставлены в промпт.
- `ind` (int): Индекс промпта, который нужно получить из файла.

**Возвращает**:

- `str`: Сформированный промпт.

**Как работает функция**:

1.  Функция открывает JSON-файл `ToolBox/BaseSettings/prompts.json` и загружает данные из него.
2.  Извлекает команду (промпт) по указанному индексу `ind`.
3.  Заменяет placeholders в команде на соответствующие значения из списка `info`.
4.  Возвращает полученный промпт.

#### `html_tags_insert`

```python
@staticmethod
def html_tags_insert(response: str) -> str:
    """
    Вставляет HTML-теги в текст ответа для форматирования.

    Args:
        response (str): Текст ответа для форматирования.

    Returns:
        str: Отформатированный текст ответа.
    """
    ...
```

**Параметры**:

- `response` (str): Текст, в который нужно вставить HTML-теги.

**Возвращает**:

- `str`: Отформатированный текст с HTML-тегами.

**Как работает функция**:

1.  Функция применяет серию регулярных выражений для замены определенных шаблонов в тексте ответа на соответствующие HTML-теги.
2.  Производит замену для заголовков (`####`, `###`), выделения жирным (`**`), курсивом (`*`), кода (` ``` `, `` ` ``).
3.  Возвращает отформатированный текст.