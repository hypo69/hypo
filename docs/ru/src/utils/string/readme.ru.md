# Модуль нормализации данных `normalizer`

## Обзор

Модуль `normalizer` предоставляет функциональность для нормализации различных типов данных, таких как строки, булевы значения, целые числа, числа с плавающей запятой, и даты в формате SQL. Он включает вспомогательные функции для обработки текста, такие как удаление HTML тегов, символов новой строки и специальных символов.

## Подробнее

Модуль предназначен для очистки и стандартизации данных перед их использованием в других частях проекта `hypotez`. Это особенно полезно при работе с данными, полученными из внешних источников, где качество и формат данных могут быть непредсказуемыми. Нормализация данных помогает обеспечить консистентность и предсказуемость, что упрощает дальнейшую обработку и анализ.

## Функции модуля

### `normalize_boolean`

**Описание**:
Преобразует входное значение в булево значение.

**Как работает функция**:
Функция принимает входные данные любого типа и пытается преобразовать их в булево значение. Если входные данные являются строкой, они сравниваются с предопределенным списком значений, такими как 'да', 'true', '1' (без учета регистра) для `True` и 'нет', 'false', '0' для `False`. Если входные данные являются числом, то 0 преобразуется в `False`, а любое другое число - в `True`.

**Параметры**:
- `input_data` (Any): Данные, которые могут представлять булево значение (строка, число, булев тип).

**Возвращает**:
- `bool`: Преобразованное булево значение.

**Примеры**:
```python
normalize_boolean('yes')  # Результат: True
normalize_boolean(0)      # Результат: False
normalize_boolean(True)   # Результат: True
normalize_boolean('False') # Результат: False
```

### `normalize_string`

**Описание**:
Преобразует строку или список строк в нормализованную строку, удаляя лишние пробелы, HTML теги и специальные символы.

**Как работает функция**:
Функция принимает строку или список строк, последовательно применяя к ним следующие операции: удаление HTML тегов с помощью `remove_html_tags`, удаление специальных символов с помощью `remove_special_characters`, удаление символов новой строки с помощью `remove_line_breaks`, удаление лишних пробелов в начале и конце строки, и кодирование строки в UTF-8. Если на вход передан список строк, то они объединяются в одну строку с пробелом в качестве разделителя перед применением остальных операций.

**Параметры**:
- `input_data` (str | list): Строка или список строк.

**Возвращает**:
- `str`: Очищенная строка в кодировке UTF-8.

**Примеры**:
```python
normalize_string(['  Example string  ', '<b>with HTML</b>'])  # Результат: 'Example string with HTML'
normalize_string('  Hello World!  ')  # Результат: 'Hello World!'
normalize_string('String\nwith line breaks') # Результат: 'String with line breaks'
```

### `normalize_int`

**Описание**:
Преобразует входное значение в целое число.

**Как работает функция**:
Функция принимает число, строку или их список и пытается преобразовать их в целое число. Если входные данные являются строкой, она должна представлять собой число. Если входные данные являются числом с плавающей точкой, они округляются в сторону нуля.

**Параметры**:
- `input_data` (str | int | float | Decimal): Число или его строковое представление.

**Возвращает**:
- `int`: Преобразованное целое число.

**Примеры**:
```python
normalize_int('42')  # Результат: 42
normalize_int(3.14)  # Результат: 3
normalize_int(-5)   # Результат: -5
```

### `normalize_float`

**Описание**:
Преобразует входное значение в число с плавающей запятой.

**Как работает функция**:
Функция принимает число, строку или список чисел и пытается преобразовать их в число с плавающей запятой. Если входные данные являются строкой, она должна представлять собой число с плавающей запятой. Если на вход передан список, функция применяет преобразование к каждому элементу списка.

**Параметры**:
- `value` (Any): Число, строка или список чисел.

**Возвращает**:
- `float | List[float] | None`: Число с плавающей запятой, список чисел с плавающей запятой или `None` в случае ошибки.

**Примеры**:
```python
normalize_float('3.14')         # Результат: 3.14
normalize_float([1, '2.5', 3])  # Результат: [1.0, 2.5, 3.0]
normalize_float(-2.7) # Результат: -2.7
```

### `remove_line_breaks`

**Описание**:
Удаляет символы новой строки из строки.

**Как работает функция**:
Функция принимает строку и удаляет из неё все символы новой строки (`\n`) и возврата каретки (`\r`).

**Параметры**:
- `input_str` (str): Входная строка.

**Возвращает**:
- `str`: Строка без символов новой строки.

**Примеры**:
```python
remove_line_breaks('String\nwith line breaks\r')  # Результат: 'String with line breaks'
remove_line_breaks('No line breaks') # Результат: 'No line breaks'
```

### `remove_html_tags`

**Описание**:
Удаляет HTML теги из строки.

**Как работает функция**:
Функция принимает строку, содержащую HTML теги, и удаляет все теги, используя регулярное выражение.

**Параметры**:
- `input_html` (str): Входная строка с HTML тегами.

**Возвращает**:
- `str`: Строка без HTML тегов.

**Примеры**:
```python
remove_html_tags('<p>Example text</p>')  # Результат: 'Example text'
remove_html_tags('<div><b>Bold text</b></div>') # Результат: 'Bold text'
```

### `remove_special_characters`

**Описание**:
Удаляет специальные символы из строки или списка строк.

**Как работает функция**:
Функция принимает строку или список строк и удаляет все символы, которые не являются буквенно-цифровыми, пробелами или дефисами.

**Параметры**:
- `input_str` (str | list): Строка или список строк.

**Возвращает**:
- `str | list`: Строка или список строк без специальных символов.

**Примеры**:
```python
remove_special_characters('Hello@World!')  # Результат: 'HelloWorld'
remove_special_characters(['String', 'with#', 'special@chars']) # Результат: ['String', 'with', 'specialchars']
```

### `normalize_sql_date`

**Описание**:
Преобразует строку или объект `datetime` в стандартный формат SQL даты (`YYYY-MM-DD`).

**Как работает функция**:
Функция принимает строку или объект `datetime` и преобразует их в строку в формате `YYYY-MM-DD`. Если входные данные являются строкой, они должны быть в формате, который может быть преобразован в `datetime` объект.

**Параметры**:
- `input_data` (str | datetime): Строка или объект `datetime`, представляющий дату.

**Возвращает**:
- `str`: Нормализованная дата в формате строки `YYYY-MM-DD`.

**Примеры**:
```python
normalize_sql_date('2024-12-06')  # Результат: '2024-12-06'
normalize_sql_date(datetime(2024, 12, 6))  # Результат: '2024-12-06'
normalize_sql_date('12/06/2024') # Результат: '2024-12-06'
```

## Пример использования

```python
from src.utils.string.normalizer import normalize_string, normalize_boolean, normalize_int, normalize_float, normalize_sql_date

# Нормализация строки
clean_str = normalize_string(['<h1>Header</h1>', '  text with spaces  '])
print(clean_str)  # 'Header text with spaces'

# Нормализация булевого значения
is_active = normalize_boolean('Yes')
print(is_active)  # True

# Нормализация целого числа
integer_value = normalize_int('42')
print(integer_value)  # 42

# Нормализация числа с плавающей запятой
float_value = normalize_float('3.14159')
print(float_value)  # 3.14159

# Нормализация SQL даты
sql_date = normalize_sql_date('2024-12-06')
print(sql_date)  # '2024-12-06'
```

## Требования

- Python 3.10 или выше.
- Модуль `src.logger` для логирования.
- Модуль используется в режиме разработки (``).

## Логирование

Все ошибки и предупреждения записываются через `logger`:
- Ошибки записываются с использованием `logger.error`.
- Неожиданные значения записываются с использованием `logger.debug` или `logger.warning`.