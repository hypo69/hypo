# Модуль V50

## Обзор

Модуль `V50` предоставляет класс `V50`, который является устаревшим провайдером для взаимодействия с языковой моделью через API `p5.v50.ltd`. Он поддерживает модель `gpt-3.5-turbo` и не требует аутентификации. Модуль использует библиотеку `requests` для выполнения HTTP-запросов к API.

## Подробней

Данный модуль реализует взаимодействие с API `p5.v50.ltd`, отправляя запросы на эндпоинт `/api/chat-process` с использованием библиотеки `requests`. Он формирует полезную нагрузку (payload) на основе предоставленных сообщений и параметров, а также устанавливает необходимые заголовки для запроса. В случае успешного запроса, модуль возвращает текст ответа.

## Классы

### `V50`

**Описание**: Класс `V50` является провайдером для взаимодействия с API `p5.v50.ltd`. Он наследуется от класса `AbstractProvider`.

**Наследует**:
- `AbstractProvider`: Абстрактный класс, определяющий интерфейс для провайдеров.

**Атрибуты**:
- `url` (str): URL API (`https://p5.v50.ltd`).
- `supports_gpt_35_turbo` (bool): Поддержка модели `gpt-3.5-turbo` (значение `True`).
- `supports_stream` (bool): Поддержка потоковой передачи (значение `False`).
- `needs_auth` (bool): Необходимость аутентификации (значение `False`).
- `working` (bool): Статус работоспособности (значение `False`).

**Методы**:
- `create_completion`: Метод для создания запроса к API и получения ответа.

## Функции

### `create_completion`

```python
    @staticmethod
    def create_completion(
        model: str,
        messages: list[dict[str, str]],
        stream: bool, **kwargs: Any) -> CreateResult:
        """
        Создает запрос к API и возвращает ответ.

        Args:
            model (str): Имя модели для использования.
            messages (list[dict[str, str]]): Список сообщений для отправки в API.
            stream (bool): Флаг, указывающий, использовать ли потоковую передачу.
            **kwargs (Any): Дополнительные аргументы, такие как `temperature`, `top_p` и `proxy`.

        Returns:
            CreateResult: Результат запроса к API.

        """
```

**Назначение**: Функция `create_completion` создает запрос к API `p5.v50.ltd` и возвращает ответ от языковой модели.

**Параметры**:
- `model` (str): Имя модели для использования.
- `messages` (list[dict[str, str]]): Список сообщений для отправки в API. Каждое сообщение представляет собой словарь с ключами `role` (роль отправителя, например, "user" или "assistant") и `content` (содержимое сообщения).
- `stream` (bool): Флаг, указывающий, использовать ли потоковую передачу. В данном случае всегда `False`.
- `**kwargs` (Any): Дополнительные аргументы, такие как `temperature` (температура модели), `top_p` (top-p sampling) и `proxy` (прокси-сервер).

**Возвращает**:
- `CreateResult`: Результат запроса к API. В данном случае, это генератор, возвращающий текст ответа.

**Как работает функция**:
1. **Формирование текста запроса**: Функция объединяет все сообщения из списка `messages` в одну строку, добавляя роль и содержимое каждого сообщения.
2. **Создание payload**: Создается словарь `payload`, который содержит текст запроса, параметры модели (температура и top_p), имя модели и уникальный идентификатор пользователя.
3. **Определение заголовков**: Определяются заголовки HTTP-запроса, включая `Content-Type`, `User-Agent` и другие необходимые параметры.
4. **Выполнение POST-запроса**: Функция отправляет POST-запрос к API `p5.v50.ltd/api/chat-process` с использованием библиотеки `requests`. В запросе передаются payload, заголовки и параметры прокси (если указаны).
5. **Обработка ответа**: Функция проверяет, содержит ли ответ строку `"https://fk1.v50.ltd"`. Если нет, функция возвращает текст ответа.

```
A: Формирование текста запроса
│
B: Создание payload
│
C: Определение заголовков
│
D: Выполнение POST-запроса к API
│
E: Проверка ответа (содержит "https://fk1.v50.ltd"?)
│
F: Возврат текста ответа (если проверка не пройдена)
```

**Примеры**:

```python
messages = [
    {"role": "user", "content": "Привет, как дела?"},
    {"role": "assistant", "content": "Привет! У меня все хорошо, спасибо, что спросили."},
    {"role": "user", "content": "Расскажи о себе."}
]
result = V50.create_completion(model="gpt-3.5-turbo", messages=messages, stream=False, temperature=0.5, top_p=0.5)
for item in result:
    print(item)