# Класс `Supplier`

## Обзор класса `Supplier`

Класс `Supplier` служит базовым классом для управления поставщиками данных в приложении. Он предоставляет основу для взаимодействия с различными источниками данных, такими как Amazon, AliExpress, Walmart и другие. Этот класс обрабатывает инициализацию настроек, специфичных для поставщика, управляет сценариями сбора данных и предоставляет методы для входа и выполнения сценариев.

## Компоненты класса `Supplier`

#### 1. **Атрибуты класса**

* `supplier_id`: Уникальный идентификатор поставщика.
* `supplier_prefix`: Префикс для поставщика, например, `aliexpress` или `amazon`.
* `supplier_settings`: Настройки для поставщика, загружаемые из конфигурационного файла.
* `locale`: Код локализации (например, `en` для английского языка, `ru` для русского).
* `price_rule`: Правило для расчета цен (например, добавление НДС или применение скидок).
* `related_modules`: Модуль, содержащий функции, специфичные для поставщика.
* `scenario_files`: Список сценариев файлов, которые должны быть выполнены.
* `current_scenario`: Текущий выполняемый сценарий.
* `login_data`: Данные для входа на сайт поставщика (при необходимости).
* `locators`: Локаторы веб-элементов на сайте поставщика.
* `driver`: Веб-драйвер для взаимодействия с сайтом поставщика.
* `parsing_method`: Метод для парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).


#### 2. **Методы**

* `__init__`: Конструктор, который инициализирует атрибуты на основе префикса поставщика и других параметров.
    ```python
    def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs):
        # Инициализирует префикс поставщика, локаль и веб-драйвер
    ```

* `_payload`: Загружает конфигурации, специфичные для поставщика, локаторы и инициализирует веб-драйвер.
    ```python
    def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
        # Загружает конфигурационные файлы и инициализирует веб-драйвер
    ```

* `login`: Обрабатывает процесс входа на сайт поставщика, если требуется аутентификация.
    ```python
    def login(self) -> bool:
        # Выполняет вход на сайт поставщика
    ```

* `run_scenario_files`: Выполняет один или несколько файлов сценариев.
    ```python
    def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool:
        # Выполняет сценарии файлов и возвращает True, если все сценарии успешно завершены
    ```

* `run_scenarios`: Выполняет один или несколько сценариев.
    ```python
    def run_scenarios(self, scenarios: dict | list[dict]) -> bool:
        # Выполняет заданные сценарии и возвращает True, если все сценарии успешно завершены
    ```

## Как это работает

1. **Инициализация**: При создании объекта класса `Supplier`, метод `__init__` инициализирует префикс поставщика, локаль и веб-драйвер.
   ```python
   supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
   ```

2. **Загрузка конфигурации**: Метод `_payload` загружает конфигурационные файлы для поставщика, включая настройки, локаторы и инициализирует веб-драйвер.
   ```python
   supplier._payload('chrome')  # Или используя другие варианты
   ```

3. **Вход**: Метод `login` обрабатывает процесс аутентификации на сайте поставщика.
   ```python
   supplier.login()
   ```

4. **Выполнение сценариев**:
   - Метод `run_scenario_files` выполняет сценарии из списка файлов.
     ```python
     supplier.run_scenario_files(['example_scenario.json'])
     ```
   - Метод `run_scenarios` выполняет сценарии на основе определенных условий или задач.
     ```python
     supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
     ```


## Визуальное представление

Класс `Supplier` выступает в качестве шаблона для управления сбором данных от различных поставщиков. Он определяет общие методы и атрибуты, которые могут быть использованы или расширены конкретными реализациями для разных поставщиков. Класс централизует управление поставщиками, включая конфигурацию, вход и выполнение сценариев.

## Пример использования

```python
# Создание объекта Supplier для 'aliexpress'
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')

# Выполнение входа на сайт поставщика
supplier.login()

# Выполнение сценариев из файлов
supplier.run_scenario_files(['example_scenario.json'])

# Или выполнение конкретных сценариев
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```

## Резюме

Класс `Supplier` предоставляет структурированный способ взаимодействия с поставщиками данных, управляя конфигурациями, выполняя входы и выполняя сценарии сбора данных. Он служит основополагающим компонентом, который можно расширить для конкретных поставщиков, унаследовавшись от этого базового класса и добавив или переопределив функциональность по мере необходимости.