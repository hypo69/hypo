# Модуль hypotez/src/utils/xls.py

## Обзор

Модуль `xls.py` предоставляет функции для конвертации файлов Excel (`xls`) в JSON и обратно, обработки нескольких листов и сохранения JSON данных в файлы Excel (`xls`). Модуль обрабатывает ошибки и предоставляет логирование для отслеживания процесса.

## Функции

### `read_xls_as_dict`

**Описание**: Читает файл Excel и конвертирует его в JSON.  По желанию конвертирует определенный лист и сохраняет результат в файл JSON. Обрабатывает ошибки.

**Параметры**:

- `xls_file` (str): Путь к файлу Excel.
- `json_file` (str, опционально): Путь к файлу JSON для сохранения результата. По умолчанию `None`.
- `sheet_name` (Union[str, int], опционально): Имя листа, который нужно прочитать. Если `None`, то считываются все листы. По умолчанию `None`.

**Возвращает**:

- Union[Dict, List[Dict], bool]: Словарь, содержащий данные из листа Excel, список словарей, если указан определённый лист, или `bool` значение `True` при успешной обработке, `False` при ошибке.

**Возможные исключения**:

- `FileNotFoundError`: Возникает, если файл Excel не найден.
- `Exception`: Возникает при других ошибках во время обработки файла.


### `save_xls_file`

**Описание**: Сохраняет JSON данные в файл Excel.  Обрабатывает ошибки.

**Параметры**:

- `data` (Dict[str, List[Dict]]): Данные в формате JSON, где ключи - имена листов, значения - списки словарей, представляющие строки.
- `file_path` (str): Путь к файлу Excel для сохранения.

**Возвращает**:

- bool: `True` если сохранение прошло успешно, `False` в противном случае.

**Возможные исключения**:

- `Exception`: Возникает при других ошибках во время сохранения файла.


## Логирование

Модуль использует `logging` для записи сообщений об ошибках и успешном выполнении операций. Уровень логирования по умолчанию - `INFO`.


## Примеры использования

```python
# Чтение и опциональное сохранение в JSON
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')  # Читает лист 'Sheet1'
if data:
    print(data)  # Вывод будет {'Sheet1': [{...}]}


# Сохранение из JSON данных
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Успешно сохранено в output.xlsx")
```
```