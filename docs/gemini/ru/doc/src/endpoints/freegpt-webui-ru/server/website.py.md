# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` отвечает за определение класса `Website`, который управляет маршрутами и отображением веб-страниц для чат-приложения. Он использует Flask для обработки HTTP-запросов и отображения HTML-шаблонов.

## Подробней

Этот модуль является частью веб-интерфейса приложения, предоставляя пользователям возможность взаимодействовать с чатом через браузер. Он определяет маршруты для главной страницы, страницы чата с конкретным идентификатором беседы и для статических ресурсов (assets).

## Классы

### `Website`

**Описание**: Класс `Website` управляет маршрутами веб-сайта и рендерингом шаблонов.

**Принцип работы**: Класс инициализируется с экземпляром Flask-приложения и определяет маршруты для различных URL-адресов. Каждый маршрут связан с определенной функцией, которая обрабатывает запрос и возвращает ответ.

**Атрибуты**:
- `app`: Экземпляр Flask-приложения.
- `routes`: Словарь, содержащий маршруты веб-сайта и связанные с ними функции и методы.

**Методы**:
- `__init__(self, app)`: Инициализирует класс `Website` с экземпляром Flask-приложения.
- `_chat(self, conversation_id)`: Обрабатывает запросы к странице чата с конкретным идентификатором беседы.
- `_index(self)`: Обрабатывает запросы к главной странице, генерируя уникальный идентификатор беседы.
- `_assets(self, folder: str, file: str)`: Обрабатывает запросы к статическим ресурсам (assets), таким как CSS и JavaScript файлы.

## Функции

### `_chat`

```python
    def _chat(self, conversation_id):
        """
        Обрабатывает запросы к странице чата с конкретным идентификатором беседы.

        Args:
            conversation_id (str): Идентификатор беседы.

        Returns:
            flask.Response: Ответ Flask, содержащий HTML-страницу чата или перенаправление на главную страницу.
        """
```

**Назначение**: Функция `_chat` обрабатывает запросы к странице чата с определенным `conversation_id`.

**Параметры**:
- `conversation_id` (str): Идентификатор беседы, который передается в URL.

**Возвращает**:
- `flask.Response`: Если `conversation_id` содержит дефис (`-`), возвращает HTML-страницу чата (`index.html`) с переданным `chat_id`. В противном случае перенаправляет на главную страницу (`/chat`).

**Как работает функция**:
1. **Проверка формата `conversation_id`**: Проверяет, содержит ли `conversation_id` символ `-`.
2. **Перенаправление или рендеринг шаблона**: Если `conversation_id` не содержит `-`, происходит перенаправление на главную страницу (`/chat`). Если содержит, отображается шаблон `index.html` с передачей `conversation_id` в качестве параметра `chat_id`.

**ASCII flowchart**:
```
    Проверка conversation_id на наличие '-'
    │
    ├─ Нет:
    │  │
    │  └── Перенаправление на '/chat'
    │
    └─ Да:
       │
       └── Отображение шаблона 'index.html' с chat_id=conversation_id
```

**Примеры**:
```python
# Пример вызова функции _chat с допустимым conversation_id
_chat("12345678-1234-1234-1234-1234567890ab")
# Пример вызова функции _chat с недопустимым conversation_id
_chat("12345678")
```

### `_index`

```python
    def _index(self):
        """
        Обрабатывает запросы к главной странице, генерируя уникальный идентификатор беседы.

        Returns:
            flask.Response: Ответ Flask, содержащий HTML-страницу с уникальным идентификатором чата.
        """
```

**Назначение**: Функция `_index` обрабатывает запросы к главной странице (`/chat/`) и генерирует уникальный идентификатор беседы.

**Возвращает**:
- `flask.Response`: HTML-страницу (`index.html`) с уникальным идентификатором чата, переданным в шаблон как `chat_id`.

**Как работает функция**:
1. **Генерация уникального идентификатора**: Создает уникальный идентификатор беседы, используя `urandom` для генерации случайных шестнадцатеричных чисел и текущее время в миллисекундах.
2. **Отображение шаблона**: Отображает шаблон `index.html` с передачей сгенерированного идентификатора в качестве параметра `chat_id`.

**ASCII flowchart**:
```
    Генерация уникального chat_id
    │
    └── Отображение шаблона 'index.html' с chat_id
```

**Примеры**:
```python
# Пример вызова функции _index
_index()
```

### `_assets`

```python
    def _assets(self, folder: str, file: str):
        """
        Обрабатывает запросы к статическим ресурсам (assets), таким как CSS и JavaScript файлы.

        Args:
            folder (str): Название папки, в которой находится файл.
            file (str): Имя файла.

        Returns:
            flask.Response: Ответ Flask, содержащий запрошенный файл, или сообщение об ошибке, если файл не найден.
        """
```

**Назначение**: Функция `_assets` обрабатывает запросы к статическим файлам, таким как CSS и JavaScript.

**Параметры**:
- `folder` (str): Имя папки, содержащей файл.
- `file` (str): Имя запрашиваемого файла.

**Возвращает**:
- `flask.Response`: Если файл найден, возвращает файл как attachment. Если файл не найден, возвращает сообщение "File not found" с кодом ошибки 404.

**Как работает функция**:
1. **Попытка отправки файла**: Пытается отправить запрошенный файл из папки `client`.
2. **Обработка исключения**: Если файл не найден, перехватывает исключение и возвращает сообщение об ошибке "File not found" с кодом 404.

**ASCII flowchart**:
```
    Попытка отправить статический файл
    │
    ├─ Файл найден:
    │  │
    │  └── Отправка файла
    │
    └─ Файл не найден:
       │
       └── Возврат сообщения об ошибке "File not found", 404
```

**Примеры**:
```python
# Пример вызова функции _assets для запроса CSS файла
_assets("css", "style.css")
# Пример вызова функции _assets для запроса JavaScript файла
_assets("js", "script.js")