# Анализ кода модуля DIGITS

**Качество кода**
-   **Соответствие требованиям к формату кода (1-10):**
    -   **Преимущества:**
        -   Документ представляет собой подробное описание игры "Угадай число" (DIGITS).
        -   Присутствует четкое описание правил игры, шаги реализации и пример работы программы.
        -   Хорошо структурировано с использованием заголовков и подзаголовков.
        -   Приведены примеры взаимодействия пользователя с программой.
        -   Указаны возможные ограничения и рекомендации по реализации.
    -   **Недостатки:**
        -   Не представлен код на Python, только описание логики.
        -   Отсутствуют docstring и reStructuredText (RST) форматирование.
        -   Не указаны зависимости и импорты, необходимые для реализации.
        -   Нет обработки ошибок, кроме общих упоминаний.
        -   Не используются `j_loads` или `j_loads_ns` для чтения файлов (так как нет кода).
        -   Нет интеграции с `src.logger.logger` для логирования.
        -   Отсутствуют RST комментарии к функциям, классам и методам.
        -   Нет указаний на использование `try-except` или `logger.error`.

**Рекомендации по улучшению**

1.  **Добавить код реализации:**
    -   Необходимо предоставить реализацию игры на Python, включая функции для генерации случайного числа, обработки ввода пользователя и проверки совпадений.
2.  **Форматировать документацию:**
    -   Использовать RST для комментариев и docstring.
    -   Добавить docstring к каждой функции, объясняющие её назначение, параметры и возвращаемое значение.
3.  **Внедрить обработку ошибок:**
    -   Использовать `try-except` блоки для обработки ошибок ввода и других потенциальных проблем.
    -   Логировать ошибки с помощью `src.logger.logger`.
4.  **Использовать `j_loads`:**
    -   Заменить `json.load` на `j_loads` или `j_loads_ns` из `src.utils.jjson`, если планируется чтение данных из файла.
5.  **Структурировать код:**
    -   Разделить код на функции для улучшения читаемости и повторного использования.
6.  **Проверить зависимости:**
    -   Указать импорты необходимых модулей (например, `random`).
7.  **Добавить тесты:**
    -   Добавить примеры использования для тестирования функциональности игры.

**Улучшенный код**
```python
"""
Модуль для реализации игры DIGITS (Угадай число)
=========================================================================================

Этот модуль содержит функции для реализации игры, в которой компьютер загадывает случайное число
с заданным количеством цифр, а пользователь пытается его угадать.

Пример использования
--------------------

Пример запуска игры:

.. code-block:: python

    if __name__ == "__main__":
        play_digits()
"""

import random #  Импорт модуля random для генерации случайных чисел.
from src.logger.logger import logger #  Импорт модуля logger для логирования ошибок.
from typing import List, Tuple #  Импорт типов для аннотаций.

def generate_secret_number(digits: int) -> str:
    """
    Генерирует случайное число заданной длины с уникальными цифрами.

    :param digits: Количество цифр в загадываемом числе.
    :return: Строка, представляющая загаданное число.
    :raises ValueError: Если количество цифр не входит в диапазон от 2 до 5.
    """
    if not 2 <= digits <= 5: # Проверка корректности количества цифр
        logger.error(f'Неверное количество цифр: {digits}') # Логирование ошибки о неверном количестве цифр
        raise ValueError("Количество цифр должно быть от 2 до 5") #  Выбрасывание исключения, если число цифр некорректно.
    
    numbers = list(range(10)) # Создание списка цифр от 0 до 9
    random.shuffle(numbers)  #  Перемешивание списка цифр
    secret_number = ''.join(map(str, numbers[:digits])) #  Генерация секретного числа из первых 'digits' цифр списка
    return secret_number  #  Возвращает строку с загаданным числом.

def get_user_guess(digits: int) -> str:
    """
    Получает ввод пользователя и проверяет его корректность.

    :param digits: Ожидаемая длина числа.
    :return: Строка, представляющая ввод пользователя.
    :raises ValueError: Если ввод пользователя некорректный.
    """
    while True: # Бесконечный цикл для запроса ввода пока ввод не будет корректным
        guess = input(f'Введите ваше предположение ({digits} цифры): ')  #  Запрос ввода числа у пользователя
        if not guess.isdigit() or len(guess) != digits: #  Проверка, что ввод состоит из цифр и имеет нужную длину.
            logger.error(f'Некорректный ввод: {guess}') # Логирование ошибки о некорректном вводе
            print(f'Некорректный ввод. Введите {digits} цифры.') #  Вывод сообщения об ошибке, если ввод не корректен.
            continue #  Переход к следующей итерации цикла при некорректном вводе
        if len(set(guess)) != digits: #  Проверка, что все цифры в числе уникальны.
            logger.error(f'Некорректный ввод: {guess}') # Логирование ошибки о некорректном вводе
            print('Цифры должны быть уникальными. Попробуйте еще раз.') #  Вывод сообщения об ошибке, если цифры не уникальны.
            continue #  Переход к следующей итерации цикла при некорректном вводе
        return guess  # Возвращение ввода пользователя, если он корректен.

def compare_numbers(secret_number: str, guess: str) -> Tuple[int, int]:
    """
    Сравнивает загаданное число с предположением пользователя и определяет количество совпадений.

    :param secret_number: Загаданное число.
    :param guess: Предположение пользователя.
    :return: Кортеж, содержащий количество угаданных цифр на правильных местах и угаданных, но не на своих местах.
    """
    correct_place = 0 # Инициализация счетчика цифр на правильных местах
    correct_number = 0 # Инициализация счетчика угаданных цифр, но не на правильных местах
    for i, digit in enumerate(guess): # Проход по цифрам в предположении пользователя
        if digit == secret_number[i]:  # Проверка, что цифра и ее позиция совпали
            correct_place += 1 # Увеличение счетчика угаданных цифр на правильных местах
        elif digit in secret_number: # Проверка, что цифра угадана, но не на своем месте
            correct_number += 1  #  Увеличение счетчика угаданных цифр, но не на правильных местах
    return correct_place, correct_number # Возвращение кортежа с результатами сравнения.

def play_digits():
    """
    Запускает игру DIGITS.
    """
    print('Добро пожаловать в игру DIGITS!')  # Вывод приветственного сообщения
    while True: # Бесконечный цикл для повторных игр
        try: #  Блок try для обработки возможных исключений
            digits = int(input('Укажите количество цифр в загаданном числе (от 2 до 5): ')) #  Запрос количества цифр в загадываемом числе
            secret_number = generate_secret_number(digits) #  Генерация секретного числа
            print(f'Компьютер загадал число из {digits} уникальных цифр. Попробуйте угадать!') #  Сообщение о начале игры
            attempts = 0 #  Инициализация счетчика попыток
            while True: # Бесконечный цикл для угадывания числа
                guess = get_user_guess(digits) # Запрос ввода пользователя и проверка корректности ввода
                attempts += 1 #  Увеличение счетчика попыток
                correct_place, correct_number = compare_numbers(secret_number, guess) #  Сравнение введенного числа с секретным
                print(f'Угадано и на правильном месте: {correct_place}') # Вывод количества угаданных цифр на правильных местах
                print(f'Угадано, но не на своём месте: {correct_number}') #  Вывод количества угаданных цифр не на своих местах

                if correct_place == digits: #  Проверка, что все цифры угаданы и на правильных местах
                    print(f'Поздравляем! Вы угадали число: {secret_number} за {attempts} попыток') # Вывод поздравления и количества попыток
                    break  #  Завершение цикла угадывания при правильном ответе
        except ValueError as ex:  # Обработка исключения ValueError (например, некорректный ввод количества цифр)
            logger.error(f'Ошибка ввода: {ex}') # Логирование ошибки ввода
            continue # Переход к следующей итерации цикла для повторного ввода

        play_again = input('Хотите сыграть снова? (да/нет): ').lower()  #  Запрос на повторную игру
        if play_again != 'да': #  Проверка, что пользователь не хочет играть еще раз
            print('Спасибо за игру!') #  Вывод прощального сообщения
            break  # Завершение цикла игры, если пользователь не хочет играть снова

if __name__ == "__main__":
    play_digits() # Запуск игры, если скрипт запущен как основной
```