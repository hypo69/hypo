## ИНСТРУКЦИЯ:

Анализ предоставленного кода подробно и объяснение его функциональности. Ответ должен включать три раздела:

1.  **<алгоритм>**: Описание рабочего процесса в виде пошаговой блок-схемы, включая примеры для каждого логического блока, и иллюстрация потока данных между функциями, классами или методами.
2.  **<mermaid>**: Код для диаграммы в формате `mermaid`, анализ и объяснение всех зависимостей, которые импортируются при создании диаграммы.
    **ВАЖНО!** Убедитесь, что все имена переменных, используемые в диаграмме `mermaid`, имеют осмысленные и описательные имена. Имена переменных вроде `A`, `B`, `C`, и т.д., не допускаются!

    **Дополнительно**: Если в коде есть импорт `import header`, добавьте блок `mermaid` flowchart, объясняющий `header.py`
    ```mermaid
    flowchart TD
        Start --> Header[<code>header.py</code><br> Determine Project Root]

        Header --> import[Import Global Settings: <br><code>from src import gs</code>]
    ```
3.  **<объяснение>**: Предоставьте подробные объяснения:
    *   **Импорты**: Их назначение и взаимосвязь с другими пакетами `src.`.
    *   **Классы**: Их роль, атрибуты, методы и взаимодействие с другими компонентами проекта.
    *   **Функции**: Их аргументы, возвращаемые значения, назначение и примеры.
    *   **Переменные**: Их типы и использование.
    *   Выделите потенциальные ошибки или области для улучшения.

Дополнительно, постройте цепочку взаимосвязей с другими частями проекта (если применимо).

Это обеспечивает всесторонний и структурированный анализ кода.

## Формат ответа: `.md` (markdown)
**КОНЕЦ ИНСТРУКЦИИ**

### <алгоритм>
Представленный код является инструкцией для агента, специализирующегося на описании мебели. Он не является исполняемым кодом в строгом смысле, а скорее набором правил и примеров для генерации текстовых описаний.
1. **Начало:** Агент получает изображение мебели или сцену с мебелью.
2. **Определение крупных объектов:** Агент определяет основные объекты мебели на изображении, начиная с самых больших.
   - *Пример:* Агент видит кровать, шкаф и стол.
3. **Описание мебели:** Агент описывает каждый предмет мебели, следуя правилам:
    - **Избегать лишнего:** Не описывать фон или отсутствующие детали (например, пустые стены).
      - *Пример:* Вместо "комната с белыми стенами и кроватью", агент пишет "кровать с деревянным изголовьем".
    - **Контекст композиции:** Описывать мебель как часть общего дизайна.
       - *Пример:* "Угловой диван, формирующий уютную зону отдыха..."
    - **Фокус на мебели:** Не описывать упаковку или защитные материалы.
        - *Пример:* Описывать кровать, а не матрас в пленке.
    - **Избегать повторений:** Не использовать одни и те же фразы несколько раз.
       - *Пример:* Вместо "...что добавляет функциональности, что создает..." лучше использовать "... что добавляет функциональности и создает..."
    - **Кратко и по делу:** Описывать только основные характеристики.
        - *Пример:* Вместо длинного описания стола, описать его как "белый стол с прозрачной столешницей".
    - **Не описывать фон:** Игнорировать пол и задний план.
        - *Пример:* Описывать диван, а не пол, на котором он стоит.
4.  **Форматирование ответа:** Агент форматирует описание в JSON формате, включающем:
    - `id_category_default`: Категория по умолчанию.
        - *Пример:* `"id_category_default": "beds"`
    - `parent`: Родительская категория.
         - *Пример:* `"parent": "furniture"`
    - `category`: Категория товара.
        - *Пример:* `"category": "beds"`
    - `name`: Название продукта.
          - *Пример:* `"name": "Wooden Bed with Drawers"`
    - `description`: Описание мебели на иврите.
       - *Пример:* `"description": "מיטה עם מסגרת עץ לבן וראש מיטה עם פאנלים דקורטיביים. בחלק התחתון ישנם שני מגירות נשלפות לאחסון, מה שמוסיף פונקציונליות וחיסכון במקום."`
5.  **Конец:** Агент отправляет JSON ответ.

### <mermaid>

```mermaid
flowchart TD
    Start[Начало] --> GetImage[Получение изображения мебели]
    GetImage --> IdentifyObjects[Определение основных объектов мебели]
    IdentifyObjects --> LoopStart[Начало цикла по объектам мебели]
    LoopStart --> DescribeFurniture[Описание мебели согласно правилам]
     DescribeFurniture --> CheckLastObject{Последний объект?}
        CheckLastObject -- Yes --> FormatResponse[Форматирование JSON ответа]
      CheckLastObject -- No --> LoopStart
    FormatResponse --> End[Конец]

    style Start fill:#f9f,stroke:#333,stroke-width:2px
    style End fill:#ccf,stroke:#333,stroke-width:2px
    style  IdentifyObjects fill:#bbf,stroke:#333,stroke-width:2px
      style  DescribeFurniture fill:#bbf,stroke:#333,stroke-width:2px
        style  FormatResponse fill:#bbf,stroke:#333,stroke-width:2px
     style LoopStart fill:#ddf,stroke:#333,stroke-width:2px
         style  GetImage fill:#bbf,stroke:#333,stroke-width:2px
    style  CheckLastObject fill:#ccf,stroke:#333,stroke-width:2px
```
### <объяснение>

**Импорты**:
В данном коде нет явных импортов, так как это инструкция, а не исполняемый код. Однако, если бы этот код был частью более крупного проекта, возможно, потребовались бы импорты для работы с изображениями, обработки JSON и т.д.

**Классы**:
В данном коде нет классов.

**Функции**:
В коде нет явных функций, но можно представить, что агент выполняет неявную функцию описания мебели, принимая на вход изображение и генерируя JSON с описанием.

**Переменные**:
В коде нет переменных, но при выполнении инструкции, агент может использовать переменные для хранения промежуточных результатов, например:
 - `current_furniture`:  хранит информацию об объекте мебели, который сейчас описывается.
 - `description_text`: хранит промежуточное описание объекта на иврите.
- `json_response`: хранит финальный JSON объект.

**Потенциальные ошибки или области для улучшения**:
- **Недостаточная детализация правил**: Можно добавить больше правил для описания разных видов мебели, разных стилей и материалов.
- **Сложность правил:** Некоторые правила могут быть сложны для понимания и применения, например, необходимость избегать повторений.
- **Обработка ошибок**: Нет явной обработки ошибок. Например, что если на изображении нет мебели?
- **Расширение**: В будущем, можно добавить поддержку описания окружения, в котором находится мебель.

**Взаимосвязь с другими частями проекта**:
Этот код, как инструкция,  является важной частью проекта, связанного с автоматическим описанием мебели. Она может быть использована в качестве инструкции для модели, которая будет обрабатывать изображения и генерировать описание.
Возможные части проекта:
-  **Модуль обработки изображений:**  который будет предоставлять входное изображение.
-  **Модуль генерации текста:** который будет использовать эту инструкцию для формирования описаний.
-  **Модуль JSON форматирования:** который будет формировать JSON в соответствии с инструкцией.
-  **База данных/API для категорий:** который будет предоставлять значения для `id_category_default`, `parent` и `category`.