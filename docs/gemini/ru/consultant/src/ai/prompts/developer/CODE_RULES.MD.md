# Анализ кода модуля CODE_RULES

**Качество кода**
8
- Плюсы
    - Код содержит подробные инструкции по стилю и документированию кода.
    - Присутствуют примеры документации в стиле RST и примеры улучшений.
    - Код явно определяет правила для использования логгера и обработки ошибок.
- Минусы
    - Инструкция не полностью соответствует требованиям reStructuredText. Некоторые моменты не до конца раскрыты.
    -  Многословность в описании правил.
    - Не хватает конкретных примеров для некоторых правил.
    - Повторение некоторых пунктов в разных разделах, что может вызвать путаницу.

**Рекомендации по улучшению**
1. **Уточнить reStructuredText**:
   - Добавить более конкретные примеры использования reStructuredText для разных элементов (параметры, возвращаемые значения, исключения).
   -  Более подробно описать использование директив Sphinx.
2. **Конкретизировать правила**:
   - Уточнить правила именования переменных и функций.
   -  Предоставить больше примеров для правил форматирования кода.
   -  Привести примеры использования Pydantic моделей.
3. **Упростить язык**:
   - Избегать многословности, сделать формулировки более лаконичными.
   -  Сгруппировать повторяющиеся пункты в более общие правила.
4. **Расширить примеры**:
   - Добавить примеры для более сложных случаев, таких как использование классов и методов.
   -  Включить примеры обработки ошибок с использованием `logger.error`.
5.  **Оформление**:
    -   Улучшить форматирование Markdown, чтобы сделать документ более читаемым.
    -  Разделить длинные пункты на более мелкие, чтобы улучшить читаемость.
6. **Документация**:
   - Документацию модуля, функций, классов и переменных оформить в стиле reStructuredText.
    - Добавить информацию о том, как обрабатывать `...` в комментариях.

**Оптимизиробанный код**
```markdown
### Code Rules:

"""
Модуль описывает правила написания кода.
=========================================================================================

Этот модуль содержит правила, которые следует соблюдать при написании кода, включая форматирование, комментирование,
документирование и обработку ошибок. Правила направлены на повышение читаемости и поддерживаемости кода.

Пример использования
--------------------

.. code-block:: python

    # Пример использования правил в коде
    def example_function(param1: str, param2: int) -> str:
        # Код исполняет примерную задачу
        result = f'{param1} - {param2}'
        return result
"""

1. **Общие принципы**
   -   Использовать единый стиль кодирования для повышения читаемости и согласованности кода.
   -   Все изменения и рекомендации должны соответствовать этому формату.

---

2. **Комментарии**
   - **Комментарии после символа `#`**:
     - **Не изменять**: Комментарии после символа `#` должны оставаться неизменными. Не переписывать и не удалять их.
     - **Информативность**: Внутренние комментарии должны быть информативными и объяснять следующий блок кода.
     - **Формат**: Использовать reStructuredText (RST) для всех комментариев и документации.
     - **Терминология**: Избегать использования терминов вроде `получаем`, `делаем` в комментариях. Вместо этого использовать фразы вроде `проверка`, `отправка`, `код исполняет ...`.
     - **Пассивный залог**: Предпочитать пассивный залог: `копирование`, `форматирование`, `создание` и т. д.
     - **Пустые строки**: Если есть пустые строки или `...`, не документировать их.

   - **Комментарии после символа `"""`**:
     - **Оптимизация**: Комментарии после `"""` можно и нужно оптимизировать на основе фактического поведения кода.

---

3. **Документация**
   - **Docstring**: Каждая функция, метод и класс должны иметь docstring в стиле Sphinx.
     - Пример для функции:
       ```python
       def function(param: str, param1: Optional[str | dict] = None) -> dict | None:
           """
           Выполняет описание функции.

           :param param: Описание параметра `param`.
           :type param: str
           :param param1: (Опционально) Описание параметра `param1`.
           :type param1: str | dict, optional
           :return: Описание возвращаемого значения.
           :rtype: dict | None
           :raises SomeError: Условия для исключения.
           """
       ```
   - **Описание модуля**: Добавлять описание модуля в начало каждого файла:
     ```python
     """
     Модуль для работы с ассистентом программиста
     =========================================================================================

     Описание функциональности модуля.

     Пример использования
     ---------------------

     .. code-block:: python

         example_usage()
     """
     ```

---

4. **Форматирование кода**
   - **Кавычки**: Использовать одинарные кавычки вместо двойных.
   - **Пробелы**: Использовать пробелы вокруг оператора присваивания `=`. Пример:
     ```python
     a = 1
     ```
   - **Согласованность**: Применять пробелы согласованно во всех выражениях и присваиваниях:
     ```python
     result = 10 if x > 5 else 20
     ```
   - **Заголовок импорта**: Всегда включать строку `import header` в начале файла.
   - **Отладка**: Добавлять `...` между `logger` и `return` для отладки, пример:
     ```python
     logger.error('Ошибка при выполнении задачи', ex)
     ...
     return
     ```

---

5. **Параметры функций**
   - **Типизация**: Параметры должны быть явно типизированы. Если значение по умолчанию `None`, использовать `Optional`. Пример:
     ```python
     def critical(self, message: str, ex: Optional = None, exc_info: Optional[bool] = True):
     ```
   - **Избегать Union**: Избегать использования `Union`.

---

6. **Pydantic**
   - **Валидация**: Использовать Pydantic для проверки данных, если это возможно и уместно.
   - **Модели**: Предпочитать Pydantic модели для классов, обрабатывающих структурированные данные.

---

7. **Логирование**
   - **Логгер**: Использовать `from src.logger.logger import logger` для логирования вместо стандартного `logging`.
   - **Пример логирования ошибок**:
     ```python
     logger.error('Ошибка при запуске бота: ', ex)
     ...
     return
     ```

---

8. **Константы**
   - **MODE**: Всегда включать глобальную константу `MODE` в код, даже если она не используется.

---

### Формат ответа:

Все ответы должны соответствовать формату Markdown.

Структура ответа должна включать:

-   **Улучшенный код**: Блок с улучшенным кодом, отформатированным и с добавленными комментариями.
-   **Изменения**: Подробный список изменений и объяснений.

Код должен быть заключен в соответствующие теги подсветки синтаксиса (например, `python`, `markdown`, `json`).

---

### Примеры:

#### Пример 1 (Python Code):
Ввод:
```python
def add_numbers(a,b):
    return a+b
```

Ожидаемый ответ:

### Улучшенный код:
```python
def add_numbers(a: int, b: int) -> int:
    """
    Функция, складывающая два числа.

    :param a: Первое число.
    :type a: int
    :param b: Второе число.
    :type b: int
    :returns: Сумма чисел `a` и `b`.
    :rtype: int
    """
    return a + b
```

### Изменения:
- Добавлена документация в стиле RST для описания функции.
- Добавлены аннотации типов для `a` и `b`.
- Добавлены пробелы вокруг `+` и параметров функции для лучшей читаемости.

### Оптимизированный полный код:
```python
def add_numbers(a: int, b: int) -> int:
    """
    Функция, складывающая два числа.

    :param a: Первое число.
    :type a: int
    :param b: Второе число.
    :type b: int
    :returns: Сумма чисел `a` и `b`.
    :rtype: int
    """
    return a + b
```
```