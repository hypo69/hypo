# Модуль hypotez/src/suppliers/aliexpress/campaign/gsheet.py

## Обзор

Модуль `gsheet.py` предоставляет класс `AliCampaignGoogleSheet` для работы с Google Таблицами в контексте рекламных кампаний AliExpress. Он наследует класс `SpreadSheet` и расширяет его функционал для управления листами, записи данных о категориях и продуктах, а также форматирования листов.  Модуль использует библиотеку `gspread` для взаимодействия с Google Таблицами.

## Оглавление

- [Модуль `gsheet.py`](#модуль-gsheetpy)
- [Класс `AliCampaignGoogleSheet`](#класс-alicampaigngooglesheet)
    - [`__init__`](#инициализация-alicampaigngooglesheet)
    - [`clear`](#очистка-данных)
    - [`delete_products_worksheets`](#удаление-листов-продуктов)
    - [`set_campaign_worksheet`](#запись-данных-кампании)
    - [`set_products_worksheet`](#запись-данных-продуктов)
    - [`set_categories_worksheet`](#запись-данных-категорий)
    - [`get_categories`](#получение-данных-категорий)
    - [`set_category_products`](#запись-продуктов-в-категорию)
    - [Вспомогательные методы](#вспомогательные-методы)
        - [`_format_categories_worksheet`](#форматирование-листа-категорий)
        - [`_format_category_products_worksheet`](#форматирование-листа-продуктов)


## Класс `AliCampaignGoogleSheet`

### Описание

Класс `AliCampaignGoogleSheet` предназначен для управления Google Таблицами в контексте AliExpress кампаний. Он позволяет загружать, сохранять и форматировать данные о категориях и продуктах.

### `__init__`

#### Описание

Инициализирует объект `AliCampaignGoogleSheet` с заданным ID таблицы Google Sheets и дополнительными параметрами.

#### Параметры

- `campaign_name` (str): Имя кампании.
- `language` (str | dict, optional): Язык кампании. По умолчанию `None`.
- `currency` (str, optional): Валюта кампании. По умолчанию `None`.

#### Возвращает

- None

#### Вызывает исключения

- Возможны исключения, связанные с ошибками работы с Google Таблицами.


### `clear`

#### Описание

Очищает содержимое таблицы, удаляя листы продуктов и очищая данные на листах категорий и других указанных листах.

#### Параметры

- None

#### Возвращает

- None

#### Вызывает исключения

- `Exception`: При возникновении ошибок при удалении листов.


### `delete_products_worksheets`

#### Описание

Удаляет все листы из таблицы Google Sheets, кроме листов 'categories' и 'product_template'.

#### Параметры

- None

#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках удаления листов.


### `set_campaign_worksheet`

#### Описание

Записывает данные кампании в лист Google Sheets с именем 'campaign'.

#### Параметры

- `campaign` (SimpleNamespace): Объект `SimpleNamespace` с данными кампании.
- `language` (str, optional): Язык кампании. По умолчанию `None`.
- `currency` (str, optional): Валюта кампании. По умолчанию `None`.


#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках записи данных в лист.


### `set_products_worksheet`

#### Описание

Записывает данные продуктов в лист Google Sheets, соответствующий заданной категории.

#### Параметры

- `category_name` (str): Имя категории.


#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках записи данных в лист.


### `set_categories_worksheet`

#### Описание

Записывает данные категорий в лист Google Sheets с именем 'categories'.

#### Параметры

- `categories` (SimpleNamespace): Объект `SimpleNamespace` с данными категорий.


#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках записи данных в лист.


### `get_categories`

#### Описание

Получает данные категорий из листа 'categories' Google Sheets.

#### Параметры

- None

#### Возвращает

- list[dict]: Данные категорий в виде списка словарей.

#### Вызывает исключения

- Возможны исключения, связанные с ошибками работы с Google Таблицами.


### `set_category_products`

#### Описание

Записывает данные продуктов в новый лист Google Sheets, соответствующий заданной категории.

#### Параметры

- `category_name` (str): Имя категории.
- `products` (dict): Словарь с данными продуктов.


#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках записи данных в лист.



### Вспомогательные методы

#### `_format_categories_worksheet`

#### Описание

Форматирует лист 'categories', устанавливая ширину столбцов и высоту строк.

#### Параметры

- `ws` (Worksheet): Лист Google Sheets для форматирования.


#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках форматирования.



#### `_format_category_products_worksheet`

#### Описание

Форматирует лист с продуктами категории, устанавливая ширину столбцов и высоту строк.

#### Параметры

- `ws` (Worksheet): Лист Google Sheets для форматирования.


#### Возвращает

- None

#### Вызывает исключения

- `Exception`: Возникает при ошибках форматирования.