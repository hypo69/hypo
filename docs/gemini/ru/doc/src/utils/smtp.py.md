# Модуль `smtp`

## Обзор

Модуль `smtp` предоставляет интерфейс для отправки и получения электронных писем с использованием протоколов SMTP и IMAP. Он включает функции для отправки писем через SMTP и получения писем через IMAP. Модуль обеспечивает безопасное хранение учетных данных путем использования переменных окружения, а также включает обработку ошибок и логирование для облегчения отладки.

## Подробней

Этот модуль предназначен для интеграции с другими частями проекта, где требуется отправка уведомлений по электронной почте или обработка входящей корреспонденции. Он позволяет абстрагироваться от низкоуровневых деталей работы с SMTP и IMAP серверами, предоставляя простой и удобный интерфейс для выполнения этих задач.

## Функции

### `send`

```python
def send(subject: str = '', body: str = '', to: str = 'one.last.bit@gmail.com') -> bool:
    """Отправляет электронное письмо.

    Args:
        subject (str, optional): Тема письма. По умолчанию пустая строка.
        body (str, optional): Тело письма. По умолчанию пустая строка.
        to (str, optional): Адрес получателя. По умолчанию 'one.last.bit@gmail.com'.

    Returns:
        bool: True в случае успешной отправки, False в случае ошибки.

    Raises:
        Exception: В случае возникновения ошибки при отправке письма.

    Example:
        >>> send(subject='Тест', body='Это тестовое письмо', to='test@example.com')
        True
    """
```

**Описание**: Отправляет электронное письмо с заданными темой, телом и получателем. Использует параметры SMTP-подключения, хранящиеся в словаре `_connection`. В случае успеха возвращает `True`, в случае ошибки - `False`. Ошибки логируются с использованием модуля `logger`.

**Параметры**:
- `subject` (str): Тема письма.
- `body` (str): Тело письма.
- `to` (str): Адрес получателя.

**Возвращает**:
- `bool`: `True`, если письмо отправлено успешно, `False` в противном случае.

**Вызывает исключения**:
- `smtplib.SMTPException`: Возникает при ошибках, связанных с SMTP-сервером.

**Примеры**:

```python
send(subject='Важное сообщение', body='Произошло важное событие.', to='адресат@example.com')
```

### `receive`

```python
def receive(imap_server: str, user: str, password: str, folder: str = 'inbox') -> Optional[List[Dict[str, str]]]:
    """Получает электронные письма из указанного почтового ящика.

    Args:
        imap_server (str): Адрес IMAP-сервера.
        user (str): Имя пользователя для подключения к IMAP-серверу.
        password (str): Пароль для подключения к IMAP-серверу.
        folder (str, optional): Название папки для получения писем. По умолчанию 'inbox'.

    Returns:
        Optional[List[Dict[str, str]]]: Список словарей, где каждый словарь содержит информацию об одном письме (тема, отправитель, тело). Возвращает None в случае ошибки.

    Raises:
        imaplib.IMAP4.error: В случае возникновения ошибки при подключении к IMAP-серверу или при выполнении операций с почтовым ящиком.

    Example:
        >>> receive(imap_server='imap.example.com', user='test@example.com', password='password', folder='INBOX')
        [{'subject': 'Тема письма', 'from': 'отправитель@example.com', 'body': 'Тело письма'}]
    """
```

**Описание**: Извлекает письма из указанного почтового ящика IMAP-сервера. Возвращает список словарей, где каждый словарь содержит информацию о письме (тема, отправитель, тело). В случае ошибки возвращает `None`. Ошибки логируются с использованием модуля `logger`.

**Параметры**:
- `imap_server` (str): Адрес IMAP-сервера.
- `user` (str): Имя пользователя для подключения к IMAP-серверу.
- `password` (str): Пароль для подключения к IMAP-серверу.
- `folder` (str): Название папки для получения писем. По умолчанию 'inbox'.

**Возвращает**:
- `Optional[List[Dict[str, str]]]`: Список словарей с информацией о письмах или `None` в случае ошибки.

**Вызывает исключения**:
- `imaplib.IMAP4.error`: Возникает при ошибках, связанных с IMAP-сервером.

**Примеры**:

```python
receive(imap_server='imap.example.com', user='пользователь@example.com', password='пароль', folder='Входящие')