# Модуль scenario_pricelist

## Обзор

Этот модуль отвечает за выполнение сценария создания мехирона для Сергея Казаринова. Он предоставляет функциональность для извлечения, обработки и сохранения данных о продуктах от различных поставщиков. Модуль включает в себя обработку данных, использование AI-моделей, а также интеграцию с Facebook для публикации сообщений.

## Классы

### `MexironBuilder`

**Описание**: Класс `MexironBuilder` отвечает за обработку данных о продуктах, их обработку с помощью AI-модели и сохранение результатов.

**Атрибуты**:

- `driver` (Driver): Экземпляр Selenium WebDriver для работы с веб-страницами.
- `export_path` (Path): Путь для экспорта результатов.
- `mexiron_name` (str): Имя мехирона.
- `price` (float): Цена продукта.
- `timestamp` (str): Отметка времени.
- `products_list` (List[dict]): Список обработанных данных о продуктах.
- `model` (GoogleGenerativeAI): Экземпляр AI-модели Gemini.
- `config` (SimpleNamespace): Настройки из файла конфигурации.


**Методы**:

#### `__init__`

**Описание**: Инициализирует объект `MexironBuilder`. Загружает конфигурацию, устанавливает отметку времени, создает путь для экспорта и инициализирует AI-модель.

**Параметры**:

- `driver` (Driver): Экземпляр Selenium WebDriver.
- `mexiron_name` (Optional[str], optional): Название мехирона. По умолчанию, значение из `timestamp`.

**Возвращает**:
-  Возвращает `None` при ошибке загрузки конфигурации или построения пути.

#### `run_scenario`

**Описание**: Выполняет сценарий: парсит продукты, обрабатывает их с помощью AI, сохраняет данные и (возможно) публикует сообщения в Facebook.

**Параметры**:

- `system_instruction` (Optional[str], optional): Система инструкций для AI-модели. По умолчанию `None`.
- `price` (Optional[str], optional): Цена продукта. По умолчанию `None`.
- `mexiron_name` (Optional[str], optional): Имя мехирона. По умолчанию `None`.
- `urls` (Optional[str | List[str]], optional): URL-адреса страниц продуктов. По умолчанию `None`.
- `bot` (Optional[object]): Объект Telegram Bot. По умолчанию `None`.

**Возвращает**:
- `bool`: `True`, если сценарий выполнен успешно, `False` иначе.

**Обрабатываемые исключения**:
- `Exception`:  Обрабатывает различные ошибки, связанные с выполнением сценария.

**Примечания**:
- Метод содержит подробную блок-схему (mermaid) процесса выполнения сценария.
- Метод `get_graber_by_supplier_url` использует `startswith` для определения поставщика по URL-адресу.


#### `get_graber_by_supplier_url`

**Описание**: Возвращает соответствующий грабер для заданного URL-адреса поставщика.

**Параметры**:
- `url` (str): URL-адрес страницы поставщика.

**Возвращает**:
- `Optional[object]`: Экземпляр грабера, если найден, иначе `None`.

#### `convert_product_fields`

**Описание**: Конвертирует поля продукта из объекта `ProductFields` в словарь.

**Параметры**:
- `f` (ProductFields): Объект, содержащий обработанные данные о продукте.

**Возвращает**:
- `dict`: Словарь с обработанными данными продукта.


#### `save_product_data`

**Описание**: Сохраняет данные о продукте в файл.

**Параметры**:
- `product_data` (dict): Данные о продукте в формате словаря.

**Возвращает**:
- `bool`: `True` если сохранение прошло успешно, `False` иначе.

#### `process_ai`

**Описание**: Обрабатывает список продуктов с помощью AI-модели.

**Параметры**:
- `products_list` (List[str]): Список данных о продуктах.
- `lang` (str): Язык обработки.
- `attempts` (int, optional): Количество попыток при ошибках. По умолчанию 3.


**Возвращает**:
- `tuple`: Обработанный ответ в форматах `ru` и `he`  или `False` если ответ не получен после всех попыток.
**Примечания**:
- Метод может обрабатывать несколько попыток обработки AI, если модель возвращает неверный результат.


#### `post_facebook`

**Описание**: Публикует сообщение в Facebook.

**Параметры**:
- `mexiron` (SimpleNamespace): Объект, содержащий данные для публикации.

**Возвращает**:
- `bool`: `True` если публикация прошла успешно, `False` иначе.

#### `create_report`

**Описание**: Создает отчет в формате HTML и PDF.

**Параметры**:
- `data` (dict): Данные для отчета.
- `html_file` (Path): Путь к файлу отчета в формате HTML.
- `pdf_file` (Path): Путь к файлу отчета в формате PDF.


## Функции


## Модули


```