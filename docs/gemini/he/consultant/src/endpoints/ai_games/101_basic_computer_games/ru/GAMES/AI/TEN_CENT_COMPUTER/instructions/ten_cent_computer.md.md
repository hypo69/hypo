# Анализ кода модуля ten_cent_computer.md

**Качество кода**
  
- Соответствие требованиям к формату кода (1-10): 7
    -  **Преимущества**:
        -  Четкая формулировка задачи и правил игры.
        -  Приведены примеры взаимодействия пользователя с симулятором.
        -  Понятный формат ввода/вывода.
    -   **Недостатки**:
        -  Отсутствие структурированного кода для реализации симулятора.
        -  Нет обработки ошибок и граничных случаев.
        -  Нет пояснений по реализации алгоритмов.
        -  Нет документации в формате reStructuredText (RST).
        -  Не используется `logger`.
        -  Нет импортов и функций.
        -  Нет разделения на логические части кода.

**Рекомендации по улучшению**

1.  **Структурировать код**: Разбить задачу на функции (например, `decimal_to_binary`, `binary_to_decimal`, `explain_number`).
2.  **Добавить обработку ошибок**: Проверять корректность входных данных (например, является ли ввод десятичным числом или двоичным представлением).
3.  **Реализовать алгоритмы**: Прописать логику преобразования чисел из десятичной в двоичную систему и обратно.
4.  **Документировать код**: Добавить docstring в формате reStructuredText (RST) для каждой функции.
5.  **Использовать логгер**: Добавить логирование ошибок и отладочную информацию с помощью `src.logger.logger`.
6.  **Добавить импорты**:  Импортировать необходимые модули.
7.  **Использовать переменные**: Выделить константы в переменные (например, длина двоичного представления, веса битов).
8.  **Добавить проверку на валидность ввода**: Проверять ввод пользователя на соответствие ожиданиям.

**Улучшенный код**
```python
"""
Модуль для симуляции "10-центового компьютера"
=========================================================================================

Модуль представляет собой симулятор для обучения детей двоичной системе счисления.
Симулятор преобразует десятичные числа в двоичное представление с помощью 4-х
"лампочек" (0 - лампа выключена, 1 - лампа включена) и обратно.

Пример использования
--------------------

Пример взаимодействия с симулятором:

.. code-block:: python

    simulator = TenCentComputer()
    simulator.process_input("Десятичное: 5")
    simulator.process_input("Лампочки: 1010")
    simulator.process_input("Объясните как 7")
"""
from src.logger.logger import logger  # добавляем импорт логгера #
from typing import Any # добавляем импорт для аннотации типов #


class TenCentComputer:
    """
    Класс реализует симулятор "10-центового компьютера".

    :ivar BINARY_LENGTH: Длина двоичного представления (константа).
    :vartype BINARY_LENGTH: int
    :ivar BIT_VALUES: Список значений битов (константа).
    :vartype BIT_VALUES: list[int]
    """

    BINARY_LENGTH = 4  # длина двоичного представления #
    BIT_VALUES = [1, 2, 4, 8]  # веса битов #

    def __init__(self) -> None:
        """
        Инициализирует экземпляр класса TenCentComputer.
        """
        pass # конструктор класса #

    def decimal_to_binary(self, decimal: int) -> str:
        """
        Преобразует десятичное число в двоичное представление.

        :param decimal: Десятичное число для преобразования.
        :type decimal: int
        :return: Двоичное представление числа в виде строки.
        :rtype: str
        :raises ValueError: Если десятичное число выходит за допустимый диапазон.

        :Example:
        >>> TenCentComputer().decimal_to_binary(5)
        '0101'
        """
        if not 0 <= decimal <= 15: # Проверка на то, что число в допустимом диапазоне #
            logger.error(f'Десятичное число {decimal} вне допустимого диапазона (0-15).') # Логирование ошибки #
            raise ValueError(f"Десятичное число {decimal} должно быть в диапазоне от 0 до 15")

        binary = bin(decimal)[2:].zfill(self.BINARY_LENGTH) # Преобразуем в бинарное и дополняем нулями #
        return binary # Возвращаем двоичное представление #

    def binary_to_decimal(self, binary: str) -> int:
        """
        Преобразует двоичное представление в десятичное число.

        :param binary: Двоичное представление числа в виде строки.
        :type binary: str
        :return: Десятичное число.
        :rtype: int
        :raises ValueError: Если двоичная строка неверного формата.

        :Example:
        >>> TenCentComputer().binary_to_decimal('0101')
        5
        """
        if len(binary) != self.BINARY_LENGTH or not all(bit in '01' for bit in binary): # Проверка на валидность бинарного представления #
           logger.error(f'Двоичное представление {binary} неверного формата. Ожидается строка из 4 символов 0 и 1') # Логирование ошибки #
           raise ValueError(f'Двоичное представление {binary} неверного формата. Ожидается строка из 4 символов 0 и 1')

        decimal = 0  # Инициализируем десятичное значение #
        for i, bit in enumerate(reversed(binary)): # Итерируем по битам в обратном порядке #
            if bit == '1': # Если бит равен 1 #
                decimal += self.BIT_VALUES[i] # Прибавляем вес этого бита к десятичному числу #
        return decimal # Возвращаем десятичное значение #

    def explain_number(self, binary: str, decimal: int) -> str:
         """
         Формирует объяснение для двоичного представления.

         :param binary: Двоичное представление числа в виде строки.
         :type binary: str
         :param decimal: Десятичное число.
         :type decimal: int
         :return: Объяснение в виде строки.
         :rtype: str

         :Example:
         >>> TenCentComputer().explain_number('0101', 5)
         'Включены лампочки 1 и 4, 1+4=5'
         """
         activated_bits = [] # Инициализируем список включенных битов #
         explanation = "Включены лампочки " # Инициализируем строку объяснения #
         for i, bit in enumerate(reversed(binary)): # Итерируем по битам в обратном порядке #
              if bit == "1": # Если бит равен 1 #
                   activated_bits.append(str(self.BIT_VALUES[i])) # Добавляем значение бита в список #
         explanation += ", ".join(activated_bits) # Составляем объяснение #
         explanation += f", {'+'.join(activated_bits)}={decimal}" # Добавляем сумму включенных битов #
         return explanation # Возвращаем объяснение #


    def process_input(self, user_input: str) -> str | None:
        """
        Обрабатывает ввод пользователя и возвращает ответ симулятора.

        :param user_input: Строка ввода пользователя.
        :type user_input: str
        :return: Строка ответа симулятора или None, если ввод некорректен.
        :rtype: str | None

        :Example:
        >>> simulator = TenCentComputer()
        >>> simulator.process_input("Десятичное: 5")
        'Двоичное: 0101, объяснение:Включены лампочки 1 и 4, 1+4=5'
        >>> simulator.process_input("Лампочки: 1010")
        'Десятичное: 10, объяснение:Включены лампочки 2 и 8, 2+8=10'
        >>> simulator.process_input("Объясните как 7")
        'Двоичное: 1110, объяснение:Включены лампочки 1, 2 и 4, 1+2+4=7'
        """
        try:
            if user_input.startswith("Десятичное: "):  # Проверяем, начинается ли ввод с "Десятичное: " #
                decimal_str = user_input[len("Десятичное: "):].strip() # Извлекаем значение десятичного числа #
                decimal = int(decimal_str) # Преобразуем строку в число #
                binary = self.decimal_to_binary(decimal) # Получаем двоичное представление #
                explanation = self.explain_number(binary, decimal) # Получаем объяснение #
                return f"Двоичное: {binary}, объяснение:{explanation}" # Формируем и возвращаем ответ #

            elif user_input.startswith("Лампочки: "): # Проверяем, начинается ли ввод с "Лампочки: " #
                binary = user_input[len("Лампочки: "):].strip() # Извлекаем двоичное представление #
                decimal = self.binary_to_decimal(binary) # Получаем десятичное значение #
                explanation = self.explain_number(binary, decimal) # Получаем объяснение #
                return f"Десятичное: {decimal}, объяснение:{explanation}" # Формируем и возвращаем ответ #

            elif user_input.startswith("Объясните как "): # Проверяем, начинается ли ввод с "Объясните как " #
                 decimal_str = user_input[len("Объясните как "):].strip() # Извлекаем значение десятичного числа #
                 decimal = int(decimal_str) # Преобразуем строку в число #
                 binary = self.decimal_to_binary(decimal) # Получаем двоичное представление #
                 explanation = self.explain_number(binary, decimal) # Получаем объяснение #
                 return f"Двоичное: {binary}, объяснение:{explanation}" # Формируем и возвращаем ответ #
            else:
                logger.error(f'Некорректный ввод пользователя: {user_input}') # Логирование ошибки #
                return None  # Возвращаем None при некорректном вводе #
        except ValueError as e: # Обрабатываем ошибки преобразования #
             logger.error(f"Ошибка преобразования ввода: {e}") # Логирование ошибки #
             return None # Возвращаем None при ошибке преобразования #
        except Exception as e: # Обрабатываем прочие ошибки #
            logger.error(f"Неожиданная ошибка: {e}") # Логирование ошибки #
            return None # Возвращаем None при неожиданной ошибке #
```