# Анализ кода модуля even.ru.md

**Качество кода**
7
- Плюсы
    - Документ содержит подробное описание игры, включая правила, пошаговую инструкцию, пример работы и ограничения.
    - Структура документа логична и последовательна, что облегчает понимание правил игры.
    - Приведены примеры работы программы, которые помогают пользователю понять игровой процесс.
- Минусы
    - Документ не является кодом, а представляет собой описание игры в формате Markdown.
    - Отсутствует исполняемый код на Python, который можно было бы проанализировать и улучшить.
    - Не используются RST комментарии.

**Рекомендации по улучшению**
1.  Преобразовать описание игры в reStructuredText (RST).
2.  Предоставить примеры кода Python для реализации данной игры.
3.  Реализовать игру на Python с соблюдением всех требований к коду.
4.  Добавить обработку ошибок.
5.  Добавить логирование.

**Оптимизированный код**

```markdown
### Название игры: **EVEN** (Игра на парность)

---

#### Описание
**EVEN** — это логическая игра, в которой игрок и компьютер по очереди берут предметы из общей кучи. Цель игры — оставить противнику чётное количество предметов после своего хода. Тот, кто оставляет противнику нечётное количество предметов, проигрывает.

---

### Пошаговая инструкция для реализации

#### 1. **Инициализация игры**
   - При запуске программы пользователь приветствуется и получает инструкции.
   - Программа генерирует случайное количество предметов в куче (например, от 10 до 30).
   - Игроку предоставляется выбор:
     - Ходить первым.
     - Позволить компьютеру сделать первый ход.

#### 2. **Основной процесс игры**
   - **Ход игрока:**
     1. Пользователь вводит, сколько предметов он хочет взять (например, от 1 до 3).
     2. Если ввод некорректен (число меньше 1, больше 3 или больше количества предметов в куче), программа выводит сообщение об ошибке и запрашивает ввод снова.
   - **Ход компьютера:**
     1. Компьютер рассчитывает количество предметов, которые ему следует взять, чтобы оставить игроку чётное количество предметов.
     2. Если это невозможно, компьютер делает ход случайным образом в пределах правил (1–3 предмета).
   - После каждого хода программа отображает количество оставшихся предметов в куче.

#### 3. **Проверка победителя**
   - Если после хода игрока или компьютера в куче остаётся нечётное количество предметов, игра завершается, и победителем объявляется противник.

#### 4. **Продолжение игры**
   - После завершения игры пользователю предлагается сыграть снова:
     ```
     Хотите сыграть ещё раз? (да/нет)
     ```
   - Если пользователь выбирает "да", программа начинает новый раунд.
   - Если "нет", программа завершает работу.

---

### Пример работы программы

1. **Начало игры:**
   ```
   Добро пожаловать в игру EVEN!
   В куче 23 предмета.
   Хотите ходить первым? (да/нет):
   > да
   ```

2. **Ход игрока:**
   ```
   Введите количество предметов, которые вы хотите взять (1–3):
   > 2
   Вы взяли 2 предмета.
   Осталось 21 предмет.
   ```

3. **Ход компьютера:**
   ```
   Компьютер взял 1 предмет.
   Осталось 20 предметов.
   ```

4. **Результат игры:**
   ```
   Введите количество предметов, которые вы хотите взять (1–3):
   > 3
   Вы взяли 3 предмета.
   Осталось 17 предметов.
   Компьютер взял 2 предмета.
   Осталось 15 предметов.

   Вы оставили компьютеру нечётное количество предметов!
   Вы проиграли.
   Хотите сыграть ещё раз? (да/нет):
   > нет
   Спасибо за игру!
   ```

---

### Возможные ограничения
- Количество предметов, которые можно взять за ход, ограничено диапазоном от 1 до 3.
- Количество предметов в куче задаётся случайным образом в начале игры.
- Компьютер играет стратегически, но при невозможности оставить чётное количество предметов делает случайный выбор.

---

### Реализация
Игра может быть реализована на Python с использованием следующих возможностей:
- **Модуль `random`** для генерации начального количества предметов.
- Циклы и условия для реализации игрового процесса и проверки корректности ввода.
- Логика стратегического хода компьютера.

Рекомендуется:
- Добавить счётчик выигранных раундов для игрока и компьютера.
- Реализовать несколько уровней сложности для хода компьютера (например, случайные ходы или стратегические).

```
```python
"""
Модуль для реализации игры EVEN.
=========================================================================================

Этот модуль содержит функции для запуска и управления логической игрой EVEN,
в которой игрок и компьютер по очереди берут предметы из общей кучи.

Пример использования
--------------------

Пример запуска игры:

.. code-block:: python

    if __name__ == "__main__":
        play_even_game()
"""

import random
from src.logger.logger import logger

def get_player_choice(items_left: int) -> int:
    """
    Запрашивает у игрока ввод количества предметов для взятия.

    :param items_left: Количество предметов, оставшихся в куче.
    :return: Количество предметов, которые игрок хочет взять.
    :raises ValueError: Если введенное значение не является числом или выходит за допустимый диапазон.
    """
    while True:
        try:
            choice = int(input(f"Введите количество предметов, которые вы хотите взять (1-3): "))
            if 1 <= choice <= 3 and choice <= items_left:
                 # Код исполняет проверку корректности выбора игрока.
                return choice
            else:
                logger.error(f"Некорректный ввод. Введите число от 1 до 3 и не больше {items_left}.")
                print(f"Некорректный ввод. Введите число от 1 до 3 и не больше {items_left}.")
        except ValueError:
            logger.error("Некорректный ввод. Введите целое число.")
            print("Некорректный ввод. Введите целое число.")


def computer_turn(items_left: int) -> int:
    """
    Определяет ход компьютера.

    :param items_left: Количество предметов, оставшихся в куче.
    :return: Количество предметов, которые компьютер забирает.
    """
    # код исполняет проверку возможности оставить четное количество предметов
    for i in range(1, 4):
        if (items_left - i) % 2 == 0:
            return i
    # Код исполняет случайный выбор, если нет возможности оставить четное количество предметов.
    return random.randint(1, 3)

def play_even_game() -> None:
    """
     Запускает игру EVEN.
    """
    while True:
        items_total = random.randint(10, 30)
        print(f"Добро пожаловать в игру EVEN!\nВ куче {items_total} предмета.")
        first_move = input("Хотите ходить первым? (да/нет): ").lower()
        items_left = items_total

        if first_move == 'да':
        # Код исполняет игровой цикл, начиная с хода игрока.
            turn = 'player'
        else:
            # Код исполняет игровой цикл, начиная с хода компьютера.
            turn = 'computer'

        while items_left > 0:
             # Код исполняет ход игрока.
            if turn == 'player':
                player_choice = get_player_choice(items_left)
                items_left -= player_choice
                print(f"Вы взяли {player_choice} предмета. Осталось {items_left} предмета.")
                if items_left % 2 != 0 and items_left != 0 :
                    print("Вы оставили компьютеру нечётное количество предметов!\nВы проиграли.")
                    break
                turn = 'computer'
             # Код исполняет ход компьютера.
            else:
                computer_choice = computer_turn(items_left)
                items_left -= computer_choice
                print(f"Компьютер взял {computer_choice} предмета. Осталось {items_left} предмета.")
                if items_left % 2 != 0 and items_left != 0 :
                    print("Компьютер оставил вам нечётное количество предметов!\nВы победили.")
                    break
                turn = 'player'
         # Код исполняет проверку на желание продолжить игру.
        play_again = input("Хотите сыграть ещё раз? (да/нет): ").lower()
        if play_again != 'да':
            print("Спасибо за игру!")
            break

if __name__ == "__main__":
    play_even_game()
```