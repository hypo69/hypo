# Модуль `search.py`

## Обзор

Модуль `search.py` предназначен для поиска информации о фильмах или сериалах на сайте Kinopoisk через поисковую систему Google. Он использует библиотеки `requests` для выполнения HTTP-запросов, `BeautifulSoup` для парсинга HTML-ответов и модуль `useragent` для получения случайного User-Agent.

## Подробней

Этот модуль используется для поиска информации о фильмах или сериалах на сайте Kinopoisk. Он выполняет поисковый запрос в Google, анализирует результаты поиска и извлекает ссылку, название и описание фильма или сериала. Это может быть полезно для интеграции с другими сервисами или ботами, которые предоставляют информацию о фильмах и сериалах.

## Функции

### `search_query`

```python
def search_query(query, type_movie='series'):
    """
    Выполняет поиск информации о фильме или сериале на Kinopoisk через Google.

    Args:
        query (str): Поисковый запрос.
        type_movie (str, optional): Тип искомого контента ("series" или "movie"). По умолчанию "series".

    Returns:
        dict | None: Словарь с информацией о фильме/сериале (ссылка, название, описание) или None, если ничего не найдено.

    Raises:
        requests.exceptions.RequestException: Если возникает ошибка при выполнении HTTP-запроса.

    Example:
        >>> search_query('теория большого взрыва')
        {'link': 'https://w2.kpfr.wiki/series/123456', 'title': 'Теория большого взрыва', 'description': 'Описание сериала...'}
    """
```

**Как работает функция**:

1.  **Формирование поискового запроса**: Функция принимает поисковый запрос `query` и тип искомого контента `type_movie` (по умолчанию "series"). Она формирует поисковый запрос для Google, добавляя префикс `site:www.kinopoisk.ru/{type_movie}`.

2.  **Выполнение HTTP-запроса**: Функция выполняет HTTP-запрос к Google с использованием библиотеки `requests`. Она передает поисковый запрос в параметрах `q` и устанавливает заголовок `User-Agent` для имитации запроса от браузера.

3.  **Парсинг HTML-ответа**: Функция анализирует HTML-ответ, используя библиотеку `BeautifulSoup`. Она находит все блоки `div` с классом `g`, которые содержат результаты поиска.

4.  **Извлечение информации**: Функция итерируется по блокам результатов поиска и извлекает ссылку, название и описание фильма или сериала. Она проверяет, что ссылка ведет на страницу Kinopoisk и что идентификатор фильма/сериала является числом.

5.  **Формирование результата**: Если информация успешно извлечена, функция возвращает словарь, содержащий ссылку, название и описание фильма/сериала. В противном случае функция возвращает `None`.

**Параметры**:

*   `query` (str): Поисковый запрос.
*   `type_movie` (str, optional): Тип искомого контента ("series" или "movie"). По умолчанию "series".

**Возвращает**:

*   `dict | None`: Словарь с информацией о фильме/сериале (ссылка, название, описание) или `None`, если ничего не найдено.

**Вызывает исключения**:

*   `requests.exceptions.RequestException`: Если возникает ошибка при выполнении HTTP-запроса.

**Примеры**:

```python
>>> search_query('теория большого взрыва')
{'link': 'https://w2.kpfr.wiki/series/123456', 'title': 'Теория большого взрыва', 'description': 'Описание сериала...'}
```

```python
>>> search_query('бойцовский клуб', type_movie='movie')
{'link': 'https://w2.kpfr.wiki/movie/666', 'title': 'Бойцовский клуб', 'description': 'Описание фильма...'}
```

## `if __name__ == '__main__':`

```python
if __name__ == '__main__':
    print(search_query('теория большого взрыва'))
```

**Как работает**:
Этот блок кода выполняется только при запуске скрипта напрямую, а не при импорте как модуля. Он вызывает функцию `search_query` с запросом "теория большого взрыва" и выводит результат в консоль. Это позволяет протестировать функцию `search_query` без необходимости написания дополнительных тестов.