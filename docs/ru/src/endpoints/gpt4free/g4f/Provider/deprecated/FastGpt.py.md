# Модуль `FastGpt`

## Обзор

Модуль `FastGpt` предоставляет класс `FastGpt`, который является провайдером для взаимодействия с API FastGPT. Он позволяет генерировать текст на основе предоставленных сообщений, используя модели GPT.

## Подробней

Этот модуль является частью набора провайдеров, используемых в проекте `hypotez` для обеспечения доступа к различным AI-моделям. Класс `FastGpt` реализует абстрактный класс `AbstractProvider` и предоставляет методы для создания завершений текста.

## Классы

### `FastGpt(AbstractProvider)`

**Описание**:
Класс `FastGpt` предоставляет интерфейс для взаимодействия с API FastGPT.

**Наследует**:
`AbstractProvider`: Абстрактный базовый класс для провайдеров.

**Атрибуты**:
- `url` (str): URL API FastGPT. По умолчанию `'https://chat9.fastgpt.me/'`.
- `working` (bool): Указывает, работает ли провайдер. По умолчанию `False`.
- `needs_auth` (bool): Указывает, требуется ли аутентификация. По умолчанию `False`.
- `supports_stream` (bool): Указывает, поддерживает ли провайдер потоковую передачу данных. По умолчанию `True`.
- `supports_gpt_35_turbo` (bool): Указывает, поддерживает ли провайдер модель `gpt-3.5-turbo`. По умолчанию `True`.
- `supports_gpt_4` (bool): Указывает, поддерживает ли провайдер модель `gpt-4`. По умолчанию `False`.

### `create_completion`

```python
    @staticmethod
    def create_completion(
        model: str,
        messages: list[dict[str, str]],
        stream: bool, **kwargs: Any) -> CreateResult:
        ...
```

**Назначение**:
Создает запрос к API FastGPT для генерации текста на основе предоставленных сообщений.

**Параметры**:
- `model` (str): Имя модели, используемой для генерации текста.
- `messages` (list[dict[str, str]]): Список сообщений, используемых в качестве контекста для генерации текста.
- `stream` (bool): Указывает, должна ли быть включена потоковая передача данных.
- `**kwargs` (Any): Дополнительные параметры для запроса.

**Возвращает**:
- `CreateResult`: Результат запроса к API FastGPT.

**Как работает функция**:

1. Функция `create_completion` устанавливает необходимые заголовки для HTTP-запроса к API FastGPT.
2. Подготавливает JSON-данные, включающие сообщения, модель, параметры температуры, штрафы за присутствие и частоту, а также верхнее значение `p`.
3. Выбирает случайный поддомен из списка `['jdaen979ew', 'chat9']`.
4. Отправляет POST-запрос к API FastGPT с использованием библиотеки `requests`.
5. Итерируется по строкам ответа, декодирует JSON и извлекает контент из каждого токена, который затем выдает через `yield`.
6. Обрабатывает исключения, возникающие при декодировании JSON.

**Примеры**:

```python
# Пример вызова функции create_completion
model = "gpt-3.5-turbo"
messages = [{"role": "user", "content": "Hello, how are you?"}]
stream = True
kwargs = {"temperature": 0.7, "top_p": 0.9}

result = FastGpt.create_completion(model=model, messages=messages, stream=stream, **kwargs)
for token in result:
    print(token, end="")