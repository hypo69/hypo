# Модуль `hypotez/src/utils/convertors/tts.py`

Этот файл содержит функции для распознавания речи (speech recognition) и синтеза речи (text-to-speech).  Он использует несколько библиотек:

* **`speech_recognition`**: для распознавания речи.
* **`pydub`**: для конвертации аудиоформатов (например, из OGG в WAV).
* **`gTTS`**: для синтеза речи.
* **`requests`**: для загрузки аудиофайлов из интернета.


## Функция `speech_recognizer`

```python
def speech_recognizer(audio_url: str = None, audio_file_path: Path = None, language: str = 'ru-RU') -> str:
```

Эта функция распознаёт речь, содержащуюся в аудиофайле.  Она может принимать URL аудиофайла для загрузки или путь к локальному файлу.

**Аргументы:**

* `audio_url`: URL аудиофайла (строка).
* `audio_file_path`: Путь к локальному аудиофайлу (объект `Path`).
* `language`: Язык распознавания (строка, например, 'ru-RU').

**Возвращаемое значение:**

* Распознанный текст (строка) или сообщение об ошибке (строка).

**Логика:**

1. Если передан `audio_url`, то скачивает аудиофайл в временную папку.
2. Конвертирует аудиофайл из формата OGG в WAV.
3. Использует `speech_recognition` для распознавания речи в WAV файле, используя заданный `language`.
4. Обрабатывает возможные ошибки:
    * `sr.UnknownValueError`: Если Google Speech Recognition не может понять аудио.
    * `sr.RequestError`: Если Google Speech Recognition не может получить результаты.
    * Общие ошибки: Возможные исключения при работе с файлами, интернетом и т.д.

## Функция `text2speech`

```python
async def text2speech(text: str, lang: str = 'ru') -> str:
```

Эта функция преобразует текст в аудиофайл.

**Аргументы:**

* `text`: Текст для преобразования в речь (строка).
* `lang`: Код языка (строка, например, 'ru').

**Возвращаемое значение:**

* Путь к созданному аудиофайлу (строка) или сообщение об ошибке (строка).

**Логика:**

1. Использует `gTTS` для генерации аудио из текста.
2. Сохраняет аудиофайл в временную папку с расширением MP3.
3. Конвертирует аудиофайл из MP3 в WAV.
4. Возвращает путь к созданному WAV-файлу.
5. Обрабатывает ошибки, возникающие при работе с файлами и библиотекми.

**Асинхронность:**

Функция `text2speech` асинхронна (`async def`). Это значит, что она может быть выполнена параллельно с другими задачами.

**Использование `tempfile`:**

Обе функции используют `tempfile` для временных файлов. Это гарантирует, что временные файлы будут автоматически удалены после завершения программы.

**Логирование:**

Функции используют `logger` для записи сообщений об ошибках и успехах в журнал.

**Документация:**

Код содержит подробную документацию (docstrings) для каждой функции, что делает его более читаемым и понятным.  Документация также содержит примеры использования функций.