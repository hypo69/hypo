# Модуль `popup.js`

## Обзор

Этот модуль JavaScript отвечает за создание всплывающего окна расширения Chrome. Он обрабатывает пользовательские запросы, взаимодействует с активной вкладкой и отображает результаты поиска. Модуль предоставляет интерфейс для ввода XPath выражений, выбора контекста и фрейма, а также отображает подробную информацию о найденных элементах.

## Переменные

### `noneClass`

**Описание**: Класс, добавляемый к элементам, чтобы скрыть их.

### `helpClass`

**Описание**: Класс, используемый для элементов справки.

### `invalidTabId`

**Описание**: Значение по умолчанию для `tabId`, обозначающее недействительный идентификатор вкладки.

### `invalidExecutionId`

**Описание**: Значение по умолчанию для `executionId`, обозначающее недействительный идентификатор выполнения.

### `invalidFrameId`

**Описание**: Значение по умолчанию для `frameId`, обозначающее недействительный идентификатор фрейма.


## Функции

### `sendToActiveTab`

**Описание**: Отправляет сообщение в активную вкладку.

**Параметры**:
- `msg` (объект): Сообщение для отправки.
- `opts` (объект, необязательно): Дополнительные параметры. По умолчанию `{}`.

**Возвращает**:
- `Promise`: Обещание, которое разрешается, когда сообщение успешно отправлено.

**Вызывает исключения**:
- Любые исключения, которые могут возникнуть при отправке сообщения.

### `sendToSpecifiedFrame`

**Описание**: Отправляет сообщение в указанный фрейм активной вкладки.

**Параметры**:
- `msg` (объект): Сообщение для отправки.

**Возвращает**:
- `Promise`: Обещание, которое разрешается, когда сообщение успешно отправлено.

**Вызывает исключения**:
- `e`: Любые ошибки, которые могут возникнуть при взаимодействии с фреймом.


### `collectPopupState`

**Описание**: Сбор текущего состояния всплывающего окна.

**Параметры**: Нет

**Возвращает**:
- `объект`: Объект, содержащий текущее состояние всплывающего окна.


### `changeContextVisible`

**Описание**: Изменяет видимость контекста в зависимости от значения флажка.

**Параметры**: Нет

**Возвращает**:
- `void`


### `changeResolverVisible`, `changeFrameIdVisible`, `changeFrameDesignationVisible`, `changeHelpVisible`

**Описание**:  Аналогичные функции для управления видимостью различных разделов.


### `makeExecuteMessage`

**Описание**: Формирует сообщение для выполнения XPath запроса.

**Параметры**: Нет

**Возвращает**:
- `объект`: Объект, содержащий данные для запроса.

### `getSpecifiedFrameId`

**Описание**: Возвращает идентификатор фрейма, выбранный пользователем.

**Параметры**: Нет

**Возвращает**:
- `number`: Идентификатор фрейма.


### `execContentScript`

**Описание**: Выполняет скрипты в контенте текущей вкладки.

**Параметры**: Нет

**Возвращает**:
- `Promise`: Обещание, которое разрешается, когда скрипты выполнены.

**Вызывает исключения**:
- Любые исключения, которые могут возникнуть при выполнении скриптов.


### `sendExecute`

**Описание**: Отправляет запрос на выполнение XPath.


### `handleExprEnter`

**Описание**: Обработчик события нажатия Enter для поля ввода XPath.

**Параметры**:
- `event` (событие): Событие нажатия Enter.


### `showDetailsPage`

**Описание**: Отображает страницу с результатами.

**Параметры**:
- `index` (число): Номер страницы.

**Возвращает**:
- `void`

**Вызывает исключения**:
- `fu.onError`: Обработка ошибок


### `showError`

**Описание**: Отображает сообщение об ошибке.


### `genericListener`

**Описание**: Общий обработчик сообщений из контента страницы.

**Параметры**:
- `message` (объект): Сообщение.
- `sender` (объект): Отправитель сообщения.
- `sendResponse` (функция): Функция для отправки ответа.


**Вызывает исключения**:
- Любые исключения, вызываемые обработчиками внутри `genericListener.listeners`.


**Примечание**: Функции `genericListener.listeners.*` - обработчики конкретных событий, например, `showResultsInPopup` для обработки результатов XPath.  Их реализация требует отдельного документирования.


## Обработчики событий

... (Вставьте документацию для обработчиков событий, например, `showResultsInPopup`, `restorePopupState`, и т.д., в формате, соответствующем требованиям.)


```