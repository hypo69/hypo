# Модуль для работы с G4F OpenAI Chat API через прокси

## Обзор

Этот модуль демонстрирует пример использования библиотеки `g4f` для взаимодействия с OpenAI Chat API через прокси-сервер. Он показывает, как установить прокси, выбрать провайдера и отправить запрос на создание чат-сессии.

## Подробнее

Этот код является примером использования библиотеки `g4f` для создания чат-сессии с использованием OpenAI API через прокси. Он демонстрирует настройку прокси для HTTP и HTTPS соединений, выбор провайдера для работы с OpenAI Chat API и отправку запроса на создание чат-сессии с использованием указанной модели и сообщений. Он особенно полезен в случаях, когда необходимо обходить географические ограничения или использовать прокси для обеспечения анонимности.

## Функции

### `create_chat_completion`

**Назначение**: Создает чат-сессию с использованием OpenAI API через прокси и выводит ответы в потоковом режиме.

```python
response = client.chat.completions.create(model='gpt-3.5-turbo',
                                     messages=messages, 
                                     stream=True)
```

**Параметры**:

- `model` (str): Идентификатор используемой модели (например, 'gpt-3.5-turbo').
- `messages` (List[dict]): Список сообщений для чат-сессии, где каждое сообщение представляет собой словарь с ключами `'role'` и `'content'`.
- `stream` (bool): Указывает, следует ли возвращать ответы в потоковом режиме.

**Возвращает**:

- `Generator[str, None, None]`: Генератор, который возвращает части ответа по мере их поступления от API.

**Как работает функция**:

1. **Инициализация клиента**: Создается экземпляр класса `Client` с настройками прокси и выбранным провайдером.
2. **Создание запроса**: Формируется запрос на создание чат-сессии с указанной моделью и сообщениями.
3. **Отправка запроса**: Запрос отправляется на OpenAI API через библиотеку `g4f`.
4. **Обработка ответа**: Ответ обрабатывается в потоковом режиме, и каждая часть ответа выводится на экран.

**ASCII flowchart**:

```
A[Инициализация клиента] --> B[Создание запроса]
B --> C[Отправка запроса]
C --> D[Обработка ответа]
D --> E[Вывод ответа]
```

Где:

- `A`: Инициализация клиента `g4f.client.Client` с прокси и провайдером.
- `B`: Создание запроса на создание чат-сессии.
- `C`: Отправка запроса на OpenAI API.
- `D`: Обработка ответа от API.
- `E`: Вывод части ответа на экран.

**Примеры**:

```python
from g4f.client   import Client
from g4f.Provider import OpenaiChat, RetryProvider

# Создание клиента с прокси и провайдером
client = Client(
    proxies = {
        'http': 'http://username:password@host:port', # MUST BE WORKING OPENAI COUNTRY PROXY ex: USA
        'https': 'http://username:password@host:port' # MUST BE WORKING OPENAI COUNTRY PROXY ex: USA
    },
    provider = RetryProvider([OpenaiChat],
                             single_provider_retry=True, max_retries=5)
)

# Список сообщений для чат-сессии
messages = [
    {'role': 'user', 'content': 'Hello'}
]

# Создание чат-сессии и вывод ответов в потоковом режиме
response = client.chat.completions.create(model='gpt-3.5-turbo',
                                     messages=messages, 
                                     stream=True)

for message in response:
    print(message.choices[0].delta.content or "")