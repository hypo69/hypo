# Модуль `suppliers`

## Обзор

Этот модуль предоставляет базовый класс `Supplier` и список реализованных поставщиков данных (например, `aliexpress`, `amazon`). Класс `Supplier` служит основой для взаимодействия с различными поставщиками, обеспечивая стандартизированный набор операций для получения данных с веб-сайтов, документов, баз данных и т.д.  Каждый поставщик имеет уникальный префикс, определяющий его тип.  Модуль управляет инициализацией, конфигурацией, аутентификацией и выполнением рабочих процессов для различных источников данных, таких как `amazon.com`, `walmart.com`, `mouser.com` и `digikey.com`. Клиенты также могут определить дополнительных поставщиков.


## Классы

### `Supplier`

**Описание**: Базовый класс для всех поставщиков. Представляет собой провайдера информации. Поставщик может быть производителем товаров, данных или информации. Источниками данных могут быть стартовая страница сайта, документ, база данных или таблица. Этот класс объединяет различных поставщиков под стандартизованный набор операций. Каждый поставщик имеет уникальный префикс. ([Подробности о префиксах](prefixes.md))


**Атрибуты**:

- `supplier_id` (int): Уникальный идентификатор поставщика.
- `supplier_prefix` (str): Префикс поставщика, например, `'amazon'`, `'aliexpress'`.
- `supplier_settings` (dict): Настройки поставщика, загруженные из файла JSON.
- `locale` (str): Код локализации (по умолчанию: `'en'`).
- `price_rule` (str): Правила для расчета цены (например, правила НДС).
- `related_modules` (module): Модули для вспомогательных операций для конкретного поставщика.
- `scenario_files` (list): Список файлов сценариев, которые необходимо выполнить.
- `current_scenario` (dict): Сценарий, который выполняется в данный момент.
- `login_data` (dict): Данные для аутентификации.
- `locators` (dict): Словарь локаторов веб-элементов.
- `driver` (Driver): Экземпляр WebDriver для взаимодействия с веб-сайтом поставщика.
- `parsing_method` (str): Метод разбора данных (например, `'webdriver'`, `'api'`, `'xls'`, `'csv'`).


**Методы**:

#### `__init__`

**Конструктор класса `Supplier`.**

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs):
    """Инициализирует экземпляр Supplier.

    Args:
        supplier_prefix (str): Префикс поставщика.
        locale (str, optional): Код локализации. По умолчанию 'en'.
        webdriver (str | Driver | bool, optional): Тип WebDriver. По умолчанию 'default'.

    Raises:
        DefaultSettingsException: Если настройки по умолчанию не настроены должным образом.
    """
```

#### `_payload`

**Загружает настройки поставщика и инициализирует WebDriver.**

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
    """Загружает настройки, локаторы и инициализирует WebDriver.

    Args:
        webdriver (str | Driver | bool): Тип WebDriver.

    Returns:
        bool: Возвращает True, если загрузка прошла успешно.
    """
```

#### `login`

**Обрабатывает аутентификацию на веб-сайте поставщика.**

```python
def login(self) -> bool:
    """Авторизует пользователя на веб-сайте поставщика.

    Returns:
        bool: Возвращает True, если вход был успешным.
    """
```

#### `run_scenario_files`

**Выполняет один или несколько файлов сценариев.**

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool:
    """Выполняет предоставленные файлы сценариев.

    Args:
        scenario_files (str | List[str], optional): Список или путь к файлам сценариев.

    Returns:
        bool: Возвращает True, если сценарии были успешно выполнены.
    """
```

#### `run_scenarios`

**Выполняет указанные сценарии.**

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool:
    """Выполняет указанные сценарии.

    Args:
        scenarios (dict | list[dict]): Сценарии для выполнения.

    Returns:
        bool: Возвращает True, если все сценарии были выполнены успешно.
    """
```


## Список реализованных поставщиков:


[aliexpress](aliexpress)  - Реализован с двумя рабочими процессами: `webdriver` и `api`
[amazon](amazon) - `webdriver`
[bangood](bangood)  - `webdriver`
... (и другие)


## Как это работает

1. **Инициализация**: Метод `__init__` настраивает префикс поставщика, локализацию и WebDriver.
2. **Загрузка настроек**: `_payload` загружает конфигурацию, инициализирует локаторы и WebDriver.
3. **Аутентификация**: `login` выполняет вход на веб-сайт поставщика.
4. **Выполнение сценариев**:  Выполнение сценариев происходит с помощью `run_scenario_files` или `run_scenarios`.


```mermaid
// Диаграмма Mermaid остается без изменений
```