# Анализ кода модуля `ACEDU`

**Качество кода**
8
-  Плюсы
    - Код игры логически понятен и хорошо структурирован, разбит на функции.
    -  Присутствует обработка ошибок ввода ставки.
    -  Используются понятные имена переменных и функций.
    -  Реализована игровая логика Acey Ducey, включая проверку диапазона карт.
    -  Есть вывод текущего баланса и сообщений о победе и проигрыше.
-  Минусы
    - Отсутствует документация в формате reStructuredText (RST) для функций, что затрудняет понимание их работы.
    - Не используется `logger` для логирования ошибок, только `print` для вывода в консоль.
    - Обработка ошибок ввода ставки происходит через `try-except` и `continue`, что может быть улучшено.
    - Карты имеют числовое представление, и их текстовые названия получаются через функцию `card_name` при выводе на экран. Это усложняет понимание логики игры.
    - Есть дублирование кода, например, при проверке результата.

**Рекомендации по улучшению**
1.  Добавить документацию в формате reStructuredText (RST) для всех функций, включая описания параметров и возвращаемых значений.
2.  Заменить `print` на `logger` для вывода ошибок и отладочной информации.
3.  Улучшить обработку ошибок, отказавшись от `try-except` и `continue` внутри цикла, используя `logger.error`.
4.  Реализовать карты в виде объектов с текстовым и числовым представлением, чтобы упростить логику игры.
5.  Избежать дублирования кода при проверке результата, вынеся общую логику в отдельную функцию.
6.  Привести код в соответствие с другими модулями по именованию переменных и функций.
7.  Добавить проверку, что в колоде есть минимум 3 карты перед началом игры.

**Оптимизированный код**

```python
"""
Модуль реализует игру Acey Ducey.
=========================================================================================

Этот модуль содержит функции для создания колоды карт, вывода карты в читаемом формате,
и основной игровой цикл для игры Acey Ducey.

Пример использования
--------------------

Пример запуска игры:

.. code-block:: python

    if __name__ == "__main__":
        play_acey_ducey()
"""

import random
from typing import List
from src.logger.logger import logger # Добавлен импорт logger


class Card:
    """
    Представляет игральную карту с рангом и именем.
    """
    def __init__(self, rank: int):
        """
        Инициализирует карту.

        :param rank: Числовое значение карты (2-14).
        """
        self.rank = rank
        self.name = self._get_card_name()

    def _get_card_name(self) -> str:
        """
        Возвращает строковое представление карты.

        :return: Строковое имя карты.
        """
        if self.rank == 11:
            return "Валет"
        if self.rank == 12:
            return "Дама"
        if self.rank == 13:
            return "Король"
        if self.rank == 14:
            return "Туз"
        return str(self.rank)

    def __str__(self) -> str:
         """
        Возвращает строковое представление карты.

        :return: Строковое имя карты.
        """
         return self.name
    

def create_deck() -> List[Card]:
    """
    Создает и возвращает перемешанную колоду карт.

    :return: Перемешанная колода карт.
    """
    ranks = list(range(2, 15))  # Карты от 2 до 14 (туз = 14)
    deck = [Card(rank) for rank in ranks for _ in range(4)] # 4 масти
    random.shuffle(deck)
    return deck


def check_win(card1: Card, card2: Card, next_card: Card) -> bool:
    """
    Проверяет, выиграл ли игрок.

    :param card1: Первая карта.
    :param card2: Вторая карта.
    :param next_card: Третья карта.
    :return: True, если игрок выиграл, иначе False.
    """
    low_card = min(card1.rank, card2.rank)
    high_card = max(card1.rank, card2.rank)
    return low_card < next_card.rank < high_card


def play_acey_ducey() -> None:
    """
    Запускает игровой процесс Acey Ducey.
    """
    print("Добро пожаловать в игру Acey Ducey!")
    print("Правила: Делаете ставку, угадывая, будет ли следующая карта между двумя выложенными.")
    print("Если карта равна одной из выложенных или туз, вы проигрываете.")
    print("Удачи!\\n")

    money = 100  # Стартовый капитал игрока
    deck = create_deck()

    if len(deck) < 3: # Проверка на количество карт в колоде
        logger.error("Недостаточно карт в колоде для начала игры.")
        print("Недостаточно карт в колоде для начала игры.")
        return

    while money > 0 and len(deck) >= 3:
        print(f"Ваш текущий баланс: ${money}")
        try: # Используем try-except для отлова ошибок при взятии карт
        # Выкладываем две карты
            card1 = deck.pop()
            card2 = deck.pop()
            # Если карты одинаковые, берем новые
            while card1.rank == card2.rank:
                deck.insert(0, card1)
                deck.insert(0, card2)
                card1 = deck.pop()
                card2 = deck.pop()

            print(f"Первая карта: {card1}")
            print(f"Вторая карта: {card2}")
        except IndexError as ex:
           logger.error('Ошибка при взятии карт',ex)
           print('Ошибка при взятии карт')
           return

        # Делаем ставку
        while True:
            try:
                bet = int(input(f"Сделайте ставку (от 1 до {money}): "))
                if 1 <= bet <= money:
                    break
                print("Неверная ставка. Попробуйте снова.")
            except ValueError:
                print("Пожалуйста, введите число.")


        # Вытягиваем следующую карту
        try:
            next_card = deck.pop()
            print(f"Следующая карта: {next_card}")

        except IndexError as ex:
            logger.error('Ошибка при взятии следующей карты', ex)
            print('Ошибка при взятии следующей карты')
            return

        # Проверяем результат
        if next_card.rank == card1.rank or next_card.rank == card2.rank or next_card.rank == 14:
            print("Вы проиграли!")
            money -= bet
        elif check_win(card1, card2, next_card):
            print("Вы выиграли!")
            money += bet
        else:
            print("Вы проиграли!")
            money -= bet

        print()

    # Завершение игры
    if money <= 0:
        print("У вас закончились деньги. Игра окончена.")
    else:
        print(f"Игра окончена. Ваш итоговый баланс: ${money}")

# Запуск игры
if __name__ == "__main__":
    play_acey_ducey()

```