# Модуль hypotez/src/utils/smtp.py

## Обзор

Этот модуль предоставляет функции для отправки и получения электронных писем с использованием SMTP и IMAP серверов. Он включает функции для отправки писем с помощью SMTP и получения писем с помощью IMAP.  Обратите внимание на важность использования переменных окружения для хранения учетных данных.

## Функции

### `send`

**Описание**: Отправляет электронное письмо. Возвращает `True` при успехе, `False` в противном случае. Логирует ошибки.

**Параметры**:

- `subject` (str, по умолчанию ''): Тема письма.
- `body` (str, по умолчанию ''): Тело письма.
- `to` (str, по умолчанию 'one.last.bit@gmail.com'): Адрес получателя.

**Возвращает**:

- bool: `True`, если письмо отправлено успешно, `False` в противном случае.

**Вызывает исключения**:

- Любые исключения, возникающие во время взаимодействия с SMTP сервером (например, `smtplib.SMTPException`). Ошибка логируется с подробными данными.


### `receive`

**Описание**: Получает электронные письма. Возвращает список словарей с информацией о письмах, если успешно, `None` в противном случае. Логирует ошибки.

**Параметры**:

- `imap_server` (str): Сервер IMAP.
- `user` (str): Пользовательское имя для входа в IMAP.
- `password` (str): Пароль для входа в IMAP.
- `folder` (str, по умолчанию 'inbox'): Папка, из которой извлекаются письма.

**Возвращает**:

- Optional[List[Dict[str, str]]]: Список словарей, содержащих информацию о письмах (например, тема, от кого, тело), если успешно, `None` в противном случае.

**Вызывает исключения**:

- Любые исключения, возникающие во время взаимодействия с IMAP сервером (например, `imaplib.IMAP4.error`). Ошибка логируется с подробными данными.


## Конфигурация

В модуле используется словарь `_connection` для хранения параметров соединения с SMTP сервером. **Важно**:  **не** храните учетные данные напрямую в коде. Используйте переменные окружения (например, `os.environ`) для безопасного хранения данных авторизации.

```
_connection = {
    'server': os.environ.get('SMTP_SERVER', 'smtp.example.com'),
    'port': int(os.environ.get('SMTP_PORT', 587)),
    'user': os.environ.get('SMTP_USER'),
    'password': os.environ.get('SMTP_PASSWORD'),
    'receiver': os.environ.get('SMTP_RECEIVER', 'one.last.bit@gmail.com')
}
```

**Важно**: Обратите внимание на использование `os.environ` для безопасного хранения паролей.  Избегайте их хранения в коде.  Этот метод помогает защитить данные авторизации.
```