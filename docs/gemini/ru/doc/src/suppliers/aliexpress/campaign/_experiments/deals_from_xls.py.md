# Модуль deals_from_xls.py

## Обзор

Модуль предназначен для парсинга XLS-таблиц, сгенерированных в личном кабинете портала AliExpress.

## Подробней

Этот модуль извлекает информацию о сделках из XLS-файла, который, вероятно, был экспортирован из личного кабинета AliExpress. Он использует класс `DealsFromXLS` для обработки данных и последующего представления их в удобном для чтения формате. Модуль инициализирует парсер сделок, указывает язык и валюту, а затем итерируется по сделкам, выводя каждую сделку с помощью функции `pprint`.

## Функции

### `deals_parser`

```python
deals_parser = DealsFromXLS(language='EN', currency='USD')
```

**Назначение**: Создание экземпляра парсера сделок `DealsFromXLS` с указанием языка (английский) и валюты (доллар США).

**Параметры**:
- `language` (str): Язык, используемый в таблице (в данном случае 'EN' для английского).
- `currency` (str): Валюта, используемая в таблице (в данном случае 'USD' для доллара США).

**Возвращает**:
- Объект `DealsFromXLS`, готовый к обработке XLS-файла.

**Как работает**:
1. Создается экземпляр класса `DealsFromXLS` с указанными параметрами языка и валюты.
2. Этот экземпляр будет использоваться для парсинга данных из XLS-файла и представления их в виде объектов сделок.

**Примеры**:

```python
deals_parser = DealsFromXLS(language='EN', currency='USD')
deals_parser = DealsFromXLS(language='RU', currency='RUB')
```

### `deals_parser.get_next_deal()`

```python
for deal in deals_parser.get_next_deal():
    pprint(deal)
```

**Назначение**: Итерирование по сделкам, полученным из XLS-файла, и вывод каждой сделки.

**Параметры**:
- Отсутствуют. Функция `get_next_deal` является генератором и возвращает следующую сделку при каждой итерации.

**Возвращает**:
- Каждая итерация возвращает словарь, представляющий собой одну сделку.

**Как работает**:
1. Вызывается метод `get_next_deal()` объекта `deals_parser`, который является генератором.
2. В цикле `for` каждая полученная сделка (словарь) передается функции `pprint` для вывода.

**Примеры**:

```python
deals_parser = DealsFromXLS(language='EN', currency='USD')
for deal in deals_parser.get_next_deal():
    pprint(deal)
```

### ASCII flowchart функции `deals_parser.get_next_deal()`:
```
A [Инициализация DealsFromXLS]
|
B [Вызов get_next_deal()]
|
C [Получение следующей сделки]
|
D [Вывод сделки через pprint()]
```

Где:
- A: Инициализация объекта `DealsFromXLS` с указанием языка и валюты.
- B: Вызов метода `get_next_deal()` для получения следующей сделки из XLS-файла.
- C: Получение данных сделки в формате словаря.
- D: Вывод информации о сделке с использованием функции `pprint`.

### `pprint(deal)`

```python
from src.utils.printer import pprint
for deal in deals_parser.get_next_deal():
    pprint(deal)
```

**Назначение**: Вывод информации о сделке в удобном для чтения формате.

**Параметры**:
- `deal` (dict): Словарь, содержащий информацию о сделке.

**Возвращает**:
- Ничего. Функция выполняет вывод данных в консоль.

**Как работает**:
1. Функция `pprint` принимает словарь `deal` в качестве аргумента.
2. Выводит содержимое словаря в консоль в отформатированном виде.

**Примеры**:

```python
from src.utils.printer import pprint
deal = {'name': 'Example Deal', 'price': 10.00, 'quantity': 100}
pprint(deal)