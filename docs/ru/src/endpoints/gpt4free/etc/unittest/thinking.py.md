# –ú–æ–¥—É–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ThinkingProcessor
========================================

–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫–ª–∞—Å—Å–∞ `ThinkingProcessor`, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –º–∞—Ä–∫–µ—Ä—ã –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π (`<think>` –∏ `</think>`).
–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –≤–∫–ª—é—á–∞—è –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç, –Ω–∞—á–∞–ª–æ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π, –æ–∫–æ–Ω—á–∞–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π, –∞ —Ç–∞–∫–∂–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –º–∞—Ä–∫–µ—Ä—ã —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö —Ç–µ–∫—Å—Ç–∞.

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–û–±–∑–æ—Ä)
- [–ö–ª–∞—Å—Å—ã](#–ö–ª–∞—Å—Å—ã)
    - [TestThinkingProcessor](#TestThinkingProcessor)
        - [–ú–µ—Ç–æ–¥—ã](#–ú–µ—Ç–æ–¥—ã)
            - [test_non_thinking_chunk](#test_non_thinking_chunk)
            - [test_thinking_start](#test_thinking_start)
            - [test_thinking_end](#test_thinking_end)
            - [test_thinking_start_and_end](#test_thinking_start_and_end)
            - [test_ongoing_thinking](#test_ongoing_thinking)
            - [test_chunk_with_text_after_think](#test_chunk_with_text_after_think)

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `thinking.py` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `unittest` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –∫–ª–∞—Å—Å–∞ `ThinkingProcessor`.
–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –≤–∞–∂–µ–Ω –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª—è—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ —Å–æ–±–æ–π —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –∏–ª–∏ –º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã.

## –ö–ª–∞—Å—Å—ã

### `TestThinkingProcessor`

**–û–ø–∏—Å–∞–Ω–∏–µ**:
–ö–ª–∞—Å—Å `TestThinkingProcessor` –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `unittest.TestCase` –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∞ `ThinkingProcessor`.

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã**:
–ö–ª–∞—Å—Å `TestThinkingProcessor` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞ –∫–ª–∞—Å—Å–æ–º `ThinkingProcessor`.
–ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ —Å–æ–∑–¥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É.
–¢–µ—Å—Ç—ã –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π, –Ω–∞—á–∞–ª–æ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π, –æ–∫–æ–Ω—á–∞–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —ç—Ç–∏—Ö —Å–ª—É—á–∞–µ–≤.

#### –ú–µ—Ç–æ–¥—ã

- `test_non_thinking_chunk`
```python
    def test_non_thinking_chunk(self):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
        
        Args:
            self: –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TestThinkingProcessor.
        """
        ...
```
    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä–æ–≤ `<think>` –∏ `</think>`, —Ñ—É–Ω–∫—Ü–∏—è `process_thinking_chunk` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

    **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**:
    1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ `chunk`, –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
    2. –ó–∞–¥–∞—é—Ç—Å—è –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `expected_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `expected_result`.
    3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `ThinkingProcessor.process_thinking_chunk` —Å –≤—Ö–æ–¥–Ω—ã–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º.
    4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `actual_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `actual_result` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
    5. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `self.assertEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    **–ü—Ä–∏–º–µ—Ä—ã**:
    ```python
    chunk = "This is a regular text."
    expected_time, expected_result = 0, [chunk]
    actual_time, actual_result = ThinkingProcessor.process_thinking_chunk(chunk)
    self.assertEqual(actual_time, expected_time)
    self.assertEqual(actual_result, expected_result)
    ```

- `test_thinking_start`
```python
    def test_thinking_start(self):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π (<think>).
        
        Args:
            self: –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TestThinkingProcessor.
        """
        ...
```

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `<think>`, —Ñ—É–Ω–∫—Ü–∏—è `process_thinking_chunk` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç –Ω–∞—á–∞–ª–æ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ–±—ä–µ–∫—Ç `Reasoning` –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

    **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**:
    1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ `chunk`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `<think>`.
    2. –ó–∞–¥–∞—é—Ç—Å—è –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `expected_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `expected_result`, –≤–∫–ª—é—á–∞—è –æ–±—ä–µ–∫—Ç `Reasoning` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º.
    3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `ThinkingProcessor.process_thinking_chunk` —Å –≤—Ö–æ–¥–Ω—ã–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º.
    4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `actual_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `actual_result` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
    5. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `self.assertAlmostEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∞ —Ç–∞–∫–∂–µ `self.assertEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

    **–ü—Ä–∏–º–µ—Ä—ã**:
    ```python
    chunk = "Hello <think>World"
    expected_time = time.time()
    expected_result = ["Hello ", Reasoning(status="ü§î Is thinking...", is_thinking="<think>"), Reasoning("World")]
    actual_time, actual_result = ThinkingProcessor.process_thinking_chunk(chunk)
    self.assertAlmostEqual(actual_time, expected_time, delta=1)
    self.assertEqual(actual_result[0], expected_result[0])
    self.assertEqual(actual_result[1], expected_result[1])
    self.assertEqual(actual_result[2], expected_result[2])
    ```

- `test_thinking_end`
```python
    def test_thinking_end(self):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π (</think>).
        
        Args:
            self: –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TestThinkingProcessor.
        """
        ...
```
    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `</think>`, —Ñ—É–Ω–∫—Ü–∏—è `process_thinking_chunk` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç –æ–∫–æ–Ω—á–∞–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ–±—ä–µ–∫—Ç `Reasoning` –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

    **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**:
    1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ `chunk`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–∞—Ä–∫–µ—Ä –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `</think>`.
    2. –ó–∞–¥–∞—é—Ç—Å—è –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `expected_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `expected_result`, –≤–∫–ª—é—á–∞—è –æ–±—ä–µ–∫—Ç `Reasoning` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º.
    3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `ThinkingProcessor.process_thinking_chunk` —Å –≤—Ö–æ–¥–Ω—ã–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `start_time`.
    4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `actual_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `actual_result` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
    5. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `self.assertEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    **–ü—Ä–∏–º–µ—Ä—ã**:
    ```python
    start_time = time.time()
    chunk = "token</think> content after"
    expected_result = [Reasoning("token"), Reasoning(status="Finished", is_thinking="</think>"), " content after"]
    actual_time, actual_result = ThinkingProcessor.process_thinking_chunk(chunk, start_time)
    self.assertEqual(actual_time, 0)
    self.assertEqual(actual_result[0], expected_result[0])
    self.assertEqual(actual_result[1], expected_result[1])
    self.assertEqual(actual_result[2], expected_result[2])
    ```

- `test_thinking_start_and_end`
```python
    def test_thinking_start_and_end(self):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –∫–∞–∫ –º–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞, —Ç–∞–∫ –∏ –º–∞—Ä–∫–µ—Ä –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π (<think> –∏ </think>).
        
        Args:
            self: –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TestThinkingProcessor.
        """
        ...
```

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –∫–∞–∫ –º–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞ `<think>`, —Ç–∞–∫ –∏ –º–∞—Ä–∫–µ—Ä –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `</think>`, —Ñ—É–Ω–∫—Ü–∏—è `process_thinking_chunk` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç –æ–±–∞ –º–∞—Ä–∫–µ—Ä–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–±—ä–µ–∫—Ç—ã `Reasoning` –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

    **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**:
    1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ `chunk`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–∞—Ä–∫–µ—Ä—ã –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `<think>` –∏ `</think>`.
    2. –ó–∞–¥–∞—é—Ç—Å—è –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `expected_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `expected_result`, –≤–∫–ª—é—á–∞—è –æ–±—ä–µ–∫—Ç—ã `Reasoning` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏.
    3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `ThinkingProcessor.process_thinking_chunk` —Å –≤—Ö–æ–¥–Ω—ã–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `start_time`.
    4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `actual_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `actual_result` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
    5. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `self.assertEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    **–ü—Ä–∏–º–µ—Ä—ã**:
    ```python
    start_time = time.time()
    chunk = "<think>token</think> content after"
    expected_result = [Reasoning(status="ü§î Is thinking...", is_thinking="<think>"), Reasoning("token"), Reasoning(status="Finished", is_thinking="</think>"), " content after"]
    actual_time, actual_result = ThinkingProcessor.process_thinking_chunk(chunk, start_time)
    self.assertEqual(actual_time, 0)
    self.assertEqual(actual_result[0], expected_result[0])
    self.assertEqual(actual_result[1], expected_result[1])
    self.assertEqual(actual_result[2], expected_result[2])
    self.assertEqual(actual_result[3], expected_result[3])
    ```

- `test_ongoing_thinking`
```python
    def test_ongoing_thinking(self):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–≥–æ —Å–æ–±–æ–π –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
        
        Args:
            self: –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TestThinkingProcessor.
        """
        ...
```

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–≥–æ —Å–æ–±–æ–π –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π, —Ñ—É–Ω–∫—Ü–∏—è `process_thinking_chunk` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç `Reasoning` —Å —Ç–µ–∫—Å—Ç–æ–º –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

    **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**:
    1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ `chunk`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ–±–æ–π –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
    2. –ó–∞–¥–∞—é—Ç—Å—è –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `expected_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `expected_result`, –≤–∫–ª—é—á–∞—è –æ–±—ä–µ–∫—Ç `Reasoning` —Å —Ç–µ–∫—Å—Ç–æ–º –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π.
    3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `ThinkingProcessor.process_thinking_chunk` —Å –≤—Ö–æ–¥–Ω—ã–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º –Ω–∞—á–∞–ª–∞ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `start_time`.
    4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `actual_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `actual_result` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
    5. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `self.assertEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    **–ü—Ä–∏–º–µ—Ä—ã**:
    ```python
    start_time = time.time()
    chunk = "Still thinking..."
    expected_result = [Reasoning("Still thinking...")]
    actual_time, actual_result = ThinkingProcessor.process_thinking_chunk(chunk, start_time)
    self.assertEqual(actual_time, start_time)
    self.assertEqual(actual_result, expected_result)
    ```

- `test_chunk_with_text_after_think`
```python
    def test_chunk_with_text_after_think(self):
        """
        –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —Ç–µ–∫—Å—Ç –¥–æ, –º–µ–∂–¥—É –∏ –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π (<think> –∏ </think>).
        
        Args:
            self: –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ TestThinkingProcessor.
        """
        ...
```

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —Ç–µ–∫—Å—Ç –¥–æ, –º–µ–∂–¥—É –∏ –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `<think>` –∏ `</think>`, —Ñ—É–Ω–∫—Ü–∏—è `process_thinking_chunk` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç –≤—Å–µ —á–∞—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ–±—ä–µ–∫—Ç—ã `Reasoning` –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –º–µ–∂–¥—É –º–∞—Ä–∫–µ—Ä–∞–º–∏.

    **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è**:
    1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤—Ö–æ–¥–Ω–æ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ `chunk`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–µ–∫—Å—Ç –¥–æ, –º–µ–∂–¥—É –∏ –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π `<think>` –∏ `</think>`.
    2. –ó–∞–¥–∞—é—Ç—Å—è –æ–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `expected_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `expected_result`, –≤–∫–ª—é—á–∞—è –æ–±—ä–µ–∫—Ç—ã `Reasoning` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –º–µ–∂–¥—É –º–∞—Ä–∫–µ—Ä–∞–º–∏.
    3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `ThinkingProcessor.process_thinking_chunk` —Å –≤—Ö–æ–¥–Ω—ã–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º.
    4. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ `actual_time` –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `actual_result` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
    5. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥—ã `self.assertEqual` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

    **–ü—Ä–∏–º–µ—Ä—ã**:
    ```python
    chunk = "Start <think>Middle</think>End"
    expected_time = 0
    expected_result = ["Start ", Reasoning(status="ü§î Is thinking...", is_thinking="<think>"), Reasoning("Middle"), Reasoning(status="Finished", is_thinking="</think>"), "End"]
    actual_time, actual_result = ThinkingProcessor.process_thinking_chunk(chunk)
    self.assertEqual(actual_time, expected_time)
    self.assertEqual(actual_result, expected_result)
    ```