# Модуль `hypotez/src/gui/context_menu/tkinter/main.py`

## Обзор

Модуль `hypotez/src/gui/context_menu/tkinter/main.py` предоставляет интерфейс для добавления или удаления пункта контекстного меню (с именем "hypo AI assistant") в Windows Explorer для фонового пространства папок и рабочего стола.  Он использует Windows Registry для изменения контекстного меню.

## Описание функций

### `add_context_menu_item()`

**Описание**: Добавляет пункт контекстного меню в Windows Explorer. Создаёт запись в реестре, которая добавляет пункт "hypo AI assistant" в контекстное меню при нажатии правой кнопкой мыши на пустом пространстве папок или рабочего стола.

**Подробности**:
- Создаёт ключ в реестре `HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\hypo_AI_assistant`.
- Создаёт подключ `HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\hypo_AI_assistant\\command`.
- Устанавливает команду для запуска Python-скрипта при выборе пункта меню.  Путь к скрипту определяется из `gs.path.src / 'gui' / 'context_menu' / 'main.py'`.
- Проверяет существование файла скрипта. Если файла нет, выводит сообщение об ошибке и возвращает.
- В случае успеха выводит сообщение об успешном добавлении пункта.
- Обрабатывает любые исключения при работе с реестром и выводит сообщение об ошибке пользователю.


**Возвращает**:
- Ничего не возвращает.

**Вызывает исключения**:
- `FileNotFoundError`: Возникает, если указанный Python-скрипт не найден по указанному пути.
- Любые исключения, связанные с доступом к реестру.


### `remove_context_menu_item()`

**Описание**: Удаляет пункт контекстного меню "hypo AI assistant" из Windows Explorer.

**Подробности**:
- Удаляет ключ реестра `HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\hypo_AI_assistant`.
- В случае успеха выводит сообщение об успешном удалении пункта.
- Обрабатывает исключения, связанные с отсутствием пункта в реестре (`FileNotFoundError`) и другими ошибками при работе с реестром.  Выводит соответствующие сообщения пользователю.


**Возвращает**:
- Ничего не возвращает.

**Вызывает исключения**:
- `FileNotFoundError`: Возникает, если пункт меню не найден в реестре.
- Любые исключения, связанные с доступом к реестру.


### `create_gui()`

**Описание**: Создаёт графический интерфейс пользователя (GUI) для управления контекстным меню.

**Подробности**:
- Создаёт окно Tkinter с кнопками для добавления, удаления и выхода.
- Кнопки вызывают соответствующие функции `add_context_menu_item()` и `remove_context_menu_item()`.
- Запускает главный цикл Tkinter для отображения и обработки событий GUI.


**Возвращает**:
- Ничего не возвращает.

**Вызывает исключения**:
- Нет.


## Модули

- `winreg`: Модуль для взаимодействия с реестром Windows.
- `os`: Модуль для работы с файлами и операционной системой.
- `tkinter`: Модуль для создания графического интерфейса пользователя.
- `messagebox`: Подмодуль `tkinter` для отображения сообщений.
- `header`: Дополнительный модуль (предполагается, что он инициализирует настройки или константы).
- `src`: Дополнительный модуль (предполагается, что он содержит пути к файлам или структуру проекта).
- `gs`: Дополнительный модуль (вероятно, содержит настройки путей или структуру проекта).


## Константы

- `MODE`: Строковая константа, вероятно, определяющая режим работы (например, 'dev').


## Замечания

- Модуль использует абсолютный путь для скрипта, который может быть не оптимальным в  различных средах.  Рекомендуется использовать относительный путь или переменные среды.
- В коде присутствуют комментарии, описывающие действия и пути к реестру, что улучшает читаемость и понимание функциональности.
- Обработка исключений улучшает устойчивость приложения.