# Модуль `Aichat.py`

## Обзор

Модуль предоставляет класс `Aichat`, который является асинхронным провайдером для взаимодействия с моделью чат-бота на основе `chat-gpt.org`. Он поддерживает модель `gpt-3.5-turbo` и требует наличия cookies для работы.

## Подробнее

Этот модуль предназначен для асинхронного взаимодействия с сервисом `chat-gpt.org` с целью получения текстовых ответов на основе предоставленных сообщений. Он использует библиотеку `requests` для выполнения HTTP-запросов и управляет cookies для аутентификации.

## Классы

### `Aichat`

**Описание**: Класс `Aichat` является асинхронным провайдером для взаимодействия с `chat-gpt.org`.

**Наследует**:
- `AsyncProvider`: Асинхронный базовый класс провайдера.

**Аттрибуты**:
- `url` (str): URL-адрес сервиса `chat-gpt.org`.
- `working` (bool): Флаг, указывающий на работоспособность провайдера (по умолчанию `False`).
- `supports_gpt_35_turbo` (bool): Флаг, указывающий на поддержку модели `gpt-3.5-turbo` (по умолчанию `True`).

### `create_async`

```python
    @staticmethod
    async def create_async(
        model: str,
        messages: Messages,
        proxy: str = None, **kwargs) -> str:
        """Асинхронно создает текстовый ответ от модели чат-бота.

        Args:
            model (str): Идентификатор модели для использования.
            messages (Messages): Список сообщений для отправки в чат-бот.
            proxy (str, optional): Адрес прокси-сервера для использования. По умолчанию `None`.
            **kwargs: Дополнительные именованные аргументы.

        Returns:
            str: Текстовый ответ от модели чат-бота.

        Raises:
            RuntimeError: Если не удалось получить cookies для `chat-gpt.org`.
            Exception: Если получен ошибочный ответ от сервера.

        Как работает функция:
         1. Функция пытается получить cookies для домена `chat-gpt.org`. Если cookies не переданы через `kwargs`, используется функция `get_cookies`.
         2. Если cookies не получены, вызывается исключение `RuntimeError`.
         3. Формируются HTTP-заголовки, необходимые для запроса к API.
         4. Создается асинхронная сессия с использованием `StreamSession` с заданными заголовками, cookies, таймаутом и прокси (если указан).
         5. Формируется JSON-данные для отправки в запросе, включая сообщения, температуру, и другие параметры.
         6. Отправляется POST-запрос к API `https://chat-gpt.org/api/text` с использованием асинхронной сессии.
         7. Обрабатывается ответ от сервера, проверяется наличие ошибок и извлекается текстовое сообщение.
         8. Если в ответе отсутствует поле `response` или оно пустое, вызывается исключение `Exception`.
         9. Возвращается текстовое сообщение из ответа.

        Примеры:
         >>> messages = [{"role": "user", "content": "Hello, how are you?"}]
         >>> Aichat.create_async(model="gpt-3.5-turbo", messages=messages)
         "I am doing well, thank you for asking!"
        """
```

**Параметры**:
- `model` (str): Идентификатор модели для использования.
- `messages` (Messages): Список сообщений для отправки в чат-бот.
- `proxy` (str, optional): Адрес прокси-сервера для использования. По умолчанию `None`.
- `**kwargs`: Дополнительные именованные аргументы, такие как cookies, температура (`temperature`), `top_p`.

**Возвращает**:
- `str`: Текстовый ответ от модели чат-бота.

**Вызывает исключения**:
- `RuntimeError`: Если не удалось получить cookies для `chat-gpt.org`.
- `Exception`: Если получен ошибочный ответ от сервера.

**ASCII схема работы функции:**

```
    Получение Cookies
    │
    └─> Проверка наличия Cookies
        │
        ├── Нет Cookies:
        │   │
        │   └──> Выброс RuntimeError
        │
        └── Есть Cookies:
            │
            └─> Формирование HTTP-заголовков
                │
                └─> Создание асинхронной сессии (StreamSession)
                    │
                    └─> Формирование JSON-данных для запроса
                        │
                        └─> Отправка POST-запроса к API
                            │
                            └─> Обработка ответа от сервера
                                │
                                ├── Ошибка в ответе:
                                │   │
                                │   └──> Выброс Exception
                                │
                                └── Успешный ответ:
                                    │
                                    └──> Извлечение текстового сообщения
                                        │
                                        └──> Возврат текстового сообщения
```

**Примеры**:
```python
messages = [{"role": "user", "content": "Hello, how are you?"}]
Aichat.create_async(model="gpt-3.5-turbo", messages=messages)
# "I am doing well, thank you for asking!"
```
```python
messages = [{"role": "user", "content": "Напиши код на Python, который выводит 'Hello, world!'."}]
Aichat.create_async(model="gpt-3.5-turbo", messages=messages)
# "print('Hello, world!')"