# Модуль для генерации OpenAPI спецификации

## Обзор

Модуль предназначен для создания и сохранения OpenAPI спецификации для приложения, использующего библиотеку `g4f`. Спецификация сохраняется в формате JSON в файл `openapi.json`. Это позволяет документировать API приложения и использовать его с различными инструментами, поддерживающими OpenAPI.

## Подробней

Этот код генерирует OpenAPI (ранее Swagger) спецификацию для API, созданного с использованием библиотеки `g4f`. OpenAPI — это стандартный формат для описания RESTful API, который позволяет автоматически генерировать документацию, клиентские библиотеки и серверные заглушки.

Процесс работы:

1.  Импортируются необходимые библиотеки: `json` для работы с JSON и `create_app` из `g4f.api` для создания экземпляра приложения.
2.  Создается экземпляр приложения с помощью `create_app()`.
3.  Вызывается метод `app.openapi()` для получения OpenAPI спецификации в виде словаря Python.
4.  Спецификация преобразуется в JSON-строку с помощью `json.dumps()`.
5.  JSON-строка записывается в файл `openapi.json`.
6.  Выводится сообщение в консоль о размере созданного файла.

## Функции

### `create_app`

**Назначение**: Создание экземпляра приложения g4f.

**Параметры**:

*   Нет.

**Возвращает**:

*   `app`: Экземпляр приложения, для которого будет сгенерирована OpenAPI спецификация.

**Как работает функция**:

1.  Функция `create_app()` вызывается для создания экземпляра приложения.
2.  Этот экземпляр приложения используется для генерации OpenAPI спецификации.

### `app.openapi()`

**Назначение**: Получение OpenAPI спецификации в виде словаря Python.

**Параметры**:

*   Нет.

**Возвращает**:

*   `dict`: Словарь Python, представляющий OpenAPI спецификацию.

**Как работает функция**:

1.  Метод `openapi()` вызывается у экземпляра приложения (`app`).
2.  Метод генерирует словарь Python, содержащий описание API в формате OpenAPI.

### `json.dumps(app.openapi())`

**Назначение**: Преобразование словаря Python в JSON-строку.

**Параметры**:

*   `app.openapi()`: Словарь Python, представляющий OpenAPI спецификацию.

**Возвращает**:

*   `str`: JSON-строка, представляющая OpenAPI спецификацию.

**Как работает функция**:

1.  Функция `json.dumps()` преобразует словарь Python, полученный от `app.openapi()`, в JSON-строку.
2.  JSON-строка записывается в файл `openapi.json`.

### Запись данных в файл `openapi.json`

**Назначение**: Запись JSON-строки в файл `openapi.json`.

**Параметры**:

*   `data`: JSON-строка, представляющая OpenAPI спецификацию.

**Возвращает**:

*   Нет.

**Как работает функция**:

1.  Файл `openapi.json` открывается в режиме записи (`"w"`).
2.  JSON-строка `data` записывается в файл.
3.  Файл закрывается.

### Вывод сообщения о размере файла

**Назначение**: Вывод сообщения о размере созданного файла в консоль.

**Параметры**:

*   `data`: JSON-строка, представляющая OpenAPI спецификацию.

**Возвращает**:

*   Нет.

**Как работает функция**:

1.  Вычисляется размер JSON-строки в байтах с помощью `len(data)`.
2.  Размер делится на 1024, чтобы получить размер в килобайтах.
3.  Размер округляется до двух знаков после запятой с помощью `round(..., 2)`.
4.  Выводится сообщение в консоль с использованием f-строки.

```ascii
Создание приложения
     ↓
Получение OpenAPI спецификации (словарь Python)
     ↓
Преобразование в JSON-строку
     ↓
Запись в файл openapi.json
     ↓
Вывод сообщения о размере файла
```

**Примеры**:

```python
import json
from g4f.api import create_app

app = create_app()

with open("openapi.json", "w") as f:
    data = json.dumps(app.openapi())
    f.write(data)

print(f"openapi.json - {round(len(data)/1024, 2)} kbytes")