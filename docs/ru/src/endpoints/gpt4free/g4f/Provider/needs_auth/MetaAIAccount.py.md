# Модуль MetaAIAccount
## Обзор

Модуль `MetaAIAccount.py` предназначен для реализации взаимодействия с Meta AI с использованием учетной записи пользователя. Он наследует функциональность от базового класса `MetaAI` и предоставляет механизм для создания асинхронного генератора ответов от модели Meta AI, используя cookies для аутентификации.

## Подробней

Этот модуль является частью системы, которая обеспечивает доступ к различным AI-моделям через унифицированный интерфейс. В частности, он специализируется на работе с Meta AI, требующей аутентификации через cookies. Модуль использует cookies, полученные для домена `.meta.ai`, для аутентификации запросов к Meta AI. Это позволяет взаимодействовать с Meta AI от имени пользователя, прошедшего аутентификацию.

## Классы

### `MetaAIAccount`

**Описание**: Класс `MetaAIAccount` предназначен для взаимодействия с Meta AI с использованием учетной записи пользователя. Он наследует функциональность от класса `MetaAI` и добавляет поддержку аутентификации через cookies.

**Наследует**:
- `MetaAI`: Базовый класс для взаимодействия с Meta AI.

**Атрибуты**:
- `needs_auth` (bool): Указывает, требуется ли аутентификация для использования данного провайдера. Всегда `True` для `MetaAIAccount`.
- `parent` (str): Указывает родительский класс, в данном случае `"MetaAI"`.
- `image_models` (List[str]): Список моделей, поддерживаемых для генерации изображений. Содержит `"meta"`.

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для получения ответов от модели Meta AI.

## Функции

### `create_async_generator`

```python
    @classmethod
    async def create_async_generator(
        cls,
        model: str,
        messages: Messages,
        proxy: str = None,
        cookies: Cookies = None,
        **kwargs
    ) -> AsyncResult:
        """ Создает асинхронный генератор для получения ответов от модели Meta AI.

        Args:
            model (str): Имя модели, которую необходимо использовать.
            messages (Messages): Список сообщений для отправки в модель.
            proxy (str, optional): Прокси-сервер для использования при подключении. По умолчанию `None`.
            cookies (Cookies, optional): Cookies для аутентификации. Если `None`, пытается получить cookies для домена `.meta.ai`. По умолчанию `None`.
            **kwargs: Дополнительные аргументы.

        Returns:
            AsyncResult: Асинхронный генератор, возвращающий чанки ответа от модели.

        Как работает функция:
        1. **Получение Cookies**:
           - Если `cookies` не переданы, функция пытается получить их для домена `.meta.ai` с использованием `get_cookies(".meta.ai", True, True)`.
        2. **Создание Генератора**:
           - Создается экземпляр класса `MetaAIAccount` с использованием прокси, если он указан.
        3. **Форматирование Промпта**:
           - Форматируются входные сообщения с помощью `format_prompt(messages)`.
        4. **Генерация Чанков**:
           - Вызывается метод `prompt` экземпляра класса `MetaAIAccount` для получения асинхронного генератора чанков ответа.

        ASCII flowchart:

        Получение Cookies (если необходимо)   Форматирование промпта
        |                                      |
        |                                      |
        V                                      V
        Создание экземпляра MetaAIAccount  -->  Вызов метода prompt
        |                                      |
        |                                      |
        V                                      V
        Асинхронная генерация чанков ответа

        Примеры:
            Пример 1: Использование с предоставленными cookies
            ```python
            cookies = {"cookie1": "value1", "cookie2": "value2"}
            async for chunk in MetaAIAccount.create_async_generator(model="meta", messages=[{"role": "user", "content": "Hello"}], cookies=cookies):
                print(chunk, end="")
            ```

            Пример 2: Использование с автоматическим получением cookies
            ```python
            async for chunk in MetaAIAccount.create_async_generator(model="meta", messages=[{"role": "user", "content": "Hello"}]):
                print(chunk, end="")
            ```
        """