# Модуль hypotez/src/webdriver/executor.py

## Обзор

Модуль `executor` отвечает за выполнение действий с веб-элементами на основе предоставленных конфигураций (локаторов). Локаторы представляют собой словари, содержащие информацию о том, как найти и взаимодействовать с элементами на веб-странице.  Модуль предоставляет следующие функциональности:

* **Парсинг и обработка локаторов**: Преобразует словари локаторов в объекты `SimpleNamespace` для гибкого управления данными локатора.
* **Взаимодействие с веб-элементами**: Выполняет различные действия с веб-элементами: клики, отправку сообщений, выполнение событий, получение атрибутов.
* **Обработка ошибок**: Поддерживает продолжение выполнения при ошибках, позволяя обрабатывать веб-страницы с нестабильными элементами или особыми требованиями.
* **Поддержка множества типов локаторов**: Обрабатывает как одиночные, так и множественные локаторы, позволяя одновременно идентифицировать и взаимодействовать с одним или несколькими веб-элементами.


## Классы

### `ExecuteLocator`

**Описание**: Обработчик локаторов для веб-элементов с использованием Selenium. Хранит драйвер, цепочки действий (ActionChains) и отображение типов локаторов (By.XPATH, By.ID, etc.).

**Атрибуты**:
* `driver`: Драйвер Selenium.
* `actions`: Цепочка действий (ActionChains).
* `by_mapping`: Словарь для отображения типов локаторов.
* `mode`: Режим работы (debug, dev).

**Методы**:

#### `execute_locator`

**Описание**: Выполняет действия с веб-элементом, заданным локатором.

**Параметры**:
* `locator` (dict | SimpleNamespace): Данные локатора. Может быть словарем или объектом `SimpleNamespace`.
* `timeout` (float, необязательно): Таймаут ожидания элемента.
* `timeout_for_event` (str, необязательно): Условие ожидания (например, 'presence_of_element_located', 'element_to_be_clickable').
* `message` (str, необязательно): Сообщение для отправки.
* `typing_speed` (float, необязательно): Скорость ввода для событий send_keys.
* `continue_on_error` (bool, необязательно):  Продолжать выполнение при ошибке.

**Возвращает**:
* str | list | dict | WebElement | bool: Результат выполнения.

**Вызывает исключения**:
* `ValueError`: Если локатор некорректен.
* Исключения Selenium (например, `NoSuchElementException`, `TimeoutException`).



#### `evaluate_locator`

**Описание**: Оценивает и обрабатывает атрибуты локатора.


**Параметры**:
* `attribute` (str | List[str] | dict): Атрибуты для оценки.


**Возвращает**:
* str | List[str] | dict: Оцененные атрибуты.


#### `get_attribute_by_locator`

**Описание**: Получает атрибут(ы) элемента или списка элементов, найденных по данному локатору.


**Параметры**:
* `locator` (dict | SimpleNamespace): Локатор как словарь или `SimpleNamespace`.
* `timeout` (float, необязательно): Максимальное время ожидания появления элемента.
* `timeout_for_event` (str, необязательно): Тип условия ожидания.


**Возвращает**:
* Union[str, list, dict, WebElement | list[WebElement] | None]: Значение атрибута(ов) или словарь с атрибутами.


#### `get_webelement_by_locator`

**Описание**: Извлекает веб-элемент или список элементов по указанному локатору.


**Параметры**:
* `locator` (dict | SimpleNamespace): Локатор.
* `timeout` (float, необязательно): Максимальное время ожидания.
* `timeout_for_event` (str, необязательно): Условие ожидания.


**Возвращает**:
* WebElement | List[WebElement] | None: Найденный элемент или список элементов.


#### `get_webelement_as_screenshot`

**Описание**: Снимает скриншот указанного веб-элемента.


**Параметры**:
* `locator` (dict | SimpleNamespace): Локатор.
* `timeout` (float): Максимальное время ожидания.
* `timeout_for_event` (str): Тип условия ожидания.
* Другие параметры, связанные с взаимодействием с веб-элементом.


**Возвращает**:
* BinaryIO | None: Бинарный поток скриншота или None при ошибке.


#### `execute_event`

**Описание**: Выполняет события, связанные с локатором.


**Параметры**:
* `locator` (dict | SimpleNamespace): Локатор.
* `timeout` (float): Максимальное время ожидания.
* `timeout_for_event` (str): Тип условия ожидания.
* `message` (str, необязательно): Сообщение для отправки.
* `typing_speed` (float, необязательно): Скорость ввода.


**Возвращает**:
* bool: True, если событие выполнено успешно, False иначе.


#### `send_message`

**Описание**: Отправляет сообщение веб-элементу.


**Параметры**:
* `locator` (dict | SimpleNamespace): Локатор элемента.
* `message` (str, необязательно): Сообщение.
* `typing_speed` (float, необязательно): Скорость набора.


**Возвращает**:
* bool: True, если сообщение отправлено успешно, False иначе.


## Функции

(Список функций, если они есть)

##  Примечания

(Список дополнительных заметок, если необходимо)