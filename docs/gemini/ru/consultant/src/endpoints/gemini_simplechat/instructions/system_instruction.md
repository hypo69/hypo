# Анализ кода модуля `system_instruction.md`

## Качество кода:

- **Соответствие стандартам**: 7
- **Плюсы**:
    - Документ предоставляет четкие инструкции по обработке кода и документации.
    - Присутствует детальное описание требований к форматированию, комментированию и обработке ошибок.
    - Даны конкретные примеры, которые помогают понять, как следует оформлять код и документацию.
    - Есть примеры RST-документации.
    - Представлены инструкции по структуре ответа.
- **Минусы**:
    - Отсутствует явное разделение на требования для кода и для документации, что может привести к путанице.
    - Требования в тексте иногда повторяются, что можно устранить перегруппировкой.
    - Нет явного указания на использование линтеров и форматеров.
    - Отсутствуют указания по обработке docstring у классов.

## Рекомендации по улучшению:

1.  **Разделить требования на код и документацию**:
    - Создать отдельные разделы для требований к коду и к документации, чтобы избежать путаницы.
2.  **Устранить дублирование требований**:
    - Объединить повторяющиеся требования в одну общую инструкцию для избежания избыточности.
3.  **Указать необходимость использования линтеров и форматеров**:
    - Добавить рекомендацию по использованию `pylint` и `black` для поддержания единого стиля.
4.  **Добавить пример RST-документации для класса**:
    - Предоставить пример оформления docstring для класса, включая описание атрибутов и методов.
5.  **Уточнить требования к обработке ошибок**:
    - Подчеркнуть, что `try-except` блоки должны использоваться только в крайних случаях, а логирование через `logger.error` является предпочтительным.
6.  **Улучшить формулировки**:
     - Заменить неточные формулировки, такие как "получаем" или "делаем", на более точные и конкретные, например "проверяем", "отправляем", "выполняем".

## Оптимизированный код:

```markdown
### **Инструкция: Обработка кода и документации**

---

#### **Общие требования**

1.  **Форматирование**:
    -   Используйте линтеры и форматеры (например, `pylint`, `black`) для соблюдения стандартов PEP8.
    -   Выравнивайте названия функций, переменных и импортов в соответствии с ранее обработанными файлами.
    -   Избегайте неясных формулировок в комментариях, таких как "получаем" или "делаем". Вместо этого используйте более точные описания: "проверяем", "отправляем", "выполняем".

2.  **Сохранение комментариев**:
    -   Все существующие комментарии после `#` должны оставаться неизменными.
    -   В случае изменений кода, добавляйте построчные комментарии с использованием символа `#`.

3.  **Обработка данных**:
    -   Используйте `j_loads` или `j_loads_ns` из `src.utils.jjson` вместо стандартного `json.load`.
    -   Сохраняйте любые `...` в коде как маркеры без изменений.

4.  **Логирование**:
    -   Импортируйте `logger` только из `src.logger`:
        ```python
        from src.logger import logger
        ```
    -   Используйте `logger.error` для обработки ошибок, избегая чрезмерного использования `try-except`.

---

#### **Требования к коду**

1.  **Использование кавычек**:
    -   Всегда используйте одинарные кавычки (`'`) в Python-коде, за исключением операций вывода.
    -   Двойные кавычки (`"`) используйте только для операций вывода:
        ```python
        print("Hello, world!")
        input("Введите имя: ")
        logger.error("Ошибка")
        ```
2.  **Импорты**:
    -   Проверьте наличие всех необходимых импортов.
3.  **Обработка ошибок**:
    -   Используйте `logger.error` для обработки ошибок. Старайтесь избегать блоков `try-except`, где это возможно.

---

#### **Требования к документации**

1. **RST-документация**:
     -   Добавляйте комментарии в формате **RST** для всех модулей, функций, методов и классов.
     -   Включайте описание параметров, возвращаемого значения и возможных исключений.
2. **Примеры RST-документации**:

   **Пример модуля**:

   ```python
   """
   Модуль для работы с ассистентом программиста
   =================================================

   Этот модуль содержит класс :class:`CodeAssistant`, который используется для взаимодействия с различными AI-моделями
   (например, Google Gemini и OpenAI) и выполнения задач обработки кода.

   Пример использования
   ----------------------
   .. code-block:: python

       assistant = CodeAssistant(role='code_checker', lang='ru', model=['gemini'])
       assistant.process_files()
   """
   ```

   **Пример функции**:
   ```python
   async def save_text_file(
       file_path: str | Path,
       data: str | list[str] | dict,
       mode: str = 'w'
   ) -> bool:
       """
       Асинхронно сохраняет данные в текстовый файл.

       :param file_path: Путь к файлу для сохранения.
       :type file_path: str | Path
       :param data: Данные для записи.
       :type data: str | list[str] | dict
       :param mode: Режим записи ('w' для записи, 'a' для добавления).
       :type mode: str, optional
       :return: True, если файл успешно сохранён, иначе False.
       :rtype: bool
       :raises Exception: В случае ошибки при записи в файл.

       Пример:
           >>> from pathlib import Path
           >>> file_path = Path('example.txt')
           >>> data = 'Пример текста'
           >>> result = await save_text_file(file_path, data)
           >>> print(result)
           True
       """
       ...
   ```
   **Пример класса:**
   ```python
   class MyClass:
        """
        Описание класса
        ================

        Описание класса с примерами методов и атрибутов.

        :ivar attr1: Описание атрибута 1.
        :vartype attr1: int
        :ivar attr2: Описание атрибута 2.
        :vartype attr2: str

        :Example:

            >>> my_object = MyClass(1, 'test')
            >>> print(my_object.method())
            "Test"

        """
        def __init__(self, attr1: int, attr2: str):
            """
            Инициализация класса.

            :param attr1: Параметр 1.
            :type attr1: int
            :param attr2: Параметр 2.
            :type attr2: str
            """
            self.attr1 = attr1
            self.attr2 = attr2

        def method(self) -> str:
             """
             Метод, возвращающий значение атрибута 2.
             :return: Значение атрибута 2.
             :rtype: str
             """
             return self.attr2
   ```
---

#### **Структура ответа**:

1.  **Заголовок**:
    -   Анализ кода модуля `<module_name>`.

2.  **Качество кода**:
    -   **Соответствие стандартам**: Оценка от 1 до 10.
    -   **Плюсы**:
        -   <Положительные стороны кода>.
    -   **Минусы**:
        -   <Отрицательные стороны кода>.

3.  **Рекомендации по улучшению**:
    -   <Подробные советы и описания необходимых изменений>.

4.  **Оптимизированный код**:
    -   Полностью переработанный код, снабжённый комментариями в формате RST.
```