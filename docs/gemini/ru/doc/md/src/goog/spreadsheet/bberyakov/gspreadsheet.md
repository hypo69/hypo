# Модуль gspreadsheet.py

## Обзор

Модуль `gspreadsheet.py` предоставляет класс `GSpreadsheet` для работы с Google Spreadsheets.  Он наследуется от класса `Spreadsheet` из модуля `global_settingspread`.  Класс позволяет получать доступ к таблицам, создавать новые таблицы и работать с существующими, используя учетные данные service account.

## Оглавление

- [Модуль gspreadsheet.py](#модуль-gspreadsheetpy)
- [Обзор](#обзор)
- [Классы](#классы)
    - [Класс `GSpreadsheet`](#класс-gspreadsheet)
        - [Метод `__init__`](#метод-init)
        - [Метод `get_project_spreadsheets_dict`](#метод-get_project_spreadsheets_dict)
        - [Метод `get_by_title`](#метод-get_by_title)
        - [Метод `get_by_id`](#метод-get_by_id)
        - [Метод `get_all_spreadsheets_for_current_account`](#метод-get_all_spreadsheets_for_current_account)


## Классы

### Класс `GSpreadsheet`

**Описание**: Класс `GSpreadsheet` представляет собой интерфейс для работы с Google Spreadsheets. Он предоставляет методы для получения, создания и работы с таблицами.

**Наследование**: `Spreadsheet`

**Атрибуты**:

- `gsh`: Экземпляр `Spreadsheet`, представляющий открытую таблицу Google Sheets. Инициализируется None.
- `gclient`: Экземпляр объекта `gspread.client`, предоставляющий методы для работы с Google Spreadsheets.

**Методы**:

#### Метод `__init__`

**Описание**: Инициализирует объект `GSpreadsheet`.

**Параметры**:

- `self`: Текущий экземпляр класса.
- `s_id` (str, необязательно): ID таблицы Google Sheets. Если передан, открывает таблицу с этим ID.
- `s_title` (str, необязательно): Название таблицы Google Sheets. Если передан, открывает таблицу с этим названием.
- `*args`: Дополнительные параметры.
- `**kwards`: Дополнительные ключевые параметры.

**Возвращает**:  None


#### Метод `get_project_spreadsheets_dict`

**Описание**: Возвращает словарь, загруженный из файла `goog\\spreadsheets.json`.

**Параметры**:

- `self`: Текущий экземпляр класса.

**Возвращает**:
- `dict`: Словарь, содержащий данные о таблицах.


#### Метод `get_by_title`

**Описание**: Открывает или создает таблицу Google Sheets по заданному названию.

**Параметры**:

- `self`: Текущий экземпляр класса.
- `sh_title` (str, по умолчанию 'New Spreadsheet'): Название таблицы.


**Возвращает**:
None

**Примечания**: Если таблица с указанным названием уже существует, она открывается. В противном случае создается новая таблица, имя которой совпадает с переданным параметром `sh_title`.


#### Метод `get_by_id`

**Описание**: Открывает таблицу Google Sheets по заданному идентификатору.

**Параметры**:

- `self`: Текущий экземпляр класса.
- `sh_id` (str): Идентификатор таблицы.

**Возвращает**:
- `Spreadsheet`: Объект, представляющий открытую таблицу.

**Примечания**: Метод возвращает открытую таблицу, используя `self.gclient.open_by_key(sh_id)`.


#### Метод `get_all_spreadsheets_for_current_account`

**Описание**: Открывает все таблицы текущего аккаунта.

**Параметры**:

- `self`: Текущий экземпляр класса.

**Возвращает**:
None

**Примечания**: Метод использует метод `openall()` для получения всех таблиц.