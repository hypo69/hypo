# Модуль для проверки времени и ожидания ввода с таймаутом
=========================================================

Модуль содержит класс `TimeoutCheck`, который используется для проверки, находится ли текущее время в заданном интервале, а также для ожидания ввода от пользователя с таймаутом.

## Обзор

Модуль предоставляет функциональность для определения, попадает ли текущее время в заданный временной интервал, что полезно для выполнения операций, которые должны происходить только в определенные периоды времени (например, ночное обслуживание). В модуле реализована возможность ожидания ввода от пользователя в течении заданного времени.

## Подробнее

Модуль содержит класс `TimeoutCheck` с методами для проверки временного интервала и ожидания ввода с таймаутом. Временной интервал по умолчанию установлен с 23:00 до 06:00, и функция может обрабатывать интервалы, охватывающие полночь.

## Классы

### `TimeoutCheck`

**Описание**: Класс предназначен для проверки, находится ли текущее время в заданном интервале, а также для ожидания ввода от пользователя с таймаутом.

**Принцип работы**:
Класс `TimeoutCheck` инициализируется без параметров. Он содержит методы `interval`, `interval_with_timeout`, `get_input` и `input_with_timeout`, которые выполняют проверку временного интервала и ожидание ввода с таймаутом соответственно. Для реализации таймаута используются потоки.

**Атрибуты**:
- `result` (bool | None): Результат проверки временного интервала. Изначально `None`.
- `user_input` (str | None): Ввод пользователя. Изначально `None`.

**Методы**:
- `interval(start: time, end: time) -> bool`: Проверяет, находится ли текущее время в заданном интервале.
- `interval_with_timeout(timeout: int, start: time, end: time) -> bool`: Проверяет, находится ли текущее время в заданном интервале с таймаутом.
- `get_input() -> None`: Запрашивает ввод от пользователя.
- `input_with_timeout(timeout: int) -> str | None`: Ожидает ввод от пользователя с таймаутом.

### `interval`

```python
def interval(self, start: time = time(23, 0), end: time = time(6, 0)) -> bool:
    """ Проверяет, находится ли текущее время в заданном интервале.

    Args:
        start (time): Начало интервала (по умолчанию 23:00).
        end (time): Конец интервала (по умолчанию 06:00).

    Returns:
        bool: True, если текущее время находится в интервале, False в противном случае.
    """
    ...
```

**Назначение**: Проверяет, находится ли текущее время в заданном интервале.

**Параметры**:
- `start` (time): Начало интервала. По умолчанию `time(23, 0)`.
- `end` (time): Конец интервала. По умолчанию `time(6, 0)`.

**Возвращает**:
- `bool`: `True`, если текущее время находится в интервале, `False` в противном случае.

**Как работает функция**:
1. Получает текущее время.
2. Проверяет, находится ли интервал в пределах одного дня или охватывает полночь.
3. Если интервал в пределах одного дня, проверяет, находится ли текущее время между `start` и `end`.
4. Если интервал охватывает полночь, проверяет, находится ли текущее время после `start` или до `end`.
5. Сохраняет результат в атрибуте `self.result`.

```
Текущее время
|
Определение типа интервала (внутри одного дня или с пересечением полуночи)
|
Внутри одного дня: start <= текущее время <= end
ИЛИ
С пересечением полуночи: текущее время >= start ИЛИ текущее время <= end
|
Сохранение результата в self.result
```

**Примеры**:
```python
from datetime import time
timeout_check = TimeoutCheck()
start_time = time(8, 0)
end_time = time(17, 0)
result = timeout_check.interval(start=start_time, end=end_time)
print(result)  # Вывод зависит от текущего времени
```

```python
from datetime import time
timeout_check = TimeoutCheck()
start_time = time(23, 0)
end_time = time(6, 0)
result = timeout_check.interval(start=start_time, end=end_time)
print(result)  # Вывод зависит от текущего времени
```

### `interval_with_timeout`

```python
def interval_with_timeout(self, timeout: int = 5, start: time = time(23, 0), end: time = time(6, 0)) -> bool:
    """ Проверяет, находится ли текущее время в заданном интервале с таймаутом.

    Args:
        timeout (int): Время в секундах для ожидания проверки интервала.
        start (time): Начало интервала (по умолчанию 23:00).
        end (time): Конец интервала (по умолчанию 06:00).

    Returns:
        bool: True, если текущее время находится в интервале и ответ получен в течение таймаута, False, если нет или произошел таймаут.
    """
    ...
```

**Назначение**: Проверяет, находится ли текущее время в заданном интервале с таймаутом.

**Параметры**:
- `timeout` (int): Время ожидания проверки интервала в секундах. По умолчанию 5.
- `start` (time): Начало интервала. По умолчанию `time(23, 0)`.
- `end` (time): Конец интервала. По умолчанию `time(6, 0)`.

**Возвращает**:
- `bool`: `True`, если текущее время находится в интервале и ответ получен в течение таймаута, `False`, если нет или произошел таймаут.

**Как работает функция**:
1. Создает и запускает поток для выполнения проверки интервала (`self.interval`).
2. Ожидает завершения потока в течение заданного времени (`timeout`).
3. Если поток не завершился в течение таймаута, выводит сообщение о таймауте и возвращает `False`.
4. Если поток завершился в течение таймаута, возвращает результат проверки интервала (`self.result`).

```
Создание и запуск потока для проверки интервала
|
Ожидание завершения потока с таймаутом
|
Таймаут произошел?
|
Да: Вывод сообщения о таймауте -> Возврат False
|
Нет: Возврат self.result
```

**Примеры**:
```python
from datetime import time
timeout_check = TimeoutCheck()
start_time = time(8, 0)
end_time = time(17, 0)
result = timeout_check.interval_with_timeout(timeout=2, start=start_time, end=end_time)
print(result)  # Вывод зависит от текущего времени и таймаута
```

```python
from datetime import time
timeout_check = TimeoutCheck()
start_time = time(23, 0)
end_time = time(6, 0)
result = timeout_check.interval_with_timeout(timeout=5, start=start_time, end=end_time)
print(result)  # Вывод зависит от текущего времени и таймаута
```

### `get_input`

```python
def get_input(self):
    """ Запрашиваем ввод от пользователя."""
    ...
```

**Назначение**: Запрашивает ввод от пользователя.

**Как работает функция**:
1. Запрашивает ввод от пользователя с помощью функции `input`.
2. Сохраняет ввод пользователя в атрибуте `self.user_input`.

**Примеры**:
```python
timeout_check = TimeoutCheck()
timeout_check.get_input()
print(timeout_check.user_input)  # Вывод введенного пользователем значения
```

### `input_with_timeout`

```python
def input_with_timeout(self, timeout: int = 5) -> str | None:
    """ Ожидаем ввод с тайм-аутом.

    Args:
        timeout (int): Время ожидания ввода в секундах.

    Returns:
        str | None: Введенные данные или None, если был тайм-аут.
    """
    ...
```

**Назначение**: Ожидает ввод от пользователя с таймаутом.

**Параметры**:
- `timeout` (int): Время ожидания ввода в секундах. По умолчанию 5.

**Возвращает**:
- `str | None`: Введенные данные или `None`, если произошел таймаут.

**Как работает функция**:
1. Создает и запускает поток для получения ввода от пользователя (`self.get_input`).
2. Ожидает завершения потока в течение заданного времени (`timeout`).
3. Если поток не завершился в течение таймаута, выводит сообщение о таймауте и возвращает `None`.
4. Если поток завершился в течение таймаута, возвращает ввод пользователя (`self.user_input`).

```
Создание и запуск потока для получения ввода
|
Ожидание завершения потока с таймаутом
|
Таймаут произошел?
|
Да: Вывод сообщения о таймауте -> Возврат None
|
Нет: Возврат self.user_input
```

**Примеры**:
```python
timeout_check = TimeoutCheck()
user_input = timeout_check.input_with_timeout(timeout=2)
print(user_input)  # Вывод зависит от ввода пользователя и таймаута
```

```python
timeout_check = TimeoutCheck()
user_input = timeout_check.input_with_timeout(timeout=5)
print(user_input)  # Вывод зависит от ввода пользователя и таймаута
```

## Функции

В данном модуле нет отдельных функций, кроме методов класса `TimeoutCheck`.

## Примеры

```python
from datetime import time
from src.utils.date_time import TimeoutCheck

# Пример использования класса TimeoutCheck
timeout_check = TimeoutCheck()

# Проверка интервала с таймаутом
if timeout_check.interval_with_timeout(timeout=5, start=time(23, 0), end=time(6, 0)):
    print("Текущее время находится в интервале.")
else:
    print("Текущее время не находится в интервале или произошел таймаут.")

# Ожидание ввода от пользователя с таймаутом
user_input = timeout_check.input_with_timeout(timeout=5)
if user_input:
    print(f"Вы ввели: {user_input}")
else:
    print("Таймаут ввода.")