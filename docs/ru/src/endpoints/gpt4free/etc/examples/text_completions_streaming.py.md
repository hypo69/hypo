# Модуль для демонстрации потоковой передачи текста с использованием g4f

## Обзор

Этот модуль демонстрирует, как использовать библиотеки `g4f.client` для выполнения запросов к моделям GPT-4 в потоковом режиме, как синхронно, так и асинхронно. Он показывает, как отправлять запрос и обрабатывать потоковые ответы, отображая контент по мере его получения.

## Подробнее

Этот код предоставляет два способа взаимодействия с API GPT-4 для получения ответов в реальном времени: синхронный (`sync_stream`) и асинхронный (`async_stream`).  Это может быть полезно для приложений, где важна скорость получения ответов, например, чат-боты или инструменты для помощи в программировании.

## Функции

### `sync_stream`

```python
def sync_stream():
    """Функция для демонстрации синхронной потоковой передачи текста с использованием g4f.
    Args:
        None
    Returns:
        None
    Raises:
        Exception: Если возникает ошибка при создании или обработке потока.
    """
```

**Назначение**:
Эта функция демонстрирует, как отправлять запрос на завершение текста с использованием gpt-4 в синхронном режиме и обрабатывать потоковый ответ.

**Как работает функция**:

1.  **Инициализация клиента**: Создается экземпляр класса `Client` из библиотеки `g4f.client`.
2.  **Создание потока**: Используется метод `client.chat.completions.create` для отправки запроса к модели gpt-4. Запрос включает вопрос о рекурсивном перечислении файлов в каталоге Python. Указано `stream=True`, что включает потоковый режим.
3.  **Обработка потока**: Функция итерируется по чанкам (фрагментам) ответа, полученным из потока. Для каждого чанка проверяется, содержит ли он полезный контент (`chunk.choices[0].delta.content`). Если контент присутствует, он выводится в консоль без добавления новой строки в конце (`end=""`), что позволяет контенту отображаться непрерывно.
4.  **Завершение**: По завершении потока функция завершает свою работу.

**Примеры**:

```python
sync_stream()
```

**ASCII flowchart**:

```
Инициализация клиента
    ↓
Создание потока (запрос к gpt-4)
    ↓
Начало цикла по чанкам в потоке
    ↓
Проверка наличия контента в чанке
    ├── Да: Вывод контента в консоль (без новой строки)
    └── Нет: Переход к следующему чанку
    ↓
Конец цикла (поток завершен)
```

### `async_stream`

```python
async def async_stream():
    """Функция для демонстрации асинхронной потоковой передачи текста с использованием g4f.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Если возникает ошибка при создании или обработке потока.
    """
```

**Назначение**:
Эта функция демонстрирует, как отправлять запрос на завершение текста с использованием gpt-4 в асинхронном режиме и обрабатывать потоковый ответ.

**Как работает функция**:

1.  **Инициализация асинхронного клиента**: Создается экземпляр класса `AsyncClient` из библиотеки `g4f.client`.
2.  **Создание асинхронного потока**: Используется метод `client.chat.completions.create` для отправки запроса к модели gpt-4. Запрос включает вопрос о рекурсивном перечислении файлов в каталоге Python. Указано `stream=True`, что включает потоковый режим.
3.  **Обработка асинхронного потока**: Функция асинхронно итерируется по чанкам (фрагментам) ответа, полученным из потока. Для каждого чанка проверяется, содержит ли он полезный контент (`chunk.choices[0].delta.content`). Если контент присутствует, он выводится в консоль без добавления новой строки в конце (`end=""`), что позволяет контенту отображаться непрерывно.
4.  **Завершение**: По завершении потока функция завершает свою работу.

**Примеры**:

```python
async def main():
    await async_stream()

asyncio.run(main())
```

**ASCII flowchart**:

```
Инициализация асинхронного клиента
    ↓
Создание асинхронного потока (запрос к gpt-4)
    ↓
Начало асинхронного цикла по чанкам в потоке
    ↓
Проверка наличия контента в чанке
    ├── Да: Вывод контента в консоль (без новой строки)
    └── Нет: Переход к следующему чанку
    ↓
Конец цикла (поток завершен)
```

### `main`

```python
def main():
    """Основная функция для запуска синхронного и асинхронного потоков.

    Args:
        None

    Returns:
        None
    """
```

**Назначение**:
Эта функция координирует выполнение синхронного и асинхронного потоков, демонстрируя оба способа взаимодействия с API gpt-4 для потоковой передачи текста.

**Как работает функция**:

1.  **Вывод заголовка для синхронного потока**: Функция выводит в консоль строку "Synchronous Stream:", чтобы обозначить начало вывода данных из синхронного потока.
2.  **Запуск синхронного потока**: Вызывается функция `sync_stream()`, которая отправляет запрос к gpt-4 в синхронном режиме и выводит полученный контент в консоль.
3.  **Вывод разделителя**: После завершения синхронного потока выводится разделитель `\n\nAsynchronous Stream:`, чтобы отделить вывод синхронного потока от асинхронного.
4.  **Запуск асинхронного потока**: Используется `asyncio.run(async_stream())` для запуска асинхронной функции `async_stream()`. Это позволяет отправить запрос к gpt-4 в асинхронном режиме и вывести полученный контент в консоль.

**Примеры**:

```python
main()
```

**ASCII flowchart**:

```
Вывод заголовка "Synchronous Stream:"
    ↓
Запуск sync_stream()
    ↓
Вывод разделителя "\n\nAsynchronous Stream:"
    ↓
Запуск asyncio.run(async_stream())