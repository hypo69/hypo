# Документация модуля `src.utils.string.normalizer`

## Обзор

Модуль `normalizer` предоставляет функциональность для нормализации различных типов данных, включая строки, логические значения, целые числа и числа с плавающей точкой. Он также включает вспомогательные функции для обработки текста.

## Оглавление

1. [Обзор](#обзор)
2. [Функции модуля](#функции-модуля)
   - [normalize_boolean](#normalize_boolean)
   - [normalize_string](#normalize_string)
   - [normalize_int](#normalize_int)
   - [normalize_float](#normalize_float)
   - [remove_line_breaks](#remove_line_breaks)
   - [remove_html_tags](#remove_html_tags)
   - [remove_special_characters](#remove_special_characters)
   - [normalize_sql_date](#normalize_sql_date)
3. [Пример использования](#пример-использования)
4. [Требования](#требования)

## Подробнее

Модуль предоставляет удобные утилиты для нормализации и обработки данных. Он может быть использован для:
- Удаления HTML-тегов из строк.
- Преобразования строк в числовые или логические значения.
- Очистки строк от специальных символов.
- Преобразования списков строк в одну нормализованную строку.

## Функции модуля

### `normalize_boolean`

**Назначение**: Преобразует входное значение в логическое.

**Параметры**:
- `input_data` (Any): Данные, которые могут представлять логическое значение (строка, число, логический тип).

**Возвращает**:
- `bool`: Преобразованное логическое значение.

**Пример**:
```python
normalize_boolean('yes')  # Результат: True
normalize_boolean(0)      # Результат: False
```

**Как работает функция**:
1. Функция `normalize_boolean` принимает входные данные `input_data` любого типа.
2. Внутри функции происходит проверка типа входных данных и их преобразование в логическое значение.
3. Если `input_data` является строкой, то она сравнивается с различными строковыми представлениями `True` и `False` (например, 'yes', 'no', 'true', 'false').
4. Если `input_data` является числом, то проверяется, равно ли оно 0 (что соответствует `False`).
5. В конечном итоге функция возвращает логическое значение `True` или `False` в зависимости от входных данных.

**ASCII flowchart**:

```
Начало --> Проверка типа данных (строка, число, bool)
|
|-- Строка? --> Сравнение со строковыми представлениями True/False --> Возврат True/False
|
|-- Число? --> Проверка на равенство 0 --> Возврат True/False
|
|-- Bool? --> Возврат исходного значения
|
Конец
```

### `normalize_string`

**Назначение**: Преобразует строку или список строк в нормализованную строку, удаляя лишние пробелы, HTML-теги и специальные символы.

**Параметры**:
- `input_data` (str | list): Строка или список строк.

**Возвращает**:
- `str`: Очищенная строка в кодировке UTF-8.

**Пример**:
```python
normalize_string(['  Example string  ', '<b>with HTML</b>'])  # Результат: 'Example string with HTML'
```

**Как работает функция**:
1. Функция `normalize_string` принимает на вход данные `input_data`, которые могут быть как строкой, так и списком строк.
2. Если на вход передан список, он объединяется в одну строку с пробелом в качестве разделителя.
3. Из полученной строки удаляются HTML-теги с использованием функции `remove_html_tags`.
4. Далее, из строки удаляются специальные символы с использованием функции `remove_special_characters`.
5. В завершение, из строки удаляются символы новой строки с помощью функции `remove_line_breaks`, а также удаляются лишние пробелы в начале и конце строки.
6. Результат преобразуется в кодировку UTF-8 и возвращается.

**ASCII flowchart**:

```
Начало --> Проверка типа данных (строка или список строк)
|
|-- Список строк? --> Объединение в одну строку
|
Преобразование:
|
|-> Удаление HTML-тегов --> Удаление специальных символов --> Удаление символов новой строки --> Удаление лишних пробелов --> Преобразование в UTF-8
|
Конец
```

### `normalize_int`

**Назначение**: Преобразует входное значение в целое число.

**Параметры**:
- `input_data` (str | int | float | Decimal): Число или его строковое представление.

**Возвращает**:
- `int`: Преобразованное целое число.

**Пример**:
```python
normalize_int('42')  # Результат: 42
normalize_int(3.14)  # Результат: 3
```

**Как работает функция**:
1. Функция `normalize_int` принимает входные данные `input_data`, которые могут быть строкой, целым числом, числом с плавающей точкой или десятичным числом.
2. Внутри функции происходит попытка преобразования входных данных в целое число с помощью функции `int()`.
3. Если в процессе преобразования возникает ошибка, функция возвращает `None`.
4. Если преобразование прошло успешно, функция возвращает полученное целое число.

**ASCII flowchart**:

```
Начало --> Проверка типа данных (строка, int, float, Decimal)
|
Преобразование:
|
|-> Попытка преобразования в int()
|
Успешно?
|
|-- Да --> Возврат целого числа
|
|-- Нет --> Возврат None
|
Конец
```

### `normalize_float`

**Назначение**: Преобразует входное значение в число с плавающей точкой.

**Параметры**:
- `value` (Any): Число, строка или список чисел.

**Возвращает**:
- `float | List[float] | None`: Число с плавающей точкой, список чисел с плавающей точкой или `None` в случае ошибки.

**Пример**:
```python
normalize_float('3.14')         # Результат: 3.14
normalize_float([1, '2.5', 3])  # Результат: [1.0, 2.5, 3.0]
```

**Как работает функция**:
1. Функция `normalize_float` принимает на вход значение `value`, которое может быть числом, строкой или списком чисел.
2. Если `value` является списком, то функция преобразует каждый элемент списка в число с плавающей точкой и возвращает список чисел с плавающей точкой.
3. Если `value` не является списком, то функция пытается преобразовать его в число с плавающей точкой с помощью функции `float()`.
4. В случае возникновения ошибки при преобразовании функция возвращает `None`.

**ASCII flowchart**:

```
Начало --> Проверка типа данных (число, строка, список)
|
|-- Список? --> Преобразование каждого элемента в float --> Возврат списка float
|
Преобразование:
|
|-> Попытка преобразования в float()
|
Успешно?
|
|-- Да --> Возврат float
|
|-- Нет --> Возврат None
|
Конец
```

### `remove_line_breaks`

**Назначение**: Удаляет символы новой строки из строки.

**Параметры**:
- `input_str` (str): Входная строка.

**Возвращает**:
- `str`: Строка без символов новой строки.

**Пример**:
```python
remove_line_breaks('String\nwith line breaks\r')  # Результат: 'String with line breaks'
```

**Как работает функция**:
1. Функция `remove_line_breaks` принимает на вход строку `input_str`.
2. Внутри функции происходит замена всех символов новой строки (`\n` и `\r`) на пустую строку с использованием метода `replace()`.
3. Функция возвращает строку без символов новой строки.

**ASCII flowchart**:

```
Начало --> Принимает строку input_str
|
Преобразование:
|
|-> Замена символов новой строки (\n, \r) на ""
|
Конец
```

### `remove_html_tags`

**Назначение**: Удаляет HTML-теги из строки.

**Параметры**:
- `input_html` (str): Входная строка с HTML-тегами.

**Возвращает**:
- `str`: Строка без HTML-тегов.

**Пример**:
```python
remove_html_tags('<p>Example text</p>')  # Результат: 'Example text'
```

**Как работает функция**:
1. Функция `remove_html_tags` принимает на вход строку `input_html` с HTML-тегами.
2. Внутри функции используется регулярное выражение для поиска и удаления всех HTML-тегов.
3. Функция возвращает строку без HTML-тегов.

**ASCII flowchart**:

```
Начало --> Принимает HTML строку input_html
|
Преобразование:
|
|-> Поиск и удаление всех HTML-тегов с использованием регулярного выражения
|
Конец
```

### `remove_special_characters`

**Назначение**: Удаляет специальные символы из строки или списка строк.

**Параметры**:
- `input_str` (str | list): Строка или список строк.

**Возвращает**:
- `str | list`: Строка или список строк без специальных символов.

**Пример**:
```python
remove_special_characters('Hello@World!')  # Результат: 'HelloWorld'
```

**Как работает функция**:
1. Функция `remove_special_characters` принимает на вход строку `input_str` или список строк.
2. Если на вход передан список строк, функция рекурсивно вызывает саму себя для каждой строки в списке.
3. Если на вход передана строка, функция удаляет все специальные символы из строки с использованием регулярного выражения.
4. Функция возвращает строку или список строк без специальных символов.

**ASCII flowchart**:

```
Начало --> Принимает строку или список строк input_str
|
|-- Список строк? --> Рекурсивный вызов для каждой строки в списке
|
Преобразование:
|
|-> Удаление специальных символов с использованием регулярного выражения
|
Конец
```

### `normalize_sql_date`

**Назначение**: Преобразует строку или объект datetime в стандартный формат SQL-даты (`YYYY-MM-DD`).

**Параметры**:
- `input_data` (str | datetime): Строка или объект datetime, представляющий дату.

**Возвращает**:
- `str`: Нормализованная SQL-дата в виде строки в формате `YYYY-MM-DD`.

**Пример**:
```python
normalize_sql_date('2024-12-06')  # Результат: '2024-12-06'
normalize_sql_date(datetime(2024, 12, 6))  # Результат: '2024-12-06'
```

**Как работает функция**:
1. Функция `normalize_sql_date` принимает на вход данные `input_data`, которые могут быть строкой или объектом datetime.
2. Если `input_data` является строкой, функция пытается преобразовать ее в объект datetime с использованием функции `datetime.strptime()`.
3. Если `input_data` является объектом datetime, функция форматирует его в строку в формате `YYYY-MM-DD` с использованием метода `strftime()`.
4. Если в процессе преобразования или форматирования возникает ошибка, функция возвращает `None`.

**ASCII flowchart**:

```
Начало --> Проверка типа данных (строка или datetime)
|
|-- Строка? --> Попытка преобразования в datetime
|
|-- datetime? --> Форматирование в строку YYYY-MM-DD
|
Успешно?
|
|-- Да --> Возврат строки в формате YYYY-MM-DD
|
|-- Нет --> Возврат None
|
Конец
```

## Пример использования

```python
from src.utils.string.normalizer import normalize_string, normalize_boolean, normalize_int, normalize_float, normalize_sql_date

# Нормализация строки
clean_str = normalize_string(['<h1>Header</h1>', '  text with spaces  '])
print(clean_str)  # 'Header text with spaces'

# Нормализация логического значения
is_active = normalize_boolean('Yes')
print(is_active)  # True

# Нормализация целого числа
integer_value = normalize_int('42')
print(integer_value)  # 42

# Нормализация числа с плавающей точкой
float_value = normalize_float('3.14159')
print(float_value)  # 3.14159

# Нормализация SQL-даты
sql_date = normalize_sql_date('2024-12-06')
print(sql_date)  # '2024-12-06'
```

## Требования

- Python 3.10 или выше.
- Модуль `src.logger` для логирования.
- Модуль используется в режиме разработки (``).

## Логирование

Все ошибки и предупреждения логируются через `logger`:
- Ошибки логируются с использованием `logger.error`.
- Неожиданные значения логируются с использованием `logger.debug` или `logger.warning`.