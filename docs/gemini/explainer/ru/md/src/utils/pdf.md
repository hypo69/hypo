# Модуль `hypotez/src/utils/pdf.py`

Этот модуль предоставляет инструменты для преобразования HTML-контента или файлов в PDF-формат.  Используются библиотеки `pdfkit` и `fpdf`.

**Ключевые особенности:**

* **Нахождение корневой директории проекта:** Функция `set_project_root` находит корневую директорию проекта, начиная от текущего файла и идя вверх по дереву директорий. Она проверяет наличие определенных файлов или директорий (pyproject.toml, requirements.txt, .git) в родительских директориях.  Это важно, чтобы корректно указывать пути к необходимым бинарникам, таким как `wkhtmltopdf.exe`.  Если корневая директория не найдена, то используется директория текущего файла.  Это важно для корректной работы скриптов в разных средах.


* **Установка пути к `wkhtmltopdf`:** Модуль определяет путь к исполняемому файлу `wkhtmltopdf.exe` относительно корневой директории проекта.  Проверяется существование этого файла.  Если его нет, генерируется исключение `FileNotFoundError`. Это предотвращает ошибки при запуске скрипта.


* **Настройка `pdfkit`:**  `pdfkit.configuration` используется для передачи пути к `wkhtmltopdf.exe`.  Опция `enable-local-file-access` включена в конфигурацию, что позволяет правильно обрабатывать локальные файлы при преобразовании.


* **`PDFUtils` класс:** Этот класс предоставляет статические методы для сохранения HTML-данных в PDF.

    * **`save_pdf`:** Метод преобразует HTML-строку или путь к HTML-файлу в PDF-файл.  Используется библиотека `pdfkit`.  Обрабатываются возможные исключения (`pdfkit.PDFKitError`, `OSError`).  Запись в лог выполняется в случае успеха и ошибок.  В случае ошибки возвращает `False`.

    * **`save_pdf_v2`:** Альтернативный метод для сохранения текста в PDF. Используется библиотека `fpdf`.  Поддерживает форматирование текста и позволяет задавать шрифт. `save_pdf_v2` может быть полезен, если `pdfkit` не подходит для конкретной задачи. Обрабатываются исключения и запись в лог.

**Возможное улучшение:**

* **Обработка ошибок при отсутствии шрифта:**  Код, использующий `fpdf`, предполагает наличие шрифта `DejaVuSans.ttf` по указанному пути.  Важно добавить проверку существования и обработку ошибок в случае его отсутствия.

**Вывод:**

Модуль хорошо структурирован и предназначен для надежной работы с преобразованием данных в PDF-формат.  Использование `logger` и обработка исключений повышает устойчивость скрипта. Альтернативный метод `save_pdf_v2` добавляет гибкость для работы с текстовыми данными.