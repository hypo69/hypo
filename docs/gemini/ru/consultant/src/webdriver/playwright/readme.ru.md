# Анализ кода модуля `src.webdriver.playwright`

## Качество кода:

- **Соответствие стандартам**: 8
- **Плюсы**:
    - Хорошая и подробная документация, объясняющая использование и настройку модуля.
    - Четкое описание параметров конфигурационного файла `playwrid.json`.
    - Примеры кода для инициализации и использования класса `Playwrid`.
    - Указаны требования к окружению и зависимостям.
- **Минусы**:
    - Отсутствие doctest примеров в коде.
    - Не стандартизированное именование файла `playwrid.json` (лучше `playwright.json`).
    - Нет описания класса `Playwrid` и его методов.
    - Не используется форматирование кода под стандарты PEP8.

## Рекомендации по улучшению:

1.  **Переименование файла конфигурации**: Измените имя файла конфигурации с `playwrid.json` на `playwright.json` для соответствия общепринятому названию библиотеки Playwright.
2.  **Документация RST**: Добавьте полноценную RST-документацию для модуля и класса `Playwrid`. Это поможет улучшить понимание структуры кода и его использования.
3.  **Форматирование кода**: Примените стандарты PEP8 для форматирования кода.
4.  **Описание класса**: Добавьте полное описание класса `Playwrid` и его методов с помощью RST-документации. Укажите типы параметров и возвращаемых значений.
5.  **Обработка ошибок**: Вместо общих `try-except` блоков, используйте более конкретную обработку ошибок с логированием через `logger.error`.
6. **Doctest примеры**: Добавить примеры использования класса `Playwrid` и его методов в doctest, для облегчения тестирования и использования.

## Оптимизированный код:
```rst
.. module:: src.webdriver.playwright

==================================================
Модуль Playwright Crawler для автоматизации браузера
==================================================

Этот модуль предоставляет кастомную реализацию :class:`Playwrid` с использованием библиотеки Playwright.
Он позволяет настраивать параметры запуска браузера, такие как user-agent, прокси, размер окна и другие настройки,
определённые в файле `playwright.json`.

Ключевые особенности
--------------------

-   **Централизованная конфигурация**: Конфигурация управляется через файл `playwright.json`.
-   **Поддержка пользовательских опций**: Возможность передавать пользовательские опции при инициализации.
-   **Улучшенное логирование и обработка ошибок**: Предоставляет подробные логи для инициализации,
    проблем с конфигурацией и ошибок WebDriver.
-   **Поддержка прокси**: Настройка прокси-сервера для обхода ограничений.
-   **Гибкие настройки браузера**: Возможность настройки размера окна, user-agent и других параметров.

Требования
----------

Перед использованием этого модуля убедитесь, что установлены следующие зависимости:

-   Python 3.x
-   Playwright
-   Crawlee

Установите необходимые зависимости Python:

.. code-block:: bash

    pip install playwright crawlee

Кроме того, убедитесь, что Playwright установлен и настроен для работы с браузером.
Установите браузеры, используя команду:

.. code-block:: bash

    playwright install

Конфигурация
------------

Конфигурация для Playwright Crawler хранится в файле `playwright.json`.
Ниже приведён пример структуры конфигурационного файла и его описание:

Пример конфигурации (`playwright.json`)
-------------------------------------

.. code-block:: json

    {
      "browser_type": "chromium",
      "headless": true,
      "options": [
        "--disable-dev-shm-usage",
        "--no-sandbox",
        "--disable-gpu"
      ],
      "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36",
      "proxy": {
        "enabled": false,
        "server": "http://proxy.example.com:8080",
        "username": "user",
        "password": "password"
      },
      "viewport": {
        "width": 1280,
        "height": 720
      },
      "timeout": 30000,
      "ignore_https_errors": false
    }

Описание полей конфигурации
----------------------------

1. `browser_type`
^^^^^^^^^^^^^^^^^
Тип браузера, который будет использоваться. Возможные значения:

- `chromium` (по умолчанию)
- `firefox`
- `webkit`

2. `headless`
^^^^^^^^^^^^^
Булевое значение, указывающее, должен ли браузер запускаться в безголовом режиме. По умолчанию `true`.

3. `options`
^^^^^^^^^^^^
Список аргументов командной строки, передаваемых в браузер. Примеры:

- `--disable-dev-shm-usage`: Отключает использование `/dev/shm` в Docker-контейнерах.
- `--no-sandbox`: Отключает режим песочницы.
- `--disable-gpu`: Отключает аппаратное ускорение GPU.

4. `user_agent`
^^^^^^^^^^^^^^^
Строка user-agent, которая будет использоваться для запросов браузера.

5. `proxy`
^^^^^^^^^
Настройки прокси-сервера:

- **enabled**: Булевое значение, указывающее, следует ли использовать прокси.
- **server**: Адрес прокси-сервера.
- **username**: Имя пользователя для аутентификации на прокси-сервере.
- **password**: Пароль для аутентификации на прокси-сервере.

6. `viewport`
^^^^^^^^^^^^^^
Размеры окна браузера:

- **width**: Ширина окна.
- **height**: Высота окна.

7. `timeout`
^^^^^^^^^^^
Максимальное время ожидания для выполнения операций (в миллисекундах). По умолчанию `30000` (30 секунд).

8. `ignore_https_errors`
^^^^^^^^^^^^^^^^^^^^^^^^
Булевое значение, указывающее, следует ли игнорировать ошибки HTTPS. По умолчанию `false`.

Использование
-------------

Чтобы использовать :class:`Playwrid` в своём проекте, просто импортируйте его и инициализируйте:

.. code-block:: python

    from src.webdriver.playwright import Playwrid

    # Инициализация Playwright Crawler с пользовательскими опциями
    browser = Playwrid(options=['--headless'])

    # Запуск браузера и переход на сайт
    browser.start('https://www.example.com')

Класс :class:`Playwrid` автоматически загружает настройки из файла `playwright.json` и использует их
для конфигурации WebDriver. Также можно указать пользовательский user-agent и передать дополнительные опции
при инициализации WebDriver.

Логирование и отладка
---------------------

Класс WebDriver использует `logger` из `src.logger` для логирования ошибок, предупреждений и общей информации.
Все проблемы, возникающие при инициализации, конфигурации или выполнении, будут записываться в логи для удобства отладки.

Примеры логов
-------------

-   **Ошибка при инициализации WebDriver**: `Ошибка при инициализации Playwright Crawler: <детали ошибки>`
-   **Проблемы с конфигурацией**: `Ошибка в файле playwright.json: <детали проблемы>`

Лицензия
--------

Этот проект лицензирован на условиях MIT License. Подробности см. в файле [LICENSE](../../LICENSE).
```