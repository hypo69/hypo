# Анализ кода модуля `5_bagles.ru.md`

**Качество кода**
-  **Соответствие требованиям к формату кода (1-10):**
    - **Преимущества:**
        - Документ структурирован и понятен для восприятия.
        - Описание игры и правила представлены четко.
        - Приведен пример работы программы, что помогает понять игровой процесс.
        - Разделы хорошо организованы: инициализация, основной цикл, проверка победы и завершение игры.
    - **Недостатки:**
        - Отсутствует непосредственно код Python, только текстовое описание.
        - Формат markdown не соответствует требованиям reStructuredText (RST) для документации кода.
        - Нет разделения на модули, функции и классы.
        - Нет примеров использования `j_loads`, `j_loads_ns` из `src.utils.jjson`.
        - Отсутствует обработка ошибок, а также использование `logger.error`.
        - Нет docstring в формате reStructuredText (RST).
        - Не используются переменные и константы, которые соответствуют принятым стандартам именования.
        - Нет никаких комментариев `#` внутри кода.
        - Нет импортов.

**Рекомендации по улучшению**

1. **Перейти на формат RST:** Переписать документ в формате reStructuredText (RST) для более формализованного представления документации.
2. **Добавить код на Python:** Добавить реализацию игры на Python.
3. **Использовать j_loads/j_loads_ns:** При необходимости использовать `j_loads` или `j_loads_ns` для чтения файлов.
4. **Включить импорты:** Добавить необходимые импорты.
5. **Добавить docstring:** Добавить docstring в формате RST для всех функций, классов и методов.
6. **Обработка ошибок:** Добавить обработку ошибок с использованием `logger.error`.
7. **Соблюдать стандарты именования:** Использовать понятные имена переменных, функций и констант.
8. **Добавить комментарии:** Добавить содержательные комментарии `#` внутри кода, объясняющие логику.
9.  **Реализация в виде кода:** Реализовать игровую логику в виде функций, которые будут описаны с помощью docstring.
10. **Поддержка режима отладки:** Добавить возможность вывода загаданного числа после игры для режима отладки.

**Улучшенный код**
```python
"""
Модуль для реализации логической игры "Bagels".
=========================================================================================

Модуль содержит функции для генерации случайного трехзначного числа,
получения подсказок и обработки ввода пользователя.

Пример использования
--------------------

.. code-block:: python

    game = BagelsGame()
    game.start_game()
"""

import random # Импортируем модуль random для генерации случайных чисел.
from src.utils.jjson import j_loads # Импортируем j_loads для загрузки JSON файлов (если потребуется).
from src.logger.logger import logger # Импортируем logger для логирования ошибок.


def generate_secret_number() -> str:
    """
    Генерирует случайное трехзначное число без повторяющихся цифр.

    :return: Строка, представляющая загаданное число.
    :rtype: str
    """
    while True: # цикл для генерации числа
        number = str(random.randint(100, 999)) # генерируем случайное трехзначное число
        if len(set(number)) == 3: # проверяем на уникальность цифр
            return number # возвращаем строку если условие выполнено


def get_clues(guess: str, secret_number: str) -> str:
    """
    Формирует подсказки для угадываемого числа на основе введенной пользователем строки.

    :param guess: Число, введенное пользователем.
    :type guess: str
    :param secret_number: Загаданное число.
    :type secret_number: str
    :return: Строка с подсказками.
    :rtype: str
    """
    clues = [] # инициализируем список подсказок
    for i, digit in enumerate(guess): # перебираем цифры в введенном числе
        if digit == secret_number[i]: # если цифра на той же позиции, добавляем ферми
            clues.append('Fermi')
        elif digit in secret_number: # если цифра есть в числе, добавляем пико
            clues.append('Pico')
    if not clues: # если не было совпадений, возвращаем bagels
        return 'Bagels'
    clues.sort() # сортируем подсказки для корректного вывода
    return ' '.join(clues) # возвращаем строку с подсказками


def is_valid_guess(guess: str) -> bool:
    """
    Проверяет, является ли ввод пользователя корректным трехзначным числом без повторяющихся цифр.

    :param guess: Строка, введенная пользователем.
    :type guess: str
    :return: True, если ввод корректный, иначе False.
    :rtype: bool
    """
    if not guess.isdigit() or len(guess) != 3: # проверяем, является ли строка числом из 3 цифр
        return False # возвращаем false если условие не выполнено
    return len(set(guess)) == 3 # проверяем на уникальность цифр


class BagelsGame:
    """
    Класс, представляющий игру "Bagels".

    Содержит методы для начала игры, обработки ввода пользователя и отображения результатов.
    """
    def __init__(self):
        """
        Инициализирует игру "Bagels".

        Устанавливает начальные значения для загаданного числа, количества попыток и флага режима обучения.
        """
        self.secret_number = None # загаданное число
        self.attempts = 0 # количество попыток
        self.debug_mode = False # режим отладки

    def start_game(self):
        """
        Начинает новую игру.

        Генерирует новое загаданное число и сбрасывает количество попыток.
        """
        self.secret_number = generate_secret_number() # генерируем загаданное число
        self.attempts = 0 # обнуляем количество попыток
        print('Я загадал трехзначное число. Попробуй его угадать!') # вывод сообщения пользователю

        while True: # цикл обработки ввода пользователя
            self.attempts += 1 # увеличиваем количество попыток
            guess = input(f'Попытка {self.attempts}. Введи трехзначное число: ') # ввод числа
            if not is_valid_guess(guess): # проверяем на корректность ввода
                print('Некорректный ввод. Введи трехзначное число без повторяющихся цифр.') # сообщение о некорректном вводе
                continue # переходим на следующий цикл

            clues = get_clues(guess, self.secret_number) # получаем подсказки
            print(f'Подсказки: {clues}') # вывод подсказок
            if clues == 'Fermi Fermi Fermi': # проверка на победу
                print(f'Поздравляем! Ты угадал число {self.secret_number} за {self.attempts} попыток!') # вывод поздравления
                if self.debug_mode: # если режим отладки активен
                    print(f'Загаданное число: {self.secret_number}') # выводим загаданное число
                break # выход из цикла

        play_again = input('Хочешь сыграть еще раз? (да/нет): ').lower() # спрашиваем хочет ли пользователь играть ещё
        if play_again == 'да': # если да
            self.start_game() # перезапускаем игру
        else: # если нет
            print('Спасибо за игру!') # прощаемся


if __name__ == '__main__':
    """
    Точка входа в программу.
    Создаёт экземпляр игры и запускает её.
    """
    try: # блок для отлова исключений
        game = BagelsGame() # создаём экземпляр игры
        game.start_game() # запускаем игру
    except Exception as ex: # ловим ошибку
        logger.error('Произошла ошибка во время запуска игры', ex) # логируем ошибку
```