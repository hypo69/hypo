# Модуль `reach_spreadsheet`

## Обзор

Модуль `reach_spreadsheet.py` предоставляет класс `ReachSpreadsheet` для работы с Google Sheets API v4. Он позволяет создавать, настраивать и делиться таблицами, а также выполнять различные операции форматирования и обновления данных. Модуль предназначен для использования в проектах, требующих интеграции с Google Sheets.

## Оглавление
1. [Классы](#классы)
    - [`SpreadsheetError`](#spreadsheeterror)
    - [`SpreadsheetNotSetError`](#spreadsheetnotseterror)
    - [`SheetNotSetError`](#sheetnotseterror)
    - [`ReachSpreadsheet`](#reachspreadsheet)
2.  [Функции](#функции)
    - [`htmlColorToJSON`](#htmlcolortojson)
3. [Тестовые функции](#тестовые-функции)
    - [`testCreateSpreadsheet`](#testcreatespreadsheet)
    - [`testSetSpreadsheet`](#testsetspreadsheet)
    - [`testAddSheet`](#testaddsheet)
    - [`testSetDimensions`](#testsetdimensions)
    - [`testGridRangeForStr`](#testgridrangeforstr)
    - [`testSetCellStringFormatterormat`](#testsetcellstringformatterormat)
    - [`testPureBlackBorder`](#testpureblackborder)
    - [`testUpdateCellStringFormatterieldsArg`](#testupdatecellstringformatterieldsarg)
    - [`create_pricelist`](#create_pricelist)
    - [`testCreateTimeManagementReport`](#testcreatetime managementreport)
## Классы

### `SpreadsheetError`

**Описание**:
Базовый класс для ошибок, связанных с работой с таблицами.

### `SpreadsheetNotSetError`

**Описание**:
Ошибка, возникающая, когда не установлен идентификатор таблицы.

### `SheetNotSetError`

**Описание**:
Ошибка, возникающая, когда не установлен идентификатор листа.

### `ReachSpreadsheet`

**Описание**:
Класс для работы с Google Sheets API v4. Предоставляет методы для создания, настройки, обмена таблицами, а также выполнения различных операций с данными.

**Методы**:

#### `__init__`

**Описание**:
Инициализирует объект `ReachSpreadsheet`, настраивает аутентификацию и создает сервисы Google Sheets и Drive API.

**Параметры**:
- `debugMode` (bool, optional): Включает режим отладки, выводя подробную информацию. По умолчанию `False`.

#### `create`

**Описание**:
Создает новую таблицу Google Sheets.

**Параметры**:
- `title` (str): Заголовок создаваемой таблицы.
- `sheetTitle` (str): Заголовок первого листа таблицы.
- `rows` (int, optional): Количество строк в листе. По умолчанию `1000`.
- `cols` (int, optional): Количество столбцов в листе. По умолчанию `26`.
- `locale` (str, optional): Локаль таблицы. По умолчанию `'en-US'`.
- `timeZone` (str, optional): Часовой пояс таблицы. По умолчанию `'Etc/GMT'`.

#### `share`

**Описание**:
Предоставляет доступ к таблице, используя заданные параметры.

**Параметры**:
- `shareRequestBody` (dict): Тело запроса для предоставления доступа.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если не установлен `spreadsheetId`.

#### `shareWithEmailForReading`

**Описание**:
Предоставляет доступ на чтение к таблице указанному пользователю.

**Параметры**:
- `email` (str): Email пользователя, которому предоставляется доступ.

#### `shareWithEmailForWriting`

**Описание**:
Предоставляет доступ на запись к таблице указанному пользователю.

**Параметры**:
- `email` (str): Email пользователя, которому предоставляется доступ.

#### `shareWithAnybodyForReading`

**Описание**:
Предоставляет доступ на чтение к таблице всем пользователям с ссылкой.

#### `shareWithAnybodyForWriting`

**Описание**:
Предоставляет доступ на запись к таблице всем пользователям с ссылкой.

#### `getSheetURL`

**Описание**:
Возвращает URL-адрес текущей таблицы.

**Возвращает**:
- str: URL-адрес текущей таблицы.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если не установлен `spreadsheetId`.
- `SheetNotSetError`: Если не установлен `sheetId`.

#### `setSpreadsheetById`

**Описание**:
Устанавливает текущую таблицу по её идентификатору и устанавливает текущий лист как первый лист этой таблицы.

**Параметры**:
- `spreadsheetId` (str): Идентификатор таблицы.

#### `runPrepared`

**Описание**:
Выполняет подготовленные запросы к таблице.

**Параметры**:
- `valueInputOption` (str, optional): Опция ввода значения. По умолчанию `"USER_ENTERED"`.

**Возвращает**:
- tuple: Кортеж, содержащий ответы на запросы обновления (`replies`) и обновления значений (`responses`).

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если не установлен `spreadsheetId`.

#### `prepare_addSheet`

**Описание**:
Подготавливает запрос на добавление нового листа в текущую таблицу.

**Параметры**:
- `sheetTitle` (str): Заголовок нового листа.
- `rows` (int, optional): Количество строк в новом листе. По умолчанию `1000`.
- `cols` (int, optional): Количество столбцов в новом листе. По умолчанию `26`.

#### `addSheet`

**Описание**:
Добавляет новый лист в текущую таблицу, устанавливает его как текущий лист и возвращает его идентификатор.

**Параметры**:
- `sheetTitle` (str): Заголовок нового листа.
- `rows` (int, optional): Количество строк в новом листе. По умолчанию `1000`.
- `cols` (int, optional): Количество столбцов в новом листе. По умолчанию `26`.

**Возвращает**:
- int: Идентификатор добавленного листа.

**Вызывает исключения**:
- `SpreadsheetNotSetError`: Если не установлен `spreadsheetId`.

#### `toGridRange`

**Описание**:
Преобразует строковый диапазон ячеек в объект `GridRange` текущего листа.

**Параметры**:
- `cellsRange` (str): Строковый диапазон ячеек.

**Возвращает**:
- dict: Объект `GridRange`, описывающий диапазон ячеек.

**Вызывает исключения**:
- `SheetNotSetError`: Если не установлен `sheetId`.

#### `prepare_setDimensionPixelSize`

**Описание**:
Подготавливает запрос на изменение размера в пикселях для указанного измерения (столбцы или строки).

**Параметры**:
- `dimension` (str): Измерение (`"COLUMNS"` или `"ROWS"`).
- `startIndex` (int): Индекс начала диапазона.
- `endIndex` (int): Индекс конца диапазона.
- `pixelSize` (int): Размер в пикселях.

**Вызывает исключения**:
- `SheetNotSetError`: Если не установлен `sheetId`.

#### `prepare_setColumnsWidth`

**Описание**:
Подготавливает запрос на изменение ширины столбцов в пикселях.

**Параметры**:
- `startCol` (int): Индекс начального столбца.
- `endCol` (int): Индекс конечного столбца.
- `width` (int): Ширина в пикселях.

#### `prepare_setColumnWidth`

**Описание**:
Подготавливает запрос на изменение ширины одного столбца в пикселях.

**Параметры**:
- `col` (int): Индекс столбца.
- `width` (int): Ширина в пикселях.

#### `prepare_setRowsHeight`

**Описание**:
Подготавливает запрос на изменение высоты строк в пикселях.

**Параметры**:
- `startRow` (int): Индекс начальной строки.
- `endRow` (int): Индекс конечной строки.
- `height` (int): Высота в пикселях.

#### `prepare_setRowHeight`

**Описание**:
Подготавливает запрос на изменение высоты одной строки в пикселях.

**Параметры**:
- `row` (int): Индекс строки.
- `height` (int): Высота в пикселях.

#### `prepare_setValues`

**Описание**:
Подготавливает запрос на установку значений в заданный диапазон ячеек.

**Параметры**:
- `cellsRange` (str): Строковый диапазон ячеек.
- `values` (list): Список списков значений для установки.
- `majorDimension` (str, optional): Измерение, вдоль которого располагаются значения. По умолчанию `"ROWS"`.

**Вызывает исключения**:
- `SheetNotSetError`: Если не установлен `sheetTitle`.

#### `prepare_mergeCells`

**Описание**:
Подготавливает запрос на слияние ячеек в заданном диапазоне.

**Параметры**:
- `cellsRange` (str): Строковый диапазон ячеек.
- `mergeType` (str, optional): Тип слияния. По умолчанию `"MERGE_ALL"`.

#### `prepare_setCellStringFormatterormat`

**Описание**:
Подготавливает запрос на установку формата для ячеек в заданном диапазоне.

**Параметры**:
- `cellsRange` (str): Строковый диапазон ячеек.
- `formatJSON` (dict): Словарь с форматом для ячеек.
- `fields` (str, optional): Поля для применения формата. По умолчанию `"userEnteredFormat"`.

#### `prepare_setCellStringFormatterormats`

**Описание**:
Подготавливает запрос на установку форматов для ячеек в заданном диапазоне, используя список форматов для каждой ячейки.

**Параметры**:
- `cellsRange` (str): Строковый диапазон ячеек.
- `formatsJSON` (list): Список списков словарей с форматами для ячеек.
- `fields` (str, optional): Поля для применения формата. По умолчанию `"userEnteredFormat"`.

## Функции

### `htmlColorToJSON`

**Описание**:
Преобразует HTML-цвет (например, "#RRGGBB") в JSON-представление цвета для Google Sheets API.

**Параметры**:
- `htmlColor` (str): HTML-цвет в строковом формате.

**Возвращает**:
- dict: JSON-представление цвета в формате {"red": float, "green": float, "blue": float}.

## Тестовые функции

### `testCreateSpreadsheet`

**Описание**:
Тестирует создание таблицы и предоставление доступа на запись.

### `testSetSpreadsheet`

**Описание**:
Тестирует установку таблицы по идентификатору и вывод идентификатора листа.

### `testAddSheet`

**Описание**:
Тестирует добавление нового листа в таблицу.

### `testSetDimensions`

**Описание**:
Тестирует установку ширины столбцов и высоты строк.

### `testGridRangeForStr`

**Описание**:
Тестирует преобразование строкового диапазона ячеек в объект `GridRange`.

### `testSetCellStringFormatterormat`

**Описание**:
Тестирует установку формата текста для ячеек.

### `testPureBlackBorder`

**Описание**:
Тестирует установку черной границы для ячеек.

### `testUpdateCellStringFormatterieldsArg`

**Описание**:
Тестирует установку форматов для ячеек с использованием аргумента `fields`.

### `create_pricelist`

**Описание**:
Создает таблицу с заданными параметрами и данными, используемыми для прайс-листов.

**Параметры**:
- `docTitle` (str): Заголовок документа.
- `sheetTitle` (str): Заголовок листа.
- `values` (list): Список строк значений для вставки в таблицу.

### `testCreateTimeManagementReport`

**Описание**:
Создает таблицу с данными отчета по тайм-менеджменту.