# Модуль options.js

## Обзор

Этот модуль отвечает за обработку пользовательских настроек расширения TryXPath.  Он позволяет пользователю изменять атрибуты и CSS стили, которые применяются к всплывающему окну расширения.  Модуль предоставляет интерфейс для выбора значений и сохранения их в хранилище расширения, а также для загрузки значений по умолчанию.

## Переменные

### `defaultAttributes`

**Описание**: Объект, содержащий значения атрибутов по умолчанию.

**Значения**:
```javascript
{
    "element": "data-tryxpath-element",
    "context": "data-tryxpath-context",
    "focused": "data-tryxpath-focused",
    "focusedAncestor": "data-tryxpath-focused-ancestor",
    "frame": "data-tryxpath-frame",
    "frameAncestor": "data-tryxpath-frame-ancestor"
}
```

### `defaultPopupBodyStyles`

**Описание**: Объект, содержащий значения стилей по умолчанию для тела всплывающего окна.

**Значения**:
```javascript
{
    "width": "367px",
    "height": "auto"
}
```

## Функции

### `isValidAttrName(name)`

**Описание**: Проверяет, является ли имя атрибута валидным.

**Параметры**:
- `name` (str): Имя атрибута.

**Возвращает**:
- `boolean`: `true`, если имя атрибута валидное, `false` иначе.

**Обрабатываемые исключения**:
- `e`: Возникает в случае ошибки при установке атрибута.


### `isValidAttrNames(names)`

**Описание**: Проверяет, являются ли все имена атрибутов в списке валидными.

**Параметры**:
- `names` (object): Объект с именами атрибутов.

**Возвращает**:
- `boolean`: `true`, если все имена атрибутов валидные, `false` иначе.


### `isValidStyleLength(len)`

**Описание**: Проверяет, является ли значение длины стилей валидным.

**Параметры**:
- `len` (str): Значение длины стилей.

**Возвращает**:
- `boolean`: `true`, если значение длины стилей валидное, `false` иначе.


### `loadDefaultCss()`

**Описание**: Загружает CSS стили по умолчанию.

**Возвращает**:
- `Promise<string>`: Обещание, содержащее загруженный CSS код или отклонение с ошибкой.

**Обрабатываемые исключения**:
- `fu.onError`: Обработка ошибок при загрузке CSS.

### `extractBodyStyles(css)`

**Описание**: Извлекает значения ширины и высоты из CSS.

**Параметры**:
- `css` (string): CSS код.

**Возвращает**:
- `object`: Объект со значениями ширины и высоты или объект со значениями по умолчанию.


### `createPopupCss(bodyStyles)`

**Описание**: Создает CSS строку для стилей тела всплывающего окна.

**Параметры**:
- `bodyStyles` (object): Объект со значениями ширины и высоты.

**Возвращает**:
- `string`: CSS строка для стилей тела всплывающего окна.


## Обработчики событий

### `window.addEventListener("load", ...)`

**Описание**: Обработчик события загрузки страницы. Инициализирует элементы, устанавливает слушатели для событий, загружает настройки и устанавливает значения по умолчанию, если они были загружены.

**Обрабатываемые исключения**:
- `fu.onError`: Обработка ошибок при получении настроек от расширения.

### `document.getElementById("save").addEventListener("click", ...)`

**Описание**: Обработчик события клика на кнопке сохранения. Сохраняет новые настройки в хранилище расширения.

**Обрабатываемые исключения**:
- `err`: Обработка ошибок при сохранении настроек.

### `document.getElementById("show-default").addEventListener("click", ...)`

**Описание**: Обработчик события клика на кнопке "Восстановить значения по умолчанию". Устанавливает значения атрибутов и стилей по умолчанию.

**Обрабатываемые исключения**:
- `fu.onError`: Обработка ошибок при загрузке CSS.


## Дополнительные замечания

Код использует анонимную функцию для создания приватного контекста.  Использует API расширений для взаимодействия с хранилищем и загрузки CSS. Обрабатывает ошибки в разных местах.