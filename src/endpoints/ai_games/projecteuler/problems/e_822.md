# Задача No 822
## Гиперболические точки на эллипсе

## Условия

Рассмотрим эллипс, заданный уравнением $4x^2 + y^2 = 4$. На этом эллипсе расположено бесконечное число точек, координаты которых являются рациональными числами.
Пусть $(x,y)$ — рациональная точка, лежащая на эллипсе. Гиперболическая точка, соответствующая точке $(x, y)$, получается путём преобразования $(x,y) \rightarrow (x',y')$, где
$x' = \frac{4x}{x^2 + y^2}$
$y' = \frac{4y}{x^2 + y^2}$.

Например, точка $(1,0)$ преобразуется в точку $(4,0)$. А точка $\left(\frac{4}{5}, \frac{6}{5}\right)$ преобразуется в $\left(\frac{16}{13}, \frac{24}{13}\right)$.

Пусть $H(x,y)$ — гиперболическая точка, полученная из рациональной точки $(x,y)$.
Рассмотрим набор из всех рациональных точек $(x,y)$, лежащих на эллипсе, для которых $x$ и $y$ представимы в виде несократимой дроби с натуральными знаменателями не более $N$. Назовем множество всех таких точек $\mathcal{E}(N)$.
Пусть $S(N)$ - сумма $x'$ координат всех точек $H(x,y)$, где $(x,y)$ принадлежат $\mathcal{E}(N)$.
Известно, что $S(10)=87.16631413$.

Найдите $S(10^6)$. В качестве ответа приведите результат, округленный до 8 знаков после десятичной точки.
