# hypotez/src/suppliers/graber.py

```markdown
## Файл `hypotez/src/suppliers/graber.py`

Этот файл содержит базовый класс `Graber` для сбора данных с HTML-страниц поставщиков.  Он использует веб-драйвер (класс `Driver`) для извлечения целевых полей страницы (например, название, описание, артикул, цена).  Локаторы для этих полей хранятся в файлах JSON в директории `locators` каждого поставщика.

**Ключевые особенности:**

* **Базовый класс:** `Graber` – это абстрактный класс, который должен быть расширен для каждого конкретного поставщика.
* **Веб-драйвер:** Использует `Driver` для взаимодействия с браузером и поиска элементов на странице.
* **Локаторы:** Локаторы хранятся в файлах JSON в папке `locators`.
* **Декоратор `close_pop_up`:** Этот декоратор позволяет автоматически закрывать всплывающие окна, которые могут появиться на странице перед извлечением данных.
* **Обработка ошибок:**  Функции для сбора данных (например, `name`, `price`) содержат обработку исключений (`try...except`) для ловли ошибок при выполнении локаторов и логирования ошибок.
* **`set_field_value`:**  Функция для общих операций установки значений полей с опцией передачи значения по умолчанию и обработкой ошибок.
* **`grab_page`:**  Асинхронная функция для сбора всех полей продукта.  Вызывает другие асинхронные функции (`id_product`, `name`, `price`, и др.) для извлечения конкретных данных.


**Пример использования (в другом классе, наследующем `Graber`):**

```python
import json
from hypotez.src.suppliers import Graber
from hypotez.src.utils.jjson import j_loads, j_loads_ns
from hypotez.src.webdriver import Driver

# Предположим, что у вас есть драйвер
driver = Driver()

# Получение локаторов из файла JSON
supplier_prefix = "suppler_prefix"
locator_path = gs.path.src.suppliers / f"{supplier_prefix}" / 'locators' / 'product.json'
locator = j_loads_ns(locator_path) # j_loads_ns, по всей видимости, загружает локаторы в SimpleNamespace

class MyGraber(Graber):
    def __init__(self, driver: Driver): # переопределён конструктор для работы с драйвером
        super().__init__(supplier_prefix, driver)


# Пример использования в вашем коде:
graber_instance = MyGraber(driver)
asyncio.run(graber_instance.grab_page(id_product="123")) # Пример вызова grab_page с аргументом id_product
```


**Важные моменты:**

* Фрагменты кода с `...` представляют собой нереализованную логику или предполагаемые дальнейшие действия, которые должны быть добавлены для конкретного поставщика.
* Код предполагает наличие дополнительных классов (`ProductFields`, `Category`, `Driver`, `PrestaShop`) и модулей (`gs`, `header`, `logger`, `utils`), которые определены в других частях проекта и не показаны здесь.
* Декоратор `close_pop_up` вызывается, если в `Context` установлен `Context.locator_for_decorator`.


**Общий принцип:**  Этот код является базовым инструментом для сбора данных.  Для работы с конкретным поставщиком вам необходимо указать локаторы для его элементов (в файлах JSON), а также реализовать функции, которые будут собирать данные из этих элементов.
```
```