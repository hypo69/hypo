# Анализ кода модуля `19_bullcow.ru.md`

**Качество кода**
 - **Соответствие требованиям к формату кода (1-10):** 6
    - **Преимущества:**
        - Документ описывает правила игры "Быки и коровы" на русском языке.
        - Представлено пошаговое описание реализации игры.
        - Содержатся примеры работы программы.
        - Документ написан в формате Markdown.
    - **Недостатки:**
        - Нет кода Python, который можно было бы проверить на соответствие требованиям.
        - Отсутствует структурированный код с комментариями в reStructuredText.
        - Не используется `j_loads` или `j_loads_ns`.
        - Недостаточное описание для автоматизированного анализа.
        - Не указаны импорты необходимых библиотек.
        - Не хватает docstring в формате RST.
        - Отсутствует обработка ошибок и логирование.

**Рекомендации по улучшению**
1. Преобразовать текстовое описание игры в исполняемый код Python.
2. Добавить функцию для генерации случайного 5-значного числа без повторяющихся цифр.
3. Реализовать функцию для сравнения введенного числа с загаданным, возвращающую количество быков и коров.
4. Обеспечить взаимодействие пользователя с программой через консоль.
5. Использовать docstring в формате RST для всех функций и классов.
6. Использовать `logger.error` для логирования ошибок.
7. Добавить импорты необходимых библиотек, таких как `random` и `src.logger.logger`.
8. Следовать стандартам кодирования Python (PEP 8).
9. Добавить обработку некорректного ввода пользователя.
10. Включить механизм проверки, что загаданное число состоит из 5 цифр и не содержит повторений.
11. Добавить возможность повторной игры.

**Улучшенный код**
```python
"""
Модуль для игры "Быки и коровы"
=========================================================================================

Этот модуль реализует игру "Быки и коровы", где игрок пытается угадать
загаданное компьютером 5-значное число.

Пример использования:
--------------------

.. code-block:: python

    game = BullCowGame()
    game.start_game()
"""
import random  # Импорт модуля random для генерации случайных чисел
from src.logger.logger import logger  # Импорт логгера для записи ошибок

class BullCowGame:
    """
    Класс, представляющий игру "Быки и коровы".

    :ivar secret_number: Секретное 5-значное число, которое нужно угадать.
    :vartype secret_number: str
    :ivar attempts: Количество попыток, сделанных игроком.
    :vartype attempts: int
    """
    def __init__(self):
        """
        Инициализация игры.
        """
        self.secret_number = self._generate_secret_number() # Генерация секретного числа при инициализации
        self.attempts = 0  # Счетчик попыток, изначально 0

    def _generate_secret_number(self) -> str:
        """
        Генерирует случайное 5-значное число без повторяющихся цифр.

        :return: Секретное число в виде строки.
        :rtype: str
        """
        digits = list(range(10)) # Создание списка цифр от 0 до 9
        random.shuffle(digits) # Перемешивание цифр
        secret_number = ''.join(map(str, digits[:5])) # Выбор первых 5 цифр и преобразование в строку
        return secret_number # Возвращение сгенерированного секретного числа

    def _evaluate_guess(self, guess: str) -> tuple[int, int]:
        """
        Сравнивает ввод игрока с загаданным числом и возвращает количество "быков" и "коров".

        :param guess: Введенное игроком число.
        :type guess: str
        :return: Кортеж, содержащий количество быков и коров.
        :rtype: tuple[int, int]
        """
        bulls = 0 # Инициализация счетчика быков
        cows = 0 # Инициализация счетчика коров
        for i, digit in enumerate(guess): # Проход по цифрам в введенном числе с индексами
            if digit == self.secret_number[i]: # Проверка на совпадение цифры и позиции (бык)
                bulls += 1 # Увеличение счетчика быков
            elif digit in self.secret_number: # Проверка на совпадение цифры в другом месте (корова)
                cows += 1 # Увеличение счетчика коров
        return bulls, cows # Возвращение количества быков и коров

    def start_game(self):
        """
        Запускает игру "Быки и коровы".
        """
        print("Добро пожаловать в игру Быки и Коровы!") # Вывод приветствия
        print("Я загадал 5-значное число.")  # Вывод информации о загаданном числе
        while True:
            try: # Блок try-except для обработки ошибок ввода
                guess = input("Ваша попытка: ") # Получение ввода от игрока
                if not guess.isdigit() or len(guess) != 5: # Проверка корректности ввода (5 цифр)
                    print("Пожалуйста, введите 5-значное число.")  # Сообщение об ошибке ввода
                    continue  # Переход к следующей итерации цикла
                self.attempts += 1  # Увеличение счетчика попыток
                bulls, cows = self._evaluate_guess(guess) # Оценка попытки игрока
                print(f"Результат: {bulls} бык(ов), {cows} коров(ы)")  # Вывод результата попытки
                if bulls == 5:  # Проверка на выигрыш (угадал все цифры и их позиции)
                    print(f"Поздравляем, вы угадали число за {self.attempts} попыток!")  # Сообщение о победе
                    break # Выход из цикла
            except Exception as ex:  # Ловля возможных ошибок
                logger.error('Ошибка в ходе игры', ex) # Логирование ошибки
                continue # Переход к следующей итерации цикла
        play_again = input("Хотите сыграть снова? (да/нет): ").lower() # Спрашиваем, хочет ли игрок начать новую игру
        if play_again == "да": # Если игрок хочет начать новую игру
            self.__init__()  # Инициализация новой игры
            self.start_game() # Запуск новой игры
        else: # Если игрок не хочет играть снова
            print("Спасибо за игру!") # Сообщение об окончании игры

if __name__ == "__main__":
    game = BullCowGame() # Создание экземпляра игры
    game.start_game() # Запуск игры
```