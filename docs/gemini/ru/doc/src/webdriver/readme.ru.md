# Модуль WebDriver Executor (ru)

## Обзор

Этот модуль предоставляет фреймворк для выполнения действий на веб-страницах с помощью WebDriver. Он обрабатывает скрипты и локаторы для автоматизации взаимодействия с веб-элементами.

## Основные функции

- **Обработка локаторов:**
    - **Инициализация:** Класс `ExecuteLocator` инициализируется экземпляром WebDriver и необязательными аргументами и ключевыми аргументами. Он настраивает WebDriver и цепочки действий для взаимодействия с веб-элементами.
    - **Выполнение локатора:** Метод `execute_locator` обрабатывает словарь локатора, содержащий информацию о том, как найти и взаимодействовать с веб-элементами. Он обрабатывает различные типы локаторов и действий на основе предоставленной конфигурации.
    - **Получение элемента:** Метод `get_webelement_by_locator` извлекает веб-элементы на основе информации локатора (XPath, ID, CSS-селекторы). Он ожидает появления элементов и может возвращать один элемент, список элементов или `False`, если элементы не найдены.
    - **Получение атрибута:** Метод `get_attribute_by_locator` извлекает атрибуты найденных элементов по локатору. Поддерживает как одиночные, так и множественные элементы.
    - **Отправка сообщения:** Метод `send_message` отправляет текстовое сообщение веб-элементу. Он поддерживает симуляцию ввода текста с настраиваемой скоростью и необязательным взаимодействием с мышкой.

- **Скриншоты:**
    - **Скриншот элемента:** Метод `get_webelement_as_screenshot` делает скриншот веб-элемента и возвращает его как PNG-изображение. Он поддерживает захват скриншотов нескольких элементов и обрабатывает ошибки, если элементы больше не присутствуют в DOM.

- **Действие клика:**
    - **Клик по элементу:** Метод `click` выполняет действие клика по веб-элементу, идентифицированному по локатору. Он обрабатывает случаи, когда клик приводит к переходу на новую страницу или открытию нового окна, и записывает ошибки, если клик не удался.

- **Оценивание локатора:**
    - **Оценивание атрибута:** Метод `evaluate_locator` оценивает атрибуты локатора, включая обработку особых случаев, когда атрибуты представлены как плейсхолдеры (например, `%EXTERNAL_MESSAGE%`).


## Обработка ошибок

Модуль использует блоки `try...except` для перехвата и регистрации ошибок во время различных операций, таких как поиск элементов, отправка сообщений и захват скриншотов.  Конкретные исключения, такие как `NoSuchElementException` и `TimeoutException`, перехватываются для обработки случаев отсутствия элементов или истечения времени ожидания.


## Использование

### Инициализация

Создайте экземпляр `ExecuteLocator` с экземпляром WebDriver.

### Выполнение локатора

Вызовите метод `execute_locator` со словарем локатора, чтобы выполнить действия или извлечь данные из веб-элементов.

### Обработка результатов

Используйте методы, такие как `get_webelement_by_locator`, `send_message` и `get_webelement_as_screenshot`, для взаимодействия с веб-элементами и обработки результатов.


## Зависимости

Модуль использует Selenium для операций с WebDriver, включая поиск элементов, отправку текста и взаимодействие с веб-страницами. Также используются встроенные библиотеки Python для обработки исключений и управления временем.


## Примеры использования (из предоставленного кода)

(Здесь размещаются примеры использования, адаптированные под формат Markdown, например)

```markdown
## Примеры использования класса Driver

### Создание экземпляра Chrome драйвера и навигация по URL:

```python
chrome_driver = Driver(Chrome)
if chrome_driver.get_url("https://www.example.com"):
    print("Успешно перешли на URL")
```

### Извлечение домена из URL:

```python
domain = chrome_driver.extract_domain("https://www.example.com/path/to/page")
print(f"Извлеченный домен: {domain}")
```

(и так далее, адаптируя примеры из исходного кода)

## Примечания

- Убедитесь, что установлены все необходимые зависимости (Selenium, и др.).
- Пути к файлам настроек и другим ресурсам должны быть настроены в `gs` (глобальные настройки).


```


**Важно:**  Для полной и эффективной документации необходимо дополнить примеры из исходного кода и объяснить функциональность отдельных методов класса `ExecuteLocator` в более детальном формате, подобном тому, как это сделано в разделе о `Driver` и с использованием форматирования Markdown.