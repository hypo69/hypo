# Настройки расширения TryXPath

## Обзор

Данный файл `options.js` отвечает за логику страницы настроек расширения TryXPath для браузера Firefox. Он позволяет пользователю настраивать HTML-атрибуты, используемые для работы расширения, а также стили CSS для всплывающего окна.

## Оглавление
1. [Константы](#константы)
2. [Переменные](#переменные)
3. [Функции](#функции)
    - [`isValidAttrName`](#isvalidattrname)
    - [`isValidAttrNames`](#isvalidattrnames)
    - [`isValidStyleLength`](#isvalidstylelength)
    - [`loadDefaultCss`](#loaddefaultcss)
    - [`extractBodyStyles`](#extractbodystyles)
    - [`createPopupCss`](#createpopupcss)
4. [Обработчики событий](#обработчики-событий)
    - [`window.load`](#windowload)
    - [`save.click`](#saveclick)
    - [`show-default.click`](#show-defaultclick)

## Константы
### `defaultAttributes`
**Описание**: Объект, содержащий значения атрибутов по умолчанию.
    - `element`: `"data-tryxpath-element"`.
    - `context`: `"data-tryxpath-context"`.
    - `focused`: `"data-tryxpath-focused"`.
    - `focusedAncestor`: `"data-tryxpath-focused-ancestor"`.
    - `frame`: `"data-tryxpath-frame"`.
    - `frameAncestor`: `"data-tryxpath-frame-ancestor"`.

### `defaultPopupBodyStyles`
**Описание**: Объект, содержащий стили по умолчанию для тела всплывающего окна.
    - `width`: `"367px"`.
    - `height`: `"auto"`.

## Переменные
### `elementAttr`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода атрибута element.
### `contextAttr`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода атрибута context.
### `focusedAttr`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода атрибута focused.
### `ancestorAttr`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода атрибута ancestor.
### `frameAttr`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода атрибута frame.
### `frameAncestorAttr`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода атрибута frameAncestor.
### `style`
**Описание**: Ссылка на HTML-элемент textarea, который используется для ввода CSS.
### `popupBodyWidth`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода ширины тела всплывающего окна.
### `popupBodyHeight`
**Описание**: Ссылка на HTML-элемент input, который используется для ввода высоты тела всплывающего окна.
### `message`
**Описание**: Ссылка на HTML-элемент, который используется для отображения сообщений.
### `testElement`
**Описание**: Временный элемент `div`, используемый для тестирования валидности имени атрибута.

## Функции

### `isValidAttrName`
**Описание**: Проверяет, является ли имя атрибута валидным.
    
**Параметры**:
- `name` (str): Имя атрибута для проверки.

**Возвращает**:
- `bool`: `true`, если имя атрибута валидное, иначе `false`.

### `isValidAttrNames`
**Описание**: Проверяет, являются ли все имена атрибутов в объекте валидными.
    
**Параметры**:
- `names` (Object): Объект, содержащий имена атрибутов для проверки.

**Возвращает**:
- `bool`: `true`, если все имена атрибутов валидны, иначе `false`.

### `isValidStyleLength`
**Описание**: Проверяет, является ли длина стиля CSS (ширина или высота) валидной.
    
**Параметры**:
- `len` (str): Строка, представляющая длину стиля CSS.

**Возвращает**:
- `bool`: `true`, если длина стиля валидна, иначе `false`.

### `loadDefaultCss`
**Описание**: Асинхронно загружает CSS по умолчанию из файла `try_xpath_insert.css`.

**Возвращает**:
- `Promise<string>`: Promise, который разрешается со строкой CSS, или отклоняется в случае ошибки.

### `extractBodyStyles`
**Описание**: Извлекает стили ширины и высоты из CSS.
    
**Параметры**:
- `css` (str): Строка CSS.

**Возвращает**:
- `Object`: Объект, содержащий ширину и высоту, извлеченные из CSS.

### `createPopupCss`
**Описание**: Создает строку CSS для тела всплывающего окна на основе переданных стилей.
    
**Параметры**:
- `bodyStyles` (Object): Объект, содержащий стили ширины и высоты.

**Возвращает**:
- `string`: Строка CSS.

## Обработчики событий

### `window.load`
**Описание**: Выполняет следующие действия после загрузки страницы:

    - Получает ссылки на HTML-элементы.
    - Запрашивает сохраненные настройки у расширения и устанавливает значения элементов input.
    - Добавляет обработчики событий на кнопки `save` и `show-default`.
  
### `save.click`
**Описание**: Обработчик события `click` на кнопке сохранения настроек.

    - Получает значения из HTML-элементов.
    - Проверяет валидность имен атрибутов и стилей.
    - Сохраняет настройки в `browser.storage.sync`.
    - Отображает сообщение об успехе или неудаче.

### `show-default.click`
**Описание**: Обработчик события `click` на кнопке установки значений по умолчанию.

    - Устанавливает значения атрибутов по умолчанию в соответствующих полях ввода.
    - Загружает CSS по умолчанию и устанавливает его в поле ввода стилей.
    - Устанавливает значения ширины и высоты всплывающего окна по умолчанию.