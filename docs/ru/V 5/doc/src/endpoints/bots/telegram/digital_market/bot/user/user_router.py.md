# Модуль `user_router`

## Обзор

Модуль `user_router` содержит обработчики для различных пользовательских действий в Telegram-боте цифрового магазина. Он включает в себя обработку команды `/start`, навигацию по страницам "О магазине" и "Мой профиль", а также отображение информации о покупках пользователя.

## Подробней

Этот модуль является частью Telegram-бота для цифрового рынка и отвечает за обработку запросов, связанных с пользователем, таких как регистрация, просмотр профиля и истории покупок. Он использует библиотеку `aiogram` для обработки входящих сообщений и `CallbackQuery`, а также взаимодействует с базой данных через `UserDAO` для получения информации о пользователях и их покупках.

## Функции

### `cmd_start`

```python
async def cmd_start(message: Message, session_with_commit: AsyncSession):
    """
    Обрабатывает команду `/start`.

    Args:
        message (Message): Объект сообщения от пользователя.
        session_with_commit (AsyncSession): Асинхровая сессия SQLAlchemy для работы с базой данных с возможностью коммита изменений.

    Returns:
        Awaitable[Message]: Отправляет приветственное сообщение с клавиатурой главного меню.

    Raises:
        Нет.

    Example:
        Пример вызова:
        Пользователь отправляет команду /start боту.
    """
```

**Как работает функция**:
Функция `cmd_start` обрабатывает команду `/start`, которую пользователь отправляет боту. Она проверяет, зарегистрирован ли пользователь в базе данных. Если пользователь зарегистрирован, функция отправляет приветственное сообщение с клавиатурой главного меню. Если пользователь не зарегистрирован, функция регистрирует его в базе данных и отправляет приветственное сообщение с клавиатурой главного меню.

**Параметры**:
- `message` (Message): Объект сообщения от пользователя, содержащий информацию об отправителе и текст сообщения.
- `session_with_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для работы с базой данных с возможностью коммита изменений.

**Возвращает**:
- `Awaitable[Message]`: Отправляет приветственное сообщение с клавиатурой главного меню.

**Вызывает исключения**:
- Нет.

**Примеры**:
Пример вызова:
Пользователь отправляет команду /start боту.

### `page_home`

```python
async def page_home(call: CallbackQuery):
    """
    Обрабатывает нажатие кнопки "Домой".

    Args:
        call (CallbackQuery): Объект обратного вызова от нажатия кнопки.

    Returns:
        Awaitable[Message]: Отправляет сообщение с главным меню.

    Raises:
        Нет.

    Example:
        Пользователь нажимает кнопку "Домой" в боте.
    """
```

**Как работает функция**:
Функция `page_home` обрабатывает нажатие кнопки "Домой". Она отправляет сообщение с главным меню пользователю.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова от нажатия кнопки, содержащий информацию о пользователе и данные, связанные с кнопкой.

**Возвращает**:
- `Awaitable[Message]`: Отправляет сообщение с главным меню.

**Вызывает исключения**:
- Нет.

**Примеры**:
Пользователь нажимает кнопку "Домой" в боте.

### `page_about`

```python
async def page_about(call: CallbackQuery):
    """
    Обрабатывает нажатие кнопки "О магазине".

    Args:
        call (CallbackQuery): Объект обратного вызова от нажатия кнопки.

    Returns:
        Awaitable[Message]: Отправляет сообщение с информацией о магазине.

    Raises:
        Нет.

    Example:
        Пользователь нажимает кнопку "О магазине" в боте.
    """
```

**Как работает функция**:
Функция `page_about` обрабатывает нажатие кнопки "О магазине". Она отправляет сообщение с информацией о магазине пользователю.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова от нажатия кнопки, содержащий информацию о пользователе и данные, связанные с кнопкой.

**Возвращает**:
- `Awaitable[Message]`: Отправляет сообщение с информацией о магазине.

**Вызывает исключения**:
- Нет.

**Примеры**:
Пользователь нажимает кнопку "О магазине" в боте.

### `page_about`

```python
async def page_about(call: CallbackQuery, session_without_commit: AsyncSession):
    """
    Обрабатывает нажатие кнопки "Мой профиль".

    Args:
        call (CallbackQuery): Объект обратного вызова от нажатия кнопки.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для работы с базой данных без возможности коммита изменений.

    Returns:
        Awaitable[Message]: Отправляет сообщение с информацией о профиле пользователя.

    Raises:
        Нет.

    Example:
        Пользователь нажимает кнопку "Мой профиль" в боте.
    """
```

**Как работает функция**:
Функция `page_about` обрабатывает нажатие кнопки "Мой профиль". Она получает статистику покупок пользователя из базы данных и отправляет сообщение с информацией о профиле пользователя.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова от нажатия кнопки, содержащий информацию о пользователе и данные, связанные с кнопкой.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для работы с базой данных без возможности коммита изменений.

**Возвращает**:
- `Awaitable[Message]`: Отправляет сообщение с информацией о профиле пользователя.

**Вызывает исключения**:
- Нет.

**Примеры**:
Пользователь нажимает кнопку "Мой профиль" в боте.

### `page_user_purchases`

```python
async def page_user_purchases(call: CallbackQuery, session_without_commit: AsyncSession):
    """
    Обрабатывает нажатие кнопки "Мои покупки".

    Args:
        call (CallbackQuery): Объект обратного вызова от нажатия кнопки.
        session_without_commit (AsyncSession): Асинхровая сессия SQLAlchemy для работы с базой данных без возможности коммита изменений.

    Returns:
        Awaitable[Message]: Отправляет сообщения с информацией о покупках пользователя.

    Raises:
        Exception: Если не удается удалить предыдущее сообщение.

    Example:
        Пользователь нажимает кнопку "Мои покупки" в боте.
    """
```

**Как работает функция**:
Функция `page_user_purchases` обрабатывает нажатие кнопки "Мои покупки". Она получает список покупок пользователя из базы данных и отправляет сообщения с информацией о каждой покупке.

**Параметры**:
- `call` (CallbackQuery): Объект обратного вызова от нажатия кнопки, содержащий информацию о пользователе и данные, связанные с кнопкой.
- `session_without_commit` (AsyncSession): Асинхровая сессия SQLAlchemy для работы с базой данных без возможности коммита изменений.

**Возвращает**:
- `Awaitable[Message]`: Отправляет сообщения с информацией о покупках пользователя.

**Вызывает исключения**:
- `Exception`: Если не удается удалить предыдущее сообщение.

**Примеры**:
Пользователь нажимает кнопку "Мои покупки" в боте.