# Модуль `html2text`

## Обзор

Модуль `html2text` предназначен для преобразования HTML-документов в эквивалентный текст, структурированный с использованием Markdown. Поддерживает различные HTML-теги и атрибуты, обеспечивая форматирование текста, списков, ссылок и изображений в формате Markdown.

## Содержание

- [Функции](#Функции)
- [Класс `_html2text`](#Класс-_html2text)
- [Класс `Storage`](#Класс-Storage)

## Функции

### `has_key(x, y)`

**Описание**: Проверяет наличие ключа `y` в словаре `x`.

**Параметры**:
- `x` (dict): Словарь для проверки.
- `y` (any): Ключ, который нужно проверить.

**Возвращает**:
- `bool`: `True`, если ключ `y` присутствует в словаре `x`, иначе `False`.

### `name2cp(k)`

**Описание**: Возвращает кодовую точку символа по имени HTML-сущности.

**Параметры**:
- `k` (str): Имя HTML-сущности.

**Возвращает**:
- `int`: Кодовая точка символа.

**Вызывает исключения**:
- `KeyError`: Если сущность `k` не найдена.

### `charref(name)`

**Описание**: Возвращает символ по числовому коду HTML-сущности.

**Параметры**:
- `name` (str): Числовой код HTML-сущности.

**Возвращает**:
- `str`: Символ, соответствующий числовому коду.

### `entityref(c)`

**Описание**: Возвращает символ по имени HTML-сущности или исходную строку, если сущность не найдена.

**Параметры**:
- `c` (str): Имя HTML-сущности.

**Возвращает**:
- `str`: Символ, соответствующий имени HTML-сущности, или исходная строка, если сущность не найдена.

**Вызывает исключения**:
- `KeyError`: Если сущность `c` не найдена.

### `replaceEntities(s)`

**Описание**: Заменяет HTML-сущности в строке `s` соответствующими символами.

**Параметры**:
- `s` (re.Match): Объект совпадения регулярного выражения, содержащий HTML-сущность.

**Возвращает**:
- `str`: Символ, соответствующий HTML-сущности.

### `unescape(s)`

**Описание**: Преобразует HTML-сущности в строке `s` в соответствующие символы.

**Параметры**:
- `s` (str): Строка с HTML-сущностями.

**Возвращает**:
- `str`: Строка с замененными HTML-сущностями.

### `onlywhite(line)`

**Описание**: Проверяет, состоит ли строка `line` только из пробельных символов.

**Параметры**:
- `line` (str): Строка для проверки.

**Возвращает**:
- `bool`: `True`, если строка `line` состоит только из пробельных символов, иначе `False`.

### `optwrap(text)`

**Описание**: Переносит строки в тексте `text` на новую строку, если они превышают заданную ширину `BODY_WIDTH`.

**Параметры**:
- `text` (str): Текст для переноса строк.

**Возвращает**:
- `str`: Текст с перенесенными строками.

**Вызывает исключения**:
- `AssertionError`: Если `wrap` не существует (требуется Python 2.3 или выше).

### `hn(tag)`

**Описание**: Извлекает уровень заголовка из HTML-тега `tag` (например, `h1`, `h2`).

**Параметры**:
- `tag` (str): HTML-тег.

**Возвращает**:
- `int | None`: Числовое значение уровня заголовка (от 1 до 9) или `None`, если тег не является заголовком.

### `dumb_property_dict(style)`

**Описание**: Преобразует строку CSS-стилей `style` в словарь атрибутов.

**Параметры**:
- `style` (str): Строка CSS-стилей.

**Возвращает**:
- `dict`: Словарь атрибутов CSS.

### `dumb_css_parser(data)`

**Описание**: Преобразует строку CSS-данных `data` в словарь селекторов CSS, каждый из которых содержит словарь атрибутов.

**Параметры**:
- `data` (str): Строка CSS-данных.

**Возвращает**:
- `dict`: Словарь селекторов CSS и их атрибутов.

### `element_style(attrs, style_def, parent_style)`

**Описание**: Возвращает словарь стилей для элемента, комбинируя стили из атрибутов элемента, определения стилей и стилей родительского элемента.

**Параметры**:
- `attrs` (dict): Словарь атрибутов элемента.
- `style_def` (dict): Словарь определений стилей.
- `parent_style` (dict): Словарь стилей родительского элемента.

**Возвращает**:
- `dict`: Словарь стилей элемента.

### `google_list_style(style)`

**Описание**: Определяет, является ли список упорядоченным или неупорядоченным, на основе CSS-стилей `style`.

**Параметры**:
- `style` (dict): Словарь CSS-стилей.

**Возвращает**:
- `str`: `'ul'`, если список неупорядоченный, `'ol'` в противном случае.

### `google_nest_count(style)`

**Описание**: Вычисляет уровень вложенности списка Google Docs на основе CSS-стилей `style`.

**Параметры**:
- `style` (dict): Словарь CSS-стилей.

**Возвращает**:
- `int`: Уровень вложенности списка.

### `google_has_height(style)`

**Описание**: Проверяет, определен ли атрибут `height` в CSS-стилях `style`.

**Параметры**:
- `style` (dict): Словарь CSS-стилей.

**Возвращает**:
- `bool`: `True`, если атрибут `height` определен, иначе `False`.

### `google_text_emphasis(style)`

**Описание**: Возвращает список модификаторов выделения текста (например, `italic`, `bold`) из CSS-стилей `style`.

**Параметры**:
- `style` (dict): Словарь CSS-стилей.

**Возвращает**:
- `list`: Список модификаторов выделения текста.

### `google_fixed_width_font(style)`

**Описание**: Проверяет, определен ли шрифт фиксированной ширины в CSS-стилях `style`.

**Параметры**:
- `style` (dict): Словарь CSS-стилей.

**Возвращает**:
- `bool`: `True`, если шрифт фиксированной ширины определен, иначе `False`.

### `list_numbering_start(attrs)`

**Описание**: Извлекает начальный номер списка из атрибутов элемента `attrs`.

**Параметры**:
- `attrs` (dict): Словарь атрибутов элемента.

**Возвращает**:
- `int`: Начальный номер списка или `0`, если атрибут `start` не задан.

### `html2text_file(html, out=wrapwrite, baseurl='')`

**Описание**: Преобразует HTML-код `html` в текст Markdown и записывает результат с помощью функции `out`.

**Параметры**:
- `html` (str): HTML-код для преобразования.
- `out` (function, optional): Функция для записи результата. По умолчанию `wrapwrite`.
- `baseurl` (str, optional): Базовый URL для преобразования относительных ссылок. По умолчанию `''`.

**Возвращает**:
- `str`: Преобразованный текст.

### `html2text(html, baseurl='')`

**Описание**: Преобразует HTML-код `html` в текст Markdown с переносом строк.

**Параметры**:
- `html` (str): HTML-код для преобразования.
- `baseurl` (str, optional): Базовый URL для преобразования относительных ссылок. По умолчанию `''`.

**Возвращает**:
- `str`: Преобразованный текст с переносом строк.

### `wrapwrite(text)`

**Описание**: Записывает текст `text` в стандартный поток вывода (с обработкой ошибок кодирования).

**Параметры**:
- `text` (str): Текст для записи.

## Класс `_html2text`

**Описание**: Класс, реализующий парсинг HTML и преобразование его в Markdown.

**Методы**:
- `__init__(self, out=None, baseurl='')`: Инициализирует парсер.
- `feed(self, data)`: Подает HTML-данные для обработки.
- `outtextf(self, s)`: Записывает строку в выходной список.
- `close(self)`: Завершает обработку и возвращает результат.
- `handle_charref(self, c)`: Обрабатывает числовую HTML-сущность.
- `handle_entityref(self, c)`: Обрабатывает именованную HTML-сущность.
- `handle_starttag(self, tag, attrs)`: Обрабатывает открывающий HTML-тег.
- `handle_endtag(self, tag)`: Обрабатывает закрывающий HTML-тег.
- `previousIndex(self, attrs)`: Возвращает индекс ссылки в списке ссылок.
- `drop_last(self, nLetters)`: Удаляет последние `nLetters` символов из выходного текста.
- `handle_emphasis(self, start, tag_style, parent_style)`: Обрабатывает выделение текста.
- `handle_tag(self, tag, attrs, start)`: Обрабатывает HTML-тег.
- `pbr(self)`: Управляет переводом строки.
- `p(self)`: Управляет выводом пустых строк.
- `soft_br(self)`: Управляет выводом мягкого переноса строки.
- `o(self, data, puredata=0, force=0)`: Выводит данные в выходной поток.
- `handle_data(self, data)`: Обрабатывает текстовые данные.
- `unknown_decl(self, data)`: Обрабатывает неизвестные объявления (пустой метод).

## Класс `Storage`

**Описание**: Пустой класс для хранения опций.