# Анализ кода модуля e_218.md

**Качество кода**
9
-  Плюсы
    - Код содержит подробное описание задачи Project Euler.
    -  Описание задачи четкое и понятное.
-  Минусы
    -  Отсутствует программный код.
    -  Нет примеров кода на Python для решения задачи.
    -  Не хватает комментариев в формате reStructuredText.

**Рекомендации по улучшению**
1.  Добавить программный код на Python для решения задачи.
2.  Реализовать функции для проверки, является ли число совершенным и для генерации пифагоровых троек.
3.  Обеспечить документирование всех функций и переменных в стиле reStructuredText.
4.  Включить примеры использования функций.
5.  Добавить логирование для отладки и обработки ошибок.
6.  Улучшить читаемость кода, используя осмысленные имена переменных и функций.

**Оптимизированный код**
```markdown
# Задача No 218
## Совершенные пифагоровы треугольники
"""
Модуль для решения задачи 218 Project Euler,
находящий количество совершенных пифагоровых треугольников.

Задача заключается в поиске количества примитивных пифагоровых троек (a, b, c),
где a < b < c, a² + b² = c², c <= 100,000,000, и хотя бы одна из сторон a, b, c
является совершенным числом.

Совершенное число - это число, равное сумме своих собственных делителей.
Первые четыре совершенные числа: 6, 28, 496 и 8128.
"""

## Условия

Рассмотрим прямоугольный треугольник со сторонами *a*, *b* и *c*, где *a*, *b* и *c* — целые числа, образующие пифагорову тройку (т.е. *a*² + *b*² = *c*²).

Если длина одной из сторон треугольника является совершенным числом, мы будем называть такой треугольник совершенным пифагоровым треугольником.

Например, треугольник со сторонами {3, 4, 5} не является совершенным, так как ни одна из его сторон не является совершенным числом.

Треугольник со сторонами {6, 8, 10} является совершенным, так как 6 — совершенное число.

Далее будем считать, что *a* < *b* < *c* и что *a*, *b* и *c* попарно взаимно простые.

Известно, что количество примитивных пифагоровых троек со стороной *c* ≤ 100 000 000 равно 15 391 376.

Сколько среди них совершенных пифагоровых треугольников?

<br>
**Примечание**:

Совершенное число — это положительное целое число, равное сумме своих собственных делителей (все делители, кроме самого числа).
Например, 6 = 1 + 2 + 3.

Первые четыре совершенных числа: 6, 28, 496 и 8128.
"""
from typing import List, Tuple
from math import gcd
from src.logger.logger import logger
from src.utils.jjson import j_loads

# TODO:  Добавить файл с совершенными числами для повышения производительности.
# TODO: Пример добавления файла
#       {
#         "perfect_numbers": [6, 28, 496, 8128]
#       }


def is_perfect(n: int) -> bool:
    """
    Проверяет, является ли число совершенным.

    :param n: Проверяемое число.
    :return: True, если число совершенное, иначе False.
    """
    if n <= 1:
        return False
    sum_divisors = 1
    for i in range(2, int(n**0.5) + 1):
        if n % i == 0:
            sum_divisors += i
            if i != n // i:
                sum_divisors += n // i
    return sum_divisors == n

def generate_primitive_pythagorean_triples(limit: int) -> List[Tuple[int, int, int]]:
    """
    Генерирует примитивные пифагоровы тройки, у которых гипотенуза не превышает заданный предел.

    :param limit: Максимальное значение гипотенузы.
    :return: Список примитивных пифагоровых троек.
    """
    triples = []
    m = 2
    while True:
        for n in range(1, m):
            if (m - n) % 2 == 1 and gcd(m, n) == 1:
                a = m * m - n * n
                b = 2 * m * n
                c = m * m + n * n
                if c > limit:
                    break
                triples.append((min(a, b), max(a, b), c)) # код добавляет кортеж с отсортированными a и b
        m += 1
        if m * m + (m - 1) * (m - 1) > limit:
            break
    return triples


def find_perfect_pythagorean_triangles(limit: int) -> int:
    """
    Находит количество совершенных пифагоровых треугольников с гипотенузой не больше заданного предела.

    :param limit: Максимальное значение гипотенузы.
    :return: Количество совершенных пифагоровых треугольников.
    """
    perfect_count = 0
    #TODO:  Использовать j_loads для загрузки совершенных чисел, если это необходимо.
    # with open('perfect_numbers.json', 'r') as f:
    #   perfect_numbers = j_loads(f).get('perfect_numbers')
    #   if not perfect_numbers:
    #        logger.error('Не удалось загрузить совершенные числа.')
    #        return 0
    triples = generate_primitive_pythagorean_triples(limit)
    for a, b, c in triples:
        if is_perfect(a) or is_perfect(b) or is_perfect(c):  # код проверяет, является ли какая-либо из сторон совершенным числом
            perfect_count += 1
    return perfect_count

def main():
    """
    Основная функция для запуска решения.
    """
    limit = 100_000_000
    try:
        count = find_perfect_pythagorean_triangles(limit)
        print(f"Количество совершенных пифагоровых треугольников с c <= {limit}: {count}")
    except Exception as e:
      logger.error(f"Произошла ошибка: {e}")

if __name__ == "__main__":
    main()
```