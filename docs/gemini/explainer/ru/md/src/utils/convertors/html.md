# Модуль `hypotez/src/utils/convertors/html.py`

Этот модуль предоставляет функции для конвертации HTML в различные форматы, включая escape-последовательности, словари и объекты `SimpleNamespace`. Также присутствует функция для конвертации HTML в PDF с использованием библиотеки WeasyPrint.

**Функции:**

* **`html2escape(input_str: str) -> str`**: Преобразует HTML-теги в escape-последовательности (например, `<` в `&lt;`). Использует функцию `StringFormatter.escape_html_tags`.

* **`escape2html(input_str: str) -> str`**: Преобразует escape-последовательности обратно в HTML-теги. Использует функцию `StringFormatter.unescape_html_tags`.

* **`html2dict(html_str: str) -> Dict[str, str]`**: Преобразует HTML в словарь, где ключами являются теги, а значениями — содержимое тегов.  Использует класс `HTMLToDictParser`, производный от `HTMLParser`.

* **`html2ns(html_str: str) -> SimpleNamespace`**: Преобразует HTML в объект `SimpleNamespace`, где теги являются атрибутами, а содержимое тегов — значениями атрибутов.  Использует функцию `html2dict`.

* **`html2pdf(html_str: str, pdf_file: str | Path) -> bool | None`**: Преобразует HTML в PDF-файл с использованием библиотеки `WeasyPrint`.
   - Возвращает `True`, если конвертация успешна.
   - Возвращает `None`, если произошла ошибка. Обработка исключений, возникающих при работе с WeasyPrint, реализована.


**Класс `HTMLToDictParser`**:

Внутренний класс, наследуемый от `HTMLParser`, предназначенный для обработки HTML и преобразования его в словарь.  Методы `handle_starttag`, `handle_endtag` и `handle_data` собирают информацию о тегах и их содержимом, помещая результат в словарь `self.result`.


**Обработка ошибок:**

Функция `html2pdf` содержит блок `try...except`, который перехватывает исключения, возникающие при работе с WeasyPrint, и выводит сообщение об ошибке в консоль.  Это важно для обработки возможных проблем во время конвертации HTML в PDF.

**Комментарии и документация:**

Код содержит подробные документационные строки (`"""Docstring"""`) для каждой функции, описывающие их назначение, входные и выходные параметры, а также примеры использования. Это способствует лучшему пониманию и использованию кода.

**Зависимости:**

Код использует несколько библиотек:

* `re` (для регулярных выражений)
* `typing`
* `pathlib`
* `venv` (вероятно, для логирования)
* `src.utils.string` (для обработки строк)
* `src.logger` (для логирования)
* `html.parser` (для обработки HTML)
* `xhtml2pdf` (для конвертации в PDF)
* `weasyprint` (для конвертации в PDF)

Необходимо убедиться, что все необходимые библиотеки установлены.


**Комментарии по коду:**

* Комментарии по коду помогают в понимании логики и назначений отдельных фрагментов.
* Вместо `# ...` рекомендуется использовать подробную документацию (`"""Docstring"""`), чтобы описать функции более точно.
* Неиспользуемые функции (например, `html2pdf` версия с `xhtml2pdf`) нужно убирать или комментировать.
* Необходимо обработать ситуацию, когда `pdf_file` является не валидным путем.


В целом, код хорошо структурирован, имеет понятную логику и подробную документацию.  Обработка ошибок и использование библиотек `WeasyPrint` в `html2pdf` делают его более надежным и практичным.