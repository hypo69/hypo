# Объяснение кода send_data.js

Этот JavaScript-код предназначен для сбора информации о загруженной веб-странице (заголовок, URL, содержимое) и отправки её на сервер по адресу `http://127.0.0.1/hypotez.online/api/` методом POST.

**Функция `onPageLoad`:**

```javascript
function onPageLoad() {
    // Собираем информацию о странице
    var title = document.title;
    var url = window.location.href;
    var body = document.body.innerHTML;
```

Эта часть кода получает заголовок страницы (`document.title`), текущий URL (`window.location.href`) и HTML-код содержимого страницы (`document.body.innerHTML`).  Эти данные собираются для дальнейшей обработки и отправки.

```javascript
    // Формируем объект с данными для отправки
    var data = {
        title: title,
        url: url,
        body: body
    };
```

Полученная информация собирается в JavaScript-объект `data`. Это позволяет организовать данные в структурированный формат, удобный для отправки на сервер.

```javascript
    // Отправляем данные на указанный адрес
    fetch('http://127.0.0.1/hypotez.online/api/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
```

Здесь происходит отправка данных на сервер с использованием `fetch API`.
* `method: 'POST'` - указывает, что данные отправляются методом POST.
* `headers: {'Content-Type': 'application/json'}` - указывает, что данные отправляются в формате JSON.  Важно для корректной обработки серверной частью.
* `body: JSON.stringify(data)` - данные преобразуются в строку JSON перед отправкой.

```javascript
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(json => {
        console.log('Response:', json);
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
```

Этот блок обрабатывает ответ от сервера:

* `.then(response => ...)` -  Обрабатывает ответ от сервера. Если ответ не успешный (например, сервер вернул ошибку), то генерируется ошибка.
* `.then(json => ...)` - Если ответ успешный, то  `response.json()` преобразует ответ в JSON-объект.  Далее,  логгируется полученный ответ в консоль.
* `.catch(error => ...)` - Обрабатывает ошибки при выполнении запроса.  Выводятся ошибки в консоль.


**Функция `window.addEventListener('load', onPageLoad);`:**

Эта строка добавляет обработчик события `load` к объекту `window`. Это значит, что функция `onPageLoad` будет вызвана, как только страница полностью загрузится.  Это гарантирует, что данные будут собраны и отправлены, когда вся необходимая информация будет доступна.

**В заключение:**

Код отправляет данные о загруженной веб-странице на сервер `http://127.0.0.1/hypotez.online/api/` в формате JSON. Сервер, в свою очередь, должен быть готов обработать этот входящий JSON и вернуть ответ, который будет отображен в консоли браузера. Важно обратить внимание на обработку ошибок (`.catch`) - она крайне необходима для надежного функционирования.