# Модуль для работы с PDF файлами

## Обзор

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Этот модуль предназначен для работы с PDF файлами. Он предоставляет функции для преобразования HTML-контента или файлов в PDF, а также для преобразования PDF файлов в HTML. Модуль использует несколько библиотек для выполнения этих задач, включая `pdfkit`, `FPDF`, `WeasyPrint`, `xhtml2pdf` и `pdfminer.six`.

## Содержание

- [Описание](#описание)
- [Ключевые особенности](#ключевые-особенности)
- [Структура модуля](#структура-модуля)
    - [Импорты](#импорты)
    - [Функция `set_project_root`](#функция-set_project_root)
    - [Класс `PDFUtils`](#класс-pdfutils)
- [Методы класса PDFUtils](#методы-класса-pdfutils)
    - [Методы для создания PDF](#методы-для-создания-pdf)
    - [Методы для преобразования PDF](#методы-для-преобразования-pdf)
- [Примеры использования](#примеры-использования)
    - [Преобразование HTML в PDF](#преобразование-html-в-pdf)
    - [Преобразование PDF в HTML](#преобразование-pdf-в-html)
- [Зависимости](#зависимости)
- [Примечания](#примечания)
- [Ссылки](#ссылки)
- [Автор](#автор)
- [Лицензия](#лицензия)

## Ключевые особенности

1.  **Конвертация HTML в PDF**:
    -   Использует библиотеку `pdfkit` для преобразования HTML-контента или файлов в PDF.
    -   Поддерживает как HTML-строки, так и файлы.

2.  **Создание PDF из текста**:
    -   Использует библиотеку `FPDF` для создания PDF файлов из текста.
    -   Поддерживает добавление пользовательских шрифтов через файл `fonts.json`.

3.  **Конвертация HTML в PDF с использованием WeasyPrint**:
    -   Использует библиотеку `WeasyPrint` для создания PDF файлов из HTML-контента или файлов.

4.  **Конвертация HTML в PDF с использованием xhtml2pdf**:
    -   Использует библиотеку `xhtml2pdf` для создания PDF файлов из HTML-контента или файлов.

5.  **Конвертация PDF в HTML**:
    -   Использует библиотеку `pdfminer.six` для извлечения текста из PDF файлов и создания HTML файлов.

## Структура модуля

### Импорты

Модуль использует следующие библиотеки:

-   `pdfkit`: Для преобразования HTML в PDF.
-   `FPDF`: Для создания PDF файлов из текста.
-   `WeasyPrint`: Для преобразования HTML в PDF с сохранением стилей.
-   `xhtml2pdf`: Альтернатива для преобразования HTML в PDF.
-   `pdfminer.six`: Для извлечения текста из PDF файлов.
-   `pathlib`: Для работы с путями к файлам.
-   `json`: Для загрузки конфигурации шрифтов.
-   `src.logger.logger`: Пользовательский логгер для записи сообщений.
-   `src.utils.printer`: Пользовательский модуль для вывода информации.

### Функция `set_project_root`

Эта функция определяет корневой каталог проекта на основе наличия маркерных файлов, таких как `pyproject.toml`, `requirements.txt` или `.git`. Это позволяет модулю работать независимо от текущего местоположения файла.

### Класс `PDFUtils`

Класс `PDFUtils` содержит статические методы для работы с PDF файлами:

## Методы класса PDFUtils

### Методы для создания PDF

-   **`save_pdf_pdfkit`**: Преобразует HTML-контент или файлы в PDF с использованием библиотеки `pdfkit`.
-   **`save_pdf_fpdf`**: Создает PDF файл из текста с использованием библиотеки `FPDF`. Поддерживает добавление пользовательских шрифтов.
-   **`save_pdf_weasyprint`**: Преобразует HTML-контент или файлы в PDF с использованием библиотеки `WeasyPrint`.
-   **`save_pdf_xhtml2pdf`**: Преобразует HTML-контент или файлы в PDF с использованием библиотеки `xhtml2pdf`.

### Методы для преобразования PDF

-   **`pdf_to_html`**: Преобразует PDF файл в HTML файл, извлекая текст с использованием библиотеки `pdfminer.six`.

## Примеры использования

### Преобразование HTML в PDF

```python
from src.utils.pdf import PDFUtils

html_content = "<h1>Пример HTML</h1><p>Это текст.</p>"
pdf_file = "output.pdf"

success = PDFUtils.save_pdf_pdfkit(html_content, pdf_file)
if success:
    print("PDF успешно создан.")
else:
    print("Ошибка при создании PDF.")
```

### Преобразование PDF в HTML

```python
from src.utils.pdf import PDFUtils

pdf_file = "example.pdf"
html_file = "example.html"

success = PDFUtils.pdf_to_html(pdf_file, html_file)
if success:
    print("HTML успешно создан.")
else:
    print("Ошибка при преобразовании PDF в HTML.")
```

## Зависимости

Для использования этого модуля необходимо установить следующие библиотеки:

-   `pdfkit`
-   `FPDF`
-   `WeasyPrint`
-   `xhtml2pdf`
-   `pdfminer.six`

Установка через `pip`:

```bash
pip install pdfkit fpdf weasyprint xhtml2pdf pdfminer.six
```

## Примечания

-   Библиотека `pdfkit` требует установки инструмента `wkhtmltopdf`. Путь к исполняемому файлу указывается в переменной `wkhtmltopdf_exe`.
-   При использовании `FPDF` файл `fonts.json` должен присутствовать в каталоге `assets/fonts`, содержащем информацию о шрифтах.

## Ссылки

-   [Документация pdfkit](https://pypi.org/project/pdfkit/)
-   [Документация FPDF](https://pyfpdf.github.io/fpdf2/)
-   [Документация WeasyPrint](https://weasyprint.org/)
-   [Документация xhtml2pdf](https://xhtml2pdf.readthedocs.io/)
-   [Документация pdfminer.six](https://pdfminersix.readthedocs.io/)

## Автор

Автор модуля: [Ваше имя]

## Лицензия

Этот модуль распространяется под [укажите лицензию, если есть].