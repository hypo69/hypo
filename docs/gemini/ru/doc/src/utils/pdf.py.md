# Модуль `pdf`

## Обзор

Модуль `pdf` предназначен для преобразования HTML-контента или файлов в PDF с использованием различных библиотек. Он поддерживает работу с `pdfkit`, `FPDF`, `WeasyPrint` и `xhtml2pdf`, предоставляя гибкий интерфейс для создания PDF-документов.

## Оглавление

- [Обзор](#обзор)
- [Функции](#функции)
  - [`set_project_root`](#set_project_root)
- [Классы](#классы)
  - [`PDFUtils`](#pdfutils)
    - [`save_pdf_pdfkit`](#save_pdf_pdfkit)
    - [`save_pdf_fpdf`](#save_pdf_fpdf)
    - [`save_pdf_weasyprint`](#save_pdf_weasyprint)
    - [`save_pdf_xhtml2pdf`](#save_pdf_xhtml2pdf)
    - [`html2pdf`](#html2pdf)

## Функции

### `set_project_root`

**Описание**: Находит корневой каталог проекта, начиная с каталога текущего файла, и останавливается на первом каталоге, содержащем любой из указанных маркерных файлов.

**Параметры**:
- `marker_files` (tuple): Кортеж имен файлов или каталогов, которые идентифицируют корень проекта. По умолчанию `('pyproject.toml', 'requirements.txt', '.git')`.

**Возвращает**:
- `Path`: Путь к корневому каталогу, если он найден, иначе каталог, где расположен скрипт.

## Классы

### `PDFUtils`

**Описание**: Класс для работы с PDF-файлами, предоставляющий методы для сохранения HTML-контента в PDF с использованием различных библиотек.

#### `save_pdf_pdfkit`

**Описание**: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `pdfkit`.

**Параметры**:
- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True`, если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `pdfkit.PDFKitError`: Ошибка генерации PDF через `pdfkit`.
- `OSError`: Ошибка доступа к файлу.
- `Exception`: Неожиданная ошибка.

#### `save_pdf_fpdf`

**Описание**: Сохраняет текст в PDF с использованием библиотеки FPDF.

**Параметры**:
- `data` (str): Текст, который необходимо сохранить в PDF.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True`, если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `FileNotFoundError`: Если не найден файл шрифтов или файл шрифта.
- `Exception`: Ошибка при сохранении PDF через FPDF.

#### `save_pdf_weasyprint`

**Описание**: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `WeasyPrint`.

**Параметры**:
- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True`, если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `Exception`: Ошибка при сохранении PDF через WeasyPrint.

#### `save_pdf_xhtml2pdf`

**Описание**: Сохраняет HTML-контент или файл в PDF с использованием библиотеки `xhtml2pdf`.

**Параметры**:
- `data` (str | Path): HTML-контент или путь к HTML-файлу.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool`: `True`, если PDF успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `Exception`: Ошибка при сохранении PDF через xhtml2pdf или ошибка компиляции PDF.

#### `html2pdf`

**Описание**: Преобразует HTML-контент в PDF-файл, используя WeasyPrint.

**Параметры**:
- `html_str` (str): HTML-контент для преобразования.
- `pdf_file` (str | Path): Путь к сохраняемому PDF-файлу.

**Возвращает**:
- `bool | None`: `True`, если PDF успешно создан, иначе `None`.

**Вызывает исключения**:
- `Exception`: Ошибка во время генерации PDF.