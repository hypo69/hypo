# Модуль запуска Telegram-бота для работы с фильмами
## Обзор

Модуль `run.py` является точкой входа для запуска Telegram-бота, предназначенного для работы с фильмами. Он инициализирует и запускает бота, используя библиотеку `aiogram` и другие необходимые компоненты.

## Подробнее

Этот модуль отвечает за запуск Telegram-бота, настройку логирования, регистрацию обработчиков и запуск процесса обработки входящих сообщений. Он использует переменные окружения для получения токена бота и настраивает промежуточное ПО для ограничения скорости обработки сообщений.

## Функции

### `main`

```python
async def main() -> None:
    """
    Запускает Telegram-бота, регистрирует обработчики и запускает процесс обработки входящих сообщений.

    Args:
        None

    Returns:
        None

    Raises:
        None

    """
```

**Назначение**:
Функция `main` является асинхронной и выполняет основные шаги по инициализации и запуску Telegram-бота.

**Как работает функция**:

1. **Инициализация бота**: Создается экземпляр класса `Bot` из библиотеки `aiogram` с использованием токена, полученного из переменных окружения (`os.getenv('TOKEN')`).
2. **Регистрация middleware**: Добавляется промежуточное программное обеспечение (`ThrottlingMiddleware`) для ограничения скорости обработки сообщений. Это помогает предотвратить злоупотребления и защитить бота от перегрузки.
3. **Регистрация роутера**: Включается роутер (`router`) для обработки сообщений. Роутер содержит набор обработчиков, которые определяют, как бот должен реагировать на различные типы сообщений.
4. **Запуск поллинга**: Запускается процесс поллинга (`dp.start_polling(bot)`), который отвечает за получение и обработку входящих сообщений от пользователей Telegram.

**Примеры**:

```python
async def main() -> None:
    bot = Bot(os.getenv('TOKEN'))
    dp.message.middleware(ThrottlingMiddleware())
    dp.include_router(router)
    await dp.start_polling(bot)
```

### `__main__`

```python
if __name__ == "__main__":
    """
    Настраивает логирование и запускает асинхронную функцию `main`.

    Args:
        None

    Returns:
        None

    Raises:
        None

    """
```

**Назначение**:
Этот блок кода выполняется только при запуске скрипта напрямую (а не при импорте как модуля). Он настраивает логирование и запускает основную функцию `main` в асинхронном режиме.

**Как работает функция**:

1. **Настройка логирования**: Используется функция `logging.basic_colorized_config` из библиотеки `betterlogging` для настройки логирования. Указывается уровень логирования (`logging.INFO`), формат сообщений и формат даты.
2. **Запуск асинхронной функции**: Используется функция `asyncio.run` для запуска асинхронной функции `main`. Это позволяет боту работать в асинхронном режиме, что необходимо для эффективной обработки множества одновременных запросов.

**Примеры**:

```python
if __name__ == "__main__":
    logging.basic_colorized_config(
        level=logging.INFO,
        format='%(asctime)s - [%(levelname)s] - %(name)s - '
               '(%(filename)s).%(funcName)s(%(lineno)d) - %(message)s',
        datefmt='%H:%M:%S'
    )
    asyncio.run(main())