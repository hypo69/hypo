# Модуль `hypotez/src/ai/openai/model/training.py`

## Обзор

Данный модуль предоставляет класс `OpenAIModel` для взаимодействия с API OpenAI, обработки диалогов, обучения и управления моделями.  Модуль содержит функции для загрузки моделей и помощников, отправки запросов, анализа тональности, динамического обучения и обучения моделей на предоставленных данных.


## Классы

### `OpenAIModel`

**Описание**: Класс `OpenAIModel` предоставляет интерфейс для взаимодействия с API OpenAI и управления моделями. Он хранит информацию о текущих сессиях,  диалоге,  и настройках.

**Атрибуты**:

- `model`:  Название модели OpenAI (по умолчанию `gpt-4o-mini`).
- `client`: Объект `OpenAI` для взаимодействия с API.
- `current_job_id`:  Идентификатор текущей работы обучения.
- `assistant_id`:  Идентификатор помощника OpenAI.
- `assistant`:  Объект помощника OpenAI.
- `thread`:  Объект диалоговой сессии OpenAI.
- `system_instruction`:  Системная инструкция для модели.
- `dialogue_log_path`: Путь к файлу для сохранения диалога.
- `dialogue`: Список словарей, содержащих сообщения в диалоге.
- `assistants`: Список помощников.
- `models_list`: Список доступных моделей.

**Методы**:

#### `__init__(self, system_instruction=None, model_name='gpt-4o-mini', assistant_id=None)`

**Описание**: Инициализирует объект `OpenAIModel`.

**Аргументы**:
- `system_instruction` (строка, необязательно): Системная инструкция для модели.
- `model_name` (строка, необязательно): Имя модели (по умолчанию `gpt-4o-mini`).
- `assistant_id` (строка, необязательно): Идентификатор помощника OpenAI.

**Возвращает**:
- `None`

#### `list_models(self) -> List[str]`

**Описание**: Возвращает список доступных моделей OpenAI.

**Возвращает**:
- `List[str]`: Список идентификаторов моделей.

#### `list_assistants(self) -> List[str]`

**Описание**: Загружает список доступных помощников из файла `assistants.json`.

**Возвращает**:
- `List[str]`: Список имен помощников.

#### `set_assistant(self, assistant_id: str)`

**Описание**: Устанавливает помощника с указанным `assistant_id`.

**Аргументы**:
- `assistant_id` (строка): Идентификатор помощника.


**Возвращает**:
- `None`

#### `_save_dialogue(self)`

**Описание**: Сохраняет диалог в файл.

**Возвращает**:
- `None`

#### `determine_sentiment(self, message: str) -> str`

**Описание**: Определяет тональность сообщения (положительная, отрицательная или нейтральная).

**Аргументы**:
- `message` (строка): Сообщение для анализа.

**Возвращает**:
- `str`: Тональность сообщения (`'positive'`, `'negative'`, или `'neutral'`).


#### `ask(self, message: str, system_instruction=None, attempts=3) -> str`

**Описание**: Отправляет сообщение модели и возвращает ответ, а также анализ тональности.

**Аргументы**:
- `message` (строка): Сообщение для отправки модели.
- `system_instruction` (строка, необязательно): Системная инструкция.
- `attempts` (целое число, необязательно): Количество попыток повторного запроса.


**Возвращает**:
- `str`: Ответ модели.

#### `describe_image(self, image_path: str | Path, prompt=None, system_instruction=None) -> str`

**Описание**: Описывает изображение с помощью модели OpenAI.

**Аргументы**:
- `image_path` (строка или Path): Путь к изображению.
- `prompt` (строка, необязательно): Приглашение к пользователю.
- `system_instruction` (строка, необязательно): Системная инструкция.

**Возвращает**:
- `str`: Описание изображения.


#### `describe_image_by_requests(self, image_path: str | Path, prompt=None) -> str`

**Описание**: Описывает изображение используя requests библиотеку.

**Аргументы**:
- `image_path` (строка или Path): Путь к изображению.
- `prompt` (строка, необязательно): Приглашение к пользователю.

**Возвращает**:
- `str`: Описание изображения.



#### `dynamic_train(self)`

**Описание**: Выполняет динамическое обучение модели на основе предыдущих диалогов.


**Возвращает**:
- `None`

#### `train(self, data=None, data_dir=None, data_file=None, positive=True) -> str | None`

**Описание**: Обучает модель на предоставленных данных.

**Аргументы**:
- `data` (строка, необязательно): Путь к CSV файлу или CSV строка с данными.
- `data_dir` (Path или строка, необязательно): Директория с CSV файлами.
- `data_file` (Path или строка, необязательно): Путь к одному CSV файлу.
- `positive` (булево, необязательно): Признак положительности данных.

**Возвращает**:
- `str` или `None`: Идентификатор работы обучения или `None` при ошибке.

#### `save_job_id(self, job_id: str, description: str, filename="job_ids.json")`

**Описание**: Сохраняет идентификатор работы обучения с описанием в файл.

**Аргументы**:
- `job_id` (строка): Идентификатор работы обучения.
- `description` (строка): Описание работы обучения.
- `filename` (строка, необязательно): Имя файла для сохранения.



## Функции

### `main()`

**Описание**: Главная функция для инициализации `OpenAIModel` и демонстрации использования.

**Возвращает**:
- `None`