```markdown
# combined-stream

A stream that emits multiple other streams one after another.

**Important Note:**  The `combined-stream` package currently only supports Node.js streams version 1.  Development is underway to transition to streams2.  Contributions are welcome!  Meanwhile, consider alternatives like [combined-stream2](https://www.npmjs.com/package/combined-stream2) or [multistream](https://www.npmjs.com/package/multistream) for streams2 compatibility.


## Installation

```bash
npm install combined-stream
```

## Usage

This example combines two text files into a single output file:

```javascript
const CombinedStream = require('combined-stream');
const fs = require('fs');

const combinedStream = CombinedStream.create();
combinedStream.append(fs.createReadStream('file1.txt'));
combinedStream.append(fs.createReadStream('file2.txt'));

combinedStream.pipe(fs.createWriteStream('combined.txt'));
```

This example demonstrates *back-pressure* handling.  The streams are paused until needed, which is the default behavior.  If you don't want this pause and want source streams to start immediately, use `pauseStreams: false`:


```javascript
const CombinedStream = require('combined-stream');
const fs = require('fs');

const combinedStream = CombinedStream.create({ pauseStreams: false });
combinedStream.append(fs.createReadStream('file1.txt'));
combinedStream.append(fs.createReadStream('file2.txt'));

combinedStream.pipe(fs.createWriteStream('combined.txt'));
```

**Asynchronous Stream Appending:**

If you don't have all the source streams available immediately or want to avoid loading resources upfront, use a callback:

```javascript
const CombinedStream = require('combined-stream');
const fs = require('fs');

const combinedStream = CombinedStream.create();
combinedStream.append((next) => {
  next(fs.createReadStream('file1.txt'));
});
combinedStream.append((next) => {
  next(fs.createReadStream('file2.txt'));
});

combinedStream.pipe(fs.createWriteStream('combined.txt'));
```

## API

### `CombinedStream.create([options])`

Creates a new combined stream object.

*   `options.maxDataSize`: Maximum buffer size (bytes). Defaults to 2MB. Exceeding this will trigger an error.
*   `options.pauseStreams`: Whether to pause underlying streams. Defaults to `true`.  Setting to `false` disables automatic pausing.


### `combinedStream.pauseStreams`

A boolean indicating whether underlying streams are automatically paused. Defaults to `true`.

### `combinedStream.maxDataSize`

The maximum buffer size in bytes. Defaults to 2MB.

### `combinedStream.dataSize`

The current buffer size in bytes.

### `combinedStream.append(stream)`

Appends a stream to the combined stream.  Can also be a function that takes a `next` callback, allowing for asynchronous stream acquisition.


*   Special case:  `stream` can also be a string or Buffer, which are treated as streams emitting the data.


`combinedStream` automatically attaches an error listener to each appended stream.

### `combinedStream.write(data)`

**Do not call directly.**  `combinedStream` handles piping automatically.

### `combinedStream.resume()`

Starts processing appended streams. Idempotent. Emits a 'resume' event.

### `combinedStream.pause()`

Pauses processing.  Has no effect if `pauseStreams` is `false`.  Emits a 'pause' event.

### `combinedStream.end()`

Sets the stream to non-writable, emits 'end', and removes all streams.

### `combinedStream.destroy()`

Similar to `end()`, but emits a 'close' event.

## License

MIT License
```
