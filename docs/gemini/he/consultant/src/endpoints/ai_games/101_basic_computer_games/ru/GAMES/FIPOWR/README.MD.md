# Анализ кода модуля `FIPOWR`

**Качество кода**
-  Соответствие требованиям к формату кода (1-10): 7
    -  **Преимущества:**
        - Код игры достаточно прост и понятен, логика игры четко прослеживается.
        - Используется функция для расчета чисел Фибоначчи, что делает код более структурированным.
        -  Обработка исключений при вводе пользователя.
        -  Есть подробные комментарии, объясняющие логику работы кода.
        -  Документация в формате RST.
    -   **Недостатки:**
        -   Не используются `j_loads` или `j_loads_ns` для чтения файлов (в данном случае это не требуется, так как нет чтения файлов).
        -   Нет импорта `logger` для логирования ошибок.
        -   Некоторые комментарии в коде написаны не в формате RST.
        -   Использование `while True` может быть заменено более явным условием выхода из цикла.

**Рекомендации по улучшению**

1.  Импортировать `logger` для логирования ошибок.
2.  Заменить комментарии в коде на формат RST.
3.  Улучшить условия выхода из цикла while, сделав их более явными.
4.  Добавить docstring к функциям.
5.  Уточнить текст сообщений для пользователя, чтобы сделать игру более интуитивной.

**Улучшенный код**

```python
"""
Модуль для игры "Фибоначчи в степени"
====================================

Модуль представляет собой игру, в которой пользователь должен угадать число,
полученное возведением случайно выбранного числа в степень числа Фибоначчи.

Описание игры
-------------
Компьютер выбирает случайное число от 1 до 100.
Игрок вводит число. Компьютер возводит выбранное число в степень числа Фибоначчи,
соответствующего номеру попытки, и сравнивает с числом пользователя.
Игра продолжается, пока числа не будут равны.

Пример использования
--------------------
Запустите данный скрипт, и следуйте инструкциям в консоли.

.. code-block:: python

    python fipowr.py
"""

import random
from src.logger.logger import logger # импортируем logger для логирования #
# Функция для вычисления числа Фибоначчи
def fibonacci(n: int) -> int:
    """
    Вычисляет n-е число Фибоначчи.

    :param n: Порядковый номер числа Фибоначчи.
    :type n: int
    :return: n-е число Фибоначчи.
    :rtype: int

    Пример:
    >>> fibonacci(0)
    0
    >>> fibonacci(1)
    1
    >>> fibonacci(5)
    5
    """
    if n <= 0:
        return 0
    elif n == 1:
        return 1
    else:
        a, b = 0, 1
        for _ in range(2, n + 1):
            a, b = b, a + b
        return b

# Инициализация счетчика попыток
numberOfGuesses = 0 # Инициализация счетчика попыток #
# Генерируем случайное число от 1 до 100
targetNumber = random.randint(1, 100) # генерируем случайное число от 1 до 100 #
is_guessed = False # флаг для выхода из цикла #

# Основной игровой цикл
while not is_guessed: # Основной игровой цикл, пока число не угадано #
    # Увеличиваем количество попыток
    numberOfGuesses += 1 # увеличиваем количество попыток #
    # Вычисляем число Фибоначчи для текущей попытки
    fibonacciNumber = fibonacci(numberOfGuesses) # вычисляем число Фибоначчи для текущей попытки #
    # Возводим загаданное число в степень числа Фибоначчи
    poweredNumber = targetNumber ** fibonacciNumber # возводим загаданное число в степень числа Фибоначчи #

    # Запрашиваем ввод числа у пользователя
    try:
        userGuess = int(input(f"Попытка {numberOfGuesses}: Введите число: ")) # Запрашиваем ввод числа у пользователя #
    except ValueError as e: # обрабатываем ошибки ввода #
        logger.error(f'Ошибка ввода: {e}') # логируем ошибку #
        print("Пожалуйста, введите целое число.") # выводим сообщение об ошибке #
        continue # переходим к следующей итерации #

    # Проверяем, угадано ли число
    if userGuess == poweredNumber: # проверяем, угадано ли число #
        print(f"ПОЗДРАВЛЯЮ! Вы угадали число за {numberOfGuesses} попыток!") # выводим сообщение о победе #
        is_guessed = True # устанавливаем флаг в True для выхода из цикла #
    else: # если число не угадано #
        print("Попробуйте ещё раз!") # выводим сообщение о необходимости попробовать еще раз #


"""
Объяснение кода:
1.  **Импорт модуля `random` и `logger`**::
   -  `import random`: Импортирует модуль `random`, который используется для генерации случайного числа.
   - `from src.logger.logger import logger`: Импортирует logger для логирования ошибок.
2.  **Функция `fibonacci(n)`**::
    -   Определяет функцию `fibonacci(n)`, которая вычисляет n-е число Фибоначчи.
    -   Использует итеративный подход для расчета чисел Фибоначчи.
    -   Добавлен docstring в формате RST.
3.  **Инициализация переменных**::
    -   `numberOfGuesses = 0`: Инициализирует переменную `numberOfGuesses` для подсчета попыток игрока.
    -   `targetNumber = random.randint(1, 100)`: Генерирует случайное целое число в диапазоне от 1 до 100 и сохраняет его в `targetNumber`.
    -   `is_guessed = False`:  Флаг для выхода из цикла.
4. **Основной цикл `while not is_guessed:`**::
    - Цикл продолжается до тех пор, пока игрок не угадает число.
    - `numberOfGuesses += 1`: Увеличивает счетчик попыток на 1 при каждом новом витке цикла.
    - `fibonacciNumber = fibonacci(numberOfGuesses)`: Вызывает функцию `fibonacci` для получения числа Фибоначчи, соответствующего текущей попытке.
    - `poweredNumber = targetNumber ** fibonacciNumber`: Вычисляет загаданное число в степени числа Фибоначчи.
    - **Ввод данных**::
       - `try...except ValueError`: Блок try-except обрабатывает возможные ошибки ввода. Если пользователь введет не целое число, то будет выведено сообщение об ошибке.
       - `logger.error(f'Ошибка ввода: {e}')`: Логирует ошибку ввода.
       - `userGuess = int(input(f"Попытка {numberOfGuesses}: Введите число: "))`: Запрашивает у пользователя число и преобразует его в целое число, сохраняя результат в `userGuess`.
    - **Условие победы**::
      -  `if userGuess == poweredNumber:`: Проверяет, равно ли введенное число вычисленному значению.
      -  `print(f"ПОЗДРАВЛЯЮ! Вы угадали число за {numberOfGuesses} попыток!")`: Выводит сообщение о победе и количестве попыток.
      - `is_guessed = True`: устанавливаем флаг в True для выхода из цикла.
    -  **Подсказка**::
       - `else:`: Если число не угадано, выводится сообщение "Попробуйте еще раз!".
"""
```