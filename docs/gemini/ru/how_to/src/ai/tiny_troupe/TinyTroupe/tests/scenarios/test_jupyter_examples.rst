Как использовать этот блок кода
========================================================================================

Описание
-------------------------
Этот код предназначен для выполнения Jupyter ноутбуков и проверки их на отсутствие ошибок. Он итерируется по списку Jupyter ноутбуков в заданной папке, выполняет каждый ноутбук с заданным таймаутом и ядром, а затем сохраняет выполненную копию.  Если во время выполнения возникает ошибка, тест завершается с ошибкой.

Шаги выполнения
-------------------------
1. **Импортирует необходимые библиотеки:** `os`, `nbformat`, `ExecutePreprocessor` из `nbconvert`, `pytest`, `sys`.
2. **Добавляет пути к родительским директориям:**  `sys.path.insert(0, ...)` -  необходимо для корректного импорта пакета `tinytroupe` из родительских директорий.
3. **Определяет переменные:** `NOTEBOOK_FOLDER` - путь к папке с ноутбуками, `TIMEOUT` - таймаут для выполнения ноутбуков (в секундах), `KERNEL_NAME` - имя ядра Jupyter (например, "python3").
4. **Функция `get_notebooks(folder)`:** Получает список путей к Jupyter ноутбукам в указанной папке, исключая файлы с определенными суффиксами ('.executed.', '.local.').
5. **Декоратор `@pytest.mark.parametrize`:** Итерируется по списку ноутбуков, полученному из функции `get_notebooks`.
6. **Функция `test_notebook_execution(notebook_path)`:**
    - Открывает Jupyter ноутбук для чтения.
    - Выводит информацию о выполняемом ноутбуке.
    - Создает экземпляр `ExecutePreprocessor` с заданным таймаутом и именем ядра.
    - **Обработка исключений:** Пробует выполнить ноутбук с помощью `ep.preprocess`. Если возникает исключение, выводит сообщение об ошибке и использует `pytest.fail` для прекращения теста.
    - **Сохранение выполненного ноутбука:** Сохраняет выполненную копию ноутбука с добавленным суффиксом ".executed.local" в ту же папку. Выводит информацию о сохраненном файле.
    - **Обработка завершения:** В `finally` блоке выполняется сохранение, независимо от того, было исключение или нет.


Пример использования
-------------------------
.. code-block:: python

    import os
    import nbformat
    from nbconvert.preprocessors import ExecutePreprocessor
    import pytest
    
    # ... (Код из примера, включая функции get_notebooks и test_notebook_execution)

    # Пример вызова функции, которая запускает тесты:
    # Должен быть файл examples/my_notebook.ipynb, и папка examples
    # должна существовать.
    pytest.main(['-v', '--disable-warnings', 'test_jupyter_examples.py'])