# Модуль options.js

## Обзор

Этот модуль JavaScript отвечает за обработку и сохранение настроек расширения tryxpath. Он предоставляет интерфейс для пользователя, позволяющий изменить параметры, такие как атрибуты, CSS и размеры всплывающего окна.  Модуль взаимодействует с хранилищем браузера для сохранения настроек и с сервисным сообщением для получения начальных значений.

## Функции

### `isValidAttrName`

**Описание**: Проверяет, является ли имя атрибута валидным.

**Параметры**:
- `name` (string): Имя атрибута.

**Возвращает**:
- `boolean`: `true`, если имя атрибута валидно, `false` иначе.

**Вызывает исключения**:
- `Error`: Возникает в случае внутренних ошибок обработки атрибута.


### `isValidAttrNames`

**Описание**: Проверяет, являются ли все имена атрибутов валидными.

**Параметры**:
- `names` (object): Объект, содержащий имена атрибутов.

**Возвращает**:
- `boolean`: `true`, если все имена атрибутов валидны, `false` иначе.

**Вызывает исключения**:
- Нет


### `isValidStyleLength`

**Описание**: Проверяет, является ли значение длины стиля (например, ширины или высоты) валидным.

**Параметры**:
- `len` (string): Значение длины стиля.

**Возвращает**:
- `boolean`: `true`, если значение длины стиля валидно (формат "числоpx" или "auto"), `false` иначе.

**Вызывает исключения**:
- Нет


### `loadDefaultCss`

**Описание**: Загружает CSS-стили по умолчанию из файла.

**Параметры**:
- Нет

**Возвращает**:
- `Promise<string>`:  Promise, который разрешается с текстом загруженного CSS или отклоняется с ошибкой.

**Вызывает исключения**:
- `Error`: Возникает в случае ошибок при загрузке файла.


### `extractBodyStyles`

**Описание**: Извлекает значения ширины и высоты из CSS-строки.

**Параметры**:
- `css` (string): Строка CSS.

**Возвращает**:
- `object`: Объект, содержащий `width` и `height`.  Возвращает пустые строки, если в CSS нет корректных значений.

**Вызывает исключения**:
- Нет


### `createPopupCss`

**Описание**: Создает CSS-строку для стиля всплывающего окна.

**Параметры**:
- `bodyStyles` (object): Объект с `width` и `height`.

**Возвращает**:
- `string`: CSS-строка для всплывающего окна.

**Вызывает исключения**:
- Нет


### <Функции обработки событий и запросов>

**Описание**:  Функции для обработки событий `load`, `click` на элементах и сообщений из контекста расширения.
Все функции в этом разделе являются внутренними и взаимодействуют с элементами DOM и хранилищем браузера.

**Вызывают исключения**:
- `Error`
- Внутри функций вызываются функции `fu.onError` и обработчики ошибок в `.then`.


## Переменные

Описание переменных с пояснениями типов данных и назначения.

* `defaultAttributes`, `defaultPopupBodyStyles` - константы с настройками по умолчанию.
* `elementAttr`, `contextAttr`, `focusedAttr`, `ancestorAttr`, `frameAttr`, `frameAncestorAttr`, `style`, `popupBodyWidth`, `popupBodyHeight`, `message`, `testElement` - переменные, содержащие ссылки на элементы DOM.
* `tx`, `fu` - алиасы на глобальные переменные модуля `tryxpath`.

## Обработка исключений

В коде используются блоки `try...catch` для перехвата исключений.  Обработка исключений (`fu.onError`) выполняет заданную логику в случае ошибки.