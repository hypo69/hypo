# Модуль extraction

## Обзор

Этот модуль предоставляет инструменты для структурированной обработки данных, полученных из симуляций TinyTroupe. Он позволяет извлекать ключевые моменты из истории взаимодействия агентов, генерировать синтетические данные для обучения машинных моделей, а также преобразовывать данные в машиночитаемые форматы (например, JSON или CSV). Модуль демонстрирует разницу между агентными симуляциями и AI-помощниками, поскольку последние не предназначены для интроспекции таким образом.

## Классы

### `ResultsExtractor`

**Описание**: Класс `ResultsExtractor` отвечает за извлечение результатов из агентов и миров TinyTroupe. Он кэширует результаты извлечения, что позволяет использовать их для генерации отчетов и других дополнительных выходов.

**Методы**:

- `extract_results_from_agent`:
    **Описание**: Извлекает результаты из экземпляра `TinyPerson`.
    **Параметры**:
        - `tinyperson` (TinyPerson): Экземпляр `TinyPerson`, для которого необходимо извлечь результаты.
        - `extraction_objective` (str): Цель извлечения.
        - `situation` (str): Ситуация, которую следует учитывать.
        - `fields` (list, optional): Список полей для извлечения. Если `None`, извлекатель сам определяет имена.
        - `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.
    **Возвращает**:
        - `dict | None`: Результаты извлечения в формате словаря или `None`, если произошла ошибка.
    **Вызывает исключения**:
        - Нет

- `extract_results_from_world`:
    **Описание**: Извлекает результаты из экземпляра `TinyWorld`.
    **Параметры**:
        - `tinyworld` (TinyWorld): Экземпляр `TinyWorld`, для которого необходимо извлечь результаты.
        - `extraction_objective` (str): Цель извлечения.
        - `situation` (str): Ситуация, которую следует учитывать.
        - `fields` (list, optional): Список полей для извлечения. Если `None`, извлекатель сам определяет имена.
        - `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.
    **Возвращает**:
        - `dict | None`: Результаты извлечения в формате словаря или `None`, если произошла ошибка.
    **Вызывает исключения**:
        - Нет

- `save_as_json`:
    **Описание**: Сохраняет последние результаты извлечения в формате JSON.
    **Параметры**:
        - `filename` (str): Имя файла для сохранения JSON.
        - `verbose` (bool, optional): Выводить ли сообщения отладки. По умолчанию `False`.
    **Возвращает**:
        - Нет
    **Вызывает исключения**:
        - Нет


### `ResultsReducer`

**Описание**: Класс `ResultsReducer` отвечает за сокращение полученных результатов.

**Методы**:

- `add_reduction_rule`:
    **Описание**: Добавляет правило сокращения.
    **Параметры**:
        - `trigger` (str): Спонсор правила сокращения.
        - `func` (callable): Функция, которая выполняет сокращение.
    **Возвращает**:
        - Нет
    **Вызывает исключения**:
        - `Exception`: Если правило для `trigger` уже существует.

- `reduce_agent`:
    **Описание**: Сокращает данные агента.
    **Параметры**:
        - `agent` (TinyPerson): Агент для сокращения.
    **Возвращает**:
        - `list`: Список сокращенных данных.
    **Вызывает исключения**:
        - Нет

- `reduce_agent_to_dataframe`:
    **Описание**: Преобразует сокращенные данные агента в DataFrame Pandas.
    **Параметры**:
        - `agent` (TinyPerson): Агент для сокращения.
        - `column_names` (list, optional): Имена столбцов DataFrame. По умолчанию `None`.
    **Возвращает**:
        - `pd.DataFrame`: DataFrame Pandas с сокращенными данными.
    **Вызывает исключения**:
        - Нет

### `ArtifactExporter`

**Описание**: Класс `ArtifactExporter` отвечает за экспорт артефактов из TinyTroupe.

**Методы**:

- `export`:
    **Описание**: Экспортирует заданные данные артефакта в файл.
    **Параметры**:
        - `artifact_name` (str): Название артефакта.
        - `artifact_data` (Union[dict, str]): Данные артефакта (словарь или строка).
        - `content_type` (str): Тип содержимого.
        - `content_format` (str, optional): Формат содержимого.
        - `target_format` (str): Целевой формат экспорта (e.g., json, txt, docx, etc).
        - `verbose` (bool, optional): Выводить ли сообщения отладки.
    **Возвращает**:
        - Нет
    **Вызывает исключения**:
        - `ValueError`: Если данные артефакта не являются строкой или словарем.

- `_export_as_txt`:
- `_export_as_json`:
- `_export_as_docx`:


### `Normalizer`

**Описание**: Класс `Normalizer` предназначен для нормализации текстовых элементов.

**Методы**:

- `__init__`:
    **Описание**: Инициализирует нормализатор.
    **Параметры**:
        - `elements` (list): Элементы для нормализации.
        - `n` (int): Количество элементов для нормализации.
        - `verbose` (bool, optional): Выводить ли сообщения отладки.
    **Возвращает**:
        - Нет
    **Вызывает исключения**:
        - Нет

- `normalize`:
    **Описание**: Нормализует элемент или список элементов.
    **Параметры**:
        - `element_or_elements` (Union[str, List[str]]): Элемент или список элементов.
    **Возвращает**:
        - str | list: Нормализованный элемент или список элементов.
    **Вызывает исключения**:
        - `ValueError`: Если входной параметр не является строкой или списком.



## Функции

(Список функций и их описаний будет добавлен, если они есть в файле)

```