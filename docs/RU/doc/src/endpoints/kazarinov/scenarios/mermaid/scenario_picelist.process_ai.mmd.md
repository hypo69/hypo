# Диаграмма последовательности обработки прайс-листа с использованием AI

## Обзор

Данная диаграмма последовательности описывает процесс взаимодействия между пользователем, AI-моделью и логгером при обработке списка продуктов (price list) с помощью AI. Она охватывает различные сценарии, включая успешную обработку, отсутствие ответа от модели, невалидные данные и ошибки в структуре данных.

## Участники

- **User**: Пользователь, инициирующий запрос и получающий результаты.
- **AI_Model**: AI-модель, обрабатывающая запрос и предоставляющая ответы.
- **Logger**: Система логирования, фиксирующая ошибки и проблемы в процессе обработки.

## Последовательность действий

### Инициация запроса

1.  **User -> AI_Model:** Пользователь отправляет запрос на обработку списка продуктов (`products_list`) в AI-модель.

### Обработка запроса AI-моделью

2.  **AI_Model -> AI_Model:** AI-модель обрабатывает запрос, используя свою команду.

3.  **AI_Model -> User:** AI-модель отправляет ответ пользователю.

### Обработка ответа AI-модели

#### Сценарий отсутствия ответа

- **alt Нет ответа от модели**
    4. **Logger -> Logger:** Логгируется ошибка "no response from gemini".
    5.  **User -> AI_Model:** Пользователь повторяет запрос (попытки уменьшаются на 1).
- **end**

#### Сценарий невалидных данных

- **alt Невалидные данные (data)**
    6.  **Logger -> Logger:** Логгируется ошибка "Error in data from gemini".
    7.  **User -> AI_Model:** Пользователь повторяет запрос (попытки уменьшаются на 1).
- **end**

#### Сценарий получения данных

- **alt Получены данные (data)**

    - **alt Данные в виде списка**
       - **alt Два элемента (ru, he)**
           8. **User -> User:** Извлекаются значения `ru` и `he` из списка.
        - **end**

        - **alt Один элемент**
           9. **User -> User:** Извлекаются значения `ru` и `he` из первого элемента списка.
        - **end**

        - **alt Невалидная структура данных**
            10. **Logger -> Logger:** Логгируется ошибка "Проблема парсинга ответа".
            11. **User -> AI_Model:** Пользователь повторяет запрос (попытки уменьшаются на 1).
        - **end**
    - **end**

    - **alt Данные в виде объекта**
        12. **User -> User:** Извлекаются значения `ru` и `he` из объекта.
    - **end**

    - **alt Невалидные значения (ru или he)**
        13. **Logger -> Logger:** Логгируется ошибка "Invalid ru or he data".
        14. **User -> AI_Model:** Пользователь повторяет запрос (попытки уменьшаются на 1).
    - **end**

    15. **User -> User:** Возврат результата значений `ru` и `he`.
- **end**