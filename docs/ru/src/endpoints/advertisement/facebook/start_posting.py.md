# Модуль отправки рекламных объявлений в Facebook

## Обзор

Модуль `src.endpoints.advertisement.facebook.start_posting` предназначен для автоматической отправки рекламных объявлений в группы Facebook. Он использует Selenium WebDriver для взаимодействия с веб-интерфейсом Facebook и модуль `FacebookPromoter` для управления процессом публикации.

## Подробней

Данный модуль является частью системы автоматизации маркетинга `hypotez`. Он позволяет настраивать и запускать рекламные кампании в Facebook, ориентируясь на различные группы пользователей и интересы. Модуль предназначен для работы как на Windows, так и на Unix платформах.

## Классы

### `FacebookPromoter`

**Описание**: Класс `FacebookPromoter` отвечает за управление процессом публикации рекламных объявлений в группах Facebook.

**Как работает класс**:
Класс инициализируется с драйвером веб-браузера и списками путей к файлам групп. Он использует эти данные для поиска и публикации объявлений в соответствующих группах Facebook.

Сделай документацию для КАЖДОЙ функции или метода. Объясни назначение каждой переменной.
- Все комментарии и docstring должны быть на русском языке в формате UTF-8. Если в оригинальном коде текст написан на английском - переводи его на русский

**Методы**:
- `run_campaigns`: Запускает рекламные кампании на основе предоставленных параметров.

## Функции

В данном модуле функции отсутствуют.

## Переменные

- `d`: Инстанс драйвера `Chrome`, используемый для управления браузером и взаимодействия с Facebook.

- `filenames`: Список имен файлов, содержащих информацию о группах Facebook, в которые будут отправляться объявления.

- `excluded_filenames`: Список имен файлов, которые исключаются из списка `filenames` для отправки объявлений.

- `campaigns`: Список рекламных кампаний, которые будут запущены.

- `promoter`: Объект класса `FacebookPromoter`, используемый для запуска рекламных кампаний.

## Цикл `while True`

**Описание**: Основной цикл, в котором происходит запуск рекламных кампаний.

**Как работает функция**:
1.  Запускает рекламные кампании, используя метод `run_campaigns` объекта `promoter`.
2.  Выводит в консоль текущее время, чтобы показать, что кампания работает.
3.  Приостанавливает выполнение программы на 180 секунд (3 минуты).

## Блок `try...except`

**Описание**: Блок обработки исключений для прерывания работы рекламной кампании.

**Как работает функция**:
1.  Блок `try` содержит основной цикл работы рекламной кампании.
2.  Блок `except KeyboardInterrupt` перехватывает исключение, возникающее при нажатии клавиш `Ctrl+C` в консоли.
3.  При возникновении исключения `KeyboardInterrupt` выводит сообщение в лог о том, что продвижение кампании было прервано.

```python
try:
    while True:
        
        promoter.run_campaigns(campaigns = copy.copy(campaigns), group_file_paths = filenames)
        print(f"Going sleep {time.localtime}")
        time.sleep(180)
        ...

        
except KeyboardInterrupt as ex:
    logger.info("Campaign promotion interrupted.")
```

## Модуль `FacebookPromoter`

**Описание**: Класс для управления рекламными кампаниями в Facebook.

**Как работает класс**:\
Инкапсулирует логику для запуска рекламных кампаний в Facebook, используя предоставленный драйвер и списки групп.

### `FacebookPromoter.run_campaigns`

```python
def run_campaigns(campaigns: list[str], group_file_paths: list[str]):
    """Запускает рекламные кампании в Facebook.

    Args:
        campaigns (list[str]): Список названий кампаний для запуска.
        group_file_paths (list[str]): Список путей к файлам с информацией о группах Facebook.

    Raises:
        Exception: Если возникает ошибка в процессе выполнения кампании.
    """
    ...
```

**Назначение**: Запускает цикл рекламных кампаний, перебирая указанные группы и кампании.

**Как работает функция**:

1.  **Инициализация**: Получает списки групп и кампаний.
2.  **Перебор групп**: Итерируется по каждой группе из списка групп.
3.  **Запуск кампании для группы**: Для каждой группы запускает цикл перебора кампаний, отправляя рекламные сообщения.
4.  **Обработка ошибок**: Ловит исключения, которые могут возникнуть в процессе выполнения кампании, и логирует их.

**Параметры**:

*   `campaigns` (list\[str]): Список названий кампаний для запуска.
*   `group_file_paths` (list\[str]): Список путей к файлам с информацией о группах Facebook.

**Возвращает**:

*   `None`

**Вызывает исключения**:

*   `Exception`: Если возникает ошибка в процессе выполнения кампании.

**Примеры**:

```python
promoter.run_campaigns(campaigns=['brands', 'mom_and_baby'], group_file_paths=['usa.json', 'he_ils.json'])
```

## Пример использования

```python
from src.webdriver.driver import Driver, Chrome
from src.endpoints.advertisement.facebook import FacebookPromoter

# Создание инстанса драйвера (пример с Chrome)
driver = Driver(Chrome)
driver.get_url("https://facebook.com")

filenames: list[str] = ["usa.json", "he_ils.json"]
campaigns: list[str] = ['brands', 'mom_and_baby']

promoter = FacebookPromoter(driver, group_file_paths=filenames, no_video=True)

try:
    promoter.run_campaigns(campaigns=campaigns, group_file_paths=filenames)
except KeyboardInterrupt as ex:
    print("Campaign promotion interrupted.")