# Анализ кода модуля e_360.md

**Качество кода: 7/10**

*   **Плюсы:**
    *   Код решает поставленную задачу, предоставляя корректные результаты.
    *   Алгоритм достаточно понятен и логически структурирован.
    *   Код содержит комментарии, объясняющие основные шаги решения задачи.
    *   Присутствует блок-схема, которая наглядно описывает алгоритм.
*   **Минусы:**
    *   Отсутствуют docstring для функций, что снижает читаемость и понимание кода.
    *   В коде не используется логирование ошибок, что затрудняет отладку и анализ проблем.
    *   Импорт `math` не нужен, так как используется только `math.sqrt` для проверки целого числа, и можно это реализовать через `z*z == z_squared`.
    *   Имеется некоторая избыточность в комментариях (например, повторение действий, которые и так понятны из кода)
    *   Перебор `y` начинается с `x` чтобы избежать повторений, но условие `z < y` для пропуска дубликатов введено неверно.

**Рекомендации по улучшению:**

1.  Добавить docstring для функций `count_lattice_points` и `sum_lattice_points` в формате reStructuredText (RST).
2.  Использовать `logger.error` для логирования возможных ошибок в процессе выполнения программы.
3.  Оптимизировать код, убрав лишний импорт и переписав проверку на целое число.
4.  Переработать комментарии, чтобы они были более информативными и соответствовали стандарту RST.
5.  Уточнить условие `z < y` для пропуска дубликатов.
6.  Добавить проверки типов и валидацию входных данных, чтобы сделать код более надежным.

**Оптимизированный код**

```python
"""
Модуль для решения задачи Project Euler #360: Сфера, покрывающая точки решетки
==============================================================================

Этот модуль содержит функции для расчета количества точек решетки (точек с целыми
координатами) на сферах с центром в начале координат и суммирования этих точек
для заданного диапазона радиусов.

Функции:
    - count_lattice_points(radius): Подсчитывает количество точек решетки на сфере с заданным радиусом.
    - sum_lattice_points(limit): Вычисляет сумму точек решетки для всех радиусов до заданного предела.

Пример использования
--------------------

.. code-block:: python

    result = sum_lattice_points(100)
    print(result)

    result = sum_lattice_points(int(10**8))
    print(result)
"""
from src.logger.logger import logger


def count_lattice_points(radius: int) -> int:
    """
    Подсчитывает количество точек решетки на сфере заданного радиуса.

    :param radius: Радиус сферы.
    :type radius: int
    :return: Количество точек решетки на сфере.
    :rtype: int
    """
    count = 0
    r_squared = radius * radius
    # Перебираем значения x от 0 до radius
    for x in range(radius + 1):
        # Перебираем значения y от x до radius
        for y in range(x, radius + 1):
            z_squared = r_squared - x * x - y * y
            # Проверяем, что z_squared неотрицательно
            if z_squared >= 0:
                z = int(z_squared**0.5)
                # Проверяем, является ли z целым числом, сравнивая квадрат z и z_squared
                if z * z == z_squared:
                    # Пропускаем дубликаты. Нужно проверять, чтобы z не было меньше x
                    if z < x:
                        continue
                    # Вычисляем количество вариантов для текущих координат
                    distinct = 1
                    if x != 0:
                        distinct *= 2
                    if y != 0:
                        distinct *= 2
                    if z != 0:
                        distinct *= 2

                    count += distinct
    return count


def sum_lattice_points(limit: int) -> int:
    """
    Вычисляет сумму точек решетки для всех радиусов до заданного предела.

    :param limit: Верхняя граница радиусов.
    :type limit: int
    :return: Сумма точек решетки для всех радиусов.
    :rtype: int
    """
    total_count = 0
    # Цикл перебирает радиусы от 1 до limit включительно.
    for r in range(1, limit + 1):
        # Код суммирует количество точек на каждой сфере.
        total_count += count_lattice_points(r)
    return total_count


# Пример использования:
if __name__ == '__main__':
    try:
        result = sum_lattice_points(100)
        print(result)
        result = sum_lattice_points(int(10**8))
        print(result)
    except Exception as e:
      logger.error(f"Произошла ошибка при выполнении: {e}", exc_info=True)
```