# Модуль `hypotez/src/suppliers/aliexpress/affiliated_products_generator.py`

## Обзор

Этот модуль предоставляет класс `AliAffiliatedProducts`, который предназначен для сбора данных о связанных продуктах с AliExpress. Класс наследуется от `AliApi` и позволяет получать аффилированные ссылки, сохранять изображения и видео продуктов, а также генерировать и сохранять данные кампании в JSON-формате.

## Классы

### `AliAffiliatedProducts`

**Описание**: Класс `AliAffiliatedProducts` наследуется от `AliApi` и расширяет его функциональность для работы со связанными продуктами. Он предоставляет методы для обработки списков идентификаторов или URL-адресов продуктов, получения аффилированных ссылок, загрузки изображений и видео, сохранения данных и подготовки выходных данных.

**Атрибуты**:

* `language`: Язык кампании (по умолчанию 'EN').
* `currency`: Валюта кампании (по умолчанию 'USD').

**Методы**:

#### `__init__`

**Описание**: Инициализирует класс `AliAffiliatedProducts`.

**Параметры**:
* `language` (str | dict, optional): Язык кампании. По умолчанию 'EN'.
* `currency` (str, optional): Валюта кампании. По умолчанию 'USD'.

**Возвращает**:
* None

#### `process_affiliate_products`

**Описание**: Обрабатывает список идентификаторов или URL-адресов продуктов, возвращает список обработанных продуктов с аффилированными ссылками и сохранёнными изображениями.

**Параметры**:
* `prod_ids` (list[str]): Список URL-адресов или идентификаторов продуктов.
* `category_root` (Path | str): Путь к корневой директории категории.

**Возвращает**:
* list[SimpleNamespace]: Список обработанных продуктов с аффилированными ссылками и сохранёнными изображениями.

**Возможные исключения**:
* `Exception`: Если имя категории не найдено в кампании.

**Примечания**:
* Метод извлекает содержимое страницы по URL-адресу.
* Обрабатывает аффилированные ссылки и сохранение изображений/видео.
* Генерирует и сохраняет данные кампании и выходные файлы.


## Функции

(Список функций отсутствует в представленном коде)


## Дополнительные заметки

* Код содержит подробное описание алгоритма работы функции `process_affiliate_products` в виде блок-схемы, что существенно повышает читаемость и понимание кода.
* Код использует `asyncio`, `datetime`, `html`, `pathlib`, `urllib.parse`, `types`, `typing`.
* Использование `logger` для логирования событий и ошибок.
* Использование `pprint` для удобства вывода отладочной информации.
* Сохранение изображений и видео с помощью функций `save_png_from_url` и `save_video_from_url`.
* Сохранение данных продуктов в JSON-файлы.
* Обработка случаев отсутствия аффилированных ссылок и других ошибок.
* Приведен пример использования класса.