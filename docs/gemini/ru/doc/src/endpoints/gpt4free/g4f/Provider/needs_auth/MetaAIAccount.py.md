# Модуль MetaAIAccount.py

## Обзор

Модуль `MetaAIAccount.py` представляет собой класс `MetaAIAccount`, который наследует функциональность от класса `MetaAI`. Этот модуль предназначен для работы с аккаунтами Meta AI, требующими аутентификации. Он используется для создания асинхронного генератора, который взаимодействует с Meta AI для генерации текста на основе предоставленных сообщений.

## Подробней

Модуль является частью подсистемы `gpt4free` проекта `hypotez` и отвечает за интеграцию с определенным типом провайдера Meta AI, требующим наличия учетной записи. Класс `MetaAIAccount` использует cookies для аутентификации и взаимодействия с API Meta AI.

## Классы

### `MetaAIAccount`

**Описание**: Класс `MetaAIAccount` расширяет класс `MetaAI` и предоставляет функциональность для работы с аккаунтами Meta AI, требующими аутентификации.

**Наследует**:

- `MetaAI`: Наследует базовую логику взаимодействия с Meta AI.

**Атрибуты**:

- `needs_auth` (bool): Указывает, что для данного провайдера требуется аутентификация (всегда `True`).
- `parent` (str): Указывает родительский класс (`"MetaAI"`).
- `image_models` (list[str]): Список моделей для генерации изображений (`["meta"]`).

**Методы**:

- `create_async_generator`: Создает асинхронный генератор для взаимодействия с Meta AI.

## Функции

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    proxy: str = None,
    cookies: Cookies = None,
    **kwargs
) -> AsyncResult:
    """
    Создает асинхронный генератор для взаимодействия с Meta AI.

    Args:
        cls (type[MetaAIAccount]): Ссылка на класс `MetaAIAccount`.
        model (str): Название модели для генерации текста.
        messages (Messages): Список сообщений для передачи в модель.
        proxy (str, optional): Адрес прокси-сервера. По умолчанию `None`.
        cookies (Cookies, optional): Cookies для аутентификации. По умолчанию `None`.
        **kwargs: Дополнительные аргументы.

    Returns:
        AsyncResult: Асинхронный генератор, выдающий чанки текста от Meta AI.

    Raises:
        Нет явных исключений, но могут возникать исключения при взаимодействии с API Meta AI.
    """
```

**Назначение**: Создает асинхронный генератор, который отправляет запросы к Meta AI и возвращает сгенерированный текст частями.

**Параметры**:

- `cls` (type[MetaAIAccount]): Ссылка на класс `MetaAIAccount`.
- `model` (str): Название модели для генерации текста.
- `messages` (Messages): Список сообщений для передачи в модель.
- `proxy` (str, optional): Адрес прокси-сервера для использования при подключении. По умолчанию `None`.
- `cookies` (Cookies, optional): Cookies для аутентификации в Meta AI. Если не указаны, используются cookies, полученные из домена ".meta.ai". По умолчанию `None`.
- `**kwargs`: Дополнительные именованные аргументы, которые могут быть переданы в функцию.

**Возвращает**:

- `AsyncResult`: Асинхронный генератор, который выдает чанки текста, полученные от Meta AI.

**Как работает функция**:

1. **Получение cookies**: Если cookies не переданы явно, функция пытается получить их для домена ".meta.ai".
2. **Создание генератора**: Создается экземпляр класса `MetaAIAccount` с использованием прокси (если указан).
3. **Форматирование запроса**: Сообщения форматируются с использованием функции `format_prompt`.
4. **Взаимодействие с Meta AI**: Вызывается метод `prompt` для получения чанков текста от Meta AI.
5. **Генерация результата**: Функция возвращает асинхронный генератор, который выдает полученные чанки текста.

```
A: Получение Cookies
|
B: Создание экземпляра MetaAIAccount (с прокси)
|
C: Форматирование запроса (format_prompt)
|
D: Взаимодействие с Meta AI (prompt)
|
E: Генерация чанков текста
```

**Примеры**:

```python
# Пример использования create_async_generator
messages = [{"role": "user", "content": "Hello, Meta AI!"}]
async def main():
    async for chunk in MetaAIAccount.create_async_generator(model="default", messages=messages):
        print(chunk, end="")

# Запуск примера (необходимо в асинхронном контексте)
# asyncio.run(main())