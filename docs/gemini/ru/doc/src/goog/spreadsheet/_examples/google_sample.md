# Модуль hypotez/src/goog/spreadsheet/_examples/google_sample.py

## Обзор

Этот модуль содержит код для доступа к Google Таблицам и получения данных из заданного листа. Он использует Google API для работы с таблицами. Код содержит обработку аутентификации и запрос данных из конкретного листа.

## Функции

### `main`

**Описание**: Функция `main` выполняет основную логику программы, включая аутентификацию, получение данных из Google Таблицы и вывод результата.

**Параметры**:
Нет параметров.

**Возвращает**:
Нет возвращаемого значения.

**Вызывает исключения**:
- `HttpError`:  Исключение возникает при проблемах с запросом к Google Таблицам (например, ошибочный запрос или сетевая проблема).


## Переменные

### `MODE`

**Описание**: Переменная `MODE` хранит строку со значением 'dev'. Предположительно, это используется для управления режимом работы программы.

**Значение**: `'dev'`


### `SCOPES`

**Описание**: Список из строк, определяющий разрешения доступа к Google Таблицам.

**Значение**: `['https://www.googleapis.com/auth/spreadsheets.readonly']`

### `SAMPLE_SPREADSHEET_ID`

**Описание**: ID Google таблицы, из которой будут считываться данные.

**Значение**: `'1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms'`


### `SAMPLE_RANGE_NAME`

**Описание**: Диапазон ячеек в Google таблице, из которого будут считываться данные.

**Значение**: `'Class Data!A2:E'`

### `ROOT_DIRECTORY`

**Описание**: Путь к корневому каталогу текущей работы.

**Значение**: Абсолютный путь к текущему рабочему каталогу.

### `path`

**Описание**: Полный путь к файлу с секретными данными для авторизации.

**Значение**: Путь к файлу `client_secret_920776813054-crpf1rcav3uui51kq9q1lis64glkpatj.apps.googleusercontent.com.json` в подкаталоге `google_api/secrets` в текущем рабочем каталоге.


##  Обработка аутентификации


В функции `main` реализован механизм аутентификации, который:

- Ищет файл `token.json` для хранения токенов доступа.
- Если файл найден, то загружает данные из него.
- Если токен доступа истек, то запрашивает его повторно.
- Если токен не найден, или данные некорректны, то запускает процедуру аутентификации через локальный сервер.
- Сохраняет обновлённые данные доступа в файл `token.json`.


## Запрос данных и вывод результата

В функции `main`:

- Создаётся объект `service` для работы с Google Таблицами.
- Выполняется запрос данных из указанной таблицы по ID и диапазону.
- Если данные получены успешно:
    - Выводится заголовок таблицы ('Name, Major:').
    - Проходятся строки данных.
    - Выводятся столбцы с именами и специальностями.
- Если данных нет, выводится сообщение об отсутствии данных.
- При возникновении исключения `HttpError` выводится сообщение об ошибке.