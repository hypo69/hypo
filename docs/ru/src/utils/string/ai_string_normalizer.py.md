# Модуль для нормализации ответа AI

## Обзор

Модуль `ai_response_normalizer.py` предназначен для очистки и нормализации текстовых ответов, полученных от AI-моделей. Он удаляет префиксы и суффиксы, такие как маркеры кода (` ```markdown`, ` ```html` и т.д.), чтобы получить "чистый" текст ответа.

## Подробнее

Этот модуль важен для предобработки ответов AI перед их дальнейшим использованием, например, для отображения пользователю или для сохранения в базе данных. Он гарантирует, что в тексте не будет нежелательных артефактов, связанных с форматированием.

## Функции

### `normalize_answer`

```python
def normalize_answer(text: str) -> str:
    """
    Функция для удаления префиксов и суффиксов из текстового ответа.

    Args:
        text (str): Текстовый ответ для нормализации.

    Returns:
        str: Нормализованный текстовый ответ без префиксов и суффиксов.
    """
```

**Назначение**: Функция `normalize_answer` принимает строку (текстовый ответ от AI) и пытается удалить из нее известные префиксы и суффиксы, чтобы получить "чистый" текст.

**Параметры**:
- `text` (str): Строка, содержащая текст ответа, который необходимо нормализовать.

**Возвращает**:
- `str`: Нормализованная строка, из которой удалены префиксы и суффиксы, если они присутствовали.

**Как работает функция**:

1.  **Инициализация списка префиксов**: В начале модуля определен список `prefixes`, содержащий различные строковые префиксы, которые могут встречаться в ответах AI (например, ```markdown, ```html, ```).
2.  **Итерация по префиксам**: Функция перебирает каждый префикс из списка `prefixes`.
3.  **Проверка наличия префикса**: Для каждого префикса проверяется, начинается ли с него входная строка `text`.
4.  **Удаление префикса и суффикса**: Если строка `text` начинается с текущего префикса, функция удаляет этот префикс с помощью метода `removeprefix()`. Затем она удаляет суффикс ``` с помощью метода `removesuffix()`.
5.  **Возврат нормализованной строки**: Если префикс был найден и удален, функция возвращает нормализованную строку.
6.  **Возврат исходной строки**: Если ни один из префиксов не был найден в начале строки, функция возвращает исходную строку `text` без изменений.

**ASCII flowchart**:

```
Начало
  ↓
Инициализация списка префиксов
  ↓
Начало цикла по префиксам
  ↓
Проверка: начинается ли текст с текущего префикса?
  ├── Да: Удаление префикса и суффикса
  │   ↓
  │   Возврат нормализованной строки
  └── Нет: Переход к следующему префиксу
  ↓
Конец цикла по префиксам
  ↓
Возврат исходной строки
  ↓
Конец
```

**Примеры**:

```python
from src.utils.string.ai_response_normalizer import normalize_answer

# Пример 1: Удаление префикса ```markdown и суффикса ```
text1 = "```markdown\nПример текста с Markdown.\n```"
normalized_text1 = normalize_answer(text1)
print(normalized_text1)  # Вывод: Пример текста с Markdown.

# Пример 2: Удаление префикса ```html и суффикса ```
text2 = "```html\n<p>Пример HTML текста.</p>\n```"
normalized_text2 = normalize_answer(text2)
print(normalized_text2)  # Вывод: <p>Пример HTML текста.</p>

# Пример 3: Удаление только префикса ```
text3 = "```\nПростой пример текста.\n```"
normalized_text3 = normalize_answer(text3)
print(normalized_text3)  # Вывод: Простой пример текста.

# Пример 4: Отсутствие префикса
text4 = "Простой пример текста без префиксов."
normalized_text4 = normalize_answer(text4)
print(normalized_text4)  # Вывод: Простой пример текста без префиксов.

# Пример 5: Пустая строка
text5 = ""
normalized_text5 = normalize_answer(text5)
print(normalized_text5)  # Вывод: ""