# Discord Bot

## Обзор

Этот документ описывает Discord-бота, написанного на Python с использованием библиотеки `discord.py`. Бот выполняет несколько функций, связанных с управлением моделью машинного обучения, обработкой аудио и взаимодействием с пользователями в текстовых и голосовых каналах Discord.

## Содержание

- [Обзор](#обзор)
- [Основные функции и команды](#основные-функции-и-команды)
- [Обработка сообщений](#обработка-сообщений)
- [Распознавание речи](#распознавание-речи)
- [Преобразование текста в речь](#преобразование-текста-в-речь)
- [Основные модули и библиотеки](#основные-модули-и-библиотеки)
- [Запуск бота](#запуск-бота)
- [Заключение](#заключение)

## Основные функции и команды

1.  **Инициализация бота:**
    - Бот инициализируется с префиксом команд `!` и включает необходимые намерения (intents), которые являются разрешениями на доступ к определенным событиям Discord.

2.  **Команды:**
    - `!hi`: Отправляет приветственное сообщение.
    - `!join`: Подключает бота к голосовому каналу, где находится пользователь.
    - `!leave`: Отключает бота от голосового канала.
    - `!train`: Обучает модель на предоставленных данных. Данные могут быть переданы как файл или текст.
    - `!test`: Тестирует модель на предоставленных данных.
    - `!archive`: Архивирует файлы в указанном каталоге.
    - `!select_dataset`: Выбирает набор данных для обучения модели.
    - `!instruction`: Отправляет инструкции из внешнего файла.
    - `!correct`: Позволяет пользователю исправить предыдущее сообщение бота.
    - `!feedback`: Позволяет пользователю отправить отзыв о работе бота.
    - `!getfile`: Отправляет файл по указанному пути.

## Обработка сообщений

-   Бот обрабатывает входящие сообщения, игнорируя собственные сообщения.
-   Если пользователь отправляет аудиофайл, бот распознает речь в аудио и отправляет текст в ответ.
-   Если пользователь находится в голосовом канале, бот преобразует текст в речь и воспроизводит его в голосовом канале.

## Распознавание речи

- Функция `recognizer` скачивает аудиофайл, конвертирует его в формат WAV и распознает речь с помощью Google Speech Recognition.

## Преобразование текста в речь

- Функция `text_to_speech_and_play` преобразует текст в речь с помощью библиотеки `gTTS` и воспроизводит его в голосовом канале.

## Основные модули и библиотеки

-   `discord.py`: Основная библиотека для создания Discord-ботов.
-   `speech_recognition`: Для распознавания речи.
-   `pydub`: Для конвертации аудиофайлов.
-   `gtts`: Для преобразования текста в речь.
-   `requests`: Для загрузки файлов.
-   `pathlib`: Для работы с путями к файлам.
-   `tempfile`: Для создания временных файлов.
-   `asyncio`: Для асинхронного выполнения задач.

## Запуск бота

-   Бот запускается с использованием токена, хранящегося в переменной `gs.credentials.discord.bot_token`.

## Заключение

Этот бот предназначен для интерактивного взаимодействия с пользователями в Discord, включая обработку голосовых команд, обучение и тестирование модели машинного обучения, предоставление инструкций и получение обратной связи.