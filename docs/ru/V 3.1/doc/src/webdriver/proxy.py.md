# Модуль `proxy`

## Обзор

Модуль `proxy` предназначен для работы с прокси-серверами. Он включает функции для загрузки списка прокси-серверов из удаленного источника, их парсинга и проверки работоспособности.

## Подробней

Этот модуль предоставляет инструменты для автоматической загрузки и обработки списка прокси-серверов. Он загружает текстовый файл со списком прокси-адресов, парсит его, разделяя прокси по категориям (HTTP, SOCKS4, SOCKS5), и предоставляет возможность проверки работоспособности каждого прокси-сервера.

Модуль используется для обеспечения анонимности и обхода географических ограничений при выполнении HTTP-запросов. Он может быть полезен в задачах сбора данных, автоматизированного тестирования и других сценариях, где требуется использование прокси-серверов.

## Функции

### `download_proxies_list`

```python
def download_proxies_list(url: str = url, save_path: Path = proxies_list_path) -> bool:
    """
    Загружает файл по указанному URL и сохраняет его в заданный путь.

    :param url: URL файла для загрузки.
    :param save_path: Путь для сохранения загруженного файла.
    :return: Успешность выполнения операции.
    """
    ...
```

**Описание**: Загружает файл со списком прокси-серверов из указанного URL-адреса и сохраняет его локально.

**Параметры**:
- `url` (str): URL-адрес, из которого нужно загрузить список прокси. По умолчанию используется значение переменной `url` из модуля.
- `save_path` (Path): Путь для сохранения загруженного списка прокси. По умолчанию используется значение переменной `proxies_list_path` из модуля.

**Возвращает**:
- `bool`: `True`, если загрузка и сохранение прошли успешно, `False` в противном случае.

**Вызывает исключения**:
- `Exception`: Логируется в случае ошибки при загрузке файла.

**Примеры**:

```python
from pathlib import Path
from src.webdriver.proxy import download_proxies_list

url = 'https://example.com/proxies.txt'
save_path = Path('./proxies.txt')
if download_proxies_list(url, save_path):
    print('Список прокси успешно загружен.')
else:
    print('Не удалось загрузить список прокси.')
```

### `get_proxies_dict`

```python
def get_proxies_dict(file_path: Path = proxies_list_path) -> Dict[str, List[Dict[str, Any]]]:
    """
    Парсит файл с прокси-адресами и распределяет их по категориям.

    :param file_path: Путь к файлу с прокси.
    :return: Словарь с распределёнными по типам прокси.
    """
    ...
```

**Описание**: Читает файл со списком прокси-серверов, парсит его и возвращает словарь, где прокси сгруппированы по типам (HTTP, SOCKS4, SOCKS5).

**Параметры**:
- `file_path` (Path): Путь к файлу со списком прокси-серверов. По умолчанию используется значение переменной `proxies_list_path` из модуля.

**Возвращает**:
- `Dict[str, List[Dict[str, Any]]]`: Словарь, где ключи - типы прокси (`'http'`, `'socks4'`, `'socks5'`), а значения - списки словарей, каждый из которых содержит информацию о прокси (`'protocol'`, `'host'`, `'port'`).

**Вызывает исключения**:
- `FileNotFoundError`: Логируется, если файл не найден.
- `Exception`: Логируется в случае ошибки при парсинге прокси.

**Примеры**:

```python
from pathlib import Path
from src.webdriver.proxy import get_proxies_dict

file_path = Path('./proxies.txt')
proxies = get_proxies_dict(file_path)
if proxies:
    print(f'Найдено HTTP прокси: {len(proxies["http"])}')
    print(f'Найдено SOCKS4 прокси: {len(proxies["socks4"])}')
    print(f'Найдено SOCKS5 прокси: {len(proxies["socks5"])}')
else:
    print('Не удалось получить список прокси.')
```

### `check_proxy`

```python
def check_proxy(proxy: dict) -> bool:
    """
    Проверяет работоспособность прокси-сервера.
    
    :param proxy: Словарь с данными прокси (host, port, protocol).
    :return: True, если прокси работает, иначе False.
    """
    ...
```

**Описание**: Проверяет работоспособность заданного прокси-сервера, отправляя через него HTTP-запрос к `https://httpbin.org/ip`.

**Параметры**:
- `proxy` (dict): Словарь, содержащий информацию о прокси-сервере (`'protocol'`, `'host'`, `'port'`).

**Возвращает**:
- `bool`: `True`, если прокси-сервер работает и возвращает HTTP-код 200, `False` в противном случае.

**Вызывает исключения**:
- `ProxyError`, `RequestException`: Логируются в случае ошибок при подключении через прокси.

**Примеры**:

```python
from src.webdriver.proxy import check_proxy

proxy = {'protocol': 'http', 'host': '1.2.3.4', 'port': '8080'}
if check_proxy(proxy):
    print('Прокси работает.')
else:
    print('Прокси не работает.')