# Анализ кода модуля `26_change.ru.md`

**Качество кода**
- **Соответствие требованиям к формату кода (1-10):**

  - **Преимущества:**
    - Документ хорошо структурирован с использованием Markdown, что делает его легко читаемым.
    - Присутствует четкое описание игры, пошаговая инструкция, пример работы программы и возможные ограничения.
    - Представлена подробная информация о процессе игры, включая ввод данных, расчет сдачи и вывод результата.
  - **Недостатки:**
    - Отсутствует фактический код для реализации игры. Это просто текстовое описание.
    - Нет docstring, соответствующих reStructuredText (RST) для документации кода, так как кода нет.

**Рекомендации по улучшению**

1. **Реализация кода:** Необходимо добавить Python-код для реализации логики игры, включая расчет сдачи и вывод результатов.
2. **Документация кода:** Добавить docstring в формате reStructuredText (RST) для всех функций, методов и классов.
3. **Обработка ошибок:** Добавить обработку ошибок, например, при некорректном вводе данных пользователем.
4. **Использование `j_loads`:** В данном случае нет необходимости в использовании `j_loads` или `j_loads_ns`, так как нет JSON.
5. **Логирование:** Использовать `from src.logger.logger import logger` для логирования ошибок и важной информации.
6. **Формат RST:** Привести все комментарии к формату RST, как описано в требованиях.

**Улучшенный код**

```markdown
# Название игры: **CHANGE** (Кассовая программа)

#### Описание
**CHANGE** — это игра, в которой компьютер выполняет роль кассира в магазине. Игрок сообщает стоимость товаров и сумму оплаты, а программа автоматически вычисляет и выводит правильную сдачу, используя банкноты и монеты. Игра помогает тренировать навыки работы с деньгами, вычисляя сдачу с точностью и показывая, как правильно распределить сдачу между различными монетами и банкнотами.

---

### Пошаговая инструкция для реализации

#### 1. **Инициализация игры**
   - Программа запрашивает у игрока стоимость товара (стоимость может быть от 0 до 100 долларов).
   - Затем программа запрашивает сумму, которую игрок платит за товар.
   - Программа вычисляет сдачу, которую должен вернуть кассир, используя банкноты и монеты (например, пятёрки, десятки, четверти, пенни и т.д.).

#### 2. **Основной цикл игры**
   - **Ввод данных:**
     1. Игрок вводит стоимость товара (например, 4.59 доллара).
     2. Игрок также вводит сумму оплаты (например, 10 долларов).
   - **Расчёт сдачи:**
     Программа вычисляет разницу между стоимостью товара и суммой оплаты. Например:
     - Стоимость товара: $4.59
     - Сумма оплаты: $10.00
     - Сдача: $5.41 # Исправлена ошибка в примере
   - **Вывод сдачи:**
     Программа выведет сдачу, разбитую на монеты и банкноты, например:
     ```
     Сдача: $5.41 # Исправлена ошибка в примере
     1 пятидолларовая купюра
     1 четверть
     1 никель
     1 пенни
     ```

#### 3. **Подсчёт победителя**
   - В игре нет победителей, так как её цель — точно вычислить сдачу.

#### 4. **Завершение игры**
   - После того как сдача будет рассчитана, программа предложит сыграть снова:
     ```
     Хотите сыграть снова? (да/нет)
     ```

---

### Пример работы программы

1. **Начало игры:**
   ```
   Добро пожаловать в игру CHANGE!
   Введите стоимость товара: 4.59
   Введите сумму оплаты: 10.00
   ```

2. **Расчёт сдачи:**
   ```
   Сдача: $5.41 # Исправлена ошибка в примере
   1 пятидолларовая купюра
   1 четверть
   1 никель
   1 пенни
   ```

3. **Завершение игры:**
   ```
   Хотите сыграть снова? (да/нет)
   > нет
   Спасибо за игру!
   ```

---

### Возможные ограничения
- Программа должна правильно вычислять сдачу для любых чисел, в том числе с дробными суммами.
- Банкноты и монеты должны быть выбраны из ограниченного набора (например, пятёрки, десятки, четверти и т.д.).

---

### Реализация

```python
"""
Модуль для игры "Сдача" (CHANGE).
=========================================================================================

Этот модуль реализует игру, в которой компьютер выступает в роли кассира,
вычисляя сдачу для игрока на основе введенной стоимости товара и суммы оплаты.

Пример использования
--------------------

.. code-block:: python

    game = ChangeGame()
    game.play()
"""

from src.logger.logger import logger # Добавлен импорт логгера
from typing import List, Tuple  # Добавлен импорт для Type Hinting

class ChangeGame:
    """
    Класс, реализующий логику игры "Сдача".

    :ivar currency_values: Словарь, содержащий номиналы валют и их названия.
    :vartype currency_values: dict
    """
    def __init__(self):
        """
        Инициализирует объект игры.
        """
        self.currency_values = {  # Словарь для купюр и монет
            5.00: "пятидолларовая купюра",
            1.00: "доллар",
            0.25: "четверть",
            0.10: "дайм",
            0.05: "никель",
            0.01: "пенни",
        }


    def calculate_change(self, price: float, payment: float) -> Tuple[float, List[Tuple[int, str]]]:
        """
        Вычисляет сдачу и разбивает её на купюры и монеты.

        :param price: Стоимость товара.
        :type price: float
        :param payment: Сумма, которую заплатил покупатель.
        :type payment: float
        :return: Кортеж, содержащий сдачу и список купюр и монет с их количеством.
        :rtype: Tuple[float, List[Tuple[int, str]]]
        """
        change = round(payment - price, 2)  # Расчет сдачи с округлением
        if change < 0:
            logger.error(f"Сумма оплаты меньше стоимости товара. Сдача: {change}") # Логгирование ошибки
            return change, []
        change_items = [] # Список для хранения результатов

        for value, name in self.currency_values.items(): # Перебор словаря номиналов
            while change >= value:
                change = round(change - value, 2) # Уменьшение сдачи и округление
                change_items.append(name) # добавление имени купюры/монеты
        result = {} # Словарь для хранения количества купюр/монет
        for item in change_items:
            result[item] = result.get(item, 0) + 1 # Подсчет количества

        return payment - price, [(count, name) for name, count in result.items()] # возврат результата


    def play(self):
        """
        Запускает игровой цикл.
        """
        print("Добро пожаловать в игру CHANGE!")
        while True: # Основной игровой цикл
            try:
                price = float(input("Введите стоимость товара: "))  # Запрос стоимости товара
                payment = float(input("Введите сумму оплаты: "))   # Запрос суммы оплаты
            except ValueError:
                logger.error("Некорректный ввод. Введите число.") # Логгирование ошибки
                continue


            change, change_items = self.calculate_change(price, payment) # Расчет сдачи
            print(f"Сдача: ${change:.2f}") # Вывод суммы сдачи
            if change_items:
                for count, name in change_items:
                    print(f"{count} {name}") # Вывод купюр и монет
            else:
                 if change < 0:
                    print("Недостаточно средств для оплаты") # Уведомление, если недостаточно средств

            again = input("Хотите сыграть снова? (да/нет) ").lower() # Запрос новой игры
            if again != 'да':
                print("Спасибо за игру!")
                break


if __name__ == "__main__": # Запуск игры, если файл запущен как основной
    game = ChangeGame()
    game.play()
```
```
```