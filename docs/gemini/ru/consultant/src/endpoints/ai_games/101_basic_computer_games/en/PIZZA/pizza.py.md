# Анализ кода модуля pizza.py

**Качество кода**
9
-  Плюсы
    - Код хорошо структурирован и легко читается.
    - Используются понятные имена переменных.
    - Присутствуют проверки ввода данных пользователя.
    - Код содержит подробные комментарии, объясняющие его работу.
    - Логика программы соответствует описанию в начале файла.
-  Минусы
    - Отсутствуют необходимые импорты, такие как `logger` из `src.logger.logger`.
    - Используется стандартный `input`, что затрудняет тестирование и расширение.
    - Код содержит много повторяющихся блоков `try-except`, которые можно упростить.
    - Формат комментариев не соответствует reStructuredText (RST).
    - Отсутствует docstring для модуля.
    - Код не использует `j_loads` или `j_loads_ns`.

**Рекомендации по улучшению**
1.  Добавить импорт `logger` из `src.logger.logger` для логирования ошибок.
2.  Переписать комментарии в формате reStructuredText (RST), включая docstring для модуля.
3.  Заменить стандартный `input` на функцию, которая может принимать мокированный ввод для тестов.
4.  Упростить блоки `try-except` за счет использования `logger.error` и перенести обработку ошибок в отдельную функцию.
5.  Избегать использования `while True` циклов, где это возможно, и переписать их с более понятным условием.
6.  Использовать форматирование строк f-string для улучшения читаемости кода.
7.  Добавить функцию `get_float_input` для обработки ввода чисел с проверкой.

**Оптимизиробанный код**
```python
"""
PIZZA:
=================
Моделирование заказа и доставки пиццы.
-----------------

:mod:`pizza` моделирует процесс заказа и доставки пиццы. Игрок должен ответить на ряд вопросов
о количестве пицц, их стоимости, размере чаевых и т.д. В конце программа выводит полную
стоимость заказа, включая налог и чаевые.

Правила игры:
    1. Программа запрашивает количество пицц.
    2. Затем запрашивает стоимость каждой пиццы.
    3. Далее запрашивает величину чаевых в процентах.
    4. Вычисляется общая стоимость пицц.
    5. Вычисляется налог (5% от общей стоимости).
    6. Вычисляется сумма чаевых.
    7. Выводится общая стоимость заказа, включая налог и чаевые.

Алгоритм:
    1. Ввести количество пицц (QUANTITY).
    2. В цикле от 1 до QUANTITY:
        2.1. Ввести стоимость пиццы (COST).
        2.2. Увеличить общую стоимость пицц (TOTAL) на COST.
    3. Ввести процент чаевых (TIP).
    4. Вычислить налог (TAX) как 5% от TOTAL.
    5. Вычислить сумму чаевых (TIP) как TIP% от TOTAL.
    6. Вычислить полную стоимость заказа (GRAND) как TOTAL + TAX + TIP.
    7. Вывести:
        7.1. Общую стоимость пицц (TOTAL).
        7.2. Налог (TAX).
        7.3. Сумму чаевых (TIP).
        7.4. Полную стоимость заказа (GRAND).

Блок-схема:

.. mermaid::
   flowchart TD
       Start["Начало"] --> InputQuantity["Ввод количества пицц: <code><b>quantity</b></code>"]
       InputQuantity --> InitializeTotal["<code><b>totalCost = 0</b></code>"]
       InitializeTotal --> LoopStart{"Начало цикла: для каждой пиццы"}
       LoopStart -- Да --> InputCost["Ввод стоимости пиццы: <code><b>pizzaCost</b></code>"]
       InputCost --> UpdateTotal["<code><b>totalCost = totalCost + pizzaCost</b></code>"]
       UpdateTotal --> LoopEnd{"Конец цикла: все пиццы обработаны"}
       LoopEnd -- Да --> InputTipPercent["Ввод процента чаевых: <code><b>tipPercent</b></code>"]
       LoopEnd -- Нет --> InputTipPercent
       InputTipPercent --> CalculateTax["<code><b>tax = totalCost * 0.05</b></code>"]
       CalculateTax --> CalculateTip["<code><b>tipAmount = totalCost * tipPercent / 100</b></code>"]
       CalculateTip --> CalculateGrandTotal["<code><b>grandTotal = totalCost + tax + tipAmount</b></code>"]
       CalculateGrandTotal --> OutputTotal["Вывод: <b>Общая стоимость пицц: <code>totalCost</code></b>"]
       OutputTotal --> OutputTax["Вывод: <b>Налог: <code>tax</code></b>"]
       OutputTax --> OutputTip["Вывод: <b>Чаевые: <code>tipAmount</code></b>"]
       OutputTip --> OutputGrandTotal["Вывод: <b>Полная стоимость заказа: <code>grandTotal</code></b>"]
       OutputGrandTotal --> End["Конец"]

Legenda:
    Start - Начало программы.
    InputQuantity - Запрос у пользователя количества пицц и сохранение значения в переменной quantity.
    InitializeTotal - Установка начального значения общей стоимости (totalCost) в 0.
    LoopStart - Начало цикла для ввода стоимости каждой пиццы.
    InputCost - Запрос у пользователя стоимости текущей пиццы и сохранение значения в переменной pizzaCost.
    UpdateTotal - Добавление стоимости текущей пиццы к общей стоимости (totalCost).
    LoopEnd - Конец цикла, проверяет, обработаны ли все пиццы.
    InputTipPercent - Запрос у пользователя процента чаевых и сохранение значения в переменной tipPercent.
    CalculateTax - Вычисление налога как 5% от общей стоимости (totalCost).
    CalculateTip - Вычисление суммы чаевых на основе введенного процента от общей стоимости (totalCost).
    CalculateGrandTotal - Вычисление полной стоимости заказа путем сложения общей стоимости, налога и чаевых.
    OutputTotal - Вывод общей стоимости пицц (totalCost).
    OutputTax - Вывод суммы налога (tax).
    OutputTip - Вывод суммы чаевых (tipAmount).
    OutputGrandTotal - Вывод полной стоимости заказа (grandTotal).
    End - Конец программы.
"""
__author__ = 'hypo69 (hypo69@davidka.net)'

from src.logger.logger import logger #  Импортируем logger для логирования ошибок

def get_int_input(prompt: str) -> int:
    """
    Запрашивает у пользователя целое число и проверяет его корректность.

    :param prompt: Сообщение для пользователя.
    :return: Корректное целое число.
    :raises ValueError: Если введено некорректное значение.
    """
    while True:
        try:
            value = int(input(prompt))
            if value > 0:
                return value
            else:
                print('Пожалуйста, введите положительное число.')
        except ValueError:
            print('Пожалуйста, введите целое число.')


def get_float_input(prompt: str, min_value: float = 0, max_value: float = float('inf')) -> float:
    """
    Запрашивает у пользователя число с плавающей точкой и проверяет его корректность.

    :param prompt: Сообщение для пользователя.
    :param min_value: Минимальное допустимое значение.
    :param max_value: Максимальное допустимое значение.
    :return: Корректное число с плавающей точкой.
    :raises ValueError: Если введено некорректное значение.
    """
    while True:
        try:
            value = float(input(prompt))
            if min_value <= value <= max_value:
                return value
            else:
                print(f'Пожалуйста, введите число от {min_value} до {max_value}.')
        except ValueError:
            print('Пожалуйста, введите числовое значение.')


# Запрашиваем у пользователя количество пицц
# Используем get_int_input для получения корректного значения количества пицц
quantity = get_int_input('Сколько пицц вы хотите заказать? ')

# Инициализируем общую стоимость
totalCost = 0

# Цикл для ввода стоимости каждой пиццы
for i in range(quantity):
    # Используем get_float_input для получения корректной стоимости пиццы
    pizzaCost = get_float_input(f'Введите стоимость пиццы {i + 1}: ')
    # Добавляем стоимость пиццы к общей сумме
    totalCost += pizzaCost


# Запрашиваем процент чаевых
# Используем get_float_input для получения корректного процента чаевых
tipPercent = get_float_input('Какой процент чаевых вы хотите оставить? ', 0, 100)


# Вычисляем налог (5%)
tax = totalCost * 0.05
# Вычисляем сумму чаевых
tipAmount = totalCost * tipPercent / 100
# Вычисляем полную стоимость заказа
grandTotal = totalCost + tax + tipAmount

# Выводим результаты
print(f'Общая стоимость пицц: {totalCost:.2f}')
print(f'Налог: {tax:.2f}')
print(f'Чаевые: {tipAmount:.2f}')
print(f'Полная стоимость заказа: {grandTotal:.2f}')

"""
Объяснение кода:
1.  **Инициализация**:
    -   `totalCost = 0`: Инициализирует переменную `totalCost` для хранения общей стоимости всех пицц.
    -   Функции `get_int_input` и `get_float_input`: используются для проверки ввода корректных данных от пользователя.
2.  **Ввод количества пицц**:
    -   `quantity = get_int_input('Сколько пицц вы хотите заказать? ')`: Запрашивает у пользователя количество пицц и сохраняет его в переменную `quantity`.
    -   Проверка на положительное число происходит в функции `get_int_input`.
3.  **Цикл для ввода стоимости каждой пиццы**:
    -   `for i in range(quantity):`: Цикл выполняется `quantity` раз для каждой пиццы.
    -   `pizzaCost = get_float_input(f'Введите стоимость пиццы {i + 1}: ')`: Запрашивает стоимость каждой пиццы и сохраняет ее в переменной `pizzaCost`.
    -   `totalCost += pizzaCost`: Добавляет стоимость текущей пиццы к общей стоимости `totalCost`.
4. **Ввод процента чаевых**:
    -   `tipPercent = get_float_input('Какой процент чаевых вы хотите оставить? ', 0, 100)`: Запрашивает у пользователя процент чаевых.
    -   Проверяет, что процент чаевых находится в диапазоне от 0 до 100 в функции `get_float_input`.
5.  **Расчеты**:
    -   `tax = totalCost * 0.05`: Вычисляет налог как 5% от общей стоимости.
    -   `tipAmount = totalCost * tipPercent / 100`: Вычисляет сумму чаевых.
    -   `grandTotal = totalCost + tax + tipAmount`: Вычисляет полную стоимость заказа, включая стоимость пицц, налог и чаевые.
6.  **Вывод результатов**:
    -   `print(f'Общая стоимость пицц: {totalCost:.2f}')`: Выводит общую стоимость пицц, форматированную до двух знаков после запятой.
    -   `print(f'Налог: {tax:.2f}')`: Выводит сумму налога.
    -   `print(f'Чаевые: {tipAmount:.2f}')`: Выводит сумму чаевых.
    -   `print(f'Полная стоимость заказа: {grandTotal:.2f}')`: Выводит полную стоимость заказа.
"""
```