# `src.webdriver.driver`

## Обзор

Данный модуль содержит реализацию базового класса `DriverBase`, метакласса `DriverMeta` и класса `Driver`, предназначенных для управления веб-драйвером. Он включает в себя методы для навигации, взаимодействия с элементами страницы, управления cookies, и других действий, связанных с автоматизацией браузера. Модуль построен на основе библиотеки `Selenium` и дополнен собственными утилитами для расширения функциональности.

## Содержание

- [Импорты](#импорты)
- [Класс `DriverBase`](#класс-driverbase)
  - [Атрибуты](#атрибуты)
  - [Методы](#методы)
    - [`driver_payload`](#driver_payload)
    - [`scroll`](#scroll)
    - [`locale`](#locale)
    - [`get_url`](#get_url)
    - [`extract_domain`](#extract_domain)
    - [`_save_cookies_localy`](#_save_cookies_localy)
    - [`page_refresh`](#page_refresh)
    - [`window_focus`](#window_focus)
    - [`wait`](#wait)
    - [`delete_driver_logs`](#delete_driver_logs)
- [Класс `DriverMeta`](#класс-drivermeta)
  - [Методы](#методы-1)
    - [`__call__`](#__call__)
- [Класс `Driver`](#класс-driver)
  - [Пример использования](#пример-использования)

## Импорты

Модуль импортирует необходимые библиотеки и модули для работы с веб-драйверами и обработки данных.

- `sys`: Для работы с системными параметрами.
- `pickle`: Для сериализации и десериализации объектов Python.
- `time`: Для работы со временем и задержками.
- `copy`: Для создания копий объектов.
- `pathlib.Path`: Для работы с путями к файлам.
- `typing.Type`: Для аннотации типов.
- `urllib.parse`: Для работы с URL.
- `selenium.webdriver.common.action_chains.ActionChains`: Для выполнения сложных действий с элементами.
- `selenium.webdriver.common.keys.Keys`: Для эмуляции нажатий клавиш.
- `selenium.webdriver.common.by.By`: Для определения локаторов элементов.
- `selenium.webdriver.support.expected_conditions as EC`: Для ожидания условий.
- `selenium.webdriver.support.ui.WebDriverWait`: Для управления ожиданием.
- `selenium.webdriver.remote.webelement.WebElement`: Для представления веб-элементов.
- `selenium.common.exceptions`: Для обработки исключений Selenium.
  - `InvalidArgumentException`: Исключение при неправильных аргументах.
  - `ElementClickInterceptedException`: Исключение при перекрытии элемента другим элементом.
  - `ElementNotInteractableException`: Исключение при попытке взаимодействия с неинтерактивным элементом.
  - `ElementNotVisibleException`: Исключение при попытке взаимодействия с невидимым элементом.
- `src.settings.gs`: Модуль с общими настройками.
- `src.webdriver.executor.ExecuteLocator`: Модуль для выполнения поиска элементов на странице.
- `src.webdriver.javascript.js.JavaScript`: Модуль для выполнения JavaScript кода.
- `src.utils.pprint`: Модуль для "красивой" печати данных.
- `src.logger.logger`: Модуль для логирования.
- `src.exceptions.WebDriverException`: Пользовательское исключение WebDriver.

## Класс `DriverBase`

### **Описание**

Базовый класс для всех драйверов. Содержит общие методы и атрибуты для взаимодействия с браузером.

### Атрибуты

- `previous_url` (str): Предыдущий URL.
- `referrer` (str): Реферер страницы.
- `page_lang` (str): Язык текущей страницы.
- `ready_state`: Состояние загрузки страницы.
- `get_page_lang`: Метод для получения языка страницы.
- `unhide_DOM_element`: Метод для отображения скрытого элемента DOM.
- `get_referrer`: Метод для получения реферера.
- `window_focus`: Метод для фокусировки окна.
- `execute_locator`: Объект `ExecuteLocator` для поиска элементов.
- `click`: Метод для клика на элемент.
- `get_webelement_as_screenshot`: Метод для получения скриншота элемента.
- `get_attribute_by_locator`: Метод для получения атрибута элемента по локатору.
- `send_message`: Метод для отправки сообщения в консоль браузера.
- `send_key_to_webelement`: Метод для отправки клавиши в веб-элемент.

### Методы

#### `driver_payload`

**Описание**: Метод для получения полезной нагрузки драйвера, включающей в себя JavaScript и ExecuteLocator методы.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.

**Возвращает**:
- `dict`: Словарь, содержащий методы JavaScript и ExecuteLocator.

#### `scroll`

**Описание**: Метод для скроллинга страницы.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.
- `scrolls` (int): Количество прокруток.
- `frame_size` (int): Размер одного фрейма прокрутки.
- `direction` (str): Направление прокрутки ('up', 'down').
- `delay` (float): Задержка между прокрутками.

**Возвращает**:
- `None | bool`: Возвращает `None`, если прокрутка не удалась, иначе `bool`.

**Методы**:

   - `carousel`: Метод для прокрутки карусели.

#### `locale`

**Описание**: Метод для получения локали страницы.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.

**Возвращает**:
- `None | str`: Возвращает локаль страницы или `None`, если не удалось определить.

#### `get_url`

**Описание**: Метод для перехода по URL.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.
- `url` (str): URL для перехода.

**Возвращает**:
- `bool`: `True`, если переход удался, `False` в противном случае.

#### `extract_domain`

**Описание**: Метод для извлечения домена из URL.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.
- `url` (str): URL, из которого нужно извлечь домен.

**Возвращает**:
- `str`: Домен из URL.

#### `_save_cookies_localy`

**Описание**: Метод для сохранения cookies в локальный файл.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.
- `to_file` (str | Path): Путь к файлу, куда будут сохранены cookies.

**Возвращает**:
- `bool`: `True`, если cookies успешно сохранены, `False` в противном случае.

#### `page_refresh`

**Описание**: Метод для перезагрузки текущей страницы.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.

**Возвращает**:
- `bool`: `True`, если перезагрузка удалась, `False` в противном случае.

#### `window_focus`

**Описание**: Метод для фокусировки на текущем окне браузера.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.

**Возвращает**:
- `None`: Ничего не возвращает.

#### `wait`

**Описание**: Метод для ожидания заданного интервала времени.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.
- `interval` (float): Время ожидания в секундах.

**Возвращает**:
- `None`: Ничего не возвращает.

#### `delete_driver_logs`

**Описание**: Метод для удаления логов драйвера.

**Параметры**:
- `self` (DriverBase): Экземпляр класса.

**Возвращает**:
- `bool`: `True`, если логи успешно удалены, `False` в противном случае.

## Класс `DriverMeta`

### **Описание**

Метакласс для управления созданием экземпляров драйверов.

### Методы

#### `__call__`

**Описание**: Метод, вызываемый при создании экземпляра класса `Driver`.

**Параметры**:
- `cls` (DriverMeta): Метакласс.
- `webdriver_cls` (Type): Класс веб-драйвера (например, `Chrome`, `Firefox`).
- `*args`: Позиционные аргументы.
- `**kwargs`: Именованные аргументы.

**Возвращает**:
- `object`: Экземпляр класса `webdriver_cls`.

**Детали:**
- Создает экземпляр указанного класса веб-драйвера.
- Вызывает метод `driver_payload()` для инициализации драйвера.

## Класс `Driver`

### **Описание**

Класс `Driver` предназначен для работы с веб-драйвером. Он использует метакласс `DriverMeta` для управления созданием экземпляров драйверов.

### Пример использования

```python
from src.webdriver.driver import Driver, Chrome, Firefox, Edge

d = Driver(Chrome)
```