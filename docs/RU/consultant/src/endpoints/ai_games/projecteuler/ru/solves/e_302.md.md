# Анализ кода модуля e_302.md

**Качество кода**
7
-  Плюсы
    - Код содержит подробное описание задачи и алгоритма решения.
    - Присутствует реализация на Python, а также блок-схема алгоритма.
    - Используется мемоизация для оптимизации вычислений.
-  Минусы
    - Отсутствуют docstring для функций.
    - Не используются `j_loads` или `j_loads_ns` для чтения файлов, хотя в данном коде это и не требуется.
    - Не используется логирование ошибок.
    - Не хватает комментариев в коде, объясняющих его работу.

**Рекомендации по улучшению**
1. **Добавить docstring:** Добавить docstring к функциям `calculate_h_n` и `calculate_s_n` для соответствия стандартам оформления кода Python и для облегчения понимания их назначения.
2. **Использовать `logger`:**  Добавить логирование ошибок с использованием `from src.logger.logger import logger` для отслеживания проблем во время работы программы, хотя в текущем коде ошибок не предвидится.
3. **Добавить комментарии:** Вставить комментарии в код, объясняющие логику работы отдельных блоков.
4. **Переписать комментарии**: Переписать комментарии, чтобы они соответствовали стандарту reStructuredText.
5. **Улучшить форматирование:** Сделать код более читаемым, добавив пустые строки для разделения логических блоков.
6. **Упростить код:** Упростить вычисление `unique_sums` в функции `calculate_h_n`

**Оптимизированный код**
```python
"""
Модуль для решения задачи Project Euler #302: Гиперкубические числа
=====================================================================

Этот модуль содержит функции для вычисления суммы H(n), где H(n) - количество уникальных сумм кубов целых чисел
от -n до n.

Пример использования
--------------------

.. code-block:: python

    result = calculate_s_n(10)
    print(f"S(10) = {result}")

    result = calculate_s_n(10**6)
    print(f"S(10^6) = {result}")
"""

from src.logger.logger import logger  # Import logger for error handling


def calculate_h_n(n: int, memo: dict) -> int:
    """
    Вычисляет количество уникальных сумм кубов целых чисел от -n до n.

    :param n: Верхняя граница диапазона целых чисел.
    :param memo: Словарь для хранения уже вычисленных значений H(n) (мемоизация).
    :return: Количество уникальных сумм кубов.
    """
    if n in memo:
        return memo[n]

    unique_sums = {0}  # Начинаем с 0, чтобы учесть случай без кубов
    for i in range(1, n + 1):
        new_sums = set()
        for sum_val in unique_sums:
            new_sums.add(sum_val + i**3)
            new_sums.add(sum_val - i**3)
        unique_sums.update(new_sums)

    memo[n] = len(unique_sums)
    return memo[n]


def calculate_s_n(limit: int) -> int:
    """
    Вычисляет сумму H(n) для n от 1 до limit.

    :param limit: Верхняя граница диапазона для вычисления суммы H(n).
    :return: Сумма всех H(n) от 1 до limit.
    """
    total_sum = 0
    memo = {}
    for n in range(1, limit + 1):
        total_sum += calculate_h_n(n, memo)
    return total_sum


if __name__ == '__main__':
    # Пример использования:
    result = calculate_s_n(10)
    print(f"S(10) = {result}")

    # Вычисление S(10^6):
    try:
        result = calculate_s_n(10**6)
        print(f"S(10^6) = {result}")
    except Exception as ex:
        logger.error(f'Произошла ошибка при вычислении S(10^6): {ex}')
        ...
```