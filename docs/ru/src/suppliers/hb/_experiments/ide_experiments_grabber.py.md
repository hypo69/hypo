# Модуль ide_experiments_grabber

## Обзор

Модуль `ide_experiments_grabber.py` предназначен для экспериментов и проверок исполнения сценариев, связанных с поставщиком HB. Основная цель модуля - получение заполненного словаря `product_fields` и отправка его на сервер.

## Подробней

Этот модуль используется для автоматизации процесса сбора данных о продуктах с сайта поставщика HB и их последующей отправки на сервер. Он включает в себя настройку веб-драйвера, выполнение сценариев и обработку полученных данных. Модуль является частью системы автоматизации сбора и обработки данных о товарах для проекта `hypotez`.

## Классы

В данном модуле классы не определены. Используются экземпляры классов `Supplier`, `Product`, `ProductFields` и `Driver` из других модулей.

## Функции

В данном модуле функции не определены. Он в основном состоит из кода, выполняющего последовательность действий для тестирования и экспериментов.

## Переменные

- `dir_root` (Path): Корневая директория проекта `hypotez`. Определяется как путь к текущей рабочей директории, обрезанный до корневой папки проекта.
- `sys.path`: Список путей, по которым Python ищет модули для импорта.
- `dir_src` (Path): Путь к папке `src` внутри корневой директории проекта.
- `s` (Supplier): Экземпляр класса `Supplier` с префиксом `hb`, представляющий поставщика HB.
- `p` (Product): Экземпляр класса `Product`, связанный с поставщиком `s`, представляющий продукт.
- `l` (Dict): Словарь локаторов для элементов продукта на странице, полученный из `s.locators["product"]`.
- `d` (Driver): Экземпляр класса `Driver`, связанный с поставщиком `s`, представляющий веб-драйвер.
- `f` (ProductFields): Экземпляр класса `ProductFields`, связанный с поставщиком `s`, представляющий поля продукта.
- `s.current_scenario` (Dict): Словарь, содержащий информацию о текущем сценарии, включая URL, название, условие и категории PrestaShop.
- `ret`: Результат выполнения сценариев, полученный с помощью функции `run_scenarios`.

## Код

### Добавление корневой директории в `sys.path`

```python
dir_root: Path = Path(os.getcwd()[:os.getcwd().rfind('hypotez') + 7])
sys.path.append(str(dir_root))  # Adding the root folder to sys.path
dir_src = Path(dir_root, 'src')
sys.path.append(str(dir_root))
from src.webdriver import executor
```

- **Назначение**: Добавляет корневую директорию проекта в `sys.path`, чтобы обеспечить возможность импорта модулей из других частей проекта.

### Инициализация объектов

```python
s: Supplier = Supplier(supplier_prefix = 'hb')
p: Product = Product(s)
l: Dict = s.locators["product"]
d: Driver = s.driver
f: ProductFields = ProductFields(s)
```

- **Назначение**: Инициализирует объекты `Supplier`, `Product`, `ProductFields` и `Driver`, необходимые для выполнения сценариев и сбора данных.

### Определение текущего сценария

```python
s.current_scenario: Dict =  {
      "url": "https://hbdeadsea.co.il/product-category/bodyspa/feet-hand-treatment/",
      "name": "טיפוח כפות ידיים ורגליים",
      "condition": "new",
      "presta_categories": {
        "default_category": 11259,
        "additional_categories": []
      }
    }
```

- **Назначение**: Определяет словарь `current_scenario`, содержащий информацию о текущем сценарии, включая URL, название, условие и категории PrestaShop.

### Выполнение сценария

```python
d.get_url(s.current_scenario['url'])
ret = run_scenarios(s, s.current_scenario)
s.related_modules.grab_product_page(s)
```

- **Назначение**: Выполняет сценарий с использованием веб-драйвера и функций для сбора данных о продукте.
- **Как работает**:
    1.  `d.get_url(s.current_scenario['url'])`: Открывает URL, указанный в текущем сценарии, с помощью веб-драйвера.
    2.  `ret = run_scenarios(s, s.current_scenario)`: Запускает выполнение сценариев для текущего поставщика и сценария.
    3.  `s.related_modules.grab_product_page(s)`: Вызывает функцию `grab_product_page` из связанных модулей поставщика для сбора данных о продукте.