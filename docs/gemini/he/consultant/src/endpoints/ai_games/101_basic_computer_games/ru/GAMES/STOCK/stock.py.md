# Анализ кода модуля `stock.py`

**Качество кода**
-  **Соответствие требованиям к формату кода (1-10):** 6
    -  **Преимущества:**
        -  Код логически структурирован и соответствует правилам игры.
        -  Используются понятные переменные.
        -  Есть понятные комментарии, описывающие основные шаги игры.
        -  Представлены блок-схема и легенда к ней.
    - **Недостатки:**
        -  Отсутствует reStructuredText (RST) для docstring и комментариев.
        -  Не используется `j_loads` или `j_loads_ns` для загрузки данных (хотя это и не требуется в данном коде).
        -  Нет обработки ошибок с помощью `logger.error`.
        -  Не все комментарии в стиле "что делает код", а должны быть "что проверяет, отправляет, и т.д."

**Рекомендации по улучшению**
1.  **Документация:**
    -   Переписать все комментарии и docstring в формате RST.
    -   Добавить описание модуля в начале файла.
    -   Добавить docstring к каждой функции и переменной.
2.  **Импорт:**
    - Добавить `from src.logger.logger import logger` для логирования ошибок.
3. **Обработка ошибок:**
   - Использовать `logger.error` вместо стандартных `try-except` для обработки ошибок ввода.
4. **Форматирование:**
    -   Обеспечить консистентное форматирование кода (например, отступы).

**Улучшенный код**
```python
"""
Модуль для игры в биржу STOCK.
=========================================================================================

Этот модуль реализует простую экономическую симуляцию, в которой игрок
покупает и продает акции, чтобы максимизировать прибыль.

Описание игры
-------------
Игра "STOCK" представляет собой текстовую экономическую симуляцию,
где игрок пытается заработать деньги, покупая и продавая акции.
Цена акции случайно изменяется каждый раунд (день).

Правила игры
------------
1. Игроку предоставляется начальная сумма денег.
2. Каждый раунд (день) цена акции изменяется случайным образом.
3. Игрок может покупать или продавать акции в каждом раунде.
4. Игрок должен ввести количество акций для покупки или продажи.
5. После каждого раунда выводится текущая цена акции,
   количество акций, доступные деньги и общая стоимость.
6. Игра продолжается заданное количество раундов (дней).

Пример использования
-------------------
.. code-block:: python

    import random

    # Инициализация параметров игры
    number_of_days = 20
    current_day = 1
    money = 1000
    stock_price = random.randint(5, 50)
    number_of_stocks = 0

    # Вывод приветствия и начального состояния
    print("Добро пожаловать в игру STOCK!")
    print(f"Начальное состояние: День {current_day}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}\\n")

    # Основной игровой цикл
    while current_day <= number_of_days:
        # Изменяем цену акции случайным образом
        stock_price = round(random.uniform(stock_price * 0.9, stock_price * 1.1), 2)

        # Выводим текущее состояние
        print(f"День {current_day}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}")

        # Запрашиваем действие пользователя
        action = input("Купить (buy) или продать (sell) акции? (или нажмите Enter для перехода к следующему дню): ").lower()

        # Обработка действий пользователя
        if action == 'buy':
            try:
                stocks_to_buy = int(input("Сколько акций купить? "))
                if money >= stocks_to_buy * stock_price:
                    money -= stocks_to_buy * stock_price
                    number_of_stocks += stocks_to_buy
                    print("Покупка совершена")
                else:
                    print("Недостаточно денег для покупки.")
            except ValueError:
                print("Некорректный ввод. Пожалуйста, введите целое число.")
        elif action == 'sell':
            try:
                stocks_to_sell = int(input("Сколько акций продать? "))
                if number_of_stocks >= stocks_to_sell:
                    money += stocks_to_sell * stock_price
                    number_of_stocks -= stocks_to_sell
                    print("Продажа совершена")
                else:
                    print("Недостаточно акций для продажи.")
            except ValueError:
                print("Некорректный ввод. Пожалуйста, введите целое число.")
        else:
            print("Переходим к следующему дню.")

        current_day += 1
        print("-----------------")

    # Вывод итогового состояния игры
    print("Игра окончена!")
    print(f"Итоговое состояние: День {current_day - 1}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}")
"""
import random  # импорт модуля random # импортируем модуль для генерации случайных чисел
from src.logger.logger import logger # импортируем логгер для записи ошибок

# Инициализация параметров игры
number_of_days = 20  # общее количество дней игры
current_day = 1  # текущий игровой день # текущий день
money = 1000  # начальное количество денег у игрока # начальные деньги
stock_price = random.randint(5, 50)  # начальная цена акции, случайное значение # цена акции
number_of_stocks = 0  # начальное количество акций у игрока # количество акций

# Вывод приветствия и начального состояния
print("Добро пожаловать в игру STOCK!") # выводим приветственное сообщение
print(f"Начальное состояние: День {current_day}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}\n") # выводим начальное состояние игры

# Основной игровой цикл
while current_day <= number_of_days:  # цикл продолжается пока текущий день меньше или равен общему количеству дней
    # Изменяем цену акции случайным образом
    stock_price = round(random.uniform(stock_price * 0.9, stock_price * 1.1), 2) # обновляем цену акции

    # Выводим текущее состояние
    print(f"День {current_day}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}") # выводим текущее состояние игры

    # Запрашиваем действие пользователя
    action = input("Купить (buy) или продать (sell) акции? (или нажмите Enter для перехода к следующему дню): ").lower() # запрашиваем действие пользователя

    # Обработка действий пользователя
    if action == 'buy': # проверяем выбрано ли действие "купить"
        try: # блок для отлова ошибок ввода
            stocks_to_buy = int(input("Сколько акций купить? ")) # запрашиваем количество акций для покупки
            if money >= stocks_to_buy * stock_price:  # проверяем достаточно ли денег для покупки
                money -= stocks_to_buy * stock_price # уменьшаем количество денег
                number_of_stocks += stocks_to_buy  # увеличиваем количество акций
                print("Покупка совершена") # выводим сообщение об успешной покупке
            else:
                print("Недостаточно денег для покупки.") # выводим сообщение о недостатке денег
        except ValueError as e: # отлавливаем ошибку ввода
            logger.error(f'Ошибка ввода при покупке акций: {e}') # логируем ошибку
            print("Некорректный ввод. Пожалуйста, введите целое число.") # выводим сообщение об ошибке
    elif action == 'sell': # проверяем выбрано ли действие "продать"
        try: # блок для отлова ошибок ввода
            stocks_to_sell = int(input("Сколько акций продать? ")) # запрашиваем количество акций для продажи
            if number_of_stocks >= stocks_to_sell:  # проверяем достаточно ли акций для продажи
                money += stocks_to_sell * stock_price # увеличиваем количество денег
                number_of_stocks -= stocks_to_sell  # уменьшаем количество акций
                print("Продажа совершена") # выводим сообщение об успешной продаже
            else:
                print("Недостаточно акций для продажи.") # выводим сообщение о недостатке акций
        except ValueError as e: # отлавливаем ошибку ввода
            logger.error(f'Ошибка ввода при продаже акций: {e}') # логируем ошибку
            print("Некорректный ввод. Пожалуйста, введите целое число.") # выводим сообщение об ошибке
    else:
        print("Переходим к следующему дню.") # выводим сообщение о переходе к следующему дню

    current_day += 1 # увеличиваем текущий день на 1
    print("-----------------") # выводим разделитель

# Вывод итогового состояния игры
print("Игра окончена!")  # выводим сообщение об окончании игры
print(f"Итоговое состояние: День {current_day - 1}, Цена акции: {stock_price}, Акций: {number_of_stocks}, Денег: {money}") # выводим итоговое состояние игры
```