# Модуль для конвертации HTML в DOCX

## Обзор

Модуль предназначен для конвертации HTML-файлов в формат DOCX с использованием LibreOffice. Он предоставляет функцию `html_to_docx`, которая принимает путь к HTML-файлу и путь для сохранения DOCX-файла.

## Подробней

Этот модуль использует LibreOffice для преобразования HTML в DOCX. Он проверяет наличие входного HTML-файла, создает выходной каталог, если он не существует, и выполняет команду LibreOffice в режиме без графического интерфейса. В случае успеха возвращает `True`, иначе `False`. Модуль также обрабатывает возможные ошибки, такие как отсутствие LibreOffice или ошибки во время конвертации, и записывает их в журнал.
В контексте проекта `hypotez` этот модуль может быть использован для автоматической генерации DOCX-документов на основе HTML-шаблонов.

## Функции

### `html_to_docx`

```python
def html_to_docx(html_file: str, output_docx: Path | str) -> bool:
    """Converts an HTML file to a Word document using LibreOffice.

    Args:
        html_file (str): Path to the input HTML file as a string.
        output_docx (Path | str): Path to the output DOCX file.

    Returns:
        bool: True if conversion is successful, False otherwise.
    """
```

**Описание**: Преобразует HTML-файл в Word-документ с использованием LibreOffice.

**Как работает функция**:
1. **Проверяет существование HTML-файла**: Функция сначала проверяет, существует ли HTML-файл по указанному пути. Если файл не найден, она регистрирует ошибку и возвращает `False`.
2. **Обеспечивает существование выходного каталога**: Затем функция проверяет, существует ли выходной каталог, в котором должен быть создан DOCX-файл. Если каталог не существует, он создается.
3. **Конструирует команду для LibreOffice**: Функция создает команду для вызова LibreOffice в режиме без графического интерфейса, указывая, что входной файл является HTML-файлом и что его нужно преобразовать в формат DOCX.
4. **Выполняет команду LibreOffice**: Затем функция выполняет команду LibreOffice с использованием модуля `subprocess`. Она перехватывает стандартный вывод и стандартный поток ошибок, чтобы проверить наличие каких-либо ошибок во время преобразования.
5. **Проверяет наличие ошибок**: Если в процессе преобразования возникают какие-либо ошибки, функция регистрирует их и возвращает `False`. В противном случае она возвращает `True`, указывая на успешное преобразование.

**Параметры**:
- `html_file` (str): Путь к входному HTML-файлу в виде строки.
- `output_docx` (Path | str): Путь к выходному DOCX-файлу.

**Возвращает**:
- `bool`: `True`, если преобразование выполнено успешно, `False` в противном случае.

**Вызывает исключения**:
- `subprocess.CalledProcessError`: Если LibreOffice не смог преобразовать HTML-файл.
- `FileNotFoundError`: Если исполняемый файл LibreOffice (soffice) не найден.
- `Exception`: При возникновении неожиданной ошибки во время преобразования.

**Примеры**:

```python
from pathlib import Path

html_file = "template.html"  # Замените на ваш HTML-файл
output_docx = Path("output_libreoffice.docx")  # Замените на желаемый выходной файл

if html_to_docx(html_file, output_docx):
    print(f"Успешно преобразован {html_file} в {output_docx} с использованием LibreOffice!")
else:
    print(f"Не удалось преобразовать {html_file} в {output_docx} с использованием LibreOffice.")