# Анализ кода модуля `anagram_generator.py`

**Качество кода**

-  **Соответствие требованиям к формату кода (1-10):** 6/10
    -   **Преимущества:**
        -   Код содержит подробные комментарии на русском языке, объясняющие логику работы.
        -   Используется `try-except` блок для обработки ошибок при взаимодействии с API.
        -   Присутствует объяснение назначения регулярных выражений для очистки ввода.
    -   **Недостатки:**
        -   Отсутствует reStructuredText (RST) для комментариев и docstring.
        -   Не используется `j_loads` или `j_loads_ns`.
        -   Не хватает импорта `logger` для логирования ошибок.
        -   Стиль комментариев не соответствует требуемому.
        -   Нет разделения на функции и модули.
        -   Код не соответствует PEP8.

**Рекомендации по улучшению**

1.  **Перевод комментариев в reStructuredText (RST):** Замените все комментарии на формат RST, включая docstrings для функций и классов.
2.  **Использование `j_loads` или `j_loads_ns`:**  В данном коде нет операций с файлами, поэтому замена не требуется, но при добавлении функционала следует помнить об этом.
3.  **Добавление импорта `logger`:** Импортируйте `logger` из `src.logger.logger` для логирования ошибок.
4.  **Обработка ошибок через `logger.error`:** Замените стандартные блоки `try-except` на использование `logger.error` для обработки ошибок.
5.  **Разделение на функции:** Разделите код на функции для повышения читаемости и переиспользуемости.
6.  **Использование `__name__ == '__main__'`:** Код должен запускаться только при прямом вызове скрипта.
7.  **Удаление ненужных комментариев:** Удалите общие комментарии.

**Улучшенный код**

```python
"""
Модуль для генерации анаграмм с использованием Google Gemini.
=========================================================================================

Этот модуль предоставляет класс :class:`GoogleGenerativeAI` для создания анаграмм
из введенных пользователем букв, используя API Google Gemini.

Пример использования:
--------------------

.. code-block:: python

    if __name__ == "__main__":
        api_key = input("Введите API ключ Google Gemini: ")
        anagram_generator = GoogleGenerativeAI(api_key=api_key)
        while True:
            user_input = input("Введите буквы, по которым Gemini подберет анаграмму: ")
            if not user_input:
                break
            result = anagram_generator.generate_anagram(user_input)
            print(result)
"""

import google.generativeai as genai # Импортируется библиотека для взаимодействия с Gemini.
import re # Импортируется библиотека для работы с регулярными выражениями.
from src.logger.logger import logger # Импортируется logger для логирования ошибок. # Добавлен импорт logger

class GoogleGenerativeAI:
    """
    Класс для генерации анаграмм с использованием Google Gemini.

    :param api_key: API ключ Google Gemini.
    """
    def __init__(self, api_key: str):
        """
        Инициализирует экземпляр класса GoogleGenerativeAI.

        :param api_key: API ключ Google Gemini.
        """
        self.api_key = api_key
        genai.configure(api_key=self.api_key) # Конфигурирование API ключа
        self.model = genai.GenerativeModel('gemini-pro') # Инициализация модели Gemini Pro
        self.system_instruction = """
        Ты - генератор анаграмм. Тебе дается набор русских букв,
        и ты пытаешься найти существующее слово русского языка,
        составленное из этих букв (используя все или часть из них).
        
        Правила анаграмм:
        *   Используются только существующие слова русского языка.
        *   При поиске анаграмм учитываются только русские буквы. Цифры и другие символы игнорируются.
        *   Если возможно составить несколько слов, возвращается одно из них.
        *   Если из заданных букв нельзя составить ни одного слова, возвращается сообщение "Нет анаграмм".
        """ # Системный промпт для Gemini

    def generate_anagram(self, letters: str) -> str:
        """
        Генерирует анаграмму для заданного набора букв.

        :param letters: Набор букв для поиска анаграммы.
        :return: Анаграмма или сообщение об отсутствии анаграмм.
        """
        q = re.sub(r"[^а-яА-ЯёЁ]", "", letters) # Удаление всех некириллических символов
        if not q: # Проверка, не пустая ли строка после очистки
            return "Введены некорректные символы."

        try:
            response = self.model.generate_content(f"{self.system_instruction} Найди анаграмму для букв: {q}") # Отправляет запрос модели Gemini
            return response.text # Возвращает текст ответа
        except Exception as ex:
            logger.error('Ошибка при взаимодействии с API Gemini', ex) # Запись ошибки в лог
            return "Произошла ошибка при генерации анаграммы." # Возвращает сообщение об ошибке

if __name__ == "__main__":
    api_key = input("Введите API ключ Google Gemini: ") # Запрос API ключа
    anagram_generator = GoogleGenerativeAI(api_key=api_key) # Создание экземпляра класса
    while True:
        user_input = input("Введите буквы, по которым Gemini подберет анаграмму: ") # Запрос букв для анаграммы
        if not user_input: # Выход из цикла, если ввод пустой
            break
        result = anagram_generator.generate_anagram(user_input) # Запуск поиска анаграммы
        print(result) # Вывод результата

```