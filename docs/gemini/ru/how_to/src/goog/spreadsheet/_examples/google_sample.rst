Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код взаимодействует с Google Sheets API для чтения данных из определенного листа. Он ищет файл `token.json` для авторизации. Если файл не найден или токен недействителен, запрашивается авторизация у пользователя. После успешной авторизации и получения токена, код считывает данные из указанного диапазона ячеек (в примере `Class Data!A2:E`) и выводит столбцы "Имя" и "Специальность".

Шаги выполнения
-------------------------
1. **Установка необходимых библиотек:** Код импортирует необходимые библиотеки для работы с Google API, включая `googleapiclient`, `google-auth`, `google-auth-oauthlib`, `pathlib` и `os.path`.


2. **Определение констант:** Определяются переменные `SCOPES`, `SAMPLE_SPREADSHEET_ID`, `SAMPLE_RANGE_NAME` и `ROOT_DIRECTORY`, содержащие необходимые параметры для подключения к Google Sheets и выбора диапазона данных.


3. **Получение токена доступа (если необходимо):**
    * Код проверяет наличие файла `token.json` с сохраненными токенами.
    * Если файл `token.json` существует и содержит валидные токены, то они используются для авторизации.
    * Если файл отсутствует или токен недействителен, выполняется запрос авторизации у пользователя:
        * Создается поток авторизации `flow`.
        * Запускается локальный сервер для авторизации.
        * Полученный токен сохраняется в файл `token.json` для дальнейшего использования.

4. **Подключение к Google Sheets API:**  Код создаёт объект `service` для взаимодействия с API Google Sheets.


5. **Чтение данных из Google Sheets:**
    * Выполняется запрос к Google Sheets с использованием метода `sheet.values().get()`.
    * Извлекаются значения из указанного диапазона (`SAMPLE_RANGE_NAME`).


6. **Обработка результатов:**
    * Проверяется, содержат ли полученные данные (`values`) значения. Если нет, выводится сообщение "No data found." и функция завершается.
    * Цикл `for` проходит по каждой строке (`row`) в полученных данных.
    * Выводятся значения столбцов "Имя" и "Специальность" (столбцы с индексами 0 и 4).


7. **Обработка ошибок:** Код обрабатывает возможные ошибки (`HttpError`), вызывая исключение и выводя сообщение об ошибке.


Пример использования
-------------------------
.. code-block:: python

    # Убедитесь, что у вас установлены необходимые библиотеки:
    # pip install google-api-python-client google-auth-httplib2 google-auth-oauthlib

    # Замените 'client_secret_920776813054-crpf1rcav3uui51kq9q1lis64glkpatj.apps.googleusercontent.com.json' на ваш собственный файл.
    # Также обновите SAMPLE_SPREADSHEET_ID и SAMPLE_RANGE_NAME, если необходимо.

    # Запустите код.  
    # При запуске, если token.json не найден, будет запущен веб-браузер, чтобы вы авторизовались в Google.