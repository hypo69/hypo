# Модуль hypotez/src/utils/xls.py

## Обзор

Этот модуль предоставляет функции для конвертации файлов Excel (`xls`) в формат JSON и обратно. Он умеет обрабатывать несколько листов, сохранять данные в JSON-файлы и обрабатывать ошибки.

## Функции

### `read_xls_as_dict`

**Описание**: Читает файл Excel и конвертирует его в JSON.  Можно конвертировать конкретный лист и сохранить результат в JSON-файл.  Обрабатывает ошибки.

**Параметры**:

- `xls_file` (str): Путь к файлу Excel.
- `json_file` (str, опционально): Путь к файлу JSON для сохранения результата. По умолчанию `None`.
- `sheet_name` (Union[str, int], опционально): Имя или индекс листа для конвертации. По умолчанию `None` (конвертируются все листы).


**Возвращает**:

- Union[Dict, List[Dict], bool]: Словарь, содержащий данные из Excel в формате {имя листа: [строки]}. Если произошла ошибка, возвращает `False`.


**Возможные исключения**:

- `FileNotFoundError`: Файл Excel не найден.
- Другие исключения: Возможны ошибки при чтении файла Excel или конвертации данных.  Модуль обрабатывает эти ошибки, регистрирует их с помощью логгера и возвращает `False`.


### `save_xls_file`

**Описание**: Сохраняет данные JSON в файл Excel. Обрабатывает ошибки.

**Параметры**:

- `data` (Dict[str, List[Dict]]): Данные в формате {имя листа: [строки]}. Строки представляют собой словари с данными.
- `file_path` (str): Путь к файлу Excel для сохранения.

**Возвращает**:

- bool: `True`, если сохранение прошло успешно, `False` в противном случае.


**Возможные исключения**:

- Другие исключения: Возможны ошибки при записи в файл Excel. Модуль обрабатывает эти ошибки, регистрирует их с помощью логгера и возвращает `False`.


## Логирование

Модуль использует `logging` для записи сообщений об ошибках и успешных операциях.  Уровень логирования настроен на `INFO`.


## Примеры использования

```python
# Чтение и сохранение в JSON
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')  # Читает лист 'Sheet1'
if data:
    print(data)  # Вывод будет {'Sheet1': [{...}]}

# Сохранение из JSON данных
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Успешно сохранено в output.xlsx")
```

## Структура модуля

Модуль использует `pandas` для работы с Excel и `json` для работы с JSON.  Использует `pathlib` для работы с путями к файлам.
```
```