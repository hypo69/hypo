# Анализ кода модуля `war_2.py`

**Качество кода**
8
-   Плюсы
    -   Код игры "Война" реализован в соответствии с правилами.
    -   Используются списки для представления колод карт.
    -   Логика игры разделена на функции и блоки, что делает код более читаемым.
    -   Вывод в консоль помогает следить за ходом игры.
-   Минусы
    -   Не используются `j_loads` или `j_loads_ns` для чтения файлов (хотя в данном коде нет операций с файлами).
    -   Отсутствуют docstring и комментарии в формате reStructuredText (RST).
    -   Не используется логирование ошибок с помощью `src.logger.logger`.
    -   Некоторые переменные и функции могут быть переименованы для большей ясности.
    -   Нет обработки исключений, хотя они могут возникнуть (например, при пустой колоде во время войны).
    -   Код не соответствует всем стандартам PEP 8, например, некоторые строки слишком длинные.
    -   Не используются константы для максимального количества ходов.
    
**Рекомендации по улучшению**

1.  **Документация в формате RST:**
    - Добавить docstring в формате RST для модуля и функции `play_war_game()`.
2.  **Импорты:**
    - Добавить необходимые импорты, такие как `logger` из `src.logger.logger`.
3.  **Логирование ошибок:**
    -   Использовать `logger.error` для обработки ошибок.
4.  **Константы:**
    -   Использовать константу для максимального количества ходов (например, `MAX_TURNS = 20`).
5.  **Улучшение читаемости кода:**
    -   Переименовать переменные для большей ясности.
6.  **Обработка исключений:**
    -   Добавить обработку исключений для случаев, когда колода пуста во время войны.
    
**Оптимизированный код**

```python
"""
Модуль реализует игру "Война" между компьютером и пользователем.
================================================================

В игре два игрока, компьютер и пользователь, получают по половине колоды карт.
В каждом раунде игроки открывают верхние карты, и игрок с высшей картой забирает обе карты.
Победителем становится игрок, собравший все карты.
"""
import random
from src.logger.logger import logger # Импорт модуля logger

MAX_TURNS = 20 # Константа для максимального количества ходов

def play_war_game() -> None:
    """
    Выполняет игру "Война" между компьютером и пользователем.

    Игра продолжается до тех пор, пока один из игроков не соберет все карты
    или пока не будет сыграно максимальное количество раундов (MAX_TURNS).
    """

    # Инициализация колод карт для компьютера и пользователя
    computer_deck = list(range(1, 6))
    user_deck = list(range(6, 11))

    # Вывод начального состояния колод
    print("Начальные колоды:")
    print(f"Колода компьютера: {computer_deck}")
    print(f"Колода пользователя: {user_deck}")

    # Основной цикл игры
    for turn in range(MAX_TURNS): # Цикл по максимальному количеству ходов
        print(f"\nРаунд {turn + 1}:")

        # Проверка, не пуста ли одна из колод
        if not computer_deck:
            print("Колода компьютера пуста, вы победили!")
            return
        if not user_deck:
            print("Колода пользователя пуста, компьютер победил!")
            return

        # Извлечение верхних карт из колод
        try:
            computer_card = computer_deck.pop(0)
            user_card = user_deck.pop(0)
        except IndexError as e: # Обработка исключения, если колода пуста
            logger.error("Ошибка извлечения карты из пустой колоды", exc_info=True)
            print("Ошибка: Невозможно извлечь карту из пустой колоды.")
            return
        
        print(f"Компьютер вытягивает: {computer_card}")
        print(f"Пользователь вытягивает: {user_card}")

        # Сравнение карт и определение победителя раунда
        if user_card > computer_card:
            print("Пользователь выигрывает раунд")
            user_deck.extend([user_card, computer_card])
        elif computer_card > user_card:
            print("Компьютер выигрывает раунд")
            computer_deck.extend([computer_card, user_card])
        else:
            # Начало "войны" при равных картах
            print("Война!")
            war_cards = [computer_card, user_card]  # Сохранение карт для войны
            while True:
                # Проверка, не пуста ли одна из колод во время войны
                if not computer_deck or not user_deck:
                  if not computer_deck:
                    print("Колода компьютера пуста во время войны, вы победили!")
                  else:
                      print("Колода пользователя пуста во время войны, компьютер победил!")
                  return

                # Извлечение дополнительных карт для войны
                try:
                    computer_war_card = computer_deck.pop(0)
                    user_war_card = user_deck.pop(0)
                    
                    war_cards.extend([computer_war_card,user_war_card]) # Добавление карт в список военных карт

                    # Проверка, существуют ли карты для сравнения
                    if computer_war_card is None or user_war_card is None:
                       if not computer_deck:
                            print("Колода компьютера пуста во время войны, вы победили!")
                       else:
                            print("Колода пользователя пуста во время войны, компьютер победил!")
                       return
                    print(f"Компьютер вытягивает дополнительную карту для войны: {computer_war_card}")
                    print(f"Пользователь вытягивает дополнительную карту для войны: {user_war_card}")

                except IndexError as e:
                    logger.error("Ошибка извлечения карты во время войны", exc_info=True)
                    print("Ошибка: Невозможно извлечь карту во время войны.")
                    return

                # Сравнение дополнительных карт для войны
                if user_war_card > computer_war_card:
                   print("Пользователь выигрывает войну!")
                   user_deck.extend(war_cards)
                   break
                elif computer_war_card > user_war_card:
                   print("Компьютер выигрывает войну!")
                   computer_deck.extend(war_cards)
                   break
                else:
                    print("Еще одна ничья в войне! Продолжаем войну")

        # Вывод состояния колод после каждого раунда
        print(f"Колода компьютера: {computer_deck}")
        print(f"Колода пользователя: {user_deck}")

    # Определение победителя после завершения всех раундов
    if len(user_deck) > len(computer_deck):
      print("\nПользователь выиграл игру!")
    elif len(computer_deck) > len(user_deck):
        print("\nКомпьютер выиграл игру!")
    else:
      print("\nНичья в игре!")

if __name__ == "__main__":
    play_war_game()
```