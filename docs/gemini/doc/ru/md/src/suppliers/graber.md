# Модуль `hypotez/src/suppliers/graber.py`

## Обзор

Этот модуль содержит базовый класс `Graber` для сбора данных с HTML-страниц поставщиков. Он использует веб-драйвер (класс `Driver`) для извлечения целевых полей (название, описание, спецификация, артикул, цена и т.д.) из страницы.  Позиции полей определяются локаторами, хранящимися в файлах JSON в папке `locators` каждого поставщика. Подробности о локаторах см. в файле `locators.ru.md`.

Для нестандартной обработки полей товара можно переопределять функции в наследуемых классах.

## Классы

### `Context`

**Описание**: Класс для хранения глобальных настроек, таких как объект драйвера (`driver`), локаторы (`locator`) и префикс поставщика (`supplier_prefix`).

**Атрибуты**:

- `driver` (Driver): Объект драйвера для управления браузером.
- `locator` (SimpleNamespace): Пространство имен для хранения локаторов.
- `supplier_prefix` (str): Префикс поставщика.

### `Graber`

**Описание**: Базовый класс для сбора данных с веб-страниц всех поставщиков.

**Методы**:

#### `__init__(self, supplier_prefix: str, driver: Driver)`

**Описание**: Инициализирует класс `Graber`.

**Параметры**:

- `supplier_prefix` (str): Префикс поставщика.
- `driver` (Driver): Экземпляр класса `Driver`.

**Возвращает**:
- None

#### `error(self, field: str)`

**Описание**: Обработчик ошибок для полей.

**Параметры**:

- `field` (str): Название поля, в котором произошла ошибка.

**Возвращает**:
- None

#### `set_field_value(self, value: Any, locator_func: Callable[[], Any], field_name: str, default: Any = '')`

**Описание**: Универсальная функция для установки значений полей с обработкой ошибок.

**Параметры**:

- `value` (Any): Значение для установки.
- `locator_func` (Callable[[], Any]): Функция для получения значения из локатора.
- `field_name` (str): Название поля.
- `default` (Any): Значение по умолчанию (по умолчанию пустая строка).

**Возвращает**:
- Any: Установленное значение.

#### `grab_page(self) -> ProductFields`

**Описание**: Асинхронная функция для сбора полей продукта.

**Возвращает**:
- `ProductFields`: Собранные поля продукта.

#### `[Методы для каждого поля (id_product, name, price, etc)]`

**Описание**: Асинхронные методы для сбора конкретных данных товара, используя локаторы из `self.locator`.  
Каждый метод получает значение `value` как аргумент, которое может быть передано извне для настройки (переопределения) значения поля.  Методы возвращают True при успешном выполнении, иначе None.


## Функции

### `close_pop_up(value: Any = None) -> Callable`

**Описание**: Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции. Используется для обработки всплывающих окон перед извлечением данных.

**Параметры**:
- `value` (Any): Дополнительное значение для декоратора.

**Возвращает**:
- `Callable`: Декоратор, оборачивающий функцию.