# Модуль options.js

## Обзор

Этот JavaScript-модуль отвечает за обработку пользовательских настроек расширения try_xpath. Он получает и сохраняет атрибуты, стили и другие параметры, связанные с отображением всплывающего окна расширения.

## Функции

### `isValidAttrName`

**Описание**: Проверяет, является ли переданное имя атрибута допустимым для использования в элементе DOM.

**Параметры**:

- `name` (str): Имя атрибута для проверки.

**Возвращает**:

- `boolean`: `true`, если имя атрибута валидно, `false` иначе.

**Вызывает исключения**:

-  Возможны исключения при работе с DOM, но они не обрабатываются явно.


### `isValidAttrNames`

**Описание**: Проверяет, являются ли все имена атрибутов в массиве допустимыми.

**Параметры**:

- `names` (object): Объект, содержащий имена атрибутов.

**Возвращает**:

- `boolean`: `true`, если все имена атрибутов валидны, `false` иначе.


### `isValidStyleLength`

**Описание**: Проверяет, является ли переданная строка допустимым значением размера стилей (ширина/высота).

**Параметры**:

- `len` (str): Строка, представляющая значение размера.

**Возвращает**:

- `boolean`: `true`, если строка соответствует формату "auto" или "[число]px", `false` иначе.


### `loadDefaultCss`

**Описание**: Загружает CSS-стили по умолчанию из файла `try_xpath_insert.css`.

**Возвращает**:

- `Promise<string>`: Promise, содержащий загруженный CSS-код. Возвращает `null` при ошибке загрузки.


### `extractBodyStyles`

**Описание**: Извлекает значения ширины и высоты из CSS-строки.

**Параметры**:

- `css` (str): Строка CSS-стилей.

**Возвращает**:

- `object`: Объект `{width: str, height: str}`, содержащий значения ширины и высоты.


### `createPopupCss`

**Описание**: Создает CSS-строку для стилизации тела всплывающего окна.

**Параметры**:

- `bodyStyles` (object): Объект `{width: str, height: str}`, содержащий значения ширины и высоты.

**Возвращает**:

- `string`: Строка CSS для тела всплывающего окна.


## Обработчики событий

### `window.addEventListener("load", ...)`

**Описание**: Обработчик события загрузки страницы. Инициализирует элементы, запрашивает настройки из `browser.runtime` и устанавливает обработчики событий для кнопок сохранения и показа значений по умолчанию.


##  Переменные

`defaultAttributes`, `defaultPopupBodyStyles`:  Константные объекты, содержащие значения атрибутов и стилей по умолчанию.


## Взаимодействие с браузером

- `browser.runtime.sendMessage`: Используется для запроса настроек из другого скрипта или функции расширения.
- `browser.storage.sync.set`: Используется для сохранения настроек в хранилище.
- `browser.runtime.getURL`: Используется для получения URL ресурсов расширения.


## Обработка ошибок

- `fu.onError`: Функция для обработки ошибок, вероятно, перехватывающая ошибки при обращении к хранилищу или другим браузерным API.
-  Исключение `e` явно обрабатывается в нескольких местах с помощью `catch(e)`.

## Замечания

- Код использует асинхронную обработку с `Promise` и `XMLHttpRequest` для загрузки CSS-стилей.
- Прямая обработка DOM-элементов.
- Использует обработчики событий для реагирования на пользовательские действия (нажатие кнопок).
- Правильно проверяет вводимые данные на валидность.