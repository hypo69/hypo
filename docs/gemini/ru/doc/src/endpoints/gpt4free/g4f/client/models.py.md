# Модуль для управления моделями клиентов

## Обзор

Модуль `ClientModels` предоставляет класс для управления и получения информации о моделях, доступных через различных провайдеров, таких как языковые модели, модели для работы с изображениями и видео. Он предназначен для упрощения доступа к моделям и их конфигурациям, а также для работы с различными API-ключами.

## Подробней

Этот модуль является частью системы `gpt4free` в проекте `hypotez` и отвечает за организацию взаимодействия с различными поставщиками моделей (провайдерами). Он предоставляет методы для получения списка доступных моделей, моделей компьютерного зрения и мультимедийных моделей.

## Классы

### `ClientModels`

**Описание**: Класс `ClientModels` предназначен для управления моделями, предоставляемыми различными провайдерами. Он инициализируется с клиентом, провайдером и медиа-провайдером, и предоставляет методы для получения моделей по имени, получения всех доступных моделей, моделей компьютерного зрения, изображений и видео.

**Принцип работы**:
Класс `ClientModels` агрегирует информацию о моделях от различных провайдеров. В конструкторе класса инициализируются клиент, основной провайдер моделей и провайдер мультимедийных моделей. Методы класса позволяют получать модели по имени, списки всех моделей, а также специализированные списки моделей для работы с изображениями и видео. Класс использует утилиты `ModelUtils` и `ProviderUtils` для конвертации и получения информации о моделях и провайдерах.

**Методы**:
- `__init__`: Инициализирует экземпляр класса `ClientModels`.
- `get`: Возвращает провайдера по имени модели или провайдера.
- `get_all`: Возвращает список всех доступных моделей для данного провайдера.
- `get_vision`: Возвращает список моделей, поддерживающих компьютерное зрение.
- `get_media`: Возвращает список мультимедийных моделей для данного провайдера.
- `get_image`: Возвращает список моделей для работы с изображениями.
- `get_video`: Возвращает список моделей для работы с видео.

#### `__init__`

```python
def __init__(self, client, provider: ProviderType = None, media_provider: ProviderType = None):
    """
    Инициализирует экземпляр класса `ClientModels`.

    Args:
        client: Клиент, используемый для выполнения запросов.
        provider (ProviderType, optional): Основной провайдер моделей. По умолчанию `None`.
        media_provider (ProviderType, optional): Провайдер мультимедийных моделей. По умолчанию `None`.
    """
```

**Параметры**:
- `client`: Клиент, используемый для выполнения запросов к провайдерам.
- `provider` (ProviderType, optional): Основной провайдер моделей. Используется для текстовых и других основных задач. По умолчанию `None`.
- `media_provider` (ProviderType, optional): Провайдер мультимедийных моделей. Используется для работы с изображениями и видео. По умолчанию `None`.

**Как работает метод**:
1. Метод `__init__` инициализирует класс `ClientModels`, сохраняя ссылки на клиент, основного провайдера и медиа-провайдера.
2. Эти ссылки используются для последующего взаимодействия с моделями и получения информации о них.

#### `get`

```python
def get(self, name, default=None) -> ProviderType:
    """
    Возвращает провайдера по имени модели или провайдера.

    Args:
        name: Имя модели или провайдера.
        default: Значение по умолчанию, если модель не найдена.

    Returns:
        ProviderType: Провайдер, соответствующий имени, или значение по умолчанию.
    """
```

**Параметры**:
- `name`: Имя модели или провайдера, для которого требуется получить информацию.
- `default`: Значение, которое будет возвращено, если модель или провайдер не найдены. По умолчанию `None`.

**Возвращает**:
- `ProviderType`: Провайдер, соответствующий переданному имени, или значение по умолчанию, если провайдер не найден.

**Как работает метод**:
1. Метод `get` ищет провайдера в `ModelUtils.convert` и `ProviderUtils.convert` по имени.
2. Если находит, возвращает соответствующего провайдера.
3. Если провайдер не найден, возвращает значение по умолчанию.

**Примеры**:

```python
client_models = ClientModels(client=some_client)
provider = client_models.get('gpt-3.5-turbo', default='fallback_provider')
print(provider)  # Выводит: <провайдер gpt-3.5-turbo> или 'fallback_provider'
```

#### `get_all`

```python
def get_all(self, api_key: str = None, **kwargs) -> list[str]:
    """
    Возвращает список всех доступных моделей для данного провайдера.

    Args:
        api_key (str, optional): API-ключ для доступа к моделям. По умолчанию `None`.
        **kwargs: Дополнительные аргументы, передаваемые провайдеру.

    Returns:
        list[str]: Список идентификаторов доступных моделей.
    """
```

**Параметры**:
- `api_key` (str, optional): API-ключ, используемый для аутентификации при запросе списка моделей у провайдера. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы, которые могут быть переданы методу `get_models` провайдера.

**Возвращает**:
- `list[str]`: Список идентификаторов моделей, доступных через данного провайдера.

**Как работает метод**:
1. Метод `get_all` проверяет, установлен ли провайдер. Если нет, возвращает пустой список.
2. Если `api_key` не передан, использует `api_key` клиента.
3. Вызывает метод `get_models` провайдера, передавая `api_key` (если он есть) и дополнительные аргументы `kwargs`.
4. Возвращает список моделей, полученный от провайдера.

**Примеры**:

```python
client_models = ClientModels(client=some_client, provider=some_provider)
models = client_models.get_all(api_key='your_api_key')
print(models)  # Выводит: ['model1', 'model2', ...]
```

#### `get_vision`

```python
def get_vision(self, **kwargs) -> list[str]:
    """
    Возвращает список моделей, поддерживающих компьютерное зрение.

    Args:
        **kwargs: Дополнительные аргументы, передаваемые провайдеру.

    Returns:
        list[str]: Список идентификаторов моделей компьютерного зрения.
    """
```

**Параметры**:
- `**kwargs`: Дополнительные аргументы, которые могут быть переданы методу `get_all` провайдера.

**Возвращает**:
- `list[str]`: Список идентификаторов моделей, поддерживающих компьютерное зрение.

**Как работает метод**:
1. Метод `get_vision` проверяет, установлен ли провайдер. Если нет, возвращает список моделей из `ModelUtils.convert`, которые являются экземплярами `VisionModel`.
2. Если провайдер установлен, вызывает метод `get_all` для обновления списка моделей.
3. Если у провайдера есть атрибут `vision_models`, возвращает его значение.
4. В противном случае возвращает пустой список.

**Примеры**:

```python
client_models = ClientModels(client=some_client, provider=some_provider)
vision_models = client_models.get_vision()
print(vision_models)  # Выводит: ['vision_model1', 'vision_model2', ...]
```

#### `get_media`

```python
def get_media(self, api_key: str = None, **kwargs) -> list[str]:
    """
    Возвращает список мультимедийных моделей для данного провайдера.

    Args:
        api_key (str, optional): API-ключ для доступа к моделям. По умолчанию `None`.
        **kwargs: Дополнительные аргументы, передаваемые провайдеру.

    Returns:
        list[str]: Список идентификаторов мультимедийных моделей.
    """
```

**Параметры**:
- `api_key` (str, optional): API-ключ, используемый для аутентификации при запросе списка моделей у медиа-провайдера. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы, которые могут быть переданы методу `get_models` медиа-провайдера.

**Возвращает**:
- `list[str]`: Список идентификаторов мультимедийных моделей, доступных через данного провайдера.

**Как работает метод**:
1. Метод `get_media` проверяет, установлен ли медиа-провайдер. Если нет, возвращает пустой список.
2. Если `api_key` не передан, использует `api_key` клиента.
3. Вызывает метод `get_models` медиа-провайдера, передавая `api_key` (если он есть) и дополнительные аргументы `kwargs`.
4. Возвращает список моделей, полученный от медиа-провайдера.

**Примеры**:

```python
client_models = ClientModels(client=some_client, media_provider=some_media_provider)
media_models = client_models.get_media(api_key='your_api_key')
print(media_models)  # Выводит: ['media_model1', 'media_model2', ...]
```

#### `get_image`

```python
def get_image(self, **kwargs) -> list[str]:
    """
    Возвращает список моделей для работы с изображениями.

    Args:
        **kwargs: Дополнительные аргументы, передаваемые провайдеру.

    Returns:
        list[str]: Список идентификаторов моделей для работы с изображениями.
    """
```

**Параметры**:
- `**kwargs`: Дополнительные аргументы, которые могут быть переданы методу `get_media` медиа-провайдера.

**Возвращает**:
- `list[str]`: Список идентификаторов моделей, предназначенных для работы с изображениями.

**Как работает метод**:
1. Метод `get_image` проверяет, установлен ли медиа-провайдер. Если нет, возвращает список моделей из `ModelUtils.convert`, которые являются экземплярами `ImageModel`.
2. Если медиа-провайдер установлен, вызывает метод `get_media` для обновления списка моделей.
3. Если у медиа-провайдера есть атрибут `image_models`, возвращает его значение.
4. В противном случае возвращает пустой список.

**Примеры**:

```python
client_models = ClientModels(client=some_client, media_provider=some_media_provider)
image_models = client_models.get_image()
print(image_models)  # Выводит: ['image_model1', 'image_model2', ...]
```

#### `get_video`

```python
def get_video(self, **kwargs) -> list[str]:
    """
    Возвращает список моделей для работы с видео.

    Args:
        **kwargs: Дополнительные аргументы, передаваемые провайдеру.

    Returns:
        list[str]: Список идентификаторов моделей для работы с видео.
    """
```

**Параметры**:
- `**kwargs`: Дополнительные аргументы, которые могут быть переданы методу `get_media` медиа-провайдера.

**Возвращает**:
- `list[str]`: Список идентификаторов моделей, предназначенных для работы с видео.

**Как работает метод**:
1. Метод `get_video` проверяет, установлен ли медиа-провайдер. Если нет, возвращает пустой список.
2. Если медиа-провайдер установлен, вызывает метод `get_media` для обновления списка моделей.
3. Если у медиа-провайдера есть атрибут `video_models`, возвращает его значение.
4. В противном случае возвращает пустой список.

**Примеры**:

```python
client_models = ClientModels(client=some_client, media_provider=some_media_provider)
video_models = client_models.get_video()
print(video_models)  # Выводит: ['video_model1', 'video_model2', ...]
```