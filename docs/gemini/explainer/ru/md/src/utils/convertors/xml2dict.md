# Модуль `xml2dict`

Этот модуль предоставляет функции для преобразования XML-данных в словари. Он включает функции для парсинга XML-строк и преобразования XML-дерева элементов в представления словарей.

## Функции:

* **`_parse_node(node: ET.Element) -> dict | str`**: Парсит XML-узел в словарь.

    * **Аргументы**:
        * `node (ET.Element)`: XML-элемент для парсинга.

    * **Возвращает**:
        * `dict | str`: Словарное представление XML-узла или строка, если у узла нет атрибутов или дочерних элементов.

* **`_make_dict(tag: str, value: any) -> dict`**: Создаёт новый словарь с тегом и значением.

    * **Аргументы**:
        * `tag (str)`: Имя тега XML-элемента.
        * `value (any)`: Значение, связанное с тегом.

    * **Возвращает**:
        * `dict`: Словарь с именем тега в качестве ключа и значением в качестве значения словаря. Обрабатывает атрибуты `xmlns`.

* **`xml2dict(xml: str) -> dict`**: Парсит XML-строку в словарь.

    * **Аргументы**:
        * `xml (str)`: XML-строка для парсинга.

    * **Возвращает**:
        * `dict`: Словарное представление XML-данных.

* **`ET2dict(element_tree: ET.Element) -> dict`**: Преобразует XML-дерево элементов в словарь.

    * **Аргументы**:
        * `element_tree (ET.Element)`: XML-дерево элементов.

    * **Возвращает**:
        * `dict`: Словарное представление XML-дерева элементов.


## Описание работы:

Функция `_parse_node` рекурсивно обрабатывает XML-узел, собирая атрибуты, текстовое содержимое и дочерние элементы в словарь.  Ключевой особенностью является обработка повторяющихся тегов. Если тег встречается несколько раз, его значение сохраняется в списке.

Функция `_make_dict` создает словарь с тегом в качестве ключа и значением, обрабатывая атрибуты `xmlns`.

Функции `xml2dict` и `ET2dict` обеспечивают общий интерфейс для парсинга XML-строки и XML-дерева в словарь соответственно, используя `_parse_node`.

**Обработка атрибутов `xmlns`:**

Функция `_make_dict` умеет распознавать атрибуты `xmlns` в формате `{...}` в тегах XML. В этом случае она создает вложенный словарь, где `xmlns` хранится как ключ, а основное значение тега — как `value`. Это позволяет сохранить информацию о пространствах имен в результирующем словаре.


**Пропуск атрибута `href`:**

Код содержит проверку на атрибут `href` и пропускает его при преобразовании в словарь. Это означает, что атрибут `href` не будет частью результирующего словаря.

**Обработка отсутствия дочерних элементов:**

Если у узла нет дочерних элементов, его текстовое значение сохраняется в словаре с ключом `value`.  Если же узел имеет только текстовое значение без атрибутов и дочерних элементов, то возвращается непосредственно это текстовое значение (а не словарь).

**Обработка списка дочерних элементов:**

В случае, если у элемента несколько дочерних элементов с одинаковым тегом, они добавляются в список значений в результате.


**Важные моменты:**

* Модуль использует библиотеку `xml.etree.ElementTree`, что обеспечивает надежную обработку XML-данных.
* `_parse_node` рекурсивно обрабатывает дерево, обрабатывая вложенность XML.
* Пропускает атрибут `href`, не поддерживаемый при преобразовании в словарь.


Этот код предоставляет гибкий и функциональный механизм для преобразования XML в словари, особенно полезный для дальнейшей обработки и анализа данных, полученных из XML-источников.