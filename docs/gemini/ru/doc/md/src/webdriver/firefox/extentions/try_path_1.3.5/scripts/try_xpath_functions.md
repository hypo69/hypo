# Модуль `try_xpath_functions.js`

## Обзор

Данный JavaScript-модуль содержит функции для выполнения XPath-запросов и манипулирования элементами DOM.  Он предоставляет методы для оценки XPath выражений, выбора элементов с помощью `querySelector` и `querySelectorAll`, работы с результатами XPath и DOM-элементами, включая сохранение/восстановление атрибутов класса и другие вспомогательные функции.

## Функции

### `execExpr`

**Описание**: Выполняет XPath-запрос или DOM-выбор на основе переданного метода (`evaluate`, `querySelector`, `querySelectorAll`).

**Параметры**:

- `expr` (string): XPath-выражение или CSS-селектор.
- `method` (string): Способ выполнения запроса (`evaluate`, `querySelector`, или `querySelectorAll`).
- `opts` (object, optional): Опции для выполнения. По умолчанию `{}`.
    - `context` (object, optional): Контекст для выполнения запроса (документ или элемент).
    - `resolver` (function | string, optional): Функция-резольвер для XPath или JSON-строка, представляющая мапу значений для замены.
    - `document` (object, optional): Объект Document, если он отличается от контекста.
    - `resultType` (number, optional): Тип результата для `evaluate` (xpathResult.*).


**Возвращает**:

- object | null: Объект с результатами выполнения, содержащий массив элементов (`items`), используемый метод (`method`) и тип результата (`resultType`). Возвращает null в случае ошибки.

**Вызывает исключения**:

- `Error`: В случае несоответствия типа контекста (`context`) требуемому методу (например, попытка использования `evaluate` на элементе, который не является узлом).


### `resToArr`

**Описание**: Преобразует результат XPath-запроса в массив узлов.

**Параметры**:

- `res` (object): Объект результата XPath.
- `type` (number, optional): Тип результата (xpathResult.*).  Если не указан, используется тип результата из `res`.

**Возвращает**:

- array: Массив узлов, полученный из результата XPath.

**Вызывает исключения**:

- `Error`: В случае неверного типа результата (`type`).


### `makeResolver`

**Описание**: Создаёт функцию-резольвер для XPath.

**Параметры**:

- `obj` (function | string | object, optional): Функция-резольвер или JSON-строка/объект, представляющая словарь значений.

**Возвращает**:

- function: Функция-резольвер, которая заменяет значения в XPath выражении на указанные.

**Вызывает исключения**:

- `Error`: В случае некорректного объекта-резольвера (не функция, не JSON-строка и не словарь).


### `isValidDict`

**Описание**: Проверяет, является ли переданный объект корректным словарем (объектом).

**Параметры**:

- `obj` (object): Объект для проверки.

**Возвращает**:

- boolean: `true`, если объект является словарем, содержащим только строковые значения; иначе `false`.


### `objToMap`

**Описание**: Преобразует объект в Map.

**Параметры**:

- `obj` (object): Объект для преобразования.

**Возвращает**:

- Map: Объект Map, содержащий пары ключ-значение из исходного объекта.


### `isDocOrElem`

**Описание**: Проверяет, является ли объект `Document` или `Element`.

**Параметры**:

- `obj` (object): Объект для проверки.

**Возвращает**:

- boolean: `true` если объект является `Document` или `Element`; иначе `false`.


### `listToArr`

**Описание**: Преобразует NodeList в массив.

**Параметры**:

- `list` (NodeList): Объект NodeList.

**Возвращает**:

- array: Массив элементов NodeList.


### `getItemDetail`

**Описание**: Возвращает подробную информацию об элементе.

**Параметры**:

- `item` (object): Элемент для получения информации.

**Возвращает**:

- object: Объект с подробной информацией об элементе (тип, имя, значение, текстовое содержимое).


### `getItemDetails`

**Описание**: Возвращает массив подробностей об элементах в массиве.

**Параметры**:

- `items` (array): Массив элементов.

**Возвращает**:

- array: Массив объектов с подробной информацией.


### `getNodeTypeStr`

**Описание**: Преобразует номер типа узла в строковое представление.

**Параметры**:

- `nodeType` (number): Номер типа узла.

**Возвращает**:

- string: Строковое представление типа узла.


### `getxpathResultStr`

**Описание**: Получает строковое представление типа результата XPath.

**Параметры**:

- `resultType` (number): Численный код типа результата.

**Возвращает**:

- string: Строковое представление типа результата.


### `getxpathResultNum`

**Описание**: Получает числовое представление типа результата XPath по строке.

**Параметры**:

- `resultTypeStr` (string): Строковое представление типа результата.

**Возвращает**:

- number: Числовое представление типа результата.


### `isAttrItem`

**Описание**: Проверяет, является ли объект `Attr`.

**Параметры**:

- `item` (object): Объект для проверки.

**Возвращает**:

- boolean: `true` если объект является `Attr`; иначе `false`.



(И так далее для остальных функций, повторяя шаблон)