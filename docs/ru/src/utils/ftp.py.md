# Модуль для взаимодействия с FTP-серверами

## Обзор

Этот модуль предоставляет интерфейс для взаимодействия с FTP-серверами, включая функции для отправки, получения и удаления файлов. Он предназначен для упрощения операций с FTP-серверами, предоставляя удобные функции для работы с файлами.

## Подробнее

Модуль позволяет отправлять медиафайлы (изображения, видео), электронные таблицы и другие файлы на FTP-сервер и получать их с него. Он использует библиотеку `ftplib` для установления соединения и выполнения операций с FTP-сервером.

## Содержание

- [Функции](#Функции)
  - [write](#write)
  - [read](#read)
  - [delete](#delete)

## Функции

### `write`

```python
def write(source_file_path: str, dest_dir: str, dest_file_name: str) -> bool:
    """
    Отправляет файл на FTP-сервер.

    Args:
        source_file_path (str): Путь к отправляемому файлу.
        dest_dir (str): Каталог назначения на FTP-сервере.
        dest_file_name (str): Имя файла на FTP-сервере.

    Returns:
        bool: True, если файл успешно отправлен, иначе False.

    Example:
        >>> success = write('local_path/to/file.txt', '/remote/directory', 'file.txt')
        >>> print(success)
        True
    """
    ...
```

**Назначение**:
Функция `write` отправляет файл, расположенный по указанному пути (`source_file_path`), на FTP-сервер в указанный каталог (`dest_dir`) и под указанным именем (`dest_file_name`).

**Параметры**:
- `source_file_path` (str): Локальный путь к файлу, который нужно отправить.
- `dest_dir` (str): Путь к каталогу на FTP-сервере, куда будет помещен файл.
- `dest_file_name` (str): Имя, которое файл будет иметь на FTP-сервере.

**Возвращает**:
- `bool`: `True`, если файл был успешно отправлен на FTP-сервер, и `False` в противном случае.

**Как работает функция**:

1.  **Устанавливает соединение с FTP-сервером**:
    *   Использует параметры соединения из глобальной переменной `_connection` (предполагается, что она определена в другом месте).
    *   Пытается установить соединение с FTP-сервером, используя `ftplib.FTP`.
    *   Переходит в указанный каталог (`dest_dir`) на FTP-сервере с помощью `session.cwd(dest_dir)`.
2.  **Отправляет файл на FTP-сервер**:
    *   Открывает файл, расположенный по пути `source_file_path`, в бинарном режиме для чтения (`'rb'`).
    *   Отправляет файл на FTP-сервер, используя метод `session.storbinary`.
3.  **Закрывает соединение с FTP-сервером**:
    *   После успешной отправки или в случае возникновения ошибки, пытается закрыть соединение с FTP-сервером с помощью `session.quit()`.
    *   Если закрытие соединения не удается, регистрирует ошибку.

```text
     Начало
     │
     ├── Установить соединение с FTP-сервером
     │   │
     │   └── Перейти в каталог назначения
     │
     ├── Открыть локальный файл (source_file_path) в бинарном режиме ('rb')
     │   │
     │   └── Отправить файл на FTP-сервер (session.storbinary)
     │
     └── Закрыть соединение с FTP-сервером
     │
     Конец
```

**Примеры**:

```python
success = write('local_path/to/file.txt', '/remote/directory', 'file.txt')
print(success)
# Ожидаемый вывод: True (если отправка прошла успешно) или False (в случае ошибки)
```

---

### `read`

```python
def read(source_file_path: str, dest_dir: str, dest_file_name: str) -> Union[str, bytes, None]:
    """
    Получает файл с FTP-сервера.

    Args:
        source_file_path (str): Путь, куда будет сохранен файл локально.
        dest_dir (str): Каталог на FTP-сервере, где расположен файл.
        dest_file_name (str): Имя файла на FTP-сервере.

    Returns:
        Union[str, bytes, None]: Содержимое файла, если успешно получен, иначе None.

    Example:
        >>> content = read('local_path/to/file.txt', '/remote/directory', 'file.txt')
        >>> print(content)
        b'Some file content'
    """
    ...
```

**Назначение**:
Функция `read` загружает файл с FTP-сервера, расположенный в указанном каталоге (`dest_dir`) и с указанным именем (`dest_file_name`), и сохраняет его локально по указанному пути (`source_file_path`).

**Параметры**:
- `source_file_path` (str): Локальный путь, куда будет сохранен загруженный файл.
- `dest_dir` (str): Путь к каталогу на FTP-сервере, где находится файл.
- `dest_file_name` (str): Имя файла на FTP-сервере.

**Возвращает**:
- `Union[str, bytes, None]`: Содержимое файла в виде байтов, если файл успешно загружен, и `None` в случае ошибки.

**Как работает функция**:

1.  **Устанавливает соединение с FTP-сервером**:
    *   Использует параметры соединения из глобальной переменной `_connection`.
    *   Пытается установить соединение с FTP-сервером, используя `ftplib.FTP`.
    *   Переходит в указанный каталог (`dest_dir`) на FTP-сервере с помощью `session.cwd(dest_dir)`.
2.  **Загружает файл с FTP-сервера**:
    *   Открывает файл, расположенный по пути `source_file_path`, в бинарном режиме для записи (`'wb'`).
    *   Загружает файл с FTP-сервера, используя метод `session.retrbinary`.
3.  **Читает содержимое загруженного файла**:
    * Открывает файл, расположенный по пути `source_file_path`, в бинарном режиме для чтения (`'rb'`).
    * Считывает содержимое файла и возвращает его.
4.  **Закрывает соединение с FTP-сервером**:
    *   После успешной загрузки или в случае возникновения ошибки, пытается закрыть соединение с FTP-сервером с помощью `session.quit()`.
    *   Если закрытие соединения не удается, регистрирует ошибку.

```text
     Начало
     │
     ├── Установить соединение с FTP-сервером
     │   │
     │   └── Перейти в каталог назначения
     │
     ├── Открыть локальный файл (source_file_path) в бинарном режиме для записи ('wb')
     │   │
     │   └── Скачать файл с FTP-сервера (session.retrbinary)
     │   
     │
     ├── Открыть локальный файл (source_file_path) в бинарном режиме для чтения ('rb')
     │   │
     │   └── Считать содержимое файла
     │
     └── Закрыть соединение с FTP-сервером
     │
     Конец
```

**Примеры**:

```python
content = read('local_path/to/file.txt', '/remote/directory', 'file.txt')
print(content)
# Ожидаемый вывод: b'Some file content' (содержимое файла в виде байтов) или None (в случае ошибки)
```

---

### `delete`

```python
def delete(source_file_path: str, dest_dir: str, dest_file_name: str) -> bool:
    """
    Удаляет файл с FTP-сервера.

    Args:
        source_file_path (str): Путь, где расположен файл локально (не используется).
        dest_dir (str): Каталог на FTP-сервере, где расположен файл.
        dest_file_name (str): Имя файла на FTP-сервере.

    Returns:
        bool: True, если файл успешно удален, иначе False.

    Example:
        >>> success = delete('local_path/to/file.txt', '/remote/directory', 'file.txt')
        >>> print(success)
        True
    """
    ...
```

**Назначение**:
Функция `delete` удаляет файл с FTP-сервера, расположенный в указанном каталоге (`dest_dir`) и с указанным именем (`dest_file_name`).

**Параметры**:
- `source_file_path` (str): Локальный путь к файлу (не используется в функции).
- `dest_dir` (str): Путь к каталогу на FTP-сервере, где находится файл.
- `dest_file_name` (str): Имя файла, который нужно удалить.

**Возвращает**:
- `bool`: `True`, если файл был успешно удален с FTP-сервера, и `False` в противном случае.

**Как работает функция**:

1.  **Устанавливает соединение с FTP-сервером**:
    *   Использует параметры соединения из глобальной переменной `_connection`.
    *   Пытается установить соединение с FTP-сервером, используя `ftplib.FTP`.
    *   Переходит в указанный каталог (`dest_dir`) на FTP-сервере с помощью `session.cwd(dest_dir)`.
2.  **Удаляет файл с FTP-сервера**:
    *   Удаляет файл с FTP-сервера, используя метод `session.delete(dest_file_name)`.
3.  **Закрывает соединение с FTP-сервером**:
    *   После успешного удаления или в случае возникновения ошибки, пытается закрыть соединение с FTP-сервером с помощью `session.quit()`.
    *   Если закрытие соединения не удается, регистрирует ошибку.

```text
     Начало
     │
     ├── Установить соединение с FTP-сервером
     │   │
     │   └── Перейти в каталог назначения
     │
     ├── Удалить файл с FTP-сервера (session.delete)
     │
     └── Закрыть соединение с FTP-сервером
     │
     Конец
```

**Примеры**:

```python
success = delete('local_path/to/file.txt', '/remote/directory', 'file.txt')
print(success)
# Ожидаемый вывод: True (если удаление прошло успешно) или False (в случае ошибки)