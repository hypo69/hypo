# Модуль `hypotez/src/goog/spreadsheet/spreadsheet.py`

## Обзор

Этот модуль предоставляет минимальную библиотеку для работы с Google Таблицами. Он позволяет создавать новые таблицы, получать доступ к существующим, загружать данные из CSV-файлов в таблицы и работать с листами.

## Классы

### `SpreadSheet`

**Описание**: Класс для работы с Google Таблицами. Обеспечивает базовые методы для доступа к API Google Таблиц, создания и управления таблицами, загрузки данных из CSV-файла в Google Таблицы.

**Атрибуты**:

* `spreadsheet_id` (str | None): ID таблицы Google Таблиц. `None` для создания новой таблицы.
* `spreadsheet_name` (str | None): Название новой таблицы, если `spreadsheet_id` не указан.
* `spreadsheet` (Spreadsheet): Объект Spreadsheet из библиотеки gspread для работы с таблицей.
* `data_file` (Path): Путь к файлу CSV с данными.
* `sheet_name` (str): Название листа в Google Таблицах.
* `credentials` (ServiceAccountCredentials): Объект аутентификации для доступа к API Google Таблиц.
* `client` (gspread.Client): Клиент для работы с API Google Таблиц.
* `worksheet` (Worksheet): Объект Worksheet для работы с конкретным листом.
* `create_sheet` (bool): Флаг, указывающий на необходимость создания листа, если он не существует.


**Методы**:

#### `__init__(self, spreadsheet_id: str, *args, **kwards)`

**Описание**: Инициализирует объект `SpreadSheet` с указанными учетными данными и файлом данных.

**Параметры**:
* `spreadsheet_id` (str): ID таблицы Google Таблиц. Укажите `None`, чтобы создать новую таблицу.
* `spreadsheet_name` (str): Название новой таблицы, если `spreadsheet_id` не указан.
* `sheet_name` (str): Название листа в Google Таблицах.


**Вызывает исключения**:
* `gspread.exceptions.SpreadsheetNotFound`: Если таблица с указанным ID не найдена.


#### `_create_credentials(self)`

**Описание**: Создает учетные данные для доступа к API Google Таблиц из JSON-файла.

**Возвращает**: Объект `ServiceAccountCredentials` для доступа к Google Таблицам.

**Вызывает исключения**:
* `Exception`: Если возникла ошибка при создании учетных данных.


#### `_authorize_client(self)`

**Описание**: Авторизует клиента для доступа к API Google Таблиц.

**Возвращает**: Авторизованный клиент `gspread.Client` для работы с Google Таблицами.

**Вызывает исключения**:
* `Exception`: Если возникла ошибка при авторизации клиента.


#### `get_worksheet(self, worksheet_name: str | Worksheet) -> Worksheet | None`

**Описание**: Получает лист по имени. Если лист с указанным именем не существует, создается новый лист.

**Параметры**:
* `worksheet_name` (str | Worksheet): Имя листа или Worksheet-объект.
* `create_if_not_present` (bool): Флаг, указывающий на создание листа, если он не существует.


**Возвращает**: Объект `Worksheet` для работы с листом.


#### `create_worksheet(self, title: str, dim: dict = {'rows': 100, 'cols': 10}) -> Worksheet | None`

**Описание**: Создает новый лист с указанным именем и размерами.

**Параметры**:
* `title` (str): Имя листа.
* `dim` (dict, optional): Словарь с размерами листа (количество строк и столбцов). По умолчанию 100 строк и 10 столбцов.


**Возвращает**: Объект `Worksheet`, если лист успешно создан. `None` в случае ошибки.

**Вызывает исключения**:
* `Exception`: Любые ошибки при создании листа.


#### `copy_worksheet(self, from_worksheet: str, to_worksheet: str)`

**Описание**: Копирует лист. (Не реализована)

#### `upload_data_to_sheet(self)`

**Описание**: Загружает данные из CSV-файла в Google Таблицы.

**Вызывает исключения**:
* `ValueError`: Если путь к файлу CSV не задан или файл не существует.
* `Exception`: Другие ошибки при загрузке данных.


## Функции

(Нет функций в этом модуле)

## Примечания

Файл содержит пример использования класса `SpreadSheet`. Необходимо заменить пути к файлам и имя листа на соответствующие значения.