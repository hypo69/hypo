# Модуль CodeLinkAva

## Обзор

Модуль `CodeLinkAva` представляет собой асинхронный генератор провайдера, который взаимодействует с API CodeLink для генерации текста на основе предоставленных сообщений. Этот модуль предназначен для работы с моделью `gpt-3.5-turbo` и использует асинхронные запросы для потоковой передачи данных.

## Подробней

Этот модуль является частью набора провайдеров в проекте `hypotez`, предназначенных для взаимодействия с различными API для генерации текста. Он использует библиотеку `aiohttp` для выполнения асинхронных HTTP-запросов и предоставляет функциональность для потоковой передачи данных, что позволяет получать результаты генерации текста по частям, не дожидаясь завершения всего процесса.

## Классы

### `CodeLinkAva`

**Описание**: Класс `CodeLinkAva` является асинхронным генератором провайдера, который взаимодействует с API CodeLink для генерации текста.

**Наследует**: `AsyncGeneratorProvider`

**Атрибуты**:
- `url` (str): URL-адрес API CodeLink.
- `supports_gpt_35_turbo` (bool): Указывает, поддерживает ли провайдер модель `gpt-3.5-turbo`.
- `working` (bool): Указывает, находится ли провайдер в рабочем состоянии.

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для получения ответов от API CodeLink.

## Функции

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: list[dict[str, str]],
    **kwargs
) -> AsyncGenerator:
    """Создает асинхронный генератор для получения ответов от API CodeLink.

    Args:
        model (str): Название модели, используемой для генерации текста.
        messages (list[dict[str, str]]): Список сообщений для передачи в API.
        **kwargs: Дополнительные аргументы для передачи в API.

    Returns:
        AsyncGenerator: Асинхронный генератор, возвращающий сгенерированный текст.
    """
```

**Назначение**: Функция `create_async_generator` создает асинхронный генератор, который отправляет запросы к API CodeLink и возвращает сгенерированный текст.

**Параметры**:
- `cls`: Ссылка на класс `CodeLinkAva`.
- `model` (str): Название модели, используемой для генерации текста.
- `messages` (list[dict[str, str]]): Список сообщений для передачи в API.
- `**kwargs`: Дополнительные аргументы для передачи в API.

**Возвращает**:
- `AsyncGenerator`: Асинхронный генератор, возвращающий сгенерированный текст.

**Как работает функция**:
1. **Формирование заголовков**: Создаются заголовки HTTP-запроса, включая User-Agent, Accept, Origin, Referer и другие параметры.
2. **Создание асинхронной сессии**: Используется `aiohttp.ClientSession` для создания асинхронной сессии с заданными заголовками.
3. **Формирование данных запроса**: Создается словарь `data`, содержащий сообщения, температуру и другие параметры, которые будут отправлены в API.
4. **Отправка POST-запроса**: Отправляется асинхронный POST-запрос к API CodeLink с использованием сессии.
5. **Обработка ответа**: Читаются строки из ответа, декодируются и обрабатываются для извлечения сгенерированного текста.
6. **Генерация текста**: Извлеченный текст передается через `yield`, что позволяет получать его по частям.

**ASCII Flowchart**:

```
    Начало
     ↓
    Формирование заголовков HTTP-запроса
     ↓
    Создание асинхронной сессии с использованием aiohttp
     ↓
    Формирование данных запроса (сообщения, температура и т.д.)
     ↓
    Отправка асинхронного POST-запроса к API CodeLink
     ↓
    Обработка ответа: чтение и декодирование строк из ответа
     ↓
    Извлечение сгенерированного текста из JSON-ответа
     ↓
    Передача текста через yield (генерация текста по частям)
     ↓
    Конец
```

**Примеры**:

```python
# Пример вызова create_async_generator
messages = [{"role": "user", "content": "Hello, how are you?"}]
async def main():
    generator = CodeLinkAva.create_async_generator(model="gpt-3.5-turbo", messages=messages)
    async for message in await generator:
        print(message)

# Запуск примера
# asyncio.run(main())