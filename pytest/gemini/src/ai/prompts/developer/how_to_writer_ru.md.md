```python
import pytest

# The user-provided code is a prompt, not actual Python code.
# Therefore, we cannot directly test it with pytest.
# However, we can create tests that verify the prompt's output format
# and the logical flow it intends to generate.

# We will simulate the documentation output for a simple code block and test it.

SAMPLE_DOC_OUTPUT = """
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет проверку на валидность значения переменной `value` перед дальнейшей обработкой.

Шаги выполнения
-------------------------
1. Получение значения переменной `value` через вызов метода `get_value()`.
2. Проверка, является ли значение пустым или невалидным. Если да, то логируется сообщение об ошибке и выполнение кода прекращается.
3. Если значение валидно, оно передается в следующую функцию для дальнейшей обработки.

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода:

.. code-block:: python

    value = get_value()
    if value:
        process_value(value)
    else:
        logger.error('Невалидное значение')
"""

def test_documentation_structure():
    """
    Checks if the documentation output contains the expected sections.
    """
    assert "Как использовать блок кода" in SAMPLE_DOC_OUTPUT
    assert "Описание" in SAMPLE_DOC_OUTPUT
    assert "Шаги выполнения" in SAMPLE_DOC_OUTPUT
    assert "Пример использования" in SAMPLE_DOC_OUTPUT


def test_documentation_steps_present():
    """
    Verifies the documentation includes expected execution steps.
    """
    assert "1. Получение значения переменной `value`" in SAMPLE_DOC_OUTPUT
    assert "2. Проверка, является ли значение пустым или невалидным" in SAMPLE_DOC_OUTPUT
    assert "3. Если значение валидно, оно передается в следующую функцию для дальнейшей обработки." in SAMPLE_DOC_OUTPUT

def test_documentation_example_code():
    """
     Checks if the documentation includes an example code block.
    """
    assert ".. code-block:: python" in SAMPLE_DOC_OUTPUT
    assert "value = get_value()" in SAMPLE_DOC_OUTPUT
    assert "if value:" in SAMPLE_DOC_OUTPUT
    assert "process_value(value)" in SAMPLE_DOC_OUTPUT
    assert "else:" in SAMPLE_DOC_OUTPUT
    assert "logger.error('Невалидное значение')" in SAMPLE_DOC_OUTPUT


def test_documentation_description():
    """
    Verify that the documentation provides a correct description of the code's purpose.
    """
    assert "Этот блок кода выполняет проверку на валидность значения переменной `value` перед дальнейшей обработкой." in SAMPLE_DOC_OUTPUT


# Additional tests based on the prompt requirements
# These tests will verify that the prompt is generating documentation
# based on the requirements specified in the prompt
def test_documentation_code_verification_description():
    """
    Verifies that the prompt instructs to describe checks performed in the code.
    """
    # This test checks that the generated doc has an instruction about 'check' inside it's prompt
    assert "если блок кода выполняет проверку, то опиши, как она работает" in """
**Промпт для генерации `how to` документации для блоков кода**

1. Ты должен проанализировать текущий блок кода и все ранее загруженные блоки кода в проекте. На основе этого анализа ты сформулируешь пошаговую инструкцию, которая описывает, какие действия нужно выполнить для исполнения данного блока кода.

2. Для каждого блока кода ты должен создать подробную инструкцию в формате reStructuredText (RST), следуя следующим шагам:

    - **Описание**: Объясни, что делает этот блок кода, например, какую задачу решает или какую проверку выполняет.
    - **Шаги выполнения**: Описывай последовательность действий, которые нужно выполнить для того, чтобы код исполнился. Для каждого шага подробно укажи, что именно происходит в процессе.
    - **Пример использования**: Приведи пример того, как этот код можно использовать в проекте, в том числе с возможными вызовами функций или методов.

3. Структура документации для каждого блока кода должна быть следующей:

```rst
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет [описание действий блока кода, например, "проверку на валидность ввода данных"].

Шаги выполнения
-------------------------
1. [Первый шаг выполнения, например, "Получение данных через вызов функции `get_data()`."]\n
2. [Второй шаг выполнения, например, "Проверка данных на валидность с использованием метода `validate_data()`."]\n
3. [Третий шаг выполнения, например, "Если данные валидны, выполняется дальнейшая обработка."]\n
4. [И так далее...]

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода в проекте:

.. code-block:: python

    <пример_кода_с_использованием>
```

4. При написании документации обязательно учитывай:

    - Если блок кода выполняет проверку, то опиши, как она работает и какие данные проверяются.
    - Если блок кода включает в себя вызовы других функций или методов, обязательно укажи, какие именно функции вызываются и с какими параметрами.
    - Важно использовать точные формулировки, избегая общих терминов типа "получаем" или "делаем". Вместо этого опиши, что конкретно делает код: "код проверяет", "код выполняет отправку запроса", и так далее.

5. Пример для блока кода, который выполняет проверку переменной:

```rst
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет проверку на валидность значения переменной `value` перед дальнейшей обработкой.

Шаги выполнения
-------------------------
1. Получение значения переменной `value` через вызов метода `get_value()`.
2. Проверка, является ли значение пустым или невалидным. Если да, то логируется сообщение об ошибке и выполнение кода прекращается.
3. Если значение валидно, оно передается в следующую функцию для дальнейшей обработки.

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода:

.. code-block:: python

    value = get_value()
    if value:
        process_value(value)
    else:
        logger.error('Невалидное значение')
```

6. Каждый блок кода должен быть документирован в этом формате, с четкими и понятными шагами, поясняющими, что именно делает код, и с примером того, как его можно использовать.

---
"""


def test_documentation_function_call_description():
   """
    Verifies that the prompt instructs to describe function/method calls in the code.
   """
    # This test checks that the generated doc has an instruction about function calls inside it's prompt
   assert "Если блок кода включает в себя вызовы других функций или методов, обязательно укажи, какие именно функции вызываются и с какими параметрами." in """
**Промпт для генерации `how to` документации для блоков кода**

1. Ты должен проанализировать текущий блок кода и все ранее загруженные блоки кода в проекте. На основе этого анализа ты сформулируешь пошаговую инструкцию, которая описывает, какие действия нужно выполнить для исполнения данного блока кода.

2. Для каждого блока кода ты должен создать подробную инструкцию в формате reStructuredText (RST), следуя следующим шагам:

    - **Описание**: Объясни, что делает этот блок кода, например, какую задачу решает или какую проверку выполняет.
    - **Шаги выполнения**: Описывай последовательность действий, которые нужно выполнить для того, чтобы код исполнился. Для каждого шага подробно укажи, что именно происходит в процессе.
    - **Пример использования**: Приведи пример того, как этот код можно использовать в проекте, в том числе с возможными вызовами функций или методов.

3. Структура документации для каждого блока кода должна быть следующей:

```rst
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет [описание действий блока кода, например, "проверку на валидность ввода данных"].

Шаги выполнения
-------------------------
1. [Первый шаг выполнения, например, "Получение данных через вызов функции `get_data()`."]\n
2. [Второй шаг выполнения, например, "Проверка данных на валидность с использованием метода `validate_data()`."]\n
3. [Третий шаг выполнения, например, "Если данные валидны, выполняется дальнейшая обработка."]\n
4. [И так далее...]

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода в проекте:

.. code-block:: python

    <пример_кода_с_использованием>
```

4. При написании документации обязательно учитывай:

    - Если блок кода выполняет проверку, то опиши, как она работает и какие данные проверяются.
    - Если блок кода включает в себя вызовы других функций или методов, обязательно укажи, какие именно функции вызываются и с какими параметрами.
    - Важно использовать точные формулировки, избегая общих терминов типа "получаем" или "делаем". Вместо этого опиши, что конкретно делает код: "код проверяет", "код выполняет отправку запроса", и так далее.

5. Пример для блока кода, который выполняет проверку переменной:

```rst
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет проверку на валидность значения переменной `value` перед дальнейшей обработкой.

Шаги выполнения
-------------------------
1. Получение значения переменной `value` через вызов метода `get_value()`.
2. Проверка, является ли значение пустым или невалидным. Если да, то логируется сообщение об ошибке и выполнение кода прекращается.
3. Если значение валидно, оно передается в следующую функцию для дальнейшей обработки.

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода:

.. code-block:: python

    value = get_value()
    if value:
        process_value(value)
    else:
        logger.error('Невалидное значение')
```

6. Каждый блок кода должен быть документирован в этом формате, с четкими и понятными шагами, поясняющими, что именно делает код, и с примером того, как его можно использовать.

---
"""

def test_documentation_exact_phrasing():
    """
        Verifies that the prompt instructs to use exact phrasing rather than vague terms
    """
    assert "Важно использовать точные формулировки, избегая общих терминов типа \"получаем\" или \"делаем\". Вместо этого опиши, что конкретно делает код: \"код проверяет\", \"код выполняет отправку запроса\", и так далее." in """
**Промпт для генерации `how to` документации для блоков кода**

1. Ты должен проанализировать текущий блок кода и все ранее загруженные блоки кода в проекте. На основе этого анализа ты сформулируешь пошаговую инструкцию, которая описывает, какие действия нужно выполнить для исполнения данного блока кода.

2. Для каждого блока кода ты должен создать подробную инструкцию в формате reStructuredText (RST), следуя следующим шагам:

    - **Описание**: Объясни, что делает этот блок кода, например, какую задачу решает или какую проверку выполняет.
    - **Шаги выполнения**: Описывай последовательность действий, которые нужно выполнить для того, чтобы код исполнился. Для каждого шага подробно укажи, что именно происходит в процессе.
    - **Пример использования**: Приведи пример того, как этот код можно использовать в проекте, в том числе с возможными вызовами функций или методов.

3. Структура документации для каждого блока кода должна быть следующей:

```rst
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет [описание действий блока кода, например, "проверку на валидность ввода данных"].

Шаги выполнения
-------------------------
1. [Первый шаг выполнения, например, "Получение данных через вызов функции `get_data()`."]\n
2. [Второй шаг выполнения, например, "Проверка данных на валидность с использованием метода `validate_data()`."]\n
3. [Третий шаг выполнения, например, "Если данные валидны, выполняется дальнейшая обработка."]\n
4. [И так далее...]

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода в проекте:

.. code-block:: python

    <пример_кода_с_использованием>
```

4. При написании документации обязательно учитывай:

    - Если блок кода выполняет проверку, то опиши, как она работает и какие данные проверяются.
    - Если блок кода включает в себя вызовы других функций или методов, обязательно укажи, какие именно функции вызываются и с какими параметрами.
    - Важно использовать точные формулировки, избегая общих терминов типа "получаем" или "делаем". Вместо этого опиши, что конкретно делает код: "код проверяет", "код выполняет отправку запроса", и так далее.

5. Пример для блока кода, который выполняет проверку переменной:

```rst
Как использовать блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода выполняет проверку на валидность значения переменной `value` перед дальнейшей обработкой.

Шаги выполнения
-------------------------
1. Получение значения переменной `value` через вызов метода `get_value()`.
2. Проверка, является ли значение пустым или невалидным. Если да, то логируется сообщение об ошибке и выполнение кода прекращается.
3. Если значение валидно, оно передается в следующую функцию для дальнейшей обработки.

Пример использования
-------------------------
Пример того, как можно использовать данный блок кода:

.. code-block:: python

    value = get_value()
    if value:
        process_value(value)
    else:
        logger.error('Невалидное значение')
```

6. Каждый блок кода должен быть документирован в этом формате, с четкими и понятными шагами, поясняющими, что именно делает код, и с примером того, как его можно использовать.

---
"""
```