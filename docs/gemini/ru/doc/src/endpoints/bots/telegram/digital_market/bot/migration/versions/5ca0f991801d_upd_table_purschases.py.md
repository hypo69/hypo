# Модуль миграции базы данных: Обновление таблицы покупок

## Обзор

Модуль содержит скрипт миграции базы данных, используемый Alembic для обновления таблицы `purchases`. Он добавляет столбец `payment_type` и создает уникальный индекс для столбца `payment_id`.

## Подробней

Этот скрипт миграции изменяет структуру таблицы `purchases` в базе данных. Он добавляет новый столбец `payment_type`, предназначенный для хранения информации о типе платежа, использованного при покупке. Также создается уникальное ограничение (unique constraint) для столбца `payment_id`, что обеспечивает уникальность идентификаторов платежей в таблице. Скрипт также содержит функцию `downgrade`, которая выполняет обратные действия, удаляя столбец `payment_type` и ограничение уникальности, чтобы вернуть базу данных к предыдущему состоянию.

## Функции

### `upgrade`

```python
def upgrade() -> None:
    """
    Обновляет структуру таблицы 'purchases', добавляя столбец 'payment_type' и уникальное ограничение для 'payment_id'.

    Args:
        None

    Returns:
        None

    Raises:
        Нет. Функция выполняет операции миграции базы данных и не предполагает выброс исключений.

    """
```

**Как работает функция**:

1.  **Добавление столбца `payment_type`**: Функция добавляет новый столбец с именем `payment_type` в таблицу `purchases`. Этот столбец предназначен для хранения типа платежа.
2.  **Создание уникального ограничения `payment_id`**: Функция создает уникальное ограничение для столбца `payment_id` в таблице `purchases`. Это гарантирует, что каждое значение в столбце `payment_id` будет уникальным.

```
    Добавление столбца payment_type
    │
    Создание уникального ограничения payment_id
```

### `downgrade`

```python
def downgrade() -> None:
    """
    Откатывает изменения, внесенные функцией `upgrade`, удаляя столбец 'payment_type' и уникальное ограничение для 'payment_id'.

    Args:
        None

    Returns:
        None

    Raises:
        Нет. Функция выполняет операции миграции базы данных и не предполагает выброс исключений.
    """
```

**Как работает функция**:

1.  **Удаление уникального ограничения `payment_id`**: Функция удаляет уникальное ограничение, связанное со столбцом `payment_id` в таблице `purchases`.
2.  **Удаление столбца `payment_type`**: Функция удаляет столбец `payment_type` из таблицы `purchases`.

```
    Удаление уникального ограничения payment_id
    │
    Удаление столбца payment_type