# Модуль для генерации таблиц в формате Markdown для документации провайдеров и моделей g4f

## Обзор

Модуль предназначен для автоматического создания таблиц в формате Markdown, которые отображают информацию о различных провайдерах и моделях, используемых в библиотеке `g4f` (Generative for free). Эти таблицы используются для документации, предоставляя разработчикам удобный способ ознакомиться со списком доступных провайдеров, их статусом, поддерживаемыми моделями и другими параметрами.

## Подробнее

Модуль содержит функции для тестирования асинхронных провайдеров, получения информации о провайдерах и моделях, а также для форматирования этой информации в виде таблиц Markdown. Он использует библиотеки `g4f`, `urllib.parse` и `asyncio`.

## Функции

### `test_async`

```python
async def test_async(provider: ProviderType) -> bool:
    """
    Асинхронно проверяет работоспособность указанного провайдера.

    Args:
        provider (ProviderType): Провайдер для тестирования.

    Returns:
        bool: `True`, если провайдер работает, `False` в противном случае.

    Raises:
        Exception: Если во время тестирования провайдера возникает исключение.

    Как работает функция:
    1. Проверяет, активен ли провайдер. Если нет, возвращает `False`.
    2. Отправляет асинхронный запрос к провайдеру с сообщением "Hello Assistant!".
    3. Ожидает ответа в течение 30 секунд.
    4. Возвращает `True`, если получен ответ, `False` в случае исключения или отсутствия ответа.

    Внутри функции происходят следующие действия и преобразования:
    - Проверка активности провайдера -> Отправка асинхронного запроса -> Ожидание ответа -> Возврат результата.
    """
```

### `test_async_list`

```python
def test_async_list(providers: list[ProviderType]) -> list:
    """
    Асинхронно тестирует список провайдеров.

    Args:
        providers (list[ProviderType]): Список провайдеров для тестирования.

    Returns:
        list: Список булевых значений, где каждое значение соответствует результату тестирования провайдера.

    Как работает функция:
    1. Проходит по списку провайдеров.
    2. Для каждого провайдера запускает асинхронную функцию `test_async`.
    3. Собирает результаты в список.
    4. Возвращает список результатов.

    Внутри функции происходят следующие действия и преобразования:
    - Итерация по списку провайдеров -> Запуск асинхронного тестирования для каждого провайдера -> Сбор результатов в список -> Возврат списка результатов.
    """
```

### `print_providers`

```python
def print_providers() -> list[str]:
    """
    Формирует список строк в формате Markdown для таблицы провайдеров.

    Returns:
        list[str]: Список строк, представляющих таблицу провайдеров в формате Markdown.

    Как работает функция:
    1. Фильтрует список провайдеров, оставляя только рабочие.
    2. Получает результаты тестирования провайдеров с помощью `test_async_list`.
    3. Формирует строки для таблицы, разделяя провайдеры на "Free" и "Auth".
    4. Добавляет информацию о каждом провайдере, такую как имя, веб-сайт, статус, поддержка стриминга и системных сообщений.
    5. Если провайдер поддерживает модели, добавляет информацию о доступных моделях и моделях для генерации изображений.
    6. Возвращает список строк для таблицы Markdown.

    Внутри функции происходят следующие действия и преобразования:
    - Фильтрация провайдеров -> Тестирование провайдеров -> Формирование строк таблицы -> Возврат списка строк.
    """
```

### `print_models`

```python
def print_models() -> list[str]:
    """
    Формирует список строк в формате Markdown для таблицы моделей.

    Returns:
        list[str]: Список строк, представляющих таблицу моделей в формате Markdown.

    Как работает функция:
    1. Определяет базовые имена и URL для различных провайдеров.
    2. Проходит по списку моделей и извлекает информацию о каждой модели, такую как имя, базовый провайдер и лучший провайдер.
    3. Формирует строки для таблицы, добавляя информацию о каждой модели, базовом провайдере, лучшем провайдере и веб-сайте.
    4. Возвращает список строк для таблицы Markdown.

    Внутри функции происходят следующие действия и преобразования:
    - Определение базовых имен и URL провайдеров -> Итерация по списку моделей -> Формирование строк таблицы -> Возврат списка строк.
    """
```

### `print_image_models`

```python
def print_image_models() -> list[str]:
    """
    Формирует список строк в формате Markdown для таблицы моделей изображений.

    Returns:
        list[str]: Список строк, представляющих таблицу моделей изображений в формате Markdown.

    Как работает функция:
    1. Проходит по списку провайдеров, у которых есть модели изображений или поддержка vision.
    2. Извлекает информацию о каждой модели изображения, такую как метка провайдера, поддержка vision и веб-сайт.
    3. Формирует строки для таблицы, добавляя информацию о каждой модели изображения и провайдере.
    4. Возвращает список строк для таблицы Markdown.

    Внутри функции происходят следующие действия и преобразования:
    - Итерация по списку провайдеров -> Извлечение информации о моделях изображений -> Формирование строк таблицы -> Возврат списка строк.
    """
```

## Запуск модуля

```python
if __name__ == "__main__":
    with open("docs/providers.md", "w") as f:
        f.write("\n".join(print_providers()))
        f.write(f"\n{\'-\' * 50} \n")
        #f.write("\\n".join(print_models()))
        #f.write(f"\\n{\'-\' * 50} \n")
        f.write("\\n".join(print_image_models()))
```

Этот блок кода выполняется только при непосредственном запуске файла. Он вызывает функции `print_providers` и `print_image_models` для создания таблиц в формате Markdown и записывает их в файл `docs/providers.md`.  Строка `#f.write("\\n".join(print_models()))` закомментирована, что означает, что таблица моделей не будет записана в файл.  Символы `{\'-\' * 50}` создают разделительную линию между таблицами.