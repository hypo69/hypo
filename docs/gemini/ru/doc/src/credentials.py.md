{
  "Improved Optimized Full Code": "# –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è\n\n# src.credentials\n\n## –û–±–∑–æ—Ä\n\n–ú–æ–¥—É–ª—å `src.credentials` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª–∞—Å—Å `ProgramSettings`, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –ø—É—Ç–∏, –ø–∞—Ä–æ–ª–∏, –ª–æ–≥–∏–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Singleton –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.\n\n## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ\n\n1.  [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)\n2.  [–ö–ª–∞—Å—Å—ã](#–∫–ª–∞—Å—Å—ã)\n    *   [ProgramSettings](#programsettings)\n3.  [–§—É–Ω–∫—Ü–∏–∏](#—Ñ—É–Ω–∫—Ü–∏–∏)\n    *   [set_project_root](#set_project_root)\n    *   [singleton](#singleton)\n\n## –ö–ª–∞—Å—Å—ã\n\n### `ProgramSettings`\n\n**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–ª–∞—Å—Å `ProgramSettings` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Singleton, —Ö—Ä–∞–Ω—è—â–∏–π –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.\n\n**–ê—Ç—Ä–∏–±—É—Ç—ã**:\n\n*   `host_name` (str): –ò–º—è —Ö–æ—Å—Ç–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –∏–º—è —Ç–µ–∫—É—â–µ–≥–æ —Ö–æ—Å—Ç–∞.\n*   `base_dir` (Path): –ë–∞–∑–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `set_project_root`.\n*   `config` (SimpleNamespace): –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ `config.json`.\n*   `credentials` (SimpleNamespace): –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ API.\n*   `path` (SimpleNamespace): –ü—É—Ç–∏ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º –ø—Ä–æ–µ–∫—Ç–∞.\n*   `host` (str): –•–æ—Å—Ç, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `'127.0.0.1'`.\n\n**–ú–µ—Ç–æ–¥—ã**:\n\n*   `__post_init__(self)`: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞, –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—É—Ç–∏ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.\n*   `_load_credentials(self)`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ KeePass.\n*   `_open_kp(self, retry: int = 3) -> PyKeePass | None`: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö KeePass.\n*   `_load_aliexpress_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Aliexpress API –∏–∑ KeePass.\n*   `_load_openai_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è OpenAI API –∏–∑ KeePass.\n*   `_load_gemini_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Gemini API –∏–∑ KeePass.\n*   `_load_telegram_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Telegram API –∏–∑ KeePass.\n*   `_load_discord_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Discord API –∏–∑ KeePass.\n*   `_load_prestashop_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è PrestaShop API –∏–∑ KeePass.\n*   `_load_serpapi_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è SerpAPI API –∏–∑ KeePass.\n*   `_load_smtp_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è SMTP –∏–∑ KeePass.\n*   `_load_facebook_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Facebook API –∏–∑ KeePass.\n*   `_load_gapi_credentials(self, kp: PyKeePass) -> bool`: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Google API –∏–∑ KeePass.\n*   `now(self) -> str`: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é –º–µ—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≥–æ–¥-–º–µ—Å—è—Ü-–¥–µ–Ω—å-—á–∞—Å—ã-–º–∏–Ω—É—Ç—ã-—Å–µ–∫—É–Ω–¥—ã-–º–∏–ª–∏—Å–µ–∫—É–Ω–¥—ã.\n\n## –§—É–Ω–∫—Ü–∏–∏\n\n### `set_project_root`\n\n**–û–ø–∏—Å–∞–Ω–∏–µ**: –§—É–Ω–∫—Ü–∏—è `set_project_root` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ª–∏—á–∏—è —Ñ–∞–π–ª–æ–≤-–º–∞—Ä–∫–µ—Ä–æ–≤.\n\n```python\ndef set_project_root(marker_files: tuple = ('__root__', '.git')) -> Path:\n    \"\"\"\n    Finds the root directory of the project starting from the current file's directory,\n    searching upwards and stopping at the first directory containing any of the marker files.\n\n    Args:\n        marker_files (tuple): Filenames or directory names to identify the project root.\n\n    Returns:\n        Path: Path to the root directory if found, otherwise the directory where the script is located.\n    \"\"\"\n```\n\n**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:\n\n*   `marker_files` (tuple, optional): –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤-–º–∞—Ä–∫–µ—Ä–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `('__root__', '.git')`.\n\n**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:\n\n*   `Path`: –ü—É—Ç—å –∫ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.\n\n### `singleton`\n\n**–û–ø–∏—Å–∞–Ω–∏–µ**: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `singleton` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Singleton –¥–ª—è –∫–ª–∞—Å—Å–∞.\n\n```python\ndef singleton(cls):\n    \"\"\"–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Singleton.\"\"\"\n    instances = {}\n\n    def get_instance(*args, **kwargs):\n        if cls not in instances:\n            instances[cls] = cls(*args, **kwargs)\n        return instances[cls]\n\n    return get_instance\n```\n\n**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:\n\n*   `cls` (class): –ö–ª–∞—Å—Å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω Singleton.\n\n**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:\n\n*   `get_instance` (function): –§—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞.\n\n```python\n\"\"\"\n.. module:: src\n    :platform: Windows, Unix\n    :synopsis: Global Project Settings: paths, passwords, logins, and API settings\n\n\"\"\"\n\nimport datetime\nfrom datetime import datetime\nimport getpass\nimport os\nimport sys\nimport json\nimport warnings\nimport socket\nfrom dataclasses import dataclass, field\nfrom pathlib import Path\nfrom types import SimpleNamespace\nfrom typing import Optional, List, Dict\n\nfrom pykeepass import PyKeePass\n\nfrom src.check_release import check_latest_release\nfrom src.logger.logger import logger\nfrom src.logger.exceptions import (\n    CredentialsError,\n    DefaultSettingsException,\n    HeaderChecksumError,\n    KeePassException,\n    PayloadChecksumError,\n    UnableToSendToRecycleBin,\n)\nfrom src.utils.file import read_text_file\nfrom src.utils.jjson import j_loads, j_loads_ns\nfrom src.utils.printer import pprint\n\n\ndef set_project_root(\n    marker_files: tuple = ('__root__', '.git')\n) -> Path:\n    \"\"\"\n    Finds the root directory of the project starting from the current file's directory,\n    searching upwards and stopping at the first directory containing any of the marker files.\n\n    Args:\n        marker_files (tuple): Filenames or directory names to identify the project root.\n\n    Returns:\n        Path: Path to the root directory if found, otherwise the directory where the script is located.\n    \"\"\"\n    __root__: Path\n    current_path: Path = Path(__file__).resolve().parent\n    __root__ = current_path\n    for parent in [current_path] + list(current_path.parents):\n        if any((parent / marker).exists() for marker in marker_files):\n            __root__ = parent\n            break\n    if __root__ not in sys.path:\n        sys.path.insert(0, str(__root__))\n    return __root__\n\n\ndef singleton(cls):\n    \"\"\"–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Singleton.\"\"\"\n    instances = {}\n\n    def get_instance(*args, **kwargs):\n        if cls not in instances:\n            instances[cls] = cls(*args, **kwargs)\n        return instances[cls]\n\n    return get_instance\n\n\n@singleton\n@dataclass\nclass ProgramSettings:\n    \"\"\"\n    `ProgramSettings` - –∫–ª–∞—Å—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã.\n\n    –°–∏–Ω–≥–ª—Ç–æ–Ω, —Ö—Ä–∞–Ω—è—â–∏–π –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.\n    \"\"\"\n\n    host_name: str = field(default_factory=lambda: socket.gethostname())\n\n    base_dir: Path = field(default_factory=lambda: set_project_root())\n    config: SimpleNamespace = field(default_factory=lambda: SimpleNamespace())\n\n    credentials: SimpleNamespace = field(default_factory=lambda: SimpleNamespace(\n        aliexpress=SimpleNamespace(\n            api_key=None,\n            secret=None,\n            tracking_id=None,\n            username=None,\n            email=None,\n            password=None\n        ),\n        presta=SimpleNamespace(\n            client=SimpleNamespace(\n                server=None,\n                port=None,\n                database=None,\n                user=None,\n                password=None,\n            )\n        ),\n        openai=SimpleNamespace(\n            owner=SimpleNamespace(\n                api_key=None,\n                assistants=[SimpleNamespace()],\n                project_api=None\n            )\n        ),\n\n        gemini=SimpleNamespace(owner=SimpleNamespace(api_key=None)),\n\n        rev_com=SimpleNamespace(owner=SimpleNamespace(\n            client_api=None,\n            user_api=None)),\n\n        shutter_stock=SimpleNamespace(owner=SimpleNamespace(token=None)),\n\n        discord=SimpleNamespace(\n            owner=SimpleNamespace(\n                application_id=None,\n                public_key=None,\n                bot_token=None)\n        ),\n\n        telegram=SimpleNamespace(\n            bot=SimpleNamespace()\n        ),\n\n        serpapi=SimpleNamespace(owner=SimpleNamespace(api_key=None,)),\n        smtp=[],\n        facebook=[],\n        gapi={}\n    ))\n\n    path: SimpleNamespace = field(default_factory=lambda: SimpleNamespace(\n        root=None,\n        src=None,\n        bin=None,\n        log=None,\n        tmp=None,\n        data=None,\n        secrets=None,\n        google_drive=None,\n        external_storage=None,\n        tools=None,\n        dev_null='nul' if sys.platform == 'win32' else '/dev/null'\n    ))\n\n    host: str = field(default='127.0.0.1')\n\n    def __post_init__(self) -> None:\n        \"\"\"–í—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞.\"\"\"\n        self.config = j_loads_ns(self.base_dir / 'src' / 'config.json')\n        if not self.config:\n            logger.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫')\n            ...\n            sys.exit()\n        self.config.timestamp_format = getattr(\n            self.config,\n            'timestamp_format',\n            '%y_%m_%d_%H_%M_%S_%f'\n        )\n        self.config.project_name = self.base_dir.name\n        self.host = getattr(self.config, 'host', '127.0.0.1')\n        self.path: SimpleNamespace = SimpleNamespace(\n            root=Path(self.base_dir),\n            bin=Path(self.base_dir / 'bin'),  # <- —Ç—É—Ç –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ (chrome, firefox, ffmpeg, ...)\n            src=Path(self.base_dir) / 'src',  # <- —Ç—É—Ç –≤–µ—Å—å –∫–æ–¥\n            endpoints=Path(self.base_dir) / 'src' / 'endpoints',  # <- —Ç—É—Ç –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã\n            secrets=Path(\n                self.base_dir / 'secrets'),  # <- —ç—Ç–æ –ø–∞–ø–∫–∞ —Å –ø–∞—Ä–æ–ª—è–º–∏ –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö ! –ï–π –Ω–µ–ª—å–∑—è –ø–æ–ø–∞–¥–∞—Ç—å –≤ –≥–∏—Ç!!!\n            toolbox=Path(self.base_dir / 'toolbox'),  # <- —Å–ª—É–∂–µ–±–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã\n            log=Path(getattr(self.config.path, 'log', self.base_dir / 'log')),\n            tmp=Path(getattr(self.config.path, 'tmp', self.base_dir / 'tmp')),\n            data=Path(getattr(self.config.path, 'data', self.base_dir / 'data')),\n            # <- –¥–∞—Ç–∞ –æ—Ç endpoints (hypo69, kazarinov, prestashop, etc ...)\n            google_drive=Path(\n                getattr(\n                    self.config.path,\n                    'google_drive',\n                    self.base_dir / 'google_drive'\n                )\n            ),  # <- GOOGLE DRIVE –ß–ï–†–ï–ó –õ–û–ö–ê–õ–¨–ù–´–ô –î–ò–°–ö (NOT API)\n            external_storage=Path(\n                getattr(\n                    self.config.path,\n                    'external_storage',\n                    self.base_dir / 'external_storage'\n                )\n            ),  # <- –í–Ω–µ—à–Ω–∏–π –¥–∏—Å–∫\n        )\n\n        if check_latest_release(self.config.git_user, self.config.git):\n            ...  # –õ–æ–≥–∏–∫–∞ —á—Ç–æ –¥–µ–ª–∞—Ç—å –∫–æ–≥–¥–∞ –µ—Å—Ç—å –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è hypo69 –Ω–∞ github\n\n        # Paths to bin directories\n        gtk_bin_dir = self.path.bin / 'gtk' / 'gtk-nsis-pack' / 'bin'\n        ffmpeg_bin_dir = self.base_dir / 'bin' / 'ffmpeg' / 'bin'\n        graphviz_bin_dir = self.base_dir / 'bin' / 'graphviz' / 'bin'\n        wkhtmltopdf_bin_dir = self.base_dir / 'bin' / 'wkhtmltopdf' / 'files' / 'bin'\n\n        for bin_path in [self.base_dir, gtk_bin_dir, ffmpeg_bin_dir, graphviz_bin_dir, wkhtmltopdf_bin_dir]:\n            if bin_path not in sys.path:\n                sys.path.insert(0, str(bin_path))  # <- –æ–ø—Ä–µ–¥–µ–ª—è—é –ø—É—Ç–∏ –∫ –±—É–Ω–∞—Ä–Ω–∏–∫–∞–º –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—É—Ç—è—Ö\n\n        os.environ['WEASYPRINT_DLL_DIRECTORIES'] = str(gtk_bin_dir)\n\n        # Suppress GTK log output to the console\n        warnings.filterwarnings(\"ignore\", category=UserWarning)\n        self._load_credentials()\n\n    def _load_credentials(self) -> None:\n        \"\"\"–ó–∞–≥—Ä—É–∂–∞–µ—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫.\"\"\"\n\n        kp = self._open_kp(3)\n        if not kp:\n            print(\"Error :( \")\n            ...\n            sys.exit(1)\n\n        if not self._load_aliexpress_credentials(kp):\n            print('Failed to load Aliexpress credentials')\n\n        if not self._load_openai_credentials(kp):\n            print('Failed to load OpenAI credentials')\n\n        if not self._load_gemini_credentials(kp):\n            print('Failed to load GoogleAI credentials')\n\n        if not self._load_discord_credentials(kp):\n            print('Failed to load Discord credentials')\n\n        if not self._load_telegram_credentials(kp):\n            print('Failed to load Telegram credentials')\n\n        if not self._load_prestashop_credentials(kp):\n            print('Failed to load prestashop credentials')\n\n        if not self._load_smtp_credentials(kp):\n            print('Failed to load SMTP credentials')\n\n        if not self._load_facebook_credentials(kp):\n            print('Failed to load Facebook credentials')\n\n        if not self._load_gapi_credentials(kp):\n            print('Failed to load GAPI credentials')\n\n        if not self._load_serpapi_credentials(kp):\n            print('Failed to load https://serpapi.com credentials')\n\n    def _open_kp(self, retry: int = 3) -> PyKeePass | None:\n        \"\"\"Open KeePass database\n\n        Args:\n            retry (int): Number of retries\n        \"\"\"\n        while retry > 0:\n            try:\n                # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ DEBUG ~~~~~~~ ‚ö†Ô∏è –§–ê–ô–õ –ü–ê–†–û–õ–Ø –í –û–¢–ö–†–´–¢–û–ú –í–ò–î–ï ‚ö†Ô∏è ~~~~~~~~~~~~~~~~~~~~~~~\n                password: str = Path(\n                    self.path.secrets / 'password.txt').read_text(encoding=\"utf-8\") or None\n                \"\"\"password: —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫—É –ø–∞—Ä–æ–ª—è –≤ ‚ö†Ô∏è –æ—Ç–∫—Ä—ã—Ç–æ–º ‚ö†Ô∏è –≤–∏–¥–µ. –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ —Å–∞–º —Ñ–∞–π–ª –∏–ª–∏ –≤—ã—Ç–µ—Ä–µ—Ç—å –µ–≥–æ —Å–æ–¥—Ä–∂–∏–º–æ–µ \"\"\"\n\n                kp = PyKeePass(\n                    str(self.path.secrets / 'credentials.kdbx'),\n                    password=password or getpass.getpass(\n                        print('üîê Enter KeePass master password: ').lower())\n                )\n\n                return kp\n            except Exception as ex:\n                print(f\"üòî Failed to open KeePass database Exception: {ex}\\n {retry-1} retries left.\")\n                ...\n                retry -= 1\n                if retry < 1:\n                    logger.critical(\n                        'üö® Failed to open KeePass database after multiple attempts',\n                        None,\n                        False\n                    )\n                    ...\n                    sys.exit()\n\n    # Define methods for loading various credentials\n    def _load_aliexpress_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load Aliexpress API credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            entry = kp.find_groups(path=['suppliers', 'aliexpress', 'api']).entries[0]\n            self.credentials.aliexpress.api_key = entry.custom_properties.get('api_key', None)\n            self.credentials.aliexpress.secret = entry.custom_properties.get('secret', None)\n            self.credentials.aliexpress.tracking_id = entry.custom_properties.get('tracking_id', None)\n            self.credentials.aliexpress.email = entry.custom_properties.get('email', None)\n            self.credentials.aliexpress.password = entry.password\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract Aliexpress API key from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_openai_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load OpenAI credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            openai_api_keys = kp.find_groups(path=['openai']).entries\n            assistants: list = kp.find_groups(path=['openai', 'assistants']).entries\n\n            for entry in openai_api_keys:\n\n                try:\n                    # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ SimpleNamespace –¥–ª—è –∫–∞–∂–¥–æ–≥–æ API –∫–ª—é—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `hypotez`)\n                    entry_ns = SimpleNamespace()\n\n                    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ –≤ self.credentials.presta.client —Å –∏–º–µ–Ω–µ–º entry.title\n                    setattr(self.credentials.openai, entry.title, entry_ns)\n\n                    # –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–µ—Ä–µ–∑ entry.title\n                    _entry = getattr(self.credentials.openai, entry.title)\n\n                    setattr(_entry, 'api_key', entry.custom_properties.get('api_key', None))\n                    setattr(_entry, 'project_api', entry.custom_properties.get('project_api', None))\n\n                except Exception as ex:\n                    logger.error(f\"Failed to extract OpenAI API key from KeePass \", ex)\n                    ...\n\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract OpenAI credentials from KeePass \", ex)\n            ...\n            return False\n\n    def _load_gemini_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load GoogleAI credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            entries = kp.find_groups(path=['gemini']).entries\n\n            for entry in entries:\n                setattr(self.credentials.gemini, entry.title, entry.custom_properties.get('api_key', None))\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract GoogleAI credentials from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_telegram_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load Telegram credentials from KeePass.\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            entries = kp.find_groups(path=['telegram']).entries\n            for entry in entries:\n                setattr(self.credentials.telegram, entry.title, entry.custom_properties.get('token', None))\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract Telegram credentials from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_discord_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load Discord credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            entry = kp.find_groups(path=['discord']).entries[0]\n            self.credentials.discord.application_id = entry.custom_properties.get('application_id', None)\n            self.credentials.discord.public_key = entry.custom_properties.get('public_key', None)\n            self.credentials.discord.bot_token = entry.custom_properties.get('bot_token', None)\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract Discord credentials from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_prestashop_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load prestashop credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n\n        for entry in kp.find_groups(path=['prestashop', 'clients']).entries:\n            try:\n                # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π SimpleNamespace –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞\n                client_ns = SimpleNamespace()\n\n                # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç –≤ self.credentials.presta.client —Å –∏–º–µ–Ω–µ–º entry.title\n                setattr(self.credentials.presta.client, entry.title, client_ns)\n\n                # –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–µ—Ä–µ–∑ entry.title\n                current_client = getattr(self.credentials.presta.client, entry.title)\n\n                setattr(current_client, 'api_key', entry.custom_properties.get('api_key', None))\n                setattr(current_client, 'api_domain', entry.custom_properties.get('api_domain', None))\n                setattr(current_client, 'db_server', entry.custom_properties.get('db_server', None))\n                setattr(current_client, 'db_user', entry.custom_properties.get('db_user', None))\n                setattr(current_client, 'db_password', entry.custom_properties.get('db_password', None))\n\n            except Exception as ex:\n                print(f\"Failed to extract prestashop credentials from KeePass \", ex)\n                ...\n                return False\n\n        return True\n\n    def _load_serpapi_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load OpenAI credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            serpapi_credentials = kp.find_groups(path=['serpapi.com']).entries\n\n            for entry in serpapi_credentials:\n\n                try:\n                    # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ SimpleNamespace –¥–ª—è –∫–∞–∂–¥–æ–≥–æ API –∫–ª—é—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `hypotez`)\n                    entry_ns = SimpleNamespace()\n\n                    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–∞ –≤ self.credentials.presta.client —Å –∏–º–µ–Ω–µ–º entry.title\n                    setattr(self.credentials.serpapi, entry.title, entry_ns)\n\n                    # –°—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–µ—Ä–µ–∑ entry.title\n                    _entry = getattr(self.credentials.serpapi, entry.title)\n                    setattr(_entry, 'api_key', entry.custom_properties.get('api_key', None))\n\n                except Exception as ex:\n                    logger.error(f\"Failed to extract serpapi.com API key from KeePass \", ex)\n                    ...\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract OpenAI credentials from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_smtp_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load SMTP credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            for entry in kp.find_groups(path=['smtp']).entries:\n                self.credentials.smtp.append(SimpleNamespace(\n                    server=entry.custom_properties.get('server', None),\n                    port=entry.custom_properties.get('port', None),\n                    user=entry.custom_properties.get('user', None),\n                    password=entry.custom_properties.get('password', None),\n                ))\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract SMTP credentials from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_facebook_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load Facebook credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            for entry in kp.find_groups(path=['facebook']).entries:\n                self.credentials.facebook.append(SimpleNamespace(\n                    app_id=entry.custom_properties.get('app_id', None),\n                    app_secret=entry.custom_properties.get('app_secret', None),\n                    access_token=entry.custom_properties.get('access_token', None),\n                ))\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract Facebook credentials from KeePass {ex}\")\n            ...\n            return False\n\n    def _load_gapi_credentials(self, kp: PyKeePass) -> bool:\n        \"\"\"Load Google API credentials from KeePass\n\n        Args:\n            kp (PyKeePass): The KeePass database instance.\n\n        Returns:\n            bool: True if loading was successful, False otherwise.\n        \"\"\"\n        try:\n            entry = kp.find_groups(path=['google', 'gapi']).entries[0]\n            self.credentials.gapi['api_key'] = entry.custom_properties.get('api_key', None)\n            return True\n        except Exception as ex:\n            print(f\"Failed to extract GAPI credentials from KeePass {ex}\")\n            ...\n            return False\n\n    @property\n    def now(self) -> str:\n        \"\"\"–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é –º–µ—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –≥–æ–¥-–º–µ—Å—è—Ü-–¥–µ–Ω—å-—á–∞—Å—ã-–º–∏–Ω—É—Ç—ã-—Å–µ–∫—É–Ω–¥—ã-–º–∏–ª–∏—Å–µ–∫—É–Ω–¥—ã.\n\n        –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â—É—é —Ç–µ–∫—É—â—É—é –º–µ—Ç–∫—É –≤—Ä–µ–º–µ–Ω–∏, –≤ —Ñ–æ—Ä–º–∞—Ç–µ `–≥–æ–¥_–º–µ—Å—è—Ü_–¥–µ–Ω—å_—á–∞—Å—ã_–º–∏–Ω—É—Ç—ã_—Å–µ–∫—É–Ω–¥—ã_–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã`.\n\n        Args:\n            dformat (str, optional): –§–æ—Ä–º–∞—Ç –¥–ª—è –º–µ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `\'%y_%m_%d_%H_%M_%S_%f\'`.\n\n        Returns:\n            str: –¢–µ–∫—É—â–∞—è –º–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å—Ç—Ä–æ–∫–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.\n        \"\"\"\n        timestamp = datetime.now().strftime(self.config.timestamp_format)\n        # –í–µ—Ä–Ω—ë–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 3 —Ü–∏—Ñ—Ä—ã –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥, —Ç.–∫. %f –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—ã (6 —Ü–∏—Ñ—Ä)\n        return f\"{timestamp[:-3]}\"\n\n\n# Global instance of ProgamSettings\ngs: ProgramSettings = ProgramSettings()\n",
  "Changes": "1.  Added documentation in Markdown format for the file, including a general overview, table of contents, and detailed descriptions of classes and functions.\n2.  Added documentation for the `set_project_root` and `singleton` functions.\n3.  Added documentation for the `ProgramSettings` class, including attributes and methods.\n4.  Formatted the code for better readability.\n"
}