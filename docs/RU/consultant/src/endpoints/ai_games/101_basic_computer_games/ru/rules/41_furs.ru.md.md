# Анализ кода модуля `41_furs.ru.md`

**Качество кода**
6
-  Плюсы
    - Представлено подробное описание правил игры "FURS" (Торговля шкурами) и пошаговая инструкция для реализации.
    -  Приведены примеры работы программы, возможные ограничения и рекомендации по реализации.
-  Минусы
    - Отсутствует reStructuredText (RST) форматирование для комментариев.
    - Нет явных указаний на использование `j_loads` или `j_loads_ns` для чтения файлов.
    -  Отсутствует импорт необходимых модулей и функций.
    -  Нет логирования ошибок.
    -  Нет комментариев в формате reStructuredText (RST) для модуля.
    - Код не является исполняемым, поэтому не может быть полностью проверен на соответствие требованиям.
**Рекомендации по улучшению**

1.  Добавить reStructuredText (RST) форматирование для всех комментариев, включая описание модуля, функций, переменных и т.д.
2.  Указать использование `j_loads` или `j_loads_ns` для чтения файлов, если это необходимо в коде.
3.  Добавить импорты необходимых модулей (например, `random` для генерации случайных цен).
4.  Внедрить логирование ошибок с помощью `from src.logger.logger import logger`.
5.  Преобразовать описание в структурированный docstring, используя reStructuredText (RST).
6.  Предоставить пример реализации на Python для демонстрации основных концепций игры (включая использование `random`, циклов и условий).

**Оптимизированный код**

```markdown
"""
Модуль с правилами игры FURS (Торговля шкурами)
=================================================

Модуль содержит подробное описание правил игры, пошаговую инструкцию для реализации,
примеры работы программы, возможные ограничения и рекомендации по реализации.
"""

### Название игры: **FURS** (Торговля шкурами)

---

#### Описание
**FURS** — это экономическая игра, в которой игрок торгует шкурами с индейцами, пытаясь заработать наибольшее количество денег.
В игре участвует несколько торговцев, и каждый ход игрок решает, сколько шкур и по какой цене купить или продать.
Цель игры — накопить как можно больше денег, управляя своими покупками и продажами шкур.

---

### Пошаговая инструкция для реализации

#### 1. **Инициализация игры**
   - При запуске игры программа приветствует игрока и объясняет правила.
   - Игрок получает начальный капитал (например, 100 долларов).
   - Программа генерирует случайные цены на шкуру, которые могут варьироваться в зависимости от сезона или состояния рынка.
   - Игрок может выбрать количество торговцев, с которыми он будет работать (например, от 2 до 5).

#### 2. **Основной процесс игры**
   - **Торговля шкурами:**
     1. Игрок может покупать шкуру по цене, установленной на рынке, или продавать её с выгодой.
     2. Каждый товар (шкура) имеет свою цену, которая может изменяться в зависимости от спроса и предложения.
     3. Цена покупки и продажи шкур варьируется и зависит от состояния рынка и торговых отношений с индейцами.
   - **Действия игрока:**
     - Игрок решает, сколько шкур он покупает или продаёт за определённую сумму денег.
     - Программа автоматически обновляет баланс денег игрока и количество шкур, которыми он владеет, после каждого действия.

#### 3. **Условия победы**
   - Игра заканчивается после достижения игроком заранее установленного количества шкур или капитала (например, 500 долларов).
   - Победителем становится тот, кто смог накопить наибольшее количество денег или шкур за отведённое время.

#### 4. **Продолжение игры**
   - После завершения игры пользователю предлагается сыграть снова:
     ```
     Хотите сыграть ещё раз? (да/нет)
     ```
   - Если игрок выбирает "да", игра начинается заново с новым капиталом и случайными ценами на шкуру.
   - Если "нет", программа завершает работу.

---

### Пример работы программы

1. **Начало игры:**
   ```
   Добро пожаловать в игру FURS!
   У вас $100.
   Торгуйте шкурами с индейцами и постарайтесь заработать как можно больше денег.
   Программа генерирует случайные цены на шкуру.
   Начните торговлю!
   ```

2. **Торговля шкурами:**
   ```
   Цена за шкуру: $20
   Сколько шкур вы хотите купить?
   > 3
   Вы купили 3 шкуры по $20. Остаток: $40.
   Ваши шкуры: 3

   Цена за шкуру: $25
   Сколько шкур вы хотите продать?
   > 2
   Вы продали 2 шкуры по $25. Остаток: $90.
   Ваши шкуры: 1
   ```

3. **Результат игры:**
   ```
   Поздравляем! Вы накопили $200.
   Хотите сыграть ещё раз? (да/нет):
   > нет
   Спасибо за игру!
   ```

---

### Возможные ограничения
- Игрок может покупать или продавать только ограниченное количество шкур за ход.
- Рынок изменяет свои цены случайным образом, что влияет на возможность получить прибыль.
- Начальный капитал ограничен (например, $100), и игрок должен эффективно им распоряжаться.

---

### Реализация
Игра может быть реализована на Python с использованием следующих возможностей:
- **Модуль `random`** для генерации случайных цен на шкуру и изменений на рынке.
- Циклы и условия для обработки ввода игрока и обновления состояния игры.
- Структуры данных для отслеживания капитала и количества шкур у игрока.

Рекомендуется:
- Добавить систему уровней сложности с изменяющимися условиями торговли.
- Реализовать случайные события, такие как изменение рыночных цен или политические события, которые влияют на торговлю.

```python
"""
Пример реализации игры FURS (Торговля шкурами)
=============================================

Этот модуль демонстрирует базовую реализацию игры FURS,
используя модуль random для генерации случайных цен и условий игры.

Пример использования
--------------------

.. code-block:: python

    game = FursGame()
    game.start_game()
"""

import random
from src.logger.logger import logger # импортируем logger

class FursGame:
    """
    Класс, представляющий игру FURS (Торговля шкурами).

    :ivar int initial_capital: Начальный капитал игрока.
    :ivar int furs_count: Количество шкур у игрока.
    """
    def __init__(self, initial_capital: int = 100, initial_furs: int = 0):
        """
        Инициализирует игру с заданным начальным капиталом и количеством шкур.
        
        :param initial_capital: Начальный капитал игрока.
        :param initial_furs: Начальное количество шкур у игрока.
        """
        self.initial_capital = initial_capital
        self.capital = initial_capital
        self.furs_count = initial_furs
        
    def start_game(self):
         """
        Начинает игру, приветствует игрока и запускает игровой цикл.
        """
         print("Добро пожаловать в игру FURS!")
         print(f"У вас ${self.capital}. Начните торговлю!")
         self.game_loop()

    def generate_price(self) -> int:
        """
        Генерирует случайную цену на шкуру.

        :return: Случайная цена на шкуру.
        """
        return random.randint(15, 35)

    def buy_furs(self, price: int):
       """
       Покупка шкур игроком.

       :param price: Цена за шкуру.
       """
       try:
            while True:
                try:
                   count = int(input("Сколько шкур вы хотите купить? "))
                   if count < 0 :
                       print("Введите положительное значение.")
                       continue
                   break

                except ValueError:
                      print("Некорректный ввод, введите число.")

            cost = price * count
            if cost > self.capital:
                print("Недостаточно средств.")
                return

            self.capital -= cost
            self.furs_count += count
            print(f"Вы купили {count} шкуры по ${price}. Остаток: ${self.capital}. Ваши шкуры: {self.furs_count}")
       except Exception as e:
            logger.error(f'Ошибка при покупке шкур: {e}')
        

    def sell_furs(self, price: int):
        """
        Продажа шкур игроком.

        :param price: Цена за шкуру.
        """
        try:
            while True:
               try:
                 count = int(input("Сколько шкур вы хотите продать? "))
                 if count < 0:
                    print("Введите положительное значение.")
                    continue
                 if count > self.furs_count:
                    print("Недостаточно шкур для продажи.")
                    continue
                 break
               except ValueError:
                 print("Некорректный ввод, введите число.")
                
            revenue = price * count
            self.capital += revenue
            self.furs_count -= count
            print(f"Вы продали {count} шкуры по ${price}. Остаток: ${self.capital}. Ваши шкуры: {self.furs_count}")
        except Exception as e:
             logger.error(f'Ошибка при продаже шкур: {e}')


    def check_win(self) -> bool:
       """
       Проверяет, выполнил ли игрок условия победы.
       Победа достигается при накоплении капитала в $200.

       :return: True, если игрок победил, False иначе.
       """
       if self.capital >= 200:
          print(f"Поздравляем! Вы накопили ${self.capital}.")
          return True
       return False

    def play_again(self) -> bool:
        """
        Спрашивает пользователя, хочет ли он сыграть еще раз.

        :return: True, если игрок хочет сыграть снова, False иначе.
        """
        while True:
            answer = input("Хотите сыграть ещё раз? (да/нет): ").lower()
            if answer in ["да", "нет"]:
                return answer == "да"
            print("Некорректный ввод. Введите 'да' или 'нет'.")


    def game_loop(self):
         """
         Основной игровой цикл.
         """
         while True:
            price = self.generate_price()
            print(f"Цена за шкуру: ${price}")

            action = input("Купить (к) или продать (п)? ").lower()
            if action == 'к':
                self.buy_furs(price)
            elif action == 'п':
                 self.sell_furs(price)
            else:
                 print("Некорректный ввод")
                 continue
            if self.check_win():
                 if self.play_again():
                     self.capital = self.initial_capital
                     self.furs_count = 0
                     continue
                 else:
                     print("Спасибо за игру!")
                     break
```