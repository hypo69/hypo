# Модуль для обновления таблицы purchases

## Обзор

Модуль содержит скрипты миграции базы данных, используемые Alembic для обновления и отката изменений в таблице `purchases`. В частности, добавляется столбец `payment_type` и уникальный индекс для `payment_id`.

## Подробней

Этот модуль предназначен для управления изменениями в структуре базы данных. Он используется Alembic для автоматического применения изменений (upgrade) и их отмены (downgrade). Файл содержит две основные функции: `upgrade` и `downgrade`, которые определяют, какие изменения должны быть внесены или отменены в базе данных.

## Функции

### `upgrade`

```python
def upgrade() -> None:
    """
    Обновляет схему базы данных, добавляя столбец 'payment_type' в таблицу 'purchases'
    и создавая уникальный индекс для столбца 'payment_id'.

    Args:
        None

    Returns:
        None

    """
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('purchases', sa.Column('payment_type', sa.String(), nullable=False))
    op.create_unique_constraint(None, 'purchases', ['payment_id'])
    # ### end Alembic commands ###
```

**Как работает функция**:

1.  **Добавление столбца `payment_type`**: Добавляет новый столбец с именем `payment_type` в таблицу `purchases`. Этот столбец предназначен для хранения информации о типе платежа.

2.  **Создание уникального индекса**: Создает уникальный индекс для столбца `payment_id` в таблице `purchases`. Это гарантирует, что каждое значение `payment_id` будет уникальным.

### `downgrade`

```python
def downgrade() -> None:
    """
    Откатывает изменения, внесенные функцией `upgrade`, удаляя уникальный индекс
    и столбец 'payment_type' из таблицы 'purchases'.

    Args:
        None

    Returns:
        None

    """
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'purchases', type_='unique')
    op.drop_column('purchases', 'payment_type')
    # ### end Alembic commands ###
```

**Как работает функция**:

1.  **Удаление уникального индекса**: Удаляет уникальный индекс, созданный для столбца `payment_id` в таблице `purchases`.

2.  **Удаление столбца `payment_type`**: Удаляет столбец `payment_type` из таблицы `purchases`, возвращая схему к предыдущему состоянию.