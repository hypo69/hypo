# Модуль try_xpath_background.js

## Обзор

Этот модуль отвечает за обработку сообщений и взаимодействие с расширением Try XPath для браузера. Он управляет сохранением состояния всплывающего окна, загрузкой стилей, отображением результатов поиска и обновлением CSS.


## Переменные

### `tx`

**Описание**: псевдоним для объекта `tryxpath`.

### `fu`

**Описание**: псевдоним для объекта `tryxpath.functions`.

### `popupState`

**Описание**: Состояние всплывающего окна.

### `popupCss`

**Описание**: Строка CSS-стилей для всплывающего окна.

### `results`

**Описание**: Результаты поиска, полученные от активной вкладки.

### `css`

**Описание**: Загруженные CSS-стили.

### `attributes`

**Описание**: Объект, содержащий атрибуты, используемые для поиска элементов.

### `genericListener`

**Описание**: Объект, управляющий обработкой сообщений.


## Функции

### `loadDefaultCss`

**Описание**: Загружает CSS-стили из файла `/css/try_xpath_insert.css`.

**Возвращает**: `Promise` объекта, содержащего ответ от запроса на загрузку.

**Вызывает исключения**: Обрабатывает ошибки при запросе.

### `genericListener(message, sender, sendResponse)`

**Описание**: Обрабатывает сообщения, полученные расширением.

**Параметры**:
- `message` (object): Данные сообщения.
- `sender` (object): Отправитель сообщения.
- `sendResponse` (function): Функция для ответа на сообщение.

**Возвращает**: Результат выполнения обработчика или `undefined`.

**Вызывает исключения**: Обрабатывает ошибки, связанные с обработкой сообщения.

### `genericListener.listeners.storePopupState(message)`

**Описание**: Сохраняет состояние всплывающего окна.

**Параметры**:
- `message` (object): Объект с данными о состоянии.

**Возвращает**: `undefined`.

### `genericListener.listeners.requestRestorePopupState(message)`

**Описание**: Отправляет сообщение о восстановлении состояния всплывающего окна.

**Параметры**:
- `message` (object): Объект с данными о запросе.

**Возвращает**: `undefined`.


### `genericListener.listeners.requestInsertStyleToPopup()`

**Описание**: Отправляет сообщение о вставке CSS-стилей в всплывающее окно.

**Возвращает**: `undefined`.

### `genericListener.listeners.showAllResults(message, sender)`

**Описание**: Создает новую вкладку для отображения результатов поиска.

**Параметры**:
- `message` (object): Объект с данными о результатах поиска.
- `sender` (object): Отправитель сообщения.


**Возвращает**: `undefined`.

### `genericListener.listeners.loadResults(message, sender, sendResponse)`

**Описание**: Возвращает результаты поиска.

**Параметры**:
- `message` (object): Объект с данными о запросе.
- `sender` (object): Отправитель сообщения.
- `sendResponse` (function): Функция для ответа на сообщение.

**Возвращает**: `true`.

### `genericListener.listeners.updateCss(message, sender)`

**Описание**: Обновляет CSS-стили во вкладке.

**Параметры**:
- `message` (object): Объект с данными о CSS-стилях.
- `sender` (object): Отправитель сообщения.

**Возвращает**: `undefined`.


### `genericListener.listeners.loadOptions(message, sender, sendResponse)`

**Описание**: Возвращает значения атрибутов и CSS.

**Параметры**:
- `message` (object): Объект с данными о запросе.
- `sender` (object): Отправитель сообщения.
- `sendResponse` (function): Функция для ответа на сообщение.

**Возвращает**: `true`.

### `genericListener.listeners.requestSetContentInfo(message, sender)`

**Описание**: Отправляет сообщение о настройке информации для контента.

**Параметры**:
- `message` (object): Данные сообщения.
- `sender` (object): Объект, который отправил сообщение.

**Возвращает**: `undefined`.

## Обработчик изменений настроек

**Описание**: Отслеживает изменения значений настроек (`attributes`, `css`, `popupCss`) в хранилище `browser.storage`.

**Параметры**:
- `changes` (object): Объект, содержащий информацию о произошедших изменениях.


## Инициализация

**Описание**: Загружает значения настроек из хранилища `browser.storage.sync` и выполняет загрузку default CSS.

**Возвращает**: `undefined`.