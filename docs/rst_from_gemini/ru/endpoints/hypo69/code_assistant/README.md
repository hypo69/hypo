```markdown
# Code Assistant: Обучение модели коду проекта

## Описание

`Code Assistant` — инструмент для взаимодействия с моделями **Gemini** и **OpenAI** для обработки исходного кода. Он выполняет задачи, такие как создание документации, проверки кода и генерации тестов на основе кода из указанных файлов.

## Основные возможности

- **Чтение исходных файлов**: Чтение кода из файлов с расширениями `.py` и `README.md` из указанных директорий.
- **Обработка с помощью моделей**: Отправка кода в модели для выполнения задач, таких как создание документации, проверки стиля, поиска ошибок и генерации тестов.
- **Генерация результатов**: Ответы моделей сохраняются в указанные директории для каждой роли и модели.  Результаты структурируются для удобства дальнейшего использования.

## Структура проекта

- **Модели**: Используются модели **Gemini** и **OpenAI** для обработки запросов.
- **Промпты**: Программа читает промпты из файлов в директории `src/ai/prompts/developer/`.  Промпты должны быть адаптированы к роли (`doc_creator`, `code_checker`) и языку (`ru`, `en`).
- **Файлы**: Обрабатываются файлы с расширениями `.py` и `README.md` в указанных стартовых директориях.  Поддерживается обработка файлов в различных кодировках.
- **Результаты**: Результаты сохраняются в структурированных папках (`docs/raw_rst_from_<model>/<lang>/`) для удобства последующей обработки.

## Пример использования

### Запуск с настройками из JSON:

```bash
python assistant.py --settings settings.json
```

### Запуск с явным указанием параметров:

```bash
python assistant.py --role doc_creator --lang ru --models gemini openai --start_dirs /path/to/dir1 /path/to/dir2 --output_dir docs
```

### Пример для роли `code_checker`:

```bash
python assistant.py --role code_checker --lang en --models gemini --start_dirs /path/to/dir --output_dir checks
```

### Важное замечание о параметрах `--output_dir`:
Параметр `--output_dir`  *обязателен* для корректного сохранения результатов.  Он задаёт директорию, в которую будут сохраняться результаты.


### Пример для модели `openai`:

```bash
python assistant.py --role doc_creator --lang en --models openai --start_dirs /path/to/project --output_dir generated_docs
```


## Параметры командной строки

- `--settings`: Путь к JSON файлу с настройками.
- `--role`: Роль модели для выполнения задачи (например, `doc_creator`, `code_checker`).
- `--lang`: Язык выполнения задачи (например, `ru` или `en`).
- `--models`: Список моделей для инициализации (например, `gemini`, `openai`).
- `--start_dirs`: Список директорий для обработки.
- `--output_dir`: Директория для сохранения результатов (**обязательный параметр!**).

## Логика работы

1. **Чтение файлов**: Поиск файлов `.py` и `README.md` в указанных стартовых директориях.  **Обратите внимание на поддержку различных кодировок файлов!**
2. **Загрузка промптов**: Загрузка файлов промптов для каждой роли и языка из директории `src/ai/prompts/developer/`.
3. **Обработка запросов**: Формирование запросов на основе загруженных файлов и отправка их в модели.
4. **Сохранение ответов**: Ответы от моделей сохраняются в заданной `--output_dir`, структурированной по модели и роли.
5. **Обработка исключений**: Обработка ошибок при чтении файлов, запросах к API и сохранении результатов.

## Исключения

Настройка исключений для файлов и директорий с помощью параметров:
- `exclude_file_patterns`: Список регулярных выражений для исключения файлов.
- `exclude_dirs`: Список директорий для исключения.
- `exclude_files`: Список файлов для исключения.

## Логирование

Логи сохраняются с помощью библиотеки `logging` и содержат информацию о процессе обработки файлов и полученных ответах.  Уровень детализации логирования можно настроить.

## Зависимости

- Gemini API: Требуется API-ключ для работы с моделью Gemini.
- OpenAI API: Требуется API-ключ для работы с моделью OpenAI.
- [Библиотека для работы с JSON](https://docs.python.org/3/library/json.html)
- [Библиотека для работы с регулярными выражениями](https://docs.python.org/3/library/re.html)
- [Библиотека для работы с файлами](https://docs.python.org/3/library/pathlib.html)
- [Библиотека для логирования](https://docs.python.org/3/library/logging.html)


```