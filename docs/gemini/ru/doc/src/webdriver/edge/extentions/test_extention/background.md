# Документация для файла `background.js`

## Обзор

Этот файл JavaScript отвечает за обработку сообщений, отправленных из других частей расширения Chrome, и за отправку данных на сервер. Он служит посредником между другими частями расширения и сервером, собирая и передавая необходимые данные.

## Функции

### `sendDataToServer`

**Описание**: Функция отправляет собранные данные на сервер.

**Параметры**:

- `url` (str): URL страницы, для которой необходимо собрать данные.

**Возвращает**:

- `None`: Функция не возвращает значения.

**Вызывает исключения**:

- `Error`: Возникает, если произошла ошибка при отправке данных на сервер.


### Обработчик `chrome.runtime.onMessage`

**Описание**: Этот обработчик слушает сообщения, отправленные из других частей расширения. Если сообщение имеет действие 'collectData', вызывает функцию `sendDataToServer`.


**Параметры**:

- `message` (dict): Сообщение, отправленное из другого скрипта расширения. Ожидается, что `message` будет иметь поле `action` со значением `'collectData'` и поле `url`.
- `sender` (object): Информация об отправителе сообщения.
- `sendResponse` (function): Функция, которая может быть использована для отправки ответа отправителю. В данном случае не используется.


**Возвращает**:

- `boolean`: Возвращает `true`, позволяя `sendResponse` передать ответ.

**Вызывает исключения**:

- Нет


## Обработчик `chrome.browserAction.onClicked`

**Описание**:  Устанавливает обработчик клика по иконке расширения. При клике по иконке отправляет сообщение `'collectData'`  в активную вкладку.


**Параметры**:

- `tab` (object): Информация о текущей вкладке.


**Возвращает**:

- `None`: Функция не возвращает значения.

**Вызывает исключения**:

- Нет



## Справочные данные

### `chrome.storage.local.get`

Функция `chrome.storage.local.get` используется для получения данных из локального хранилища расширения.


### `fetch`

Функция `fetch` используется для отправки запроса к серверу.

### `JSON.stringify`

Функция `JSON.stringify` преобразует объект JavaScript в строку JSON.

### Константы

`serverUrl`: Строковая константа, содержащая URL сервера, на который будут отправляться данные.  (Изменийте на ваш URL)


## Описание переменных

- `collectedData`: Содержит данные, которые должны быть отправлены на сервер. Извлекается из локального хранилища расширения.


## Особенности

- Обратите внимание, что `serverUrl` задан в коде как `http://127.0.0.1/hypotez.online/api/`. Измените его на корректный адрес вашего сервера.
- Функция `sendDataToServer` использует локальное хранилище `chrome.storage.local` для получения данных.
- Обработчик `chrome.browserAction.onClicked` отправляет сообщение в текущую вкладку, что предполагает наличие скрипта обработчика в содержимом этой вкладки (content script).


## Оглавление

- [Обзор](#обзор)
- [Функции](#функции)
  - [`sendDataToServer`](#senddatatoserver)
  - [`Обработчик chrome.runtime.onMessage`](#обработчик-chromeruntimeonmessage)
- [Обработчик `chrome.browserAction.onClicked`](#обработчик-chromebrowseractiononclicked)
- [Справочные данные](#справочные-данные)
- [Описание переменных](#описание-переменных)
- [Особенности](#особенности)
- [Оглавление](#оглавление)