Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код предоставляет класс `GSRender` для форматирования и рендеринга данных в Google Таблицах.  Класс содержит методы для создания и настройки таблиц, включая форматирование заголовков, объединение ячеек, изменение свойств листа и добавление строк.  Он использует библиотеки `gspread`, `gspread-formatting` и другие вспомогательные функции для взаимодействия с Google Spreadsheets API.

Шаги выполнения
-------------------------
1. **Импорт необходимых библиотек:**  Код импортирует нужные модули из пакетов `src`, `spread_formatting`, `spread`, `goog.helpers` и т.д.  Это обеспечивает доступ к функциям и классам для работы с Google Таблицами.

2. **Определение класса `GSRender`:**  Класс `GSRender` содержит методы для выполнения различных операций с таблицей.

3. **Метод `render_header`:** Этот метод отвечает за форматирование заголовка таблицы.  Он устанавливает цвет фона, выравнивание текста, шрифт и размер шрифта для ячеек заголовка.  Для форматирования заголовка используется класс `CellFormat`. Дополнительно, метод может обрабатывать объединение ячеек (`merge_type`) и применять условное форматирование (`ConditionalFormatRule`).

4. **Метод `merge_range`:** Объединяет ячейки в указанном диапазоне (`range`) в соответствии с типом объединения (`merge_type`).  Это полезно для создания блоков ячеек с одинаковым содержанием или для визуального оформления.

5. **Метод `set_worksheet_direction`:**  Изменяет направление листа на  право-налево (`rtl`) в Google Таблицах.

6. **Метод `header`:** Добавляет строку заголовка (`ws_header`) в таблицу (`ws`) на указанную строку (`row`). Обрабатывает разные типы входных данных для `ws_header`. Вызывает `render_header` для форматирования добавленной строки.

7. **Метод `write_category_title`:** Добавляет строку с названием категории (`ws_category_title`) в таблицу. Работает аналогично методу `header`, но обрабатывает другую строку.


8. **Метод `get_first_empty_row`:**  Определяет первую пустую строку в таблице или по указанной колонке (`by_col`). Это помогает динамически добавлять строки без конфликтов с заполненными данными.


Пример использования
-------------------------
.. code-block:: python

    from gspread_formatting import *
    from spread import Spreadsheet, Worksheet
    from goog.spreadsheet.bberyakov.grender import GSRender

    # Предполагая, что вы уже имеете подключение к Google Таблицам
    # и переменные sh (Spreadsheet) и ws (Worksheet)
    grender = GSRender()

    # Пример добавления заголовка
    grender.header(ws, "Заголовок таблицы", 1)

    # Пример добавления категории
    grender.write_category_title(ws, "Категория продуктов", 2)

    # Пример объединения ячеек
    grender.merge_range(ws, 'A1:B1', 'MERGE_COLUMNS')

    # Сохранение изменений
    sh.spreadsheet.update()