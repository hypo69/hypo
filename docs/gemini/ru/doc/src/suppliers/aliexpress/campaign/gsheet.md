# Модуль `hypotez/src/suppliers/aliexpress/campaign/gsheet.py`

## Обзор

Модуль `gsheet.py` предоставляет класс `AliCampaignGoogleSheet` для работы с Google Таблицами в контексте рекламных кампаний AliExpress. Он позволяет записывать и обновлять данные о кампаниях, категориях и продуктах, а также форматировать листы.

## Классы

### `AliCampaignGoogleSheet`

**Описание**: Класс `AliCampaignGoogleSheet` наследуется от `SpreadSheet` и расширяет его функциональность для работы с Google Таблицами в рамках кампаний AliExpress.  Предоставляет методы для управления листами, записи данных, и форматирования.

**Атрибуты**:

- `spreadsheet_id`: Идентификатор Google Таблицы.
- `spreadsheet`: Объект `SpreadSheet` для работы с таблицей.
- `worksheet`: Активный лист в таблице.

**Методы**:

#### `__init__`

**Описание**: Инициализирует объект `AliCampaignGoogleSheet`.

**Параметры**:

- `campaign_name` (str): Название кампании.
- `language` (str | dict, optional): Язык кампании. По умолчанию `None`.
- `currency` (str, optional): Валюта кампании. По умолчанию `None`.

**Возвращает**:
-  Не имеет возвращаемого значения.


#### `clear`

**Описание**: Очищает содержимое таблицы, удаляя листы продуктов и очищая данные на листах категорий и других определенных листах.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает возможные ошибки при удалении листов.


#### `delete_products_worksheets`

**Описание**: Удаляет все листы Google Таблицы, кроме `'categories'` и `'product_template'`.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при удалении листов.


#### `set_campaign_worksheet`

**Описание**: Записывает данные о кампании на лист Google Таблицы с именем `campaign`.

**Параметры**:

- `campaign` (`SimpleNamespace` | str): Объект `SimpleNamespace` содержащий данные кампании.
- `language` (str, optional): Язык кампании.
- `currency` (str, optional): Валюта кампании.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при записи данных.


#### `set_products_worksheet`

**Описание**: Записывает данные о продуктах из списка объектов `SimpleNamespace` в ячейки Google Таблицы.

**Параметры**:

- `category_name` (str): Название категории для получения продуктов.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при записи данных.

#### `set_categories_worksheet`

**Описание**: Записывает данные о категориях из объекта `SimpleNamespace` в Google Таблицу.

**Параметры**:

- `categories` (`SimpleNamespace`): Объект `SimpleNamespace` содержащий данные категорий.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при записи данных.


#### `get_categories`

**Описание**: Получает данные о категориях из Google Таблицы.

**Возвращает**:
- list[dict]: Список словарей с данными о категориях.

#### `set_category_products`

**Описание**: Записывает данные о продуктах для указанной категории в новый лист Google Таблицы.

**Параметры**:

- `category_name` (str): Имя категории.
- `products` (dict): Словарь с данными о продуктах.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при обновлении данных о продуктах.


#### `_format_categories_worksheet`

**Описание**: Форматирует лист Google Таблицы для категорий.

**Параметры**:

- `ws` (Worksheet): Лист Google Таблицы для форматирования.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при форматировании.


#### `_format_category_products_worksheet`

**Описание**: Форматирует лист Google Таблицы для продуктов.

**Параметры**:

- `ws` (Worksheet): Лист Google Таблицы для форматирования.

**Возвращает**:
- Не имеет возвращаемого значения.
**Обрабатывает исключения**:
- `Exception`: Обрабатывает ошибки при форматировании.


## Функции

(Список функций отсутствует, так как в коде нет функций без атрибутов `def`).