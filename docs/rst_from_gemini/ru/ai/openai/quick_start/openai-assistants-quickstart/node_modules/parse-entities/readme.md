```markdown
# parse-entities

[![Build][build-badge]][build]
[![Coverage][coverage-badge]][coverage]
[![Downloads][downloads-badge]][downloads]
[![Size][size-badge]][size]

Parse HTML character references.

## Contents

* [What is this?](#what-is-this)
* [When should I use this?](#when-should-i-use-this)
* [Install](#install)
* [Use](#use)
* [API](#api)
    * [parseEntities(value[, options])](#parseentitiesvalue-options)
* [Types](#types)
* [Compatibility](#compatibility)
* [Security](#security)
* [Related](#related)
* [Contribute](#contribute)
* [License](#license)

## What is this?

This package provides a function to decode HTML character references (entities).

## When should I use this?

Use this package for compliant decoding of character references in your applications, particularly in situations where speed and correctness are important.  It's suitable for tasks like parsing HTML or XML where precise entity handling is needed.  It can also be valuable in linters to identify and report problematic character reference usage.

## Install

This package is ESM only.

In Node.js (version 14.14+, 16.0+), install with npm:

```bash
npm install parse-entities
```

In Deno, using esm.sh:

```typescript
import {parseEntities} from 'https://esm.sh/parse-entities@3'
```

In browsers, using esm.sh (requires bundling):

```html
<script type="module">
  import {parseEntities} from 'https://esm.sh/parse-entities@3?bundle'
</script>
```


## Use

```javascript
import {parseEntities} from 'parse-entities';

console.log(parseEntities('alpha &amp; bravo')); // Output: alpha & bravo
console.log(parseEntities('charlie &copycat; delta')); // Output: charlie ¬©cat; delta
console.log(parseEntities('echo &copy; foxtrot &#8800; golf &#x1D306; hotel'));
// Output: echo ¬© foxtrot ‚â† golf ùåÜ hotel
```

## API

### parseEntities(value[, options])

Parse HTML character references.

#### Parameters

* `value` (string): The string containing the entities to parse.
* `options` (object, optional): Configuration options.


##### `options`

###### `additional` (string, optional, default: ''):
   An additional set of characters to accept after an ampersand.  This can be useful for handling custom entities or potential variations in the data.

###### `attribute` (boolean, optional, default: false):
   Whether to parse the `value` as an attribute value. This setting modifies behavior slightly to support attribute-specific parsing rules (if any exist).

###### `nonTerminated` (boolean, optional, default: true):
   Whether to allow non-terminated character references.  For example, `&copycat`.  This is compliant with the spec but can lead to unexpected results if not handled correctly.

###### `position` (Position or Point, optional):
    The starting position of the input string, useful when parsing within a larger context such as a document or syntax tree.  Defaults to `{line: 1, column: 1, offset: 0}`.

###### `warning` (function, optional):
   An error handler function for warnings.  See the details below for usage.

###### `text` (function, optional):
   A callback function for handling text portions outside of entity references.

###### `reference` (function, optional):
   A callback function for handling individual entity references.

###### `warningContext`, `textContext`, `referenceContext` (any, optional):
   Context objects to pass to the `warning`, `text`, and `reference` functions respectively.


#### Returns

string: The parsed string with HTML entities decoded.

#### `warning`

Error handler function. Called when a warning occurs during parsing.

*   `reason` (string): A human-readable description of the warning.
*   `point` (Point): The location in the input string where the warning occurred.
*   `code` (number): A machine-readable code associated with the warning. (See example table)

```javascript
function myErrorHandler(reason, point, code) {
    console.error(`Warning: ${reason} at ${point.line}:${point.column}`);
}
```

Example Error Codes (Note: Codes might slightly differ from the original doc)

| Code | Description |
|---|---|
| `1` | Missing semicolon in named entity |
| `2` | Missing semicolon in numeric entity |
| `3` | Empty named entity |
| ... | ... |

#### `text`, `reference`

See the original documentation for detailed parameter information.

## Types

This package is type-safe (TypeScript compatible).

## Compatibility

Works with recent versions of Node.js, Deno, and modern browsers.

## Security

This package is designed to handle character references safely.


## Related

Refer to the original documentation for the related packages and links.

## Contribute

See the original documentation for contribution instructions.

## License

[MIT License] ¬© [Titus Wormer]


```