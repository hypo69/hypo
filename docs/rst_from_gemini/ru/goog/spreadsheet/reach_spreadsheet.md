```markdown
# Модуль `reach_spreadsheet.py` для работы с Google Sheets API

Этот модуль предоставляет класс `ReachSpreadsheet` для взаимодействия с Google Sheets API v4.  Он предназначен для создания, редактирования и управления листами электронных таблиц, а также для их совместного использования.  Модуль не является полным обертыванием над API, но достаточно функционален для задач, для которых он был создан (Telegram-бот, статья на Хабре).


## Класс `ReachSpreadsheet`

Класс `ReachSpreadsheet` предоставляет методы для следующих операций:

* **Создание новой таблицы:** `create(title, sheetTitle, rows=1000, cols=26, locale='en-US', timeZone='Etc/GMT')`. Создает новую электронную таблицу с заданным названием, названием листа, количеством строк и столбцов, а также региональными настройками.
* **Установка текущей таблицы по ID:** `setSpreadsheetById(spreadsheetId)`. Устанавливает текущую таблицу по её ID.
* **Добавление нового листа:** `addSheet(sheetTitle, rows=1000, cols=26)`. Добавляет новый лист к текущей таблице, устанавливает его текущим и возвращает его ID.
* **Обмен ссылкой на таблицу:** `share(shareRequestBody)`.  Обменивает ссылку на таблицу с заданными параметрами.  Дополнительные методы: `shareWithEmailForReading`, `shareWithEmailForWriting`, `shareWithAnybodyForReading`, `shareWithAnybodyForWriting` для удобства работы с определенными типами доступа.
* **Получение URL листа:** `getSheetURL()`. Возвращает URL текущего листа.
* **Выполнение подготовленных операций:** `runPrepared(valueInputOption='USER_ENTERED')`.  Выполняет все подготовленные операции добавления/изменения данных и форматирования.  Важно:  обновление выполняется только после вызова этого метода.
* **Подготовка операций добавления строк:** `prepare_addSheet(sheetTitle, rows, cols)`. Подготавливает запрос на добавление нового листа.
* **Подготовка операций изменения ширины и высоты столбцов/строк:** `prepare_setColumnWidth`, `prepare_setColumnsWidth`, `prepare_setRowHeight`, `prepare_setRowsHeight`. Подготавливают запросы на изменение размеров столбцов и строк.
* **Подготовка операций записи данных:** `prepare_setValues(cellsRange, values, majorDimension='ROWS')`.  Подготавливает запрос на запись данных в указанный диапазон ячеек.
* **Подготовка операций объединения ячеек:** `prepare_mergeCells(cellsRange, mergeType='MERGE_ALL')`. Подготавливает запрос на объединение ячеек.
* **Подготовка операций форматирования ячеек:** `prepare_setCellStringFormatterormat`, `prepare_setCellStringFormatterormats`.  Подготавливает запросы на форматирование ячеек (шрифт, цвет, выравнивание).


##  Обработка ошибок

Модуль содержит классы исключений: `SpreadsheetError`, `SpreadsheetNotSetError`, `SheetNotSetError` для более детальной информации об ошибках.


##  Важные замечания

* **`debugMode`:** Параметр `debugMode` (по умолчанию `False`) включит вывод отладочной информации при выполнении методов.
* **`gs.path.tmp`:** Используется для получения пути к временному файлу с ключами API.  Необходимо убедиться, что этот объект (`gs.path.tmp`) корректно определен в контексте вашего приложения.
* **`httplib2`, `googleapiclient`, `oauth2client`:** Необходимо установить соответствующие библиотеки (`pip install httplib2 google-api-python-client oauth2client`).
* **`credentials`:**  Для корректной работы необходимо получить и правильно настроить `credentials` (ключ API Google).
* **`runPrepared()`:**  Этот метод необходимо вызывать, чтобы запустить подготовленные операции.  Данные не будут обновлены до его вызова.
* **`toGridRange(cellsRange)`:**  Преобразует строковое представление диапазона ячеек в словарь `GridRange`, необходимый для запросов API.
* **`htmlColorToJSON(htmlColor)`:** Преобразует HTML-цвет в JSON-формат, используемый API.
* **Типизация:**  Добавлены подсказки типов для аргументов методов, что повышает читаемость и позволяет использовать статический анализ кода.

##  Тестирование

В модуле есть несколько функций-тестов (`testCreateSpreadsheet`, `testSetSpreadsheet`, и т.д.), позволяющих проверить работу `ReachSpreadsheet`.


**Важно:** для выполнения тестов необходимо заменить `GOOGLE_CREDENTIALS_FILE` на фактическое имя файла с закрытым ключом.  Также нужно подготовить соответствующую тестовую среду.
```