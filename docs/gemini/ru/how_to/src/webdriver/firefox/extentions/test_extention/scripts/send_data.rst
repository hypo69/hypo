Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Данный код JavaScript собирает информацию о загруженной странице (заголовок, URL, содержимое тела) и отправляет её на сервер `http://127.0.0.1/hypotez.online/api/` в формате JSON.  Код использует метод `fetch` для асинхронной отправки данных.  Он обрабатывает успешный ответ сервера и выводит его в консоль, а при ошибке выводит сообщение об ошибке в консоль.

Шаги выполнения
-------------------------
1. **Собирает информацию о странице:** Получает заголовок страницы (`document.title`), URL (`window.location.href`) и содержимое тела (`document.body.innerHTML`).
2. **Формирует объект данных:** Создаёт JavaScript-объект `data`, содержащий собранную информацию (заголовок, URL, содержимое).
3. **Отправляет данные на сервер:** Использует метод `fetch` для отправки POST-запроса на указанный URL. Заголовок `Content-Type` устанавливается как `application/json`.  Данные отправляются в формате JSON, используя `JSON.stringify(data)`.
4. **Обрабатывает ответ сервера:**
    - Проверяет статус ответа (`response.ok`). Если статус не 2xx, генерирует ошибку.
    - Парсит ответ в JSON (`response.json()`).
    - Выводит полученный ответ в консоль (`console.log('Response:', json)`).
5. **Обрабатывает ошибки:** Если возникла ошибка при отправке запроса или обработке ответа, выводит сообщение об ошибке в консоль (`console.error('Error:', error)`).
6. **Регистрирует обработчик события:** Регистрирует функцию `onPageLoad` как обработчик события `load` для объекта `window`. Это гарантирует, что код выполнится после загрузки страницы.

Пример использования
-------------------------
.. code-block:: javascript
    
    // Создаем обработчик события для загрузки страницы
    function onPageLoad() {
        // Собирает информацию о странице
        var title = document.title;
        var url = window.location.href;
        var body = document.body.innerHTML;
    
        // Формирует объект с данными для отправки
        var data = {
            title: title,
            url: url,
            body: body
        };
    
        // Отправляет данные на указанный адрес
        fetch('http://127.0.0.1/hypotez.online/api/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(json => {
            console.log('Response:', json);
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
    
    // Добавляем обработчик события для загрузки страницы
    window.addEventListener('load', onPageLoad);