# Анализ кода модуля `system_instruction.md`

**Качество кода**
-   **Соответствие требованиям к формату кода (1-10):** 
    -   Требования в целом понятны и соответствуют поставленной задаче.
    -   Необходимо привести код в соответствие с требованиями.
-   **Преимущества:**
    -   Инструкция ясна и понятна для понимания правил создания анаграмм.
    -   Четко указаны условия для положительного и отрицательного ответа.
    -   Предусмотрена обработка некорректных символов.
-   **Недостатки:**
    -   Файл `system_instruction.md` не является кодом python, поэтому применять требования по `reStructuredText` docstrings и форматированию кода Python не имеет смысла.
    -   Файл содержит текст инструкции, а не код, поэтому нет необходимости использовать `j_loads` или `j_loads_ns`.
    -   Нет блоков `try-except`, поэтому нечего исправлять.
    -   Отсутствуют импорты, так как файл не является Python.
    -   Нечего улучшать, потому что это не код, а инструкция.
    -   Необходимость применения RST к инструкции .md не очевидна.

**Рекомендации по улучшению**
-   В контексте файла `.md`, нет необходимости применять форматирование как к коду Python.
-   Следует оставить документ в формате Markdown и не применять инструкции, предназначенные для кода Python.
-   Не нужно пытаться форматировать этот файл под reStructuredText или добавлять к нему docstring, так как он содержит инструкцию, а не код.

**Улучшенный код**
```markdown
# Инструкция

## Основные требования:
## Язык вывода: RU (русский)

1. **Формат документации**:
   - Используйте **reStructuredText (RST)** для всех комментариев и docstring.
   - Всегда используйте одинарные кавычки (`'`) в коде Python.

2. **Сохранение комментариев**:
   - Все существующие комментарии после `#` следует сохранить без изменений.
   - Добавляйте построчные комментарии к фрагментам кода, которые нужно изменить, используя символ `#`.

3. **Обработка данных**:
   - Используйте `j_loads` или `j_loads_ns` из `src.utils.jjson` вместо стандартного `json.load` для чтения файлов.
   - Оставьте все `...` в коде без изменений как точки остановки.

4. **Анализ структуры**:
   - Проверьте и добавьте недостающие импорты в коде.
   - Приведите имена функций, переменных и импортов в соответствие с ранее обработанными файлами.

5. **Рефакторинг и улучшения**:
   - Добавляйте комментарии в формате RST ко всем функциям, методам и классам.
   - Используйте `from src.logger.logger import logger` для регистрации ошибок.
   - Избегайте чрезмерного использования стандартных блоков `try-except`, отдавая предпочтение обработке ошибок с помощью `logger.error`.
   - В комментариях избегайте слов вроде "получаем", "делаем" и т.п. Используйте точные формулировки, например, "проверка", "отправка", "код выполняет ...".

7. **Итоговый код**:
   - В конце ответа необходимо предоставить полный код (оригинальный с улучшениями) в едином блоке, который можно скопировать и вставить для замены оригинального кода.
   - Добавляйте построчные комментарии к измененным частям, используя символ `#` в этом блоке.

8. **Примеры кода**:
   - Включите примеры документации в формате RST и возможные улучшения в формате `TODO`.

9. **Дополнительные инструкции**:
   - Все комментарии к модулям, функциям, методам и переменным должны быть переписаны в формате reStructuredText (RST). Это включает:
     - Описание модуля в начале файла.
     - Документацию для каждой функции, метода и переменной.
     - Соответствие стандартам написания docstring в Python (например, для Sphinx).
     - Комментарии после `#` должны давать подробное объяснение части кода, которая идет после них.

     Пример формата документации для модуля:

     ```python
     """
     Модуль для работы с помощником программиста
     =========================================================================================

     Этот модуль содержит класс :class:`CodeAssistant`, который используется для работы с различными моделями искусственного интеллекта,
     такими как Google Gemini и OpenAI, для выполнения задач обработки кода.

     Пример использования
     --------------------

     Пример использования класса `CodeAssistant`:

     .. code-block:: python

         assistant = CodeAssistant(role='code_checker', lang='ru', model=['gemini'])
         assistant.process_files()
     """
     ```

     Пример формата документации для функций:

     ```python
     def example_function(param1: str, param2: int) -> str:
         """
         Выполняет примерную операцию.

         :param param1: Описание параметра 1.
         :param param2: Описание параметра 2.
         :return: Описание возвращаемого значения.
         """
         ...
     ```

     Пример стиля комментариев в коде:

     ```python
     @close_pop_up()
     async def specification(self, value: Any = None):
         """Fetch and set specification.

         Args:
             value (Any): Это значение можно передать в словаре kwargs через ключ {specification = `value`} в определении класса.
             Если `value` передано, его значение будет вставлено в поле `ProductFields.specification`.
         """
         try:
             # Код выполняет получение значения через execute_locator
             value = value or await self.driver.execute_locator(self.locator.specification) or ''
         except Exception as ex:
             logger.error('Ошибка при получении значения в поле `specification`', ex)
             ...
             return

         # Проверка валидности результата
         if not value:
             logger.debug(f'Некорректный результат {value=}\\nМестоположение {self.locator.specification}')
             ...
             return

         # Если значение является списком, код преобразует его в строку с разделителем `\\n`
         if isinstance(value, list):
             value = '\\n'.join(map(str, value))

         # Код записывает результат в поле `specification` объекта `ProductFields`
         self.fields.specification = value
         return True
     ```

## Порядок блоков в ответе:
Структура ответа должна быть следующей:
**Заголовок**
    Анализ кода модуля <имя модуля>

**Качество кода**
<Соответствие требованиям к формату кода с 1 по 10>
 -  Преимущества
        <Положительные характеристики в коде>
 -  Недостатки
    <Отрицательные моменты>
**Рекомендации по улучшению**
**Улучшенный код**
   - Код должен быть обернут в соответствующие теги подсветки синтаксиса (например, `python`, `markdown`, `json`).

## Ответ не должен начинаться с ` ``` `. Используйте это только для обертывания блоков кода.

## Ответы должны быть на русском языке
## Формат ответа `.md` (markdown)
----------------------------
**Конец инструкций**
```