# Модуль `hypotez/src/utils/smtp.py`

## Обзор

Этот модуль предоставляет функциональность для отправки и получения электронных писем с использованием SMTP и IMAP серверов. Он включает функции для отправки писем с использованием SMTP и получения писем с использованием IMAP, обеспечивая надежное и безопасное взаимодействие с почтовыми серверами.

## Настройки

Конфигурация SMTP сервера хранится в словаре `_connection`.  **НЕЛЬЗЯ** жестко задавать учетные данные в этом файле. Используйте переменные окружения для хранения паролей и других конфигурационных данных (например, `os.environ`). Это критически важно для безопасности.

## Функции

### `send`

**Описание**: Отправляет электронное письмо. Возвращает `True`, если операция выполнена успешно, и `False` в противном случае. Логирует ошибки.

**Параметры**:

- `subject` (str, по умолчанию ''): Тема письма.
- `body` (str, по умолчанию ''): Тело письма.
- `to` (str, по умолчанию 'one.last.bit@gmail.com'): Адрес получателя.

**Возвращает**:

- bool: `True` при успешной отправке, `False` при ошибке.

**Вызывает исключения**:

- Любые исключения, возникающие при взаимодействии с SMTP сервером (например, `smtplib.SMTPException`). Подробные сообщения об ошибках записываются в лог.


### `receive`

**Описание**: Получает электронные письма с IMAP сервера. Возвращает список словарей, содержащих информацию о письмах, если операция выполнена успешно, и `None` в противном случае.  Логирует ошибки.

**Параметры**:

- `imap_server` (str): Адрес IMAP сервера.
- `user` (str): Пользовательское имя.
- `password` (str): Пароль.
- `folder` (str, по умолчанию 'inbox'): Папка для получения писем.

**Возвращает**:

- Optional[List[Dict[str, str]]]: Список словарей, содержащих информацию о письмах, если операция выполнена успешно, или `None` в случае ошибки.  Каждый словарь имеет следующие ключи: `subject`, `from`, `body`.

**Вызывает исключения**:

- Любые исключения, возникающие при взаимодействии с IMAP сервером (например, `imaplib.IMAP4.error`). Подробные сообщения об ошибках записываются в лог.  Обратите внимание на обработку потенциальных кодировок тела письма с использованием `decode`.