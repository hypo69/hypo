# Анализ кода модуля `68_orbit.ru.md`

**Качество кода**

*   **Соответствие требованиям к формату кода (1-10):** 7/10
    *   **Плюсы:**
        *   Текст хорошо структурирован с использованием Markdown.
        *   Логика игры изложена в последовательных шагах.
        *   Примеры использования программы и возможные ограничения хорошо описаны.
    *   **Минусы:**
        *   Отсутствуют docstring и reStructuredText (RST) комментарии, которые были запрошены.
        *   Код представлен в текстовом виде, а не в виде исполняемого Python кода, что затрудняет его анализ и улучшение.
        *   Не используются  `j_loads` или `j_loads_ns`  из  `src.utils.jjson` так как нет кода.
        *   Не добавлены импорты.
        *   Не используется  `from src.logger.logger import logger`  для логирования ошибок.

**Рекомендации по улучшению**

1.  **Преобразование в исполняемый Python код:** Необходимо преобразовать описание игры в исполняемый Python код.
2.  **Добавление docstring и RST комментариев:** Добавить docstring для всех функций и классов, а также использовать reStructuredText (RST) для комментариев в коде.
3.  **Использование `j_loads` или `j_loads_ns`:** Если для чтения данных из файла требуется использование `json.load`, нужно заменить его на `j_loads` или `j_loads_ns` из `src.utils.jjson`.
4.  **Добавление импортов:** Добавить необходимые импорты для работы с кодом.
5.  **Использование логгера:** Заменить стандартный `try-except` на использование `logger.error` из `src.logger.logger`.
6.  **Уточнение описаний:** Заменить неточные описания на более конкретные.
7.  **Форматирование кода:** Обеспечить, что код соответствует PEP 8.

**Улучшенный код**

```python
"""
Модуль для реализации игры "ORBIT" (Орбитальная игра).
=====================================================

Модуль содержит функции для управления игровым процессом:
инициализация игры, захват секторов, проверка условий завершения
и обработка пользовательского ввода.

Пример использования:

.. code-block:: python

    game = OrbitGame()
    game.start_game()
"""
import random
from typing import List, Dict, Tuple

from src.logger.logger import logger # импорт логгера

class OrbitGame:
    """
    Класс, представляющий игру "ORBIT".

    Содержит методы для инициализации игры, обработки ходов игроков
    и проверки условий завершения игры.
    """

    def __init__(self):
        """
        Инициализирует игру, устанавливая начальные параметры.

        Инициализирует орбиту планеты, игроков и счетчики.
        """
        self.orbit_size = 12 # количество секторов на орбите
        self.orbit = [None] * self.orbit_size #  орбита - список с None
        self.players = {1: 0, 2: 0} # Словарь для хранения захваченных секторов для каждого игрока
        self.current_player = 1 #  начинает игрок 1
        self.max_moves = 20 # максимальное кол-во ходов
        self.moves_count = 0 # счётчик ходов
        logger.info("Игра ORBIT инициализирована.") # Запись в лог

    def _display_welcome_message(self):
        """
        Выводит приветственное сообщение и правила игры.
        """
        print("Добро пожаловать в ORBIT!")
        print("Ваша задача — захватить как можно больше орбитальных секторов вокруг планеты.")
        print("Игра продолжается до тех пор, пока один из игроков не захватит большинство секторов или не будет достигнуто максимальное количество ходов.")
        print("Удачи!")
    
    def _display_orbit_status(self):
        """
        Отображает текущее состояние орбиты.

        Выводит на экран информацию о том, какие сектора заняты и кем.
        """
        print("Текущее состояние орбиты:")
        for i, player in enumerate(self.orbit): #  цикл по орбите
            if player is None: # если сектор не занят
                print(f"Сектор {i + 1}: Свободен")
            else: # если сектор занят
                print(f"Сектор {i + 1}: Игрок {player}")

    def _display_players_scores(self):
        """
        Отображает количество захваченных секторов каждым игроком.
        """
        print("Счет игроков:")
        for player, score in self.players.items(): # вывод набранных очков каждого игрока
            print(f"Игрок {player}: {score} секторов")

    def _is_valid_move(self, sector: int) -> bool:
        """
        Проверяет, является ли выбранный сектор свободным.

        :param sector: Номер сектора, который игрок пытается захватить.
        :return: `True`, если сектор свободен, `False` в противном случае.
        """
        if not 1 <= sector <= self.orbit_size: #  проверка на ввод номера сектора в диапазоне
           print(f"Ошибка: Неверный номер сектора. Пожалуйста, введите число от 1 до {self.orbit_size}.")
           return False
        if self.orbit[sector - 1] is not None: #  проверка занятости сектора
            print("Сектор уже захвачен. Попробуйте снова.")
            return False
        return True

    def _capture_sector(self, sector: int):
        """
        Захватывает выбранный сектор текущим игроком.

        :param sector: Номер сектора, который игрок хочет захватить.
        """
        self.orbit[sector - 1] = self.current_player # захватываем сектор
        self.players[self.current_player] += 1 # увеличиваем счетчик захваченных секторов
        print(f"Сектор {sector} захвачен Игроком {self.current_player}.")
    
    def _switch_player(self):
        """
        Переключает текущего игрока на следующего.
        """
        self.current_player = 3 - self.current_player # переключает текущего игрока

    def _check_game_end(self) -> bool:
       """
       Проверяет, завершилась ли игра.

       :return: `True`, если игра завершена, `False` в противном случае.
       """
       max_score_to_win = self.orbit_size // 2 + 1 # максимальное кол-во очков для победы
       for score in self.players.values():
           if score >= max_score_to_win: # проверка на победу
               return True
       if self.moves_count >= self.max_moves: # если закончились ходы
           return True
       return False
    
    def _announce_winner(self):
       """
       Объявляет победителя игры или ничью.
       """
       max_score_to_win = self.orbit_size // 2 + 1
       for player, score in self.players.items(): # проход по игрокам
           if score >= max_score_to_win:
                print(f"Игра окончена! Победил Игрок {player} с {score} захваченными секторами.")
                return

       print("Игра окончена! Ничья.")


    def start_game(self):
        """
        Запускает игровой процесс.
        """
        self._display_welcome_message() #  вывод приветствия
        while True: # основной цикл игры
            self._display_orbit_status() #  вывод состояния орбиты
            self._display_players_scores() #  вывод состояния игроков

            print(f"Игрок {self.current_player}, ваш ход.")
            while True: # цикл запроса ввода номера сектора
                try:
                    sector = int(input(f"Введите номер сектора, который хотите захватить (от 1 до {self.orbit_size}): ")) # получение ввода от игрока
                    if self._is_valid_move(sector): # проверка валидности хода
                        break
                except ValueError:
                    logger.error("Ошибка: Неверный ввод. Пожалуйста, введите целое число.") # логирование ошибки
                    print("Ошибка: Неверный ввод. Пожалуйста, введите целое число.") # вывод ошибки
            
            self._capture_sector(sector) # захват сектора
            self.moves_count += 1 # увеличиваем счетчик ходов

            if self._check_game_end(): # проверка на конец игры
                self._display_orbit_status() # вывод состояния орбиты
                self._display_players_scores() # вывод состояния игроков
                self._announce_winner() # объявление победителя
                break
            
            self._switch_player() # переключение игрока

        while True: #  цикл запроса начала новой игры
            play_again = input("Хотите сыграть снова? (да/нет): ").lower() # запрос на игру
            if play_again in ["да", "нет"]: # если ответ валидный, то выходим из цикла
                break
            else:
                logger.error("Ошибка: Неверный ввод. Пожалуйста, введите 'да' или 'нет'.") # логирование ошибки
                print("Ошибка: Неверный ввод. Пожалуйста, введите 'да' или 'нет'.") # вывод ошибки
        
        if play_again == "да":
                self.__init__() # сброс игры
                self.start_game() # запуск новой игры
        else:
           print("Спасибо за игру!") #  выход из игры

if __name__ == "__main__":
    game = OrbitGame() # создаём экземпляр класса
    game.start_game() #  начинаем игру
```