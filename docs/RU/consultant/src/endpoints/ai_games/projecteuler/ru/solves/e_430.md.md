# Анализ кода модуля e_430.md

**Качество кода: 8/10**

*   **Плюсы:**
    *   Код хорошо структурирован и содержит подробное объяснение решения задачи.
    *   Используется `decimal` для точных вычислений, что необходимо для данной задачи.
    *   Присутствует описание алгоритма, блок-схема и реализация на Python.
    *   Комментарии поясняют каждый шаг решения.
*   **Минусы:**
    *   Отсутствует docstring для модуля.
    *   Функция `expected_blue_points` не имеет аннотации типов.
    *   Нет обработки исключений.

**Рекомендации по улучшению:**

1.  Добавить docstring для модуля, описывающий его назначение.
2.  Добавить аннотации типов для функции `expected_blue_points`.
3.  Обработать исключения в функции `expected_blue_points`, используя `logger.error` из `src.logger.logger`.
4.  Установить точность для Decimal в константу.
5.  Изменить комментарии в коде на reStructuredText (RST) формат.

**Оптимизированный код**

```python
"""
Модуль для расчета ожидаемого количества синих точек после M перемещений.
======================================================================

Этот модуль предоставляет функцию для расчета ожидаемого количества синих точек
на прямой после M случайных перекрашиваний. Изначально все точки синие, и каждое
перекрашивание меняет цвет всех точек между двумя случайно выбранными точками на красный.

Пример использования
--------------------

.. code-block:: python

    from decimal import Decimal

    N = 10**7
    M = 10**16
    result = expected_blue_points(N, M)
    print(f"{result:.10f}")
"""
from decimal import Decimal, getcontext
from src.logger.logger import logger # подключаем logger


DECIMAL_PRECISION = 50 # устанавливаем точность для Decimal


def expected_blue_points(N: int, M: int) -> Decimal:
    """
    Вычисляет ожидаемое количество синих точек после M перемещений.

    :param N: Количество точек на прямой.
    :type N: int
    :param M: Количество перемещений.
    :type M: int
    :return: Ожидаемое количество синих точек.
    :rtype: decimal.Decimal
    """
    getcontext().prec = DECIMAL_PRECISION # Устанавливаем точность для decimal
    N_dec = Decimal(N) # Преобразуем N в Decimal
    expected_blue_points = Decimal(0) # Инициализируем ожидаемое количество синих точек

    try:
        for i in range(1, N + 1): # перебираем все точки
            i_dec = Decimal(i) # Преобразуем i в Decimal
            p_i = ((i_dec - 1) / N_dec)**2 + ((N_dec - i_dec) / N_dec)**2 # Вычисляем вероятность, что точка i останется синей после одного перемещения
            expected_blue_points += p_i**Decimal(M) # Добавляем к общему ожиданию вероятность того, что точка i останется синей после M перемещений
    except Exception as ex:
        logger.error('Ошибка при вычислении ожидаемого количества синих точек', exc_info=ex) # Логируем ошибку
        return Decimal(0) # возвращаем 0 в случае ошибки

    return expected_blue_points # возвращаем ожидаемое количество синих точек


if __name__ == "__main__":
    N = 10**7
    M = 10**16
    result = expected_blue_points(N, M)
    print(f"{result:.10f}")
```