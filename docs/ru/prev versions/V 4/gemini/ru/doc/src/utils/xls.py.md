# Модуль `src.utils.xls`

## Обзор

Модуль `src.utils.xls` предоставляет функциональность для конвертации файлов Excel (`.xls`) в формат JSON и наоборот. Он включает функции для чтения данных из Excel файлов, сохранения их в формате JSON, а также для сохранения JSON данных в Excel файлы. Модуль предназначен для работы с данными в формате Excel, обеспечивая удобный способ преобразования данных между Excel и JSON.

## Подробней

Этот модуль используется для преобразования данных из формата Excel в JSON и обратно. Он позволяет читать данные из Excel файлов, сохранять их в формате JSON для дальнейшей обработки или передачи, а также сохранять JSON данные обратно в Excel файлы. Это может быть полезно, когда требуется автоматизировать процесс обработки данных, хранящихся в Excel файлах, или интегрировать их с другими системами, использующими JSON формат.

## Функции

### `read_xls_as_dict`

```python
def read_xls_as_dict(
    xls_file: str,
    json_file: str = None,
    sheet_name: Union[str, int] = None
) -> Union[Dict, List[Dict], bool]:
    """
    Reads an Excel file and converts it to JSON.  Optionally, converts a specific sheet and saves the result to a JSON file.
    Handles errors gracefully.
    """
    ...
```

**Описание**:
Читает Excel файл и конвертирует его в JSON формат. Опционально, конвертирует указанный лист и сохраняет результат в JSON файл. Обрабатывает ошибки.

**Параметры**:
- `xls_file` (str): Путь к Excel файлу.
- `json_file` (str, optional): Путь к JSON файлу для сохранения результата. По умолчанию `None`.
- `sheet_name` (Union[str, int], optional): Имя или индекс листа для конвертации. По умолчанию `None` (конвертирует все листы).

**Возвращает**:
- `Union[Dict, List[Dict], bool]`: Если `sheet_name` указан как `None`, возвращает словарь, где ключи - имена листов, а значения - списки словарей, представляющие строки данных. Если `sheet_name` указан, возвращает список словарей, представляющий строки данных из указанного листа. Возвращает `False` в случае ошибки.

**Вызывает исключения**:
- `FileNotFoundError`: Если файл не найден.
- `Exception`: В случае других ошибок при обработке файла.

**Как работает функция**:

```
+---------------------+
|   Начало функции    |
+---------------------+
|  Проверка наличия   |
|    Excel файла      |
+---------------------+
|         Да          |        Нет       |
|--------------------->|  Логирование   |
|                      |   ошибки и     |
|                      |  возврат False |
+---------------------+
|  Чтение Excel файла |
+---------------------+
|  Проверка наличия   |
|  `sheet_name`       |
+---------------------+
|         Да          |        Нет       |
|--------------------->|                  |
|Чтение конкретного   |Чтение всех листов|
|листа               |                  |
+---------------------+<-----------------+
|Преобразование данных|
|   в JSON формат    |
+---------------------+
|  Сохранение в файл |
|   (если указан)     |
+---------------------+
|   Логирование      |
|   успешной записи  |
+---------------------+
| Возврат JSON данных|
+---------------------+
|    Конец функции    |
+---------------------+
```

**Примеры**:

```python
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')
if data:
    print(data)
```

### `save_xls_file`

```python
def save_xls_file(data: Dict[str, List[Dict]], file_path: str) -> bool:
    """Saves JSON data to an Excel file. Handles errors gracefully."""
    ...
```

**Описание**:
Сохраняет JSON данные в Excel файл. Обрабатывает ошибки.

**Параметры**:
- `data` (Dict[str, List[Dict]]): Данные для сохранения, где ключи - имена листов, а значения - списки словарей, представляющие строки данных.
- `file_path` (str): Путь к Excel файлу для сохранения данных.

**Возвращает**:
- `bool`: `True` в случае успешного сохранения, `False` в случае ошибки.

**Вызывает исключения**:
- `Exception`: В случае ошибок при записи в файл.

**Как работает функция**:

```
+---------------------+
|   Начало функции    |
+---------------------+
|   Создание Excel    |
|      writer         |
+---------------------+
|  Для каждого листа  |
|  в JSON данных      |
+---------------------+
|Преобразование данных|
|  в DataFrame       |
+---------------------+
|Запись DataFrame в  |
|   Excel файл       |
+---------------------+
|   Логирование      |
|   успешной записи  |
+---------------------+
|  Сохранение файла  |
+---------------------+
|  Возврат True или  |
|       False         |
+---------------------+
|    Конец функции    |
+---------------------+
```

**Примеры**:

```python
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Successfully saved to output.xlsx")