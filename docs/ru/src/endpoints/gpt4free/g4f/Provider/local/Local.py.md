# Модуль для интеграции локальных моделей GPT4All

## Обзор

Этот модуль предоставляет интеграцию с локальными моделями GPT4All через класс `Local`. Он позволяет использовать эти модели для создания завершений текста, поддерживая как потоковую передачу, так и историю сообщений. Модуль адаптирован для работы в проекте `hypotez` и соответствует его стандартам кодирования и логирования.

## Подробнее

Модуль предназначен для работы с локальными моделями, предоставляемыми библиотекой `gpt4all`. Он проверяет наличие необходимых зависимостей и предоставляет интерфейс для создания завершений текста на основе выбранной модели. Этот модуль является частью системы `hypotez` и обеспечивает возможность использования локальных моделей без необходимости подключения к внешним API.

## Классы

### `Local`

**Описание**: Класс `Local` предоставляет интерфейс для работы с локальными моделями GPT4All.

**Наследует**:

- `AbstractProvider`: Обеспечивает общую структуру для провайдеров моделей.
- `ProviderModelMixin`: Добавляет функциональность для работы с моделями провайдера.

**Атрибуты**:

- `label` (str): Метка провайдера, установлена как "GPT4All".
- `working` (bool): Флаг, указывающий, что провайдер находится в рабочем состоянии (True).
- `supports_message_history` (bool): Флаг, указывающий на поддержку истории сообщений (True).
- `supports_system_message` (bool): Флаг, указывающий на поддержку системных сообщений (True).
- `supports_stream` (bool): Флаг, указывающий на поддержку потоковой передачи (True).
- `models` (List[str]): Список доступных моделей. Изначально пуст, заполняется при первом вызове `get_models`.
- `default_model` (str): Модель по умолчанию. Устанавливается как первый элемент списка `models` при первом вызове `get_models`.

**Методы**:

- `get_models`: Возвращает список доступных моделей.
- `create_completion`: Создает завершение текста на основе предоставленных параметров.

### `get_models`

```python
    @classmethod
    def get_models(cls) -> list[str]:
        """ Возвращает список доступных моделей.

        Args:
            cls: Ссылка на класс.

        Returns:
            list[str]: Список доступных моделей.

        Как работает функция:
         1. Проверяет, был ли уже загружен список моделей.
         2. Если список моделей пуст, загружает его с помощью функции `get_models()` из модуля `...locals.models`.
         3. Устанавливает первую модель в списке в качестве модели по умолчанию.
         4. Возвращает список моделей.

         A - Проверка загруженности моделей
         |
         -- B - Загрузка моделей, установка модели по умолчанию
         |
         C - Возврат списка моделей

        Примеры:
            >>> Local.get_models()
            ['model1', 'model2', 'model3']
        """
        ...
```

- **Назначение**: Возвращает список доступных моделей. Если список моделей еще не был загружен, он загружается с помощью функции `get_models()` из модуля `...locals.models` и сохраняется в атрибуте класса `models`.
- **Параметры**:
    - `cls`: Ссылка на класс.
- **Возвращает**:
    - `list[str]`: Список доступных моделей.
- **Как работает функция**:
    1. Проверяет, был ли уже загружен список моделей.
    2. Если список моделей пуст, загружает его с помощью функции `get_models()` из модуля `...locals.models`.
    3. Устанавливает первую модель в списке в качестве модели по умолчанию.
    4. Возвращает список моделей.

     ```text
     Проверка загруженности моделей (A)
     │
     └── Загрузка моделей, установка модели по умолчанию (B)
     │
     Возврат списка моделей (C)
     ```

- **Примеры**:

```python
>>> Local.get_models()
['model1', 'model2', 'model3']
```

### `create_completion`

```python
    @classmethod
    def create_completion(
        cls,
        model: str,
        messages: Messages,
        stream: bool,
        **kwargs
    ) -> CreateResult:
        """ Создает завершение текста на основе предоставленных параметров.

        Args:
            cls: Ссылка на класс.
            model (str): Название используемой модели.
            messages (Messages): Список сообщений для создания завершения.
            stream (bool): Флаг, указывающий на потоковую передачу.
            **kwargs: Дополнительные параметры.

        Returns:
            CreateResult: Результат создания завершения.

        Raises:
            MissingRequirementsError: Если не установлены необходимые зависимости (пакет "gpt4all").

        Как работает функция:
         1. Проверяет, установлены ли необходимые зависимости.
         2. Если зависимости не установлены, вызывает исключение `MissingRequirementsError`.
         3. Если зависимости установлены, вызывает функцию `create_completion()` из модуля `...locals.provider` для создания завершения.

         A - Проверка зависимостей
         |
         -- B - Вызов исключения (если зависимости не установлены)
         |
         C - Создание завершения

        Примеры:
            >>> Local.create_completion(model='model1', messages=[{'role': 'user', 'content': 'Hello'}], stream=False)
            'Hello World!'
        """
        ...
```

- **Назначение**: Создает завершение текста на основе предоставленных параметров.
- **Параметры**:
    - `cls`: Ссылка на класс.
    - `model` (str): Название используемой модели.
    - `messages` (Messages): Список сообщений для создания завершения.
    - `stream` (bool): Флаг, указывающий на потоковую передачу.
    - `**kwargs`: Дополнительные параметры.
- **Возвращает**:
    - `CreateResult`: Результат создания завершения.
- **Вызывает исключения**:
    - `MissingRequirementsError`: Если не установлены необходимые зависимости (пакет "gpt4all").
-  **Как работает функция**:
    1. Проверяет, установлены ли необходимые зависимости.
    2. Если зависимости не установлены, вызывает исключение `MissingRequirementsError`.
    3. Если зависимости установлены, вызывает функцию `create_completion()` из модуля `...locals.provider` для создания завершения.

     ```text
     Проверка зависимостей (A)
     │
     └── Вызов исключения (если зависимости не установлены) (B)
     │
     Создание завершения (C)
     ```

- **Примеры**:

```python
>>> Local.create_completion(model='model1', messages=[{'role': 'user', 'content': 'Hello'}], stream=False)
'Hello World!'
```

## Функции

В данном модуле напрямую не определены функции, за исключением методов класса `Local`. Однако, он использует функции из других модулей, таких как `get_models` из `...locals.models` и `create_completion` из `...locals.provider`.