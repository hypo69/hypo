Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код представляет класс `SpreadSheet`, предназначенный для работы с Google Таблицами. Он позволяет создавать новые таблицы, подключаться к существующим, загружать данные из CSV-файла в выбранный лист.  Код включает обработку ошибок и использование библиотек `gspread` и `pandas` для эффективной работы с Google Таблицами.

Шаги выполнения
-------------------------
1. **Импортирование необходимых библиотек:** Код импортирует необходимые библиотеки, такие как `gspread`, `pandas`, `pathlib` и `logger`.  Это позволяет использовать функции и классы из этих библиотек в дальнейшем коде.
2. **Создание экземпляра класса `SpreadSheet`:** Создается экземпляр класса `SpreadSheet` с параметрами `spreadsheet_id`, `spreadsheet_name` и `sheet_name`. Если `spreadsheet_id` равно `None`, то будет создана новая таблица с указанным именем `spreadsheet_name`. Если `spreadsheet_id` задано, то будет открыта таблица с указанным `spreadsheet_id`.
3. **Создание/подключение к Google Таблицам:** Используя `self.credentials` и `self.client`, код авторизуется для доступа к Google Таблицам.  В случае отсутствия таблицы с указанным ID, возникает исключение `SpreadsheetNotFound`.
4. **Получение листа:**  Метод `get_worksheet()` получает лист в таблице с заданным именем `sheet_name`. Если листа нет, он создается с помощью `create_worksheet()`.
5. **Загрузка данных из CSV:** Метод `upload_data_to_sheet()` читает данные из CSV-файла, используя `pd.read_csv()`. Подготавливает данные в формате, подходящем для записи в Google Таблицы (списком списков).
6. **Запись данных в Google Таблицы:** Данные записываются в лист с помощью `self.worksheet.update('A1', data_list)`.  Это записывает данные в ячейки листа, начиная с ячейки A1.
7. **Обработка ошибок:**  Код содержит обработку исключений (`try...except`) для предотвращения аварийного завершения при возникновении проблем, таких как отсутствие файла, ошибки при подключении к Google Таблицам и т.п.  Логирование ошибок выполняется через `logger`.


Пример использования
-------------------------
.. code-block:: python

    from pathlib import Path
    from hypotez.src.goog.spreadsheet.spreadsheet import SpreadSheet

    data_file = Path('/mnt/data/google_extracted/your_data_file.csv')  # Замените на реальный путь
    sheet_name = 'Sheet1'  # Замените на реальное имя листа

    # Создание новой таблицы
    google_sheet_handler = SpreadSheet(
        spreadsheet_id=None,
        sheet_name=sheet_name,
        spreadsheet_name='My New Spreadsheet'
    )
    google_sheet_handler.upload_data_to_sheet()