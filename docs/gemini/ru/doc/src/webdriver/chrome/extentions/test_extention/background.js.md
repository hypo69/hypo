# `background.js`

## Обзор

Этот файл является фоновым скриптом расширения Chrome. Он отвечает за обработку событий нажатия на иконку расширения и прослушивание сообщений от контентных скриптов, а также за отправку собранных данных на сервер.

## Оглавление

1.  [Функции](#Функции)
    -   [`chrome.browserAction.onClicked.addListener`](#chromebrowserActiononClickedaddListener)
    -   [`chrome.runtime.onMessage.addListener`](#chromeruntimeonMessageaddListener)
    -   [`sendDataToServer`](#sendDataToServer)

## Функции

### `chrome.browserAction.onClicked.addListener`

**Описание**:
Устанавливает слушателя для события нажатия на иконку расширения. При нажатии отправляет сообщение `collectData` контентному скрипту на активной вкладке.

**Параметры**:
- `tab` (object): Объект вкладки, на которой произошло нажатие.

### `chrome.runtime.onMessage.addListener`

**Описание**:
Устанавливает слушателя для входящих сообщений от других частей расширения (например, контентных скриптов). Проверяет, есть ли в сообщении действие `collectData`, и если да, то вызывает функцию `sendDataToServer`, передавая ей URL из сообщения.

**Параметры**:
- `message` (object): Объект сообщения, отправленный из другого скрипта.
- `sender` (object): Информация об отправителе сообщения.
- `sendResponse` (function): Функция для отправки ответа отправителю (не используется).

### `sendDataToServer`

**Описание**:
Отправляет собранные данные на сервер. Получает данные из `chrome.storage.local` и отправляет их на указанный URL через POST-запрос. В случае успешной отправки выводит сообщение в консоль, в случае ошибки также выводит сообщение об ошибке.

**Параметры**:
- `url` (string): URL активной вкладки.

**Возвращает**:
- `None`: Функция не возвращает значения.

**Вызывает исключения**:
- `Error`: Выбрасывается, если не удалось отправить данные на сервер (response.ok не true).