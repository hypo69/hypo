# Анализ кода модуля `AMAZIN`

**Качество кода**

-   **Соответствие требованиям к формату кода (1-10):** 
    -   **Преимущества:**
        -   Документ предоставляет ясное описание логики и шагов реализации генератора лабиринтов.
        -   Структура документа понятна и хорошо организована, используя заголовки и подзаголовки.
        -   Присутствуют примеры ввода и вывода, что помогает понять, как работает программа.
    -   **Недостатки:**
        -   Файл `README.MD` не содержит исполняемого кода, поэтому нельзя оценить код с точки зрения Python.
        -   Отсутствуют комментарии и docstring в коде, так как это текстовый файл.
        -   Нет импортов и конкретных функций, которые можно было бы анализировать.

**Рекомендации по улучшению**

1.  **Преобразовать в код Python:**
    -   Необходимо реализовать описанный алгоритм генерации лабиринтов на Python.
    -   Создать функции для ввода размеров, генерации лабиринта и его отображения.
2.  **Добавить docstring и комментарии:**
    -   В каждой функции и методе необходимо добавить docstring в формате reStructuredText.
    -   Добавить комментарии к коду, поясняющие логику и сложные моменты.
3.  **Использовать logger для обработки ошибок:**
    -   Вместо общих блоков `try-except` использовать `logger.error` для регистрации ошибок.
4.  **Использовать j_loads для чтения файлов:**
    -   Если понадобится чтение каких-либо файлов конфигурации, использовать `j_loads` или `j_loads_ns` из `src.utils.jjson`.
5.  **Разделить функционал на модули:**
    -   Разбить код на модули для генерации лабиринта и его отображения.
6.  **Обработка пользовательского ввода:**
    -   Реализовать корректную обработку пользовательского ввода, включая проверку на корректность введенных данных.
7.  **Добавить возможность выбора алгоритма:**
    -   Сделать возможным выбор различных алгоритмов генерации лабиринтов.

**Улучшенный код**

```python
"""
Модуль для генерации лабиринтов.
=========================================================================================

Модуль предоставляет класс :class:`MazeGenerator`, который генерирует лабиринты
с использованием алгоритма рекурсивного поиска в глубину (DFS).

Пример использования
--------------------

Пример использования класса `MazeGenerator`:

.. code-block:: python

    maze_generator = MazeGenerator()
    maze_generator.run()
"""

import random
from src.logger.logger import logger # импортируем logger

class MazeGenerator:
    """
    Класс для генерации лабиринтов.

    :param width: Ширина лабиринта.
    :param height: Высота лабиринта.
    :ivar grid: Матрица, представляющая лабиринт.
    """
    def __init__(self, width: int = 10, height: int = 8):
        """
        Инициализирует генератор лабиринтов с заданными размерами.
        """
        self.width = width
        self.height = height
        self.grid = [['#' for _ in range(2 * width + 1)] for _ in range(2 * height + 1)] # Инициализируем сетку символами решетки.
        self.start_cell = (1, 1) #  Задаем начальную ячейку лабиринта.
    
    def _is_valid(self, x: int, y: int) -> bool:
        """
        Проверяет, находятся ли координаты в пределах сетки лабиринта.

        :param x: Координата x.
        :param y: Координата y.
        :return: True, если координаты находятся в пределах сетки, иначе False.
        """
        return 0 < x < 2 * self.width and 0 < y < 2 * self.height

    def _generate_maze(self, x: int, y: int):
         """
         Генерирует лабиринт, используя алгоритм DFS.

         :param x: Текущая координата x.
         :param y: Текущая координата y.
         """
         self.grid[y][x] = ' ' # Устанавливаем текущую ячейку как проход.
         directions = [(0, 2), (2, 0), (0, -2), (-2, 0)] # Возможные направления.
         random.shuffle(directions) # Перемешиваем направления случайным образом.

         for dx, dy in directions:
             nx, ny = x + dx, y + dy # Вычисляем новые координаты.
             if self._is_valid(nx, ny) and self.grid[ny][nx] == '#': #  Проверяем, что координаты валидны и ячейка не посещена.
                self.grid[y + dy // 2][x + dx // 2] = ' ' # Удаляем стену между текущей и следующей ячейкой.
                self._generate_maze(nx, ny) # Рекурсивно вызываем для следующей ячейки.

    def display_maze(self):
        """
        Выводит лабиринт на экран.
        """
        for row in self.grid: #  Проходим по каждой строке лабиринта.
            print(''.join(row))# Выводим строку на экран.

    def run(self):
        """
        Запускает процесс генерации и отображения лабиринта.
        """
        try:
            #  Запускаем процесс генерации лабиринта.
            self._generate_maze(self.start_cell[0], self.start_cell[1])
            #  Отображаем готовый лабиринт.
            self.display_maze()
        except Exception as e:
            logger.error('Ошибка во время генерации лабиринта', exc_info=e) # Логгируем ошибку.
        
        while True:
            new_maze = input('Сгенерировать новый лабиринт? (да/нет): ').lower() #  Запрашиваем у пользователя, хочет ли он сгенерировать новый лабиринт.
            if new_maze == 'да': # Если ответ да - создаем новый лабиринт.
                self.grid = [['#' for _ in range(2 * self.width + 1)] for _ in range(2 * self.height + 1)] # Сбрасываем сетку
                self._generate_maze(self.start_cell[0], self.start_cell[1])  #Генерируем новый лабиринт
                self.display_maze() # Отображаем его
            elif new_maze == 'нет': # Если нет - выходим
                print('До свидания!')
                break
            else:
               print('Некорректный ввод. Введите "да" или "нет".') # Обработка некорректного ввода
        

if __name__ == '__main__':
    try: # Добавляем обертку try-except для обработки ошибок
        width = int(input('Введите ширину лабиринта: ')) #  Запрашиваем у пользователя ширину лабиринта.
        height = int(input('Введите высоту лабиринта: ')) # Запрашиваем высоту.
        if width <= 0 or height <= 0: #  Если ширина или высота введены некорректно - выводим ошибку
            print('Ширина и высота должны быть больше нуля. Используются размеры по умолчанию (10x8).')
            maze_generator = MazeGenerator()
        else:
            maze_generator = MazeGenerator(width, height)
        maze_generator.run()
    except ValueError as e:
        logger.error('Некорректный ввод. Пожалуйста, введите целые числа.', exc_info=e)  # Логгируем ошибку если ввод некорректный
```