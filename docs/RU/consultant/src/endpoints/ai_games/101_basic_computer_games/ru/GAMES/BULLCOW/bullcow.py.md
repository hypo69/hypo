# Анализ кода модуля `bullcow.py`

**Качество кода**
8
-  Плюсы
    -  Код игры "Быки и коровы" реализован корректно и соответствует правилам игры.
    -  Присутствует подробная документация в формате reStructuredText, описывающая правила игры, алгоритм и блок-схему.
    -  Функция `generate_target_number` корректно генерирует 4-значное число с уникальными цифрами.
    -  Код хорошо структурирован и логически понятен, содержит комментарии.
-  Минусы
    -  Не используются `j_loads` или `j_loads_ns` для чтения файлов (это не требуется в данном контексте, но указано в инструкции).
    -  Отсутствует логирование ошибок с использованием `from src.logger.logger import logger`.
    -  Используются стандартные блоки `try-except`, которые можно заменить на обработку ошибок с помощью `logger.error`.

**Рекомендации по улучшению**

1.  **Логирование ошибок:** Добавить логирование ошибок с использованием `from src.logger.logger import logger` для отслеживания возможных проблем в коде.
2.  **Обработка ошибок:** Заменить блоки `try-except` на обработку ошибок с помощью `logger.error` для более централизованного управления ошибками.
3.  **Улучшение документации:** Переписать docstring в соответствии с требованиями reStructuredText, добавить описания параметров и возвращаемых значений.
4. **Использовать константы**: Вместо литеральных значений для проверки длины числа (1000 и 9999), использовать именованные константы.
5.  **Проверка на уникальность**: Можно добавить проверку уникальности цифр во введенном числе, хотя по условию задачи это не требуется, но может быть желательным.

**Оптимизированный код**

```python
"""
Модуль для реализации игры "Быки и коровы".
=========================================================================================

Этот модуль реализует игру "Быки и коровы", в которой компьютер загадывает четырехзначное число
с уникальными цифрами, а игрок пытается его угадать. После каждой попытки игрок получает
подсказки в виде количества "быков" (цифры угаданы и находятся на правильных местах) и
"коров" (цифры угаданы, но находятся на неправильных местах).

Пример использования
--------------------

.. code-block:: python

    from src.endpoints.ai_games.101_basic_computer_games.ru.GAMES.BULLCOW import bullcow

    bullcow.play_bullcow()
"""
import random
from src.logger.logger import logger  # Импортируем logger

def generate_target_number() -> int:
    """
    Генерирует случайное 4-значное число с неповторяющимися цифрами.

    :return: Случайное 4-значное число.
    :rtype: int
    """
    digits = list(range(10))
    random.shuffle(digits)
    target = digits[0] * 1000 + digits[1] * 100 + digits[2] * 10 + digits[3]
    if digits[0] == 0:
        return generate_target_number()
    return target

def play_bullcow():
    """
    Запускает игровой процесс "Быки и коровы".
    """
    # Генерируем загаданное число
    targetNumber = generate_target_number()
    # Инициализируем счетчик попыток
    numberOfGuesses = 0
    MIN_NUMBER = 1000 # Константа для минимального значения числа
    MAX_NUMBER = 9999 # Константа для максимального значения числа

    # Основной игровой цикл
    while True:
        # Увеличиваем количество попыток
        numberOfGuesses += 1
        # Запрашиваем ввод числа у пользователя
        try:
            userGuess = int(input('Введите 4-значное число: '))
        except ValueError as ex:
            logger.error('Пользователь ввел некорректное значение', ex)
            print('Пожалуйста, введите целое 4-значное число.')
            continue

        # Проверка что число 4-х значное
        if not (MIN_NUMBER <= userGuess <= MAX_NUMBER):
            print('Пожалуйста, введите 4-значное число.')
            continue

        # Инициализация счетчиков быков и коров
        bulls = 0
        cows = 0

        # Преобразуем загаданное число и ввод пользователя в строки, чтобы было проще сравнивать цифры
        target_str = str(targetNumber)
        guess_str = str(userGuess)

        # Проходим по каждой цифре
        for i in range(4):
            if guess_str[i] == target_str[i]:
                # Если цифры на одной и той же позиции совпадают, это "бык"
                bulls += 1
            elif guess_str[i] in target_str:
                # Если цифра есть в загаданном числе, но не на той же позиции, это "корова"
                cows += 1

        # Вывод количества быков и коров
        print(f'{bulls} быков, {cows} коров')

        # Проверка на победу
        if bulls == 4:
            print(f'ПОЗДРАВЛЯЮ! Вы угадали число за {numberOfGuesses} попыток!')
            break  # Завершение игры при выигрыше


if __name__ == '__main__':
    play_bullcow()

"""
Объяснение кода:
1.  **Импорт модуля `random` и `logger`**::
   -  `import random`: Импортирует модуль `random`, который используется для генерации случайных чисел и перемешивания элементов списка.
   - `from src.logger.logger import logger`: Импортирует модуль `logger` для логирования ошибок.
2.  **Функция `generate_target_number()`**::
    -  Генерирует случайное 4-значное число с неповторяющимися цифрами:
        - `digits = list(range(10))`: Создает список цифр от 0 до 9.
        - `random.shuffle(digits)`: Перемешивает список цифр случайным образом.
        - `target = digits[0] * 1000 + digits[1] * 100 + digits[2] * 10 + digits[3]`: Собирает 4-значное число из первых четырех случайных цифр.
        - `if digits[0] == 0:`: Проверка, что первая цифра не ноль, если это так, то рекурсивно вызывается функция для генерации нового числа.
        - `return target`: Возвращает сгенерированное число.
3.  **Функция `play_bullcow()`**::
    -   Содержит основной игровой цикл и логику игры.
    -   `targetNumber = generate_target_number()`: Генерирует загаданное 4-значное число и сохраняет его в `targetNumber`.
    -   `numberOfGuesses = 0`: Инициализирует переменную `numberOfGuesses` для подсчета количества попыток игрока.
    -   `MIN_NUMBER = 1000` и `MAX_NUMBER = 9999`: Константы для минимального и максимального значения числа.
    -   **Основной цикл `while True:`**:
        -   Бесконечный цикл, который продолжается, пока игрок не угадает число (не сработает команда `break`).
        -   `numberOfGuesses += 1`: Увеличивает счетчик попыток на 1.
        -   **Ввод данных**:
            -   `try...except ValueError`: Блок try-except обрабатывает ошибки, когда пользователь вводит не число.
            -    `logger.error('Пользователь ввел некорректное значение', ex)`: Записывает ошибку в лог.
            -   `userGuess = int(input("Введите 4-значное число: "))`: Запрашивает у пользователя 4-значное число и сохраняет его в `userGuess`.
            - `if not (MIN_NUMBER <= userGuess <= MAX_NUMBER):`: Проверяет, что число 4-х значное.
        -   **Инициализация счетчиков "быков" и "коров"**:
            -   `bulls = 0`: Инициализирует счетчик "быков" в 0.
            -   `cows = 0`: Инициализирует счетчик "коров" в 0.
        -   **Преобразование чисел в строки**:
            - `target_str = str(targetNumber)`: Преобразуем загаданное число в строку.
            - `guess_str = str(userGuess)`: Преобразуем ввод пользователя в строку.
        -   **Проверка на "быков" и "коров"**:
            -   `for i in range(4):`:  Цикл для проверки каждой цифры введенного числа:
                -   `if guess_str[i] == target_str[i]:`:  Если цифры на одинаковых позициях совпадают, увеличиваем `bulls` на 1.
                -  `elif guess_str[i] in target_str:`: Если цифра из введенного числа есть в загаданном числе, но не на той же позиции, увеличиваем `cows` на 1.
        -   **Вывод количества "быков" и "коров"**:
            -   `print(f"{bulls} быков, {cows} коров")`: Выводит на экран количество "быков" и "коров".
        -   **Условие победы**:
            -   `if bulls == 4:`: Проверяет, равно ли количество "быков" 4 (все цифры угаданы).
            -   `print(f"ПОЗДРАВЛЯЮ! Вы угадали число за {numberOfGuesses} попыток!")`: Выводит сообщение о победе и количестве попыток.
            -   `break`: Завершает цикл, если число угадано.
"""
```