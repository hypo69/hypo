# Анализ кода модуля `nim.py`

**Качество кода**

-   **Соблюдение требований к формату кода (1-10):**
    -   **Преимущества:**
        -   Код достаточно хорошо структурирован и легко читаем.
        -   Используются осмысленные имена переменных и функций.
        -   Игровой процесс разбит на логические этапы, реализованные в отдельных функциях.
        -   Блок-схема игры представлена в формате Mermaid, что облегчает понимание логики программы.
        -   Код сопровождается подробными комментариями, поясняющими основные этапы работы.
        -   Используется `if __name__ == "__main__":` для запуска игры.
    -   **Недостатки:**
        -   Отсутствует docstring у модуля.
        -   Используются комментарии `#`, вместо RST docstring.
        -   Не используется `from src.logger.logger import logger` для обработки ошибок.
        -   Не используются `j_loads` или `j_loads_ns` для загрузки данных.
        -   Отсутствует обработка исключений для случая, если пользователь введет неверный номер кучи или количество камней.
        -   Отсутствует проверка корректности ввода (ввод чисел, а не символов) в функции `get_player_move`.

**Рекомендации по улучшению**

1.  **Добавить docstring к модулю:**
    -   В начале файла добавить описание модуля в формате RST.

2.  **Заменить комментарии на docstring в формате RST:**
    -   Добавить docstring к каждой функции.
    -   Все комментарии, которые сейчас написаны через `#`, переписать в формате reStructuredText.

3.  **Использовать `logger` для обработки ошибок:**
    -   Вместо `print` для вывода ошибок использовать `logger.error`.
    -   Реализовать обработку ошибок в `get_player_move`.

4.  **Использовать `j_loads` или `j_loads_ns`:**
    -   В данном коде нет загрузки данных из файлов, поэтому это не требуется.

5.  **Улучшить обработку ввода:**
    -   В функции `get_player_move` добавить проверку на ввод не числовых символов.
    -   Выводить информативные сообщения об ошибках.

6.  **Улучшить читаемость кода:**
    -   Использовать `f-строки` для более удобного форматирования строк.
    -   Сделать код более модульным и переиспользовать функции.

**Улучшенный код**

```python
"""
Модуль реализует игру NIM.
=========================================================================================

Игра NIM - математическая игра для двух игроков, где игроки по очереди убирают камни из нескольких кучек.
Цель игры - забрать последний камень.

Правила игры:
    1. В начале игры есть несколько кучек камней, количество камней в каждой кучке задается.
    2. Игроки по очереди берут любое ненулевое количество камней из одной кучки.
    3. Игрок, который берет последний камень, выигрывает.

Пример использования:

.. code-block:: python

    if __name__ == "__main__":
        play_nim()
"""
import random # Импортирует модуль random для генерации случайных чисел
from src.logger.logger import logger  #  Импортирует logger для логирования ошибок

def display_piles(piles):
    """
    Выводит текущее состояние кучек камней.

    :param piles: Список, представляющий кучки камней.
    :type piles: list
    """
    print("Текущее состояние кучек:")
    for i, pile in enumerate(piles):
        print(f"Кучка {i + 1}: {pile} камней") # Использует f-строку для форматирования вывода

def get_player_move(piles, player):
    """
    Запрашивает у игрока номер кучки и количество камней для удаления.

    :param piles: Список, представляющий кучки камней.
    :type piles: list
    :param player: Номер текущего игрока (1 или 2).
    :type player: int
    :return: Кортеж, содержащий номер кучки и количество камней для удаления.
    :rtype: tuple
    """
    while True:
        try:
            pile_number = int(input(f"Игрок {player}, выберите номер кучки (1-{len(piles)}): ")) - 1 # Запрашивает номер кучки у игрока и преобразует в индекс
            if 0 <= pile_number < len(piles):  # Проверяет, что номер кучки в допустимом диапазоне
                stones_to_remove = int(input(f"Игрок {player}, сколько камней взять из кучки {pile_number + 1}: ")) # Запрашивает количество камней для удаления
                if 0 < stones_to_remove <= piles[pile_number]: # Проверяет, что количество камней допустимо
                    return pile_number, stones_to_remove # Возвращает номер кучки и количество камней для удаления
                else:
                    logger.error('Недопустимое количество камней. Пожалуйста, выберите значение от 1 до текущего количества в кучке.') # Выводит сообщение об ошибке через logger
                    print('Недопустимое количество камней. Пожалуйста, выберите значение от 1 до текущего количества в кучке.') # Выводит сообщение об ошибке для пользователя
            else:
                logger.error('Недопустимый номер кучки. Пожалуйста, выберите существующую кучку.')  # Выводит сообщение об ошибке через logger
                print("Недопустимый номер кучки. Пожалуйста, выберите существующую кучку.") # Выводит сообщение об ошибке для пользователя
        except ValueError:
            logger.error('Неверный ввод. Пожалуйста, введите целые числа.') # Выводит сообщение об ошибке через logger
            print("Неверный ввод. Пожалуйста, введите целые числа.")  # Выводит сообщение об ошибке для пользователя


def play_nim():
    """
    Реализует игру NIM.
    """
    piles = [random.randint(1, 10), random.randint(1, 10), random.randint(1, 10)] # Инициализирует кучки камней случайными значениями
    current_player = 0  # 0 - игрок 1, 1 - игрок 2 # Устанавливает первого игрока
    
    while sum(piles) > 0: # Игровой цикл пока есть камни в кучках
        display_piles(piles) # Отображает текущее состояние кучек
        pile_number, stones_to_remove = get_player_move(piles, current_player + 1)  # Получает ход текущего игрока
        piles[pile_number] -= stones_to_remove # Вычитает выбранное количество камней из выбранной кучки
        current_player = (current_player + 1) % 2 # Переключает игрока
    print(f"Игрок {current_player + 1} победил!")  # Объявляет победителя

if __name__ == "__main__":
    play_nim()
```