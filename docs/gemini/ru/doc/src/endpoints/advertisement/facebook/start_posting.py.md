# Модуль `start_posting`

## Обзор

Модуль `start_posting.py` предназначен для автоматической отправки рекламных объявлений в группы Facebook. Он использует веб-драйвер для взаимодействия с Facebook и модуль `FacebookPromoter` для управления рекламными кампаниями.

## Подробнее

Этот модуль автоматизирует процесс публикации рекламных объявлений в различных группах Facebook. Он предназначен для запуска рекламных кампаний, используя данные из файлов конфигурации, определяющих целевые группы и параметры кампаний.

## Классы

В данном коде классы не определены.

## Функции

В данном коде функции не определены.

## Переменные

### `filenames`

```python
filenames:list[str] = [\
                        "usa.json",\
                        "he_ils.json",\
                        "ru_ils.json",\
                        "katia_homepage.json",\
                        "my_managed_groups.json",\
          \
                        ]
```

**Описание**: Список строк, содержащих имена файлов JSON, используемых для определения групп Facebook, в которых будет размещаться реклама.

### `excluded_filenames`

```python
excluded_filenames:list[str] = ["my_managed_groups.json",                        \
                                "ru_usd.json",\
                            "ger_en_eur.json",  ]
```

**Описание**: Список строк, содержащих имена файлов JSON, которые исключаются из процесса размещения рекламы.

### `campaigns`

```python
campaigns:list = [\'brands\',\
                  \'mom_and_baby\',\
                  \'pain\',\
                  \'sport_and_activity\',\
                  \'house\',\
                  \'bags_backpacks_suitcases\',\
                  \'man\']
```

**Описание**: Список строк, содержащий названия рекламных кампаний.

### `promoter`

```python
promoter:FacebookPromoter = FacebookPromoter(d, group_file_paths=filenames, no_video = True)
```

**Описание**: Экземпляр класса `FacebookPromoter`, используемый для управления и запуска рекламных кампаний. Инициализируется драйвером `d`, списком файлов с группами `filenames` и параметром `no_video`, указывающим на отсутствие видео в рекламных объявлениях.

### `d`

```python
d = Driver(Chrome)
d.get_url(r"https://facebook.com")
```

**Описание**: Инстанс драйвера веб-браузера Chrome, используемый для автоматического взаимодействия с Facebook. Он открывает Facebook в браузере.

## Основной блок кода

### `try...except KeyboardInterrupt`

```python
try:
    while True:
        
        promoter.run_campaigns(campaigns = copy.copy(campaigns), group_file_paths = filenames)
        print(f"Going sleep {time.localtime}")
        time.sleep(180)
        ...

        
except KeyboardInterrupt:
    logger.info("Campaign promotion interrupted.")
```

**Описание**: Блок кода, отвечающий за запуск и выполнение рекламных кампаний в бесконечном цикле до тех пор, пока он не будет прерван пользователем (нажатием Ctrl+C).

**Как работает функция**:

1.  **Запуск цикла**: Входит в бесконечный цикл `while True`, который будет выполняться до принудительной остановки.
2.  **Запуск рекламных кампаний**: Вызывает метод `run_campaigns` экземпляра `promoter` класса `FacebookPromoter`. Этот метод запускает рекламные кампании, используя переданные параметры:
    *   `campaigns`: Копия списка кампаний, которые нужно запустить. Используется `copy.copy()` для избежания изменения оригинального списка.
    *   `group_file_paths`: Список файлов, содержащих информацию о группах Facebook, в которых будет размещаться реклама.
3.  **Ожидание**: После запуска кампаний скрипт выводит сообщение о переходе в режим ожидания (`Going sleep`) с текущим временем и засыпает на 180 секунд (`time.sleep(180)`).
4.  **Обработка прерывания**: Если пользователь прерывает выполнение скрипта нажатием Ctrl+C, возбуждается исключение `KeyboardInterrupt`. Блок `except` перехватывает это исключение и логирует сообщение о прерывании продвижения кампании с помощью `logger.info("Campaign promotion interrupted.")`.

**ASII flowchart**:

```
Начало цикла
│
└──► Запуск рекламных кампаний (promoter.run_campaigns)
│
└──► Ожидание (time.sleep)
│
└──► Возврат к началу цикла
│
Прерывание цикла (KeyboardInterrupt)
│
└──► Логирование прерывания кампании
│
Конец
```

**Примеры**:

```python
# Пример запуска скрипта (в консоли)
# python start_posting.py
```

В данном случае нет параметров, передаваемых в функцию. Скрипт запускается напрямую и использует предопределенные значения переменных `filenames`, `excluded_filenames` и `campaigns`.