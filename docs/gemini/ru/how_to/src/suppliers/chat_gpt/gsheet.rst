Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `GptGs`, который предоставляет методы для работы с Google Таблицами в контексте управления рекламными кампаниями AliExpress.  Класс наследуется от `SpreadSheet` и реализует методы для чтения, записи и очистки данных в разных листах Google Таблиц, связанных с категориями, продуктами и кампаниями.  Методы позволяют добавлять, обновлять и удалять данные, а также копировать листы.  В классе используется библиотека `gspread` для взаимодействия с Google Таблицами.

Шаги выполнения
-------------------------
1. **Инициализация класса `GptGs`**:
   Создается экземпляр класса `GptGs`, передавая в конструктор идентификатор Google Таблицы `'1nu4mNNFMzSePlggaaL_QM2vdKVP_NNBl2OG7R9MNrs0'`.  Это связывает код с конкретной таблицей.

2. **Очистка таблицы (`clear`):**
   Метод `clear` удаляет все листы, созданные для продуктов, и очищает данные на листах категорий, кампании и других указанных листах.  Это позволяет начать работу с чистой таблицей.

3. **Обновление данных в листе (`update_chat_worksheet`):**
   Этот метод записывает данные о кампании в Google Таблицу, используя объект `SimpleNamespace` или словарь/список в качестве входных данных.  Он предоставляет гибкость в формате данных.  Метод находит лист с заданным именем, извлекает необходимые данные из объекта и записывает их в указанные ячейки.

4. **Чтение данных из листа (`get_campaign_worksheet`):**
   Метод читает данные из листа 'campaign'.  Возвращает объект `SimpleNamespace` с прочитанными данными о кампании.

5. **Запись данных о категории (`set_category_worksheet`):**
   Метод записывает данные о категории в лист 'category'.  Он принимает объект `SimpleNamespace` с данными о категории и записывает их вертикально, в ячейки начиная с A1.

6. **Чтение данных о категории (`get_category_worksheet`):**
   Метод читает данные из листа 'category'. Возвращает объект `SimpleNamespace` с прочитанными данными о категории.

7. **Запись данных о категориях (`set_categories_worksheet`):**
   Метод записывает данные о нескольких категориях в лист 'categories'. Он получает объект `SimpleNamespace` содержащий данные нескольких категорий.  Он итерируется по его атрибутам (категориям) и записывает данные каждой категории в отдельные строки, начиная с 2-ой строки листа.

8. **Чтение данных о категориях (`get_categories_worksheet`):**
   Метод считывает данные из листа 'categories' в виде списка списков строк.

9. **Запись данных о продукте (`set_product_worksheet`):**
   Метод создаёт новый лист для продукта, копируя шаблон 'product_template', и записывает данные продукта. Он принимает объект `SimpleNamespace` с данными продукта и записывает их в новую таблицу, добавляя заголовки в первой строке.

10. **Чтение данных о продукте (`get_product_worksheet`):**
    Метод читает данные из листа 'products' и возвращает объект `SimpleNamespace` с данными о продукте.

11. **Запись данных о продуктах (`set_products_worksheet`):**
    Записывает данные о нескольких продуктах в заданный лист, используя список `SimpleNamespace`. Данные записываются в виде отдельных строк.

12. **Удаление листов (`delete_products_worksheets`):**
    Удаляет все листы, кроме указанных, из Google Таблицы.

13. **Сохранение данных категорий из листа (`save_categories_from_worksheet`):**
    Метод парсит данные из листа `categories` и сохраняет их в объекте `SimpleNamespace`, который доступен через `self.campaign.category`.  Используется для обновления данных о категориях.

14. **Сохранение данных кампании из листа (`save_campaign_from_worksheet`):**
    Метод парсит данные кампании и категорий из соответствующих листов и сохраняет их в объекте `self.campaign`, обновляя данные кампании.



Пример использования
-------------------------
.. code-block:: python

    from hypotez.src.suppliers.chat_gpt.gsheet import GptGs
    from types import SimpleNamespace

    # Создаем экземпляр класса
    gsheet = GptGs()

    # Пример данных кампании
    campaign_data = SimpleNamespace(
        name="My Campaign",
        title="AliExpress Campaign",
        language="ru",
        currency="USD",
        description="Campaign description",
        category=SimpleNamespace(
            category1=SimpleNamespace(
                name="Category 1", title="Title 1", description="Desc 1", tags=["tag1", "tag2"], products_count=10)
        ),
        products = SimpleNamespace()

    )

    # Обновление данных о кампании
    gsheet.set_categories_worksheet(campaign_data.category)

    # Чтение данных кампании
    campaign_read = gsheet.get_campaign_worksheet()
    print(campaign_read)