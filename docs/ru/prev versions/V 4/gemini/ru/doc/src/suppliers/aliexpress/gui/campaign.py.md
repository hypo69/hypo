# Модуль `campaign.py`

## Обзор

Модуль предоставляет графический интерфейс (GUI) для редактирования и подготовки кампаний AliExpress. Он включает в себя функциональность для открытия JSON-файлов с данными кампаний, отображения данных в редактируемых полях и подготовки кампании с использованием класса `AliCampaignEditor`.

## Подробней

Этот модуль является частью GUI-интерфейса для работы с кампаниями AliExpress. Он позволяет пользователю загружать данные кампании из JSON-файла, просматривать и редактировать основные параметры кампании, такие как заголовок, описание и название промоакции. После редактирования пользователь может запустить процесс подготовки кампании, который выполняется асинхронно. Модуль использует библиотеку PyQt6 для создания графического интерфейса и `AliCampaignEditor` для выполнения подготовки кампании. Расположение файла в структуре проекта `hypotez` указывает на его принадлежность к подсистеме управления кампаниями AliExpress.

## Классы

### `CampaignEditor`

**Описание**:
Класс `CampaignEditor` представляет собой виджет PyQt6, который предоставляет интерфейс для редактирования кампаний AliExpress. Он позволяет загружать данные кампании из JSON-файла, отображать и редактировать параметры кампании, а также подготавливать кампанию к запуску.

**Методы**:
- `__init__`: Инициализирует виджет `CampaignEditor`.
- `setup_ui`: Создает и настраивает пользовательский интерфейс.
- `setup_connections`: Устанавливает связи между сигналами и слотами.
- `open_file`: Открывает диалоговое окно для выбора JSON-файла кампании.
- `load_file`: Загружает JSON-файл и отображает данные в виджетах.
- `create_widgets`: Создает виджеты для отображения и редактирования данных кампании.
- `prepare_campaign`: Асинхронно подготавливает кампанию.

**Параметры**:
- `parent` (QtWidgets.QWidget, optional): Родительский виджет. По умолчанию `None`.
- `main_app` (MainApp, optional): Экземпляр главного приложения. По умолчанию `None`.

**Примеры**:

```python
from PyQt6 import QtWidgets
from campaign import CampaignEditor

app = QtWidgets.QApplication([])
campaign_editor = CampaignEditor()
campaign_editor.show()
app.exec()
```

## Функции

### `__init__`

```python
def __init__(self, parent=None, main_app=None):
    """ Инициализирует виджет CampaignEditor """
```

**Описание**:
Инициализирует виджет `CampaignEditor`, устанавливает ссылку на главное приложение, настраивает пользовательский интерфейс и устанавливает связи между сигналами и слотами.

**Параметры**:
- `parent` (QtWidgets.QWidget, optional): Родительский виджет. По умолчанию `None`.
- `main_app` (MainApp, optional): Экземпляр главного приложения. По умолчанию `None`.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют

**Примеры**:
```python
campaign_editor = CampaignEditor()
```

### `setup_ui`

```python
def setup_ui(self):
    """ Setup the user interface """
```

**Описание**:
Настраивает пользовательский интерфейс виджета, включая создание кнопок, полей ввода и других элементов управления.

**Параметры**:
- Отсутствуют

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют

**Примеры**:
```python
campaign_editor.setup_ui()
```

### `setup_connections`

```python
def setup_connections(self):
    """ Setup signal-slot connections """
```

**Описание**:
Устанавливает связи между сигналами и слотами для обеспечения взаимодействия между элементами управления.

**Параметры**:
- Отсутствуют

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют

**Примеры**:
```python
campaign_editor.setup_connections()
```

### `open_file`

```python
def open_file(self):
    """ Open a file dialog to select and load a JSON file """
```

**Описание**:
Открывает диалоговое окно для выбора JSON-файла кампании и загружает выбранный файл.

**Параметры**:
- Отсутствуют

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют

**Примеры**:
```python
campaign_editor.open_file()
```

### `load_file`

```python
def load_file(self, campaign_file):
    """ Load a JSON file """
```

**Описание**:
Загружает JSON-файл кампании, отображает имя файла в метке и создает виджеты для отображения и редактирования данных кампании.

**Параметры**:
- `campaign_file` (str): Путь к JSON-файлу кампании.

**Возвращает**:
- `None`

**Вызывает исключения**:
- `Exception`: Если не удалось загрузить JSON-файл.

**Примеры**:
```python
campaign_editor.load_file('campaign.json')
```

### `create_widgets`

```python
def create_widgets(self, data):
    """ Create widgets based on the data loaded from the JSON file """
```

**Описание**:
Создает виджеты для отображения и редактирования данных кампании на основе данных, загруженных из JSON-файла.

**Параметры**:
- `data` (SimpleNamespace): Данные кампании, загруженные из JSON-файла.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют

**Примеры**:
```python
campaign_editor.create_widgets(data)
```

### `prepare_campaign`

```python
@asyncSlot()
async def prepare_campaign(self):
    """ Asynchronously prepare the campaign """
```

**Описание**:
Асинхронно подготавливает кампанию с использованием класса `AliCampaignEditor`.

**Параметры**:
- Отсутствуют

**Возвращает**:
- `None`

**Вызывает исключения**:
- `Exception`: Если не удалось подготовить кампанию.

**Примеры**:
```python
await campaign_editor.prepare_campaign()