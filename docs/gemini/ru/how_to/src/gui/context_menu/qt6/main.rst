Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код реализует приложение на PyQt6, которое позволяет добавлять и удалять пункт контекстного меню «hypo AI assistant» в контекстном меню рабочего стола и папок в Windows Explorer.  Код взаимодействует с реестром Windows для модификации контекстных меню. Он предоставляет функции `add_context_menu_item()` для добавления и `remove_context_menu_item()` для удаления этого пункта.

Шаги выполнения
-------------------------
1. **Импортирование необходимых модулей:** Код импортирует модули `winreg` для работы с реестром, `os` для работы с файловой системой, `QtWidgets` из PyQt6 для создания графического интерфейса, а также пользовательские модули `header` и `gs`.

2. **Определение функции `add_context_menu_item()`:**
    * Определяет путь к ключу в реестре, который отвечает за добавление пункта в контекстное меню папок и рабочего стола.
    * Создаёт ключ в реестре с именем «hypo AI assistant» в указанном пути.
    * Создаёт под-ключ «command» и задаёт команду для запуска файла.
    * Проверяет существование файла, указанного в `command_path`. Если файла нет, выводит диалоговое окно об ошибке.
    * Записывает команду запуска файла в реестр.
    * Выводит диалоговое окно с подтверждением успешного добавления или ошибкой.

3. **Определение функции `remove_context_menu_item()`:**
    * Определяет путь к ключу в реестре, который отвечает за удаление пункта из контекстного меню.
    * Попытку удалить ключ в реестре.
    * Выводит диалоговое окно с подтверждением удаления или сообщением об ошибке.

4. **Определение класса `ContextMenuManager`:**
    * Создаёт главный класс приложения.
    * Создаёт интерфейс с кнопками «Добавить пункт меню», «Удалить пункт меню» и «Выход».
    * При нажатии на кнопку «Добавить пункт меню» вызывается функция `add_context_menu_item()`.
    * При нажатии на кнопку «Удалить пункт меню» вызывается функция `remove_context_menu_item()`.
    * При нажатии на кнопку «Выход» приложение закрывается.

5. **Главный блок `if __name__ == "__main__":`:**
    * Создаёт приложение PyQt6.
    * Создаёт экземпляр класса `ContextMenuManager` и отображает его.
    * Запускает главный цикл приложения.

Пример использования
-------------------------
.. code-block:: python

    # Пример использования (в другом файле):
    import sys
    from PyQt6 import QtWidgets
    from hypotez.src.gui.context_menu.qt6.main import ContextMenuManager


    if __name__ == "__main__":
        app = QtWidgets.QApplication(sys.argv)
        window = ContextMenuManager()
        window.show()
        sys.exit(app.exec())