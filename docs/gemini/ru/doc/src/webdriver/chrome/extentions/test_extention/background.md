# Модуль `background.js`

## Обзор

Файл `background.js` отвечает за обработку событий, связанных с расширением для Chrome. Он слушает события кликов по иконке расширения и сообщения, отправляемые из других частей расширения (например, скриптов контента).  При получении сообщения с действием `'collectData'` он отправляет данные на сервер.


## Обработка событий кликов

### `chrome.browserAction.onClicked.addListener`

**Описание**: Функция-обработчик кликов по иконке расширения.

**Аргументы**:
- `tab` (object): Объект, содержащий информацию о вкладке, на которой был произведен клик.

**Действие**:
Отправляет сообщение в текущую вкладку с запросом сбора данных.

## Обработка сообщений

### `chrome.runtime.onMessage.addListener`

**Описание**: Функция-обработчик сообщений, отправленных из других частей расширения.

**Аргументы**:
- `message` (object): Сообщение, отправленное из другого скрипта.
- `sender` (object): Информация об отправителе сообщения.
- `sendResponse` (function): Функция для отправки ответа отправителю.

**Действие**:
Обрабатывает сообщения с действием `'collectData'`. Если такое сообщение получено, вызывается функция `sendDataToServer()`.

**Возвращает**: `true` (необходимое значение для асинхронных запросов).

## Отправка данных на сервер

### `sendDataToServer`

**Описание**: Функция отправляет собранные данные на сервер.

**Аргументы**:
- `url` (string): URL страницы, для которой собираются данные.

**Действие**:
- Получает сохраненные данные из хранилища `chrome.storage.local`.
- Проверяет наличие данных.
- Если данные есть, выполняет `fetch`-запрос на сервер с данными.
  - Обрабатывает успешное отправление данных и выводит сообщение в консоль.
  - Обрабатывает ошибки отправки данных и выводит сообщение в консоль.
- Если данных нет, выводит сообщение в консоль об отсутствии данных.

**Вызывает исключения**:
- `Error`: При ошибке отправки данных на сервер.

**Используемые ресурсы**:
- `chrome.storage.local`:  Для получения сохраненных данных.
- `fetch`:  Для отправки данных на сервер.