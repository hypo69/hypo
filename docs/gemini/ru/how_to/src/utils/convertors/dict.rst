Как использовать функции модуля `hypotez/src/utils/convertors/dict.py`
=============================================================================

Описание
-------------------------
Модуль `hypotez/src/utils/convertors/dict.py` содержит функции для конвертации словарей в объекты `SimpleNamespace` и обратно, а также для экспорта данных в различные форматы (XML, CSV, JSON, XLS, HTML, PDF).  Он предоставляет инструменты для работы со сложными структурами данных, включая вложенные словари и списки.

Шаги выполнения
-------------------------
1. **Импортирование модуля:**
   Импортируйте модуль:

   ```python
   from hypotez.src.utils.convertors.dict import dict2ns, dict2xml, dict2csv, dict2json, dict2xls, dict2html, dict2pdf, replace_key_in_dict
   ```

2. **Использование функций:**
   Выбор конкретной функции зависит от задачи:

   * **`dict2ns(data)`:** Конвертирует словарь в объект `SimpleNamespace`. Рекурсивно обрабатывает вложенные структуры.  Возвращает объект `SimpleNamespace` или список объектов `SimpleNamespace`, если входные данные – список словарей.

   * **`dict2xml(data, encoding='UTF-8')`:** Генерирует строку XML из словаря. Поддерживает вложенные структуры и списки.  Возвращает строку XML. Поднимает исключение, если в входном словаре больше одного корневого узла.

   * **`dict2csv(data, file_path)`:** Сохраняет данные словаря или объекта `SimpleNamespace` в CSV-файл. Возвращает `True`, если сохранение прошло успешно, и `False` в противном случае.

   * **`dict2xls(data, file_path)`:** Сохраняет данные словаря или объекта `SimpleNamespace` в XLS-файл. Возвращает `True`, если сохранение прошло успешно, и `False` в противном случае.

   * **`dict2html(data, encoding='UTF-8')`:** Генерирует строку HTML-таблицы из словаря или объекта `SimpleNamespace`. Рекурсивно обрабатывает вложенные структуры.  Возвращает полную строку HTML документа.

   * **`dict2pdf(data, file_path)`:** Сохраняет данные словаря в PDF-файл.  Создает PDF-файл, содержащий данные словаря в формате ключ:значение.

   * **`replace_key_in_dict(data, old_key, new_key)`:** Рекурсивно заменяет ключ в словаре или списке на новый. Поддерживает вложенные структуры и списки.  Возвращает обновленный словарь или список.

3. **Обработка входящих данных:**
   Для функций `dict2csv`, `dict2xls`, `dict2pdf`, `dict2html` входной параметр `data` должен быть типом `dict` или `SimpleNamespace`.  Если передается `SimpleNamespace`, то функция автоматически преобразует его в словарь перед обработкой.

4. **Обработка исключений:**
    Функция `dict2xml` может поднять исключение `Exception` если в входных данных есть более одного корневого узла (в словаре несколько элементов, не являющихся списками).


Пример использования
-------------------------
.. code-block:: python

    import json
    from hypotez.src.utils.convertors.dict import dict2ns, dict2xml, dict2pdf

    # Пример данных
    data = {
        "name": "John Doe",
        "age": 30,
        "address": {
            "street": "123 Main St",
            "city": "Anytown"
        },
        "phone_numbers": ["123-456-7890", "987-654-3210"]
    }

    # Конвертация в SimpleNamespace
    ns_data = dict2ns(data)
    print(ns_data.name)  # Вывод: John Doe

    # Генерация XML
    xml_string = dict2xml(data)
    print(xml_string)

    # Сохранение в PDF
    dict2pdf(data, "data.pdf")

    # Обратите внимание: для работы с файлами нужно указать корректный путь