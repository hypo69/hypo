# Задача No 875
## Длиннейшие циклические цепи

## Условия

Пусть *a* и *b* — целые положительные числа, и пусть *g* = НОД(*a*, *b*). Мы определяем цепь *C*( *a*, *b*) следующим образом:

*   Первым членом цепи является *a*.
*   Если последний член цепи равен *n*, следующий член цепи — это *n* + НОД(*n*, *b*), если *n* + НОД(*n*, *b*) ≤ *a* + *b*, и *n* - НОД(*n*, *b*), если *n* + НОД(*n*, *b*) > *a* + *b*.
*   Цепь заканчивается, когда какой-либо член появляется в цепи во второй раз.

Обозначим длину цепи *C*( *a*, *b*) через *L*( *a*, *b*). Если цепь не является циклической (т.е. ни один член не повторяется), считаем, что *L*( *a*, *b*) = 0.

Например:
*   *C*(3, 4) = [3, 4, 6, 4], *L*(3, 4) = 3, так как 4 повторяется.
*   *C*(15, 9) = [15, 18, 24, 18], *L*(15, 9) = 3, так как 18 повторяется.
*   *C*(4, 6) = [4, 6, 8, 10, 8], *L*(4, 6) = 4, так как 8 повторяется.
*   *C*(5, 7) = [5, 6, 7, 8, 9, 10, 9], *L*(5, 7) = 6, так как 9 повторяется.
*   *C*(1, 3) = [1, 2, 3, 2], *L*(1, 3) = 3, так как 2 повторяется.

Пусть *M*( *n*) = максимум {*L*( *a*, *b*) : 1 ≤ *a*, *b* ≤ *n*}.

Известно, что *M*(10) = 6, *M*(100) = 180.

Найдите *M*(10<sup>6</sup>).
