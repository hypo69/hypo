# Модуль `xls`

## Обзор

Модуль `xls` предоставляет функции для конвертации файлов Excel (`.xls`) в формат JSON и обратно. Он поддерживает работу с несколькими листами в файле Excel, а также обеспечивает обработку ошибок для повышения надежности.

## Содержание

- [Обзор](#обзор)
- [Функции](#функции)
    - [`read_xls_as_dict`](#read_xls_as_dict)
    - [`save_xls_file`](#save_xls_file)

## Функции

### `read_xls_as_dict`

**Описание**:
Считывает Excel-файл и конвертирует его в JSON. Опционально может конвертировать определенный лист и сохранить результат в JSON-файл. Обрабатывает ошибки.

**Параметры**:
- `xls_file` (str): Путь к Excel-файлу.
- `json_file` (Optional[str], optional): Путь для сохранения JSON-файла. По умолчанию `None`.
- `sheet_name` (Optional[str | int], optional): Название или индекс листа для конвертации. Если `None`, обрабатываются все листы. По умолчанию `None`.

**Возвращает**:
- `Union[Dict, List[Dict], bool]`: Возвращает словарь, где ключи — названия листов, а значения — списки словарей (записи). Если `sheet_name` задан, возвращается список словарей. В случае ошибки возвращается `False`.

**Вызывает исключения**:
- `FileNotFoundError`: Если указанный Excel-файл не найден.
- `Exception`: При возникновении других ошибок во время обработки файла.

### `save_xls_file`

**Описание**:
Сохраняет JSON-данные в Excel-файл.

**Параметры**:
- `data` (Dict[str, List[Dict]]): Словарь, где ключи — названия листов, а значения — списки словарей (записи).
- `file_path` (str): Путь для сохранения Excel-файла.

**Возвращает**:
- `bool`: `True`, если файл успешно сохранен, иначе `False`.

**Вызывает исключения**:
- `Exception`: При возникновении ошибок во время сохранения файла.