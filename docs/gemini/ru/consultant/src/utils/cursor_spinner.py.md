# Анализ кода модуля `cursor_spinner`

**Качество кода: 7/10**

*   **Плюсы:**
    *   Код выполняет свою функцию - отображает спиннер в консоли.
    *   Использует генератор для циклического отображения символов.
    *   Присутствует docstring для модуля и функций.
    *   Есть пример использования в `if __name__ == "__main__":`.
*   **Минусы:**
    *   Отсутствует явное указание кодировки в начале файла.
    *   Нет обработки возможных ошибок.
    *   Используется  `sys.stdout.write` для вывода, что может быть менее читабельно, чем `print`.
    *   Стиль комментариев не соответствует reStructuredText (RST).
    *   Нет импорта `logger` из `src.logger.logger`.

**Рекомендации по улучшению**

1.  **Добавить RST-совместимые комментарии**: Переписать docstring и комментарии в формате RST.
2.  **Использовать `logger`**:  Добавить импорт `logger` и использовать его для логирования.
3.  **Улучшить вывод**: Рассмотреть возможность использования `print` вместо  `sys.stdout.write` для большей читаемости.
4.  **Добавить обработку ошибок**: Хотя в данном коде маловероятны ошибки, стоит добавить обработку потенциальных исключений для надежности.
5.  **Удалить избыточные shebang**: Оставить только один shebang.

**Оптимизированный код**

```python
# -*- coding: utf-8 -*-
#! venv/bin/python/python3.12

"""
Модуль для отображения спиннера в консоли.
=========================================================================================

Этот модуль предоставляет утилиту для отображения спиннера (вращающегося курсора) в консоли,
чтобы имитировать процесс загрузки или ожидания.

Пример использования
--------------------

.. code-block:: python

    from src.utils.cursor_spinner import show_spinner

    show_spinner(duration=5.0, delay=0.1) # Показывает спиннер в течение 5 секунд

"""
import time
import sys

from src.logger.logger import logger # Импортируем logger


MODE = 'dev'

def spinning_cursor():
    """
    Генератор для создания спиннера.

    Этот генератор циклически возвращает символы |, /, -, \\.

    :yield: Следующий символ в последовательности спиннера.
    :rtype: str

    Пример:
        >>> cursor = spinning_cursor()
        >>> next(cursor)  # '|'
        >>> next(cursor)  # '/'
        >>> next(cursor)  # '-'
        >>> next(cursor)  # '\\'
    """
    while True:
        for cursor in '|/-\\':
            yield cursor

def show_spinner(duration: float = 5.0, delay: float = 0.1):
    """
    Отображает спиннер в консоли в течение заданного времени.

    :param duration: Длительность отображения спиннера в секундах. По умолчанию 5.0.
    :type duration: float
    :param delay: Задержка между каждым шагом вращения спиннера в секундах. По умолчанию 0.1.
    :type delay: float

    Пример:
        >>> show_spinner(duration=3.0, delay=0.2)  # Отображает спиннер в течение 3 секунд
    """
    spinner = spinning_cursor()
    end_time = time.time() + duration

    try:
        while time.time() < end_time:
            # Код выводит следующий символ спиннера
            sys.stdout.write(next(spinner))
            # Код принудительно выводит в консоль
            sys.stdout.flush()
            # Код приостанавливает выполнение на время задержки
            time.sleep(delay)
            # Код переносит курсор на предыдущую позицию для перезаписи
            sys.stdout.write('\b')
    except Exception as ex:
        logger.error(f'Ошибка при отображении спиннера: {ex}')
        ... # Сохраняем точку остановки для отладки
        return


if __name__ == "__main__":
    # Пример использования спиннера в скрипте
    print("Spinner for 5 seconds:")
    show_spinner(duration=5.0, delay=0.1)
    print("\nDone!")
```