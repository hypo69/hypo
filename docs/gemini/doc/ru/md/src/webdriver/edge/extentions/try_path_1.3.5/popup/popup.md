# Модуль `popup.js`

## Обзор

Этот JavaScript-модуль реализует всплывающее окно для расширения `try_xpath_1.3.5`. Он отвечает за обработку пользовательского ввода, отправку запросов в активную вкладку/рамку, отображение результатов в табличной форме и управление состоянием приложения.

## Функции

### `sendToActiveTab`

**Описание**: Отправляет сообщение в активную вкладку.

**Параметры**:

- `msg` (объект): Сообщение для отправки.
- `opts` (объект, необязательно): Дополнительные опции для отправки, например, `frameId`. По умолчанию `{}`.

**Возвращает**:
- `Promise`: Обещание, которое разрешается после отправки сообщения.

**Вызывает исключения**:
- `Ошибка`: Возникает в случае неудачи при выполнении запроса к вкладке.

### `sendToSpecifiedFrame`

**Описание**: Отправляет сообщение в указанную рамку активной вкладки.

**Параметры**:
- `msg` (объект): Сообщение для отправки.

**Возвращает**:
- `Promise`: Обещание, которое разрешается после отправки сообщения в указанную рамку.

**Вызывает исключения**:
- `Ошибка`: Возникает при возникновении ошибки при выполнении запроса к рамке.


### `collectPopupState`

**Описание**: Собирает текущее состояние всплывающего окна.

**Параметры**: Нет.

**Возвращает**:
- `объект`: Объект, содержащий текущее состояние всплывающего окна.

**Вызывает исключения**:
- Нет.


### `changeContextVisible`

**Описание**: Изменяет видимость раздела контекста в зависимости от состояния флажка.

**Параметры**:
- Нет.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.



### `changeResolverVisible`, `changeFrameIdVisible`, `changeFrameDesignationVisible`, `changeHelpVisible`

(Аналогичные функции для изменения видимости других разделов.)

**Описание**: Изменяет видимость заданных блоков в зависимости от состояния флажков.


**Параметры**:
- Нет.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.



### `makeExecuteMessage`

**Описание**: Создает сообщение для выполнения XPath-запроса в текущем контексте.

**Параметры**: Нет.

**Возвращает**:
- `объект`: Сообщение для выполнения XPath-запроса.


**Вызывает исключения**:
- Нет.


### `getSpecifiedFrameId`

**Описание**: Возвращает идентификатор рамки на основе выбранного значения в списке или выражения.


**Параметры**:
- Нет.

**Возвращает**:
- `число`: Идентификатор рамки.

**Вызывает исключения**:
- Нет.



### `execContentScript`

**Описание**: Выполняет скрипты `try_xpath_check_frame.js`, `try_xpath_functions.js`, и `try_xpath_content.js` в активной вкладке.

**Параметры**: Нет.

**Возвращает**:
- `Promise`: Обещание, которое разрешается после выполнения скриптов.

**Вызывает исключения**:
- `Ошибка`: Возникает при возникновении ошибки при выполнении скриптов.



### `sendExecute`

**Описание**: Отправляет сообщение для выполнения XPath-запроса в указанную рамку.

**Параметры**: Нет.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- `Ошибка`: Возникает в случае ошибки при отправке сообщения.


### `handleExprEnter`

**Описание**: Обработчик события нажатия Enter на поле ввода.


**Параметры**:
- `event` (объект): Событие.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


### `showDetailsPage`


**Описание**: Отображает детали результатов на заданной странице.


**Параметры**:
- `index` (целое число): Номер страницы.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- `Ошибка`: Возникает в случае ошибки при обновлении таблицы.


### `showError`

**Описание**: Отображает сообщение об ошибке в всплывающем окне.

**Параметры**:
- `message` (строка): Сообщение об ошибке.
- `frameId` (число): Идентификатор рамки, применимый к сообщению об ошибке.


**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


### `genericListener`

**Описание**: Общий обработчик сообщений от активной вкладки.

**Параметры**:
- `message`: Сообщение из вкладки.
- `sender`: Объект отправителя (вкладка/рамка).
- `sendResponse`: Функция для отправки ответа.


**Возвращает**:
- `Promise` или `null`.

**Вызывает исключения**:
- Может вызывать исключения из обработанных обработчиками `listeners`.


### `genericListener.listeners.showResultsInPopup`

**Описание**: Обработчик сообщения о результатах в всплывающем окне.


**Параметры**:
- `message`: Сообщение о результатах.
- `sender`: Объект отправителя.

**Возвращает**:
- Нет.

**Вызывает исключения**:
- `Ошибка`: Возникает в случае ошибки при обновлении таблицы.



### `genericListener.listeners.restorePopupState`

**Описание**: Восстанавливает состояние всплывающего окна из сохранённого состояния.


**Параметры**:
- `message`: Сообщение с сохранённым состоянием.


**Возвращает**:
- Нет.

**Вызывает исключения**:
- Нет.


**(Другие методы `genericListener.listeners` аналогичны)**

## Обработчики событий

Модуль содержит обработчики событий для различных элементов интерфейса, включая кнопки, поля ввода и флажки. Эти обработчики вызывают соответствующие функции для управления состоянием всплывающего окна и отправки сообщений.



```