# Модуль `hypotez/src/translators/product_translator.py`

## Обзор

Модуль `product_translator.py` предоставляет функции для работы с переводами полей товаров. Он обеспечивает связь между данными о товарах из системы PrestaShop, базой данных переводов и механизмом перевода.  Модуль содержит функции для получения переводов из базы данных, вставки новых переводов и перевода полей товара.

## Функции

### `get_translations_from_presta_translations_table`

**Описание**: Получает переводы полей товара из таблицы переводов PrestaShop.

**Параметры**:
- `product_reference` (str): Уникальный идентификатор товара.
- `i18n` (str, optional): Код языка (например, `en_EN`, `ru_RU`). По умолчанию `None`.

**Возвращает**:
- `list`: Список словарей с переводами полей товара. Возвращает пустой список, если переводы не найдены.

**Вызывает исключения**:
- Возможны исключения, связанные с взаимодействием с базой данных (например, проблемы с подключением или запросом).


### `insert_new_translation_to_presta_translations_table`

**Описание**: Вставляет новые переводы полей товара в базу данных переводов.

**Параметры**:
- `record` (dict): Словарь с данными для нового перевода.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Возможны исключения, связанные с взаимодействием с базой данных (например, проблемы с подключением или запросом).


### `translate_record`

**Описание**: Переводит поля товара с одного языка на другой.

**Параметры**:
- `record` (dict): Словарь с данными, которые нужно перевести.
- `from_locale` (str): Код исходного языка (например, `en_EN`).
- `to_locale` (str): Код целевого языка (например, `ru_RU`).

**Возвращает**:
- `dict`: Словарь с переведенными данными.

**Вызывает исключения**:
- `Exception`: Возникает при ошибках в процессе перевода (например, проблемы с API OpenAI).


##  Замечания

- В модуле используется менеджер `ProductTranslationsManager` для взаимодействия с базой данных переводов.
- Для перевода используется функция `translate` из модуля `src.ai.openai`.
- Необходимо добавить обработку потенциальных ошибок, например, проверку корректности входных данных и обработку исключений, связанных с отсутствием данных в базе или некорректными запросами.
- В комментариях используется спецификация типов (typing) для указания типов данных.
- Необходимо дополнить функцию `translate_record` реализацией обработки переведенной записи.
- Фрагмент кода, обозначенный `...`, требует реализации.

##  TODO

- Реализовать парсер для кодов языков `en_EN`, `he_HE`, `ru_RU`.
- Доработать функцию `record` для обработки мультиязычных полей в словаре `presta_fields` более гибким способом.
- Дополнить обработку ошибок и валидацию входных данных.
- Добавить unit-тесты для проверки корректности работы модуля.