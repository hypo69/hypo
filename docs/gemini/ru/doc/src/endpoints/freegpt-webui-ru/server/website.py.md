# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` предназначен для настройки маршрутов и обработки запросов, связанных с веб-сайтом. Он использует Flask для определения маршрутов и рендеринга шаблонов.

## Подробней

Модуль отвечает за обработку различных URL-адресов, таких как главная страница ("/"), страница чата ("/chat/") и статические ресурсы ("/assets/"). Он использует Flask для маршрутизации запросов к соответствующим функциям, которые генерируют ответы для пользователя. В частности, модуль создает случайные conversation_id для новых чатов и предоставляет доступ к статическим файлам, таким как JavaScript и CSS.

## Классы

### `Website`

**Описание**: Класс `Website` управляет маршрутами и обработкой запросов для веб-сайта.

**Принцип работы**: Класс инициализируется с объектом Flask app и определяет маршруты для различных URL-адресов. Каждый маршрут связан с определенной функцией класса, которая обрабатывает запрос и возвращает ответ.

**Методы**:

- `__init__(self, app)`: Инициализирует класс `Website` с объектом Flask app.
- `_chat(self, conversation_id)`: Обрабатывает запросы к странице чата с определенным `conversation_id`.
- `_index(self)`: Обрабатывает запросы к главной странице ("/chat/").
- `_assets(self, folder: str, file: str)`: Обрабатывает запросы к статическим ресурсам, таким как JavaScript и CSS.

#### `__init__(self, app)`

```python
def __init__(self, app) -> None:
    """
    Инициализирует класс Website.

    Args:
        app: Объект Flask application.

    Returns:
        None
    """
```

**Параметры**:

- `app`: Объект Flask application.

**Как работает класс**
1. Функция получает объект Flask application.
2. Инициализирует класс `Website`, сохраняя объект `app` в `self.app`.
3. Определяет маршруты в словаре `self.routes`, связывая URL-адреса с функциями и методами HTTP.

**Примеры**:

```python
from flask import Flask
app = Flask(__name__)
website = Website(app)
```

#### `_chat(self, conversation_id)`

```python
def _chat(self, conversation_id):
    """
    Обрабатывает запросы к странице чата с определенным conversation_id.

    Args:
        conversation_id: Идентификатор беседы.

    Returns:
        Response: Ответ Flask, содержащий отрендеренный шаблон index.html или перенаправление на '/chat'.
    """
```

**Параметры**:

- `conversation_id`: Идентификатор беседы.

**Как работает класс**
1. Функция получает идентификатор беседы `conversation_id`.
2. Проверяет, содержит ли `conversation_id` символ '-'. Если нет, выполняет перенаправление на '/chat'.
3. Если `conversation_id` содержит '-', функция отображает шаблон 'index.html', передавая `conversation_id` в шаблон как `chat_id`.

**Примеры**:

```python
# Пример вызова функции _chat с допустимым conversation_id
response = website._chat('1234-5678-90ab-cdef-1234567890ab')
```

```python
# Пример вызова функции _chat с недопустимым conversation_id
response = website._chat('1234567890abcdef1234567890ab')
```

#### `_index(self)`

```python
def _index(self):
    """
    Обрабатывает запросы к главной странице ("/chat/").

    Args:
        None

    Returns:
        Response: Ответ Flask, содержащий отрендеренный шаблон index.html с новым chat_id.
    """
```

**Параметры**:

- Нет

**Как работает класс**
1. Функция генерирует случайный идентификатор чата, используя `urandom` и `time`.
2. Отображает шаблон 'index.html', передавая сгенерированный идентификатор чата в шаблон как `chat_id`.

**Примеры**:

```python
# Пример вызова функции _index
response = website._index()
```

#### `_assets(self, folder: str, file: str)`

```python
def _assets(self, folder: str, file: str):
    """
    Обрабатывает запросы к статическим ресурсам, таким как JavaScript и CSS.

    Args:
        folder (str): Имя папки, содержащей файл.
        file (str): Имя файла.

    Returns:
        Response: Ответ Flask, содержащий запрошенный файл, или сообщение об ошибке "File not found" с кодом 404.
    """
```

**Параметры**:

- `folder` (str): Имя папки, содержащей файл.
- `file` (str): Имя файла.

**Как работает класс**
1. Функция получает имя папки и имя файла.
2. Пытается отправить запрошенный файл с помощью `send_file`.
3. Если файл не найден, возвращает сообщение об ошибке "File not found" с кодом 404.

**Примеры**:

```python
# Пример вызова функции _assets для получения файла style.css из папки css
response = website._assets('css', 'style.css')
```

```python
# Пример вызова функции _assets для получения файла, который не существует
response = website._assets('js', 'nonexistent.js')