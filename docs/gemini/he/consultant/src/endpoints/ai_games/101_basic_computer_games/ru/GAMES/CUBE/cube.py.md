# Анализ кода модуля `cube.py`

**Качество кода**
-  **Соблюдение требований к формату кода (1-10):**
    - **Преимущества:**
        - Код в целом понятный и хорошо структурирован.
        - Присутствует базовая документация для функций и общая логика работы.
        - Код разделен на функции, что способствует читаемости и переиспользованию.
    - **Недостатки:**
        - Отсутствует подробная документация в формате reStructuredText (RST).
        - Нет обработки ошибок с использованием `logger.error`.
        - Используются стандартные комментарии `#` вместо docstring.
        - Не используется `j_loads` или `j_loads_ns` для чтения файлов (хотя здесь нет чтения файлов).
        - Отсутствуют импорты логгера.
        - Нет описания модуля в начале файла.
        - Использованы строковые константы без явного назначения.

**Рекомендации по улучшению**

1. **Документация:**
   - Добавить описание модуля в начале файла в формате RST.
   - Переписать все комментарии и docstring в формат RST.
   - Добавить описания для всех функций, классов и переменных.
2. **Логирование:**
   - Импортировать `logger` из `src.logger.logger`.
   - Заменить стандартные блоки `try-except` на `logger.error` для обработки ошибок.
3. **Формат кода:**
   - Использовать `j_loads` или `j_loads_ns` при необходимости чтения файлов (в данном коде этого нет, но учитывать для будущих задач).
   - Улучшить стиль написания, придерживаясь PEP 8.
   - Переписать строковые константы в явном виде.
4. **Структура кода:**
   - Убрать избыточные комментарии, если логика очевидна.
   - Проверить соответствие имен функций, переменных и импортов принятым соглашениям.

**Улучшенный код**

```python
"""
Модуль для реализации игры "Куб".
=========================================================================================

Модуль содержит функции для генерации, отображения и перемещения граней куба.
Игра представляет собой головоломку, где игрок должен собрать куб, перемещая его грани
вверх, вниз, влево и вправо.

Пример использования
--------------------

.. code-block:: python

    cube = generate_cube()
    display_cube(cube)
    while True:
        move = input("Введите ход (U, D, L, R): ").upper()
        if move not in ['U', 'D', 'L', 'R']:
            print("Неверный ход. Попробуйте еще раз.")
            continue
        cube = move_cube(cube, move)
        display_cube(cube)
        if is_solved(cube):
            print("Поздравляю! Вы собрали куб!")
            break
"""
import random  # Импорт модуля random для генерации случайных чисел
from src.logger.logger import logger  # Импорт логгера для обработки ошибок


def generate_cube() -> list[list[int]]:
    """
    Генерирует случайный куб 3x3.

    :return: Список списков, представляющий куб.
    :rtype: list[list[int]]
    """
    numbers = list(range(1, 10))  # Создается список чисел от 1 до 9
    random.shuffle(numbers)  # Перемешиваем список чисел в случайном порядке
    cube = [numbers[i:i + 3] for i in range(0, 9, 3)]  # Создаем матрицу 3x3 из перемешанных чисел
    return cube  # Возвращаем созданный куб


def display_cube(cube: list[list[int]]) -> None:
    """
    Выводит куб на экран.

    :param cube: Список списков, представляющий куб.
    :type cube: list[list[int]]
    """
    for row in cube:  # Итерируемся по каждой строке куба
        print('  '.join(map(str, row)))  # Выводим строку, преобразуя числа в строки и разделяя их двумя пробелами


def move_cube(cube: list[list[int]], move: str) -> list[list[int]]:
    """
    Перемещает грани куба в зависимости от введенной команды.

    :param cube: Список списков, представляющий куб.
    :type cube: list[list[int]]
    :param move: Строка, представляющая направление перемещения ('U', 'D', 'L', 'R').
    :type move: str
    :return: Список списков, представляющий куб после перемещения.
    :rtype: list[list[int]]
    """
    if move == 'U':  # Если команда 'U', сдвигаем все ряды куба вверх
        temp = cube[0]  # Сохраняем первый ряд
        for i in range(2):  # Цикл по первым двум рядам
            cube[i] = cube[i + 1]  # Сдвигаем ряды вверх
        cube[2] = temp  # Перемещаем сохраненный первый ряд в конец
    elif move == 'D':  # Если команда 'D', сдвигаем все ряды куба вниз
        temp = cube[2]  # Сохраняем последний ряд
        for i in range(2, 0, -1):  # Цикл по рядам в обратном порядке
            cube[i] = cube[i - 1]  # Сдвигаем ряды вниз
        cube[0] = temp  # Перемещаем сохраненный последний ряд в начало
    elif move == 'L':  # Если команда 'L', сдвигаем все столбцы куба влево
        temp = [row[0] for row in cube]  # Сохраняем первый столбец
        for i in range(3):  # Цикл по строкам
            for j in range(2):  # Цикл по первым двум элементам строки
                cube[i][j] = cube[i][j + 1]  # Сдвигаем элементы столбца влево
            cube[i][2] = temp[i]  # Перемещаем сохраненный элемент столбца в конец
    elif move == 'R':  # Если команда 'R', сдвигаем все столбцы куба вправо
        temp = [row[2] for row in cube]  # Сохраняем последний столбец
        for i in range(3):  # Цикл по строкам
            for j in range(2, 0, -1):  # Цикл по элементам столбца в обратном порядке
                cube[i][j] = cube[i][j - 1]  # Сдвигаем элементы столбца вправо
            cube[i][0] = temp[i]  # Перемещаем сохраненный элемент столбца в начало
    return cube  # Возвращаем куб после перемещения


def is_solved(cube: list[list[int]]) -> bool:
    """
    Проверяет, собран ли куб.

    :param cube: Список списков, представляющий куб.
    :type cube: list[list[int]]
    :return: True, если куб собран, False в противном случае.
    :rtype: bool
    """
    expected = [1, 2, 3, 4, 5, 6, 7, 8, 9]  # Ожидаемая последовательность чисел в собранном кубе
    actual = []  # Список для хранения текущей последовательности чисел в кубе
    for row in cube:  # Итерируемся по каждой строке куба
        actual.extend(row)  # Добавляем все числа из строки в список
    return actual == expected  # Сравниваем текущую и ожидаемую последовательности


if __name__ == '__main__':
    cube = generate_cube()  # Инициализируем куб
    display_cube(cube)  # Выводим куб на экран

    while True:  # Начинаем основной игровой цикл
        try: # Оборачиваем ввод пользователя в блок try-except
            move = input("Введите ход (U, D, L, R): ").upper()  # Запрашиваем ввод хода у пользователя и преобразуем в верхний регистр
            if move not in ['U', 'D', 'L', 'R']:  # Проверяем корректность введенного хода
                print("Неверный ход. Попробуйте еще раз.") # Выводим сообщение об ошибке
                continue # Переходим к следующей итерации цикла
            cube = move_cube(cube, move) # Перемещаем грани куба
            display_cube(cube) # Выводим куб на экран
            if is_solved(cube): # Проверяем, собран ли куб
                print("Поздравляю! Вы собрали куб!") # Выводим сообщение о победе
                break  # Завершаем цикл, если куб собран
        except Exception as ex: # Ловим все ошибки
            logger.error('Произошла ошибка при выполнении игры.', exc_info=ex)  # Логируем ошибку
            break # Завершаем цикл при ошибке
```