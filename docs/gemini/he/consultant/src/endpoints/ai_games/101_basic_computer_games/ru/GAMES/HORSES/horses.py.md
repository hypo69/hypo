# Анализ кода модуля `horses.py`

**Качество кода**

- **Соответствие требованиям к формату кода (1-10):**

  - **Преимущества:**
    - Код выполняет основную задачу игры "Скачки", генерируя случайное число для победившей лошади и сравнивая его с выбором пользователя.
    - Присутствует обработка ошибок ввода пользователя, что предотвращает сбои программы при некорректных данных.
    - Код достаточно прост и понятен для восприятия.
  - **Недостатки:**
    - Отсутствует docstring в формате reStructuredText (RST) для модуля.
    - Отсутствуют комментарии в формате reStructuredText (RST) для отдельных участков кода.
    - Используется стандартный `print` для вывода сообщений, вместо более подходящего логгера.
    - Желательно было бы использовать более явное имя переменной для номера лошади, выбранной пользователем.
    - Отсутствует импорт `logger` и его использование для логирования ошибок.
    - Желательно было бы убрать множественные проверки в блоке try и использовать для этого валидатор.
    - Код завершается с помощью `exit()`, что может быть нежелательно в более крупном приложении.

**Рекомендации по улучшению**

1.  Добавить docstring в формате reStructuredText (RST) для модуля, включая описание игры, правил и алгоритма.
2.  Добавить docstring в формате reStructuredText (RST) для каждого блока кода (если требуется по заданию).
3.  Заменить использование `print` на `logger.info` для информационных сообщений и `logger.error` для ошибок.
4.  Импортировать и использовать `logger` для регистрации ошибок и информации.
5.  Добавить проверку корректности ввода через валидатор.
6.  Заменить `exit()` на более управляемый способ завершения игры, например, через возврат значения.
7.  Использовать более точные имена переменных.
8.  Разделить код на более мелкие функции для лучшей читаемости.

**Улучшенный код**

```python
"""
HORSES:
=================
Сложность: 3
-----------------
Игра "Скачки" - это простая игра, в которой игрок выбирает лошадь, а затем компьютер случайным образом определяет, какая из лошадей победит.
Игрок либо выигрывает, либо проигрывает в зависимости от своего выбора.

Правила игры:
1. Компьютер генерирует случайное число от 1 до 7 (номер лошади-победителя).
2. Игрок вводит номер лошади (от 1 до 7), за которую он хочет болеть.
3. Игра сообщает, выиграла ли выбранная игроком лошадь.
-----------------
Алгоритм:
1.  Сгенерировать случайное целое число от 1 до 7 (номер лошади-победителя) и сохранить в переменной `winning_horse`.
2.  Запросить у пользователя ввод числа от 1 до 7 (номер лошади, за которую он играет) и сохранить в переменной `user_horse`.
3.  Если `user_horse` равно `winning_horse`, вывести сообщение "УРА! ВАША ЛОШАДЬ ВЫИГРАЛА!".
4.  Иначе вывести сообщение "К СОЖАЛЕНИЮ, ВЫ ПРОИГРАЛИ!".
5. Конец игры.
-----------------
"""
import random # Импортируем модуль random для генерации случайных чисел.
from src.logger.logger import logger # Импортируем logger для логирования сообщений.
from typing import Any # Импортируем Any для аннотации типов.


def get_user_horse() -> int | None:
    """
    Запрашивает у пользователя ввод номера лошади и проверяет корректность ввода.

    :return: Номер лошади, выбранный пользователем, или None в случае некорректного ввода.
    :rtype: int | None
    """
    try:
        user_input = input("Выберите номер лошади от 1 до 7: ")
        user_horse = int(user_input) # Преобразует введенное значение в целое число.
        if not 1 <= user_horse <= 7: # Проверяет, что номер находится в диапазоне от 1 до 7.
            logger.error(f"Введен некорректный номер лошади: {user_horse}") # Логирует ошибку при некорректном вводе.
            return None # Возвращает None, если ввод некорректен.
        return user_horse # Возвращает введенное целое число
    except ValueError:
        logger.error(f"Некорректный ввод: {user_input}. Необходимо ввести целое число") # Логирует ошибку, если ввод не является целым числом.
        return None # Возвращает None в случае ошибки ввода.


def run_horses_game():
    """
    Запускает игру "Скачки", генерирует номер лошади-победителя и сравнивает его с выбором пользователя.
    """
    winning_horse = random.randint(1, 7)  # Генерирует случайное число от 1 до 7 (номер лошади-победителя).
    logger.info(f"Номер лошади-победителя: {winning_horse}") # Логирует номер лошади-победителя.

    user_horse = get_user_horse() # Запрашивает у пользователя номер лошади.
    if user_horse is None: # Если ввод пользователя некорректен, завершаем игру.
        logger.info("Игра завершена из-за некорректного ввода.") # Логирует завершение игры из-за ошибки ввода.
        return

    # Проверяем, выиграл ли пользователь
    if user_horse == winning_horse: # Проверяет, совпадает ли номер пользователя с номером лошади-победителя.
        logger.info("УРА! ВАША ЛОШАДЬ ВЫИГРАЛА!") # Выводит сообщение о победе, используя logger.
    else:
        logger.info("К СОЖАЛЕНИЮ, ВЫ ПРОИГРАЛИ!") # Выводит сообщение о проигрыше, используя logger.


if __name__ == "__main__":
    run_horses_game() # Запускает игру, если скрипт запущен напрямую.

"""
Объяснение кода:
1.  **Импорт модуля `random`**::
     - `import random`: Импортирует модуль `random`, который используется для генерации случайного числа.
2.  **Импорт `logger`**::
     - `from src.logger.logger import logger`: Импортирует логгер для вывода информационных и отладочных сообщений.
3.  **Функция `get_user_horse()`**::
     - `def get_user_horse() -> int | None`: Объявляет функцию для запроса номера лошади у пользователя.
     - `try...except ValueError`: Блок try-except обрабатывает возможные ошибки ввода. Если пользователь введет не целое число, то будет залогирована ошибка.
     - `user_horse = int(user_input)`: Преобразует введенный текст в целое число.
     - `if not 1 <= user_horse <= 7`: Проверяет, входит ли номер лошади в допустимый диапазон от 1 до 7.
     - `logger.error(f"Введен некорректный номер лошади: {user_horse}")`: Логирует ошибку при некорректном вводе номера.
     - `return None`: Возвращает `None` в случае ошибки.
     - `return user_horse`: Возвращает номер лошади, если ввод корректен.
4.  **Функция `run_horses_game()`**::
     - `def run_horses_game()`: Объявляет функцию для запуска игры.
     - `winning_horse = random.randint(1, 7)`: Генерирует случайное целое число от 1 до 7 и сохраняет его в переменной `winning_horse`.
     - `user_horse = get_user_horse()`: Получает номер лошади, выбранный пользователем.
     - `if user_horse is None`: Проверяет, что номер лошади введен корректно. Если нет - завершает игру.
     - `if user_horse == winning_horse`: Проверяет, равно ли введенное пользователем число загаданному числу.
     - `logger.info("УРА! ВАША ЛОШАДЬ ВЫИГРАЛА!")`: Выводит сообщение о победе, если числа равны, используя логгер.
     - `logger.info("К СОЖАЛЕНИЮ, ВЫ ПРОИГРАЛИ!")`: Выводит сообщение о проигрыше, если числа не равны, используя логгер.
5.  **Условие `if __name__ == "__main__":`**::
     - `if __name__ == "__main__":`: Запускает функцию `run_horses_game()`, если скрипт запущен как главный.
"""
```