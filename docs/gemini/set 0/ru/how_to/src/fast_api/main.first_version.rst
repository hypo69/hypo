Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код представляет собой FastAPI приложение, которое обрабатывает данные, отправленные через HTML-форму.  Приложение монтирует папку `html` в качестве статических файлов и открывает `index.html` в браузере.  Существует endpoint `/process_data`, который принимает имя и фамилию из формы, передает их скрипту `script.py`, получает ответ от скрипта и возвращает его в виде JSON.  Код также содержит обработку ошибок при выполнении `script.py` и при открытии страницы.

Шаги выполнения
-------------------------
1. **Импорт необходимых библиотек**: Модули `os`, `subprocess`, `webbrowser`, `pathlib`, `fastapi`, `Popen`, `PIPE`, `StaticFiles` импортируются для работы с файловой системой, запуском внешних скриптов, открытием браузера и обработки данных FastAPI.
2. **Инициализация FastAPI приложения**: Создаётся объект `app` типа `FastAPI`.
3. **Монтирование статических файлов**: Папка `html` монтируется как статические файлы приложения с помощью `app.mount("/")`.
4. **Открытие index.html в браузере**: Функция `webbrowser.open` открывает `index.html` в браузере.
5. **Обработка данных формы `/process_data`**:
    * Endpoint `@app.post("/process_data")` обрабатывает POST-запросы на `/process_data`.
    * Проверяет, что поля `first_name` и `last_name` заполнены. Если нет, то возвращает ошибку 400.
    * Формирует строку входных данных `input_data`.
    * Запускает скрипт `script.py` с помощью `subprocess.Popen` и передает ему входные данные.
    * Получает результат выполнения скрипта.
    * Проверяет код возврата `process.returncode`. Если он не равен 0, возвращает ошибку 500, содержащую ошибку выполнения скрипта.
    * Возвращает результат выполнения скрипта в виде JSON.
6. **Обработка запроса `/`**: Endpoint `@app.get("/")` возвращает сообщение о перенаправлении на `index.html`.
7. **Обработка ошибок**: В блоках обработки ошибок используется `HTTPException`, который возвращает ошибки FastAPI.

Пример использования
-------------------------
.. code-block:: python

    # Предположим, что у вас есть HTML-форма с полями "Имя" и "Фамилия".
    # При отправке формы данные будут переданы в endpoint /process_data

    # Пример содержимого HTML-формы:
    ```html
    <form method="POST" action="/process_data">
        Имя: <input type="text" name="first_name"><br>
        Фамилия: <input type="text" name="last_name"><br>
        <input type="submit" value="Отправить">
    </form>
    ```

    # После отправки формы на сервер будет вызван endpoint /process_data,
    # который получит имя и фамилию и передаст их `script.py`.
    # Результат выполнения `script.py` будет возвращен в формате JSON.