# Модуль show_all_results.js

## Обзор

Этот скрипт JavaScript отображает результаты поиска в веб-приложении. Он получает данные о результатах, форматирует их и выводит на страницу.  Скрипт также предоставляет возможность экспорта результатов в текстовый файл.

## Функции

### `showAllResults`

**Описание**: Функция отображает результаты поиска на странице.

**Параметры**:
- `results` (объект): Объект, содержащий данные о результатах поиска.  Ожидается, что объект содержит поля `message`, `title`, `href`, `frameId`, `context` (опционально), `main`.

**Возвращает**:
- Не имеет возвращаемого значения.

**Вызывает исключения**:
- Не обрабатывает исключения явно.  Ожидается, что `updateDetailsTable` и `onError` будут обрабатывать возможные ошибки.


### `makeTextDownloadUrl`

**Описание**:  Функция генерирует URL для скачивания текстового файла.

**Параметры**:
- `text` (строка): Текст, который нужно сохранить в файле.

**Возвращает**:
- `string`: Строка, представляющая URL для скачивания файла.

**Вызывает исключения**:
- Нет.


### `makeInfoText`

**Описание**: Функция формирует текстовое представление результатов для экспорта.

**Параметры**:
- `results` (объект): Объект, содержащий данные о результатах.

**Возвращает**:
- `string`: Строка, содержащая отформатированные результаты для экспорта в текстовый файл.

**Вызывает исключения**:
- Нет.

### `makeConvertedInfoText`

**Описание**:  Функция формирует текстовое представление результатов для экспорта в формате JSON.

**Параметры**:
- `results` (объект): Объект, содержащий данные о результатах.


**Возвращает**:
- `string`: Строка, содержащая отформатированные результаты для экспорта в текстовый файл (JSON).

**Вызывает исключения**:
- Нет.


##  Обработчики событий

**Описание:**  Обработчики событий, отвечающие за реакцию на клики кнопок.

**Обработчик события load**

- Отправляет запрос на получение результатов поиска.
- При успешном получении результатов:
    - устанавливает атрибуты `download` для ссылок экспорта,
    - формирует URL для экспорта текстового файла с результатами,
    - вызывает функцию `showAllResults` для отображения результатов на странице.
- Обрабатывает возможные ошибки с помощью `catch(fu.onError)`.

**Обработчик события click на элементе context-detail**

- Обрабатывает клики на кнопках внутри таблицы `context-detail`.
- Отправляет сообщение в активную вкладку для фокусировки элемента.

**Обработчик события click на элементе main-details**

- Обрабатывает клики на кнопках внутри таблицы `main-details`.
- Отправляет сообщение в активную вкладку для фокусировки элемента.  
- Использует `parseInt()` для конвертации атрибута `data-index` в число.


## Вспомогательные функции

### `tryxpath.functions.updateDetailsTable`

**Описание**:  Функция для обновления таблицы с детальными результатами.  Должна обрабатывать возможные ошибки.

**Параметры**:
- `tbody` (элемент): Элемент <table><tbody></table>, в котором будут обновляться данные.
- `details` (массив): Массив данных для обновления таблицы.
- `options` (объект): Объект с дополнительными параметрами.

**Возвращает**:
-  Promise: Результат выполнения `updateDetailsTable`.

**Вызывает исключения**:
-  Возможны исключения внутри функции.


### `tryxpath.functions.onError`

**Описание**:  Функция для обработки ошибок,  необходимо определить в контексте модуля `tryxpath.functions`.

**Параметры**:
-  `ex` (объект): Объект исключения.

**Возвращает**:
-  Не имеет возвращаемого значения.

**Вызывает исключения**:
-  Нет.