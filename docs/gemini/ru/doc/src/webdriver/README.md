# Модуль WebDriver Executor

## Обзор

Модуль `webdriver/executor.py` предоставляет фреймворк для управления и взаимодействия с веб-страницами с помощью WebDriver. Он обрабатывает скрипты и локаторы для автоматизации действий с веб-элементами.

## Основные возможности

- **Обработка локаторов:**
  - **Инициализация:** Класс `ExecuteLocator` инициализируется экземпляром WebDriver и опциональным списком аргументов и ключевых аргументов. Он настраивает WebDriver и цепочки действий для взаимодействия с веб-элементами.
  - **Выполнение локатора:** Метод `execute_locator` обрабатывает словарь локатора, который содержит информацию о том, как найти и взаимодействовать с веб-элементами. Он обрабатывает различные типы локаторов и действий на основе предоставленной конфигурации.
  - **Получение элемента:** Метод `get_webelement_by_locator` получает веб-элементы на основе информации локатора (XPath, ID, CSS-селекторы). Он ожидает появления элементов и может возвращать один элемент, список элементов или `False`, если элементы не найдены.
  - **Получение атрибута:** Метод `get_attribute_by_locator` получает атрибуты найденных элементов по локатору. Поддерживает как одиночные, так и множественные элементы.
  - **Отправка сообщения:** Метод `send_message` отправляет текстовый ввод в веб-элементы. Поддерживает симуляцию набора текста с настраиваемой скоростью и опциональным взаимодействием с мышкой.

- **Скриншоты:**
  - **Скриншот элемента:** Метод `get_webelement_as_screenshot` делает скриншот веб-элемента и возвращает его как изображение PNG. Поддерживает захват скриншотов нескольких элементов и обрабатывает ошибки, если элементы больше не присутствуют в DOM.

- **Действие клика:**
  - **Клик по элементу:** Метод `click` выполняет клик по веб-элементу, идентифицированному по локатору. Обрабатывает случаи, когда клик приводит к переходу на новую страницу или открытию нового окна, и регистрирует ошибки, если клик не удался.

- **Оценивание локатора:**
  - **Оценивание атрибутов:** Метод `evaluate_locator` оценивает атрибуты локатора, включая обработку специальных случаев, когда атрибуты представлены как плейсхолдеры (например, `%EXTERNAL_MESSAGE%`).


## Обработка ошибок

Модуль использует блоки `try-except` для перехвата и регистрации ошибок во время различных операций, таких как поиск элементов, отправка сообщений и захват скриншотов. Специфические исключения, такие как `NoSuchElementException` и `TimeoutException`, обрабатываются для ситуаций, когда элементы не найдены или истекло время ожидания.


## Использование

### Инициализация

Создайте экземпляр `ExecuteLocator`, передав ему экземпляр WebDriver.

### Выполнение локатора

Вызовите метод `execute_locator` со словарем локатора для выполнения действий или получения данных из веб-элементов.

### Обработка результатов

Используйте методы, такие как `get_webelement_by_locator`, `send_message`, `get_webelement_as_screenshot`, для взаимодействия с веб-элементами и обработки результатов.


## Зависимости

Модуль использует Selenium для работы с WebDriver, включая поиск элементов, отправку текста и взаимодействие с веб-страницами. Также используются встроенные библиотеки Python для обработки исключений и управления временем.

## Класс `ExecuteLocator`

### Атрибуты

- `driver`: Экземпляр WebDriver для взаимодействия с браузером.
- `actions`: Экземпляр `ActionChains` для выполнения сложных действий с веб-элементами.
- `by_mapping`: Словарь, сопоставляющий строковые представления локаторов с объектами Selenium `By`.


### Методы

Подробное описание методов класса `ExecuteLocator` будет добавлено после получения кода исходного файла.

```